!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.svgEditor=t()}(this,function(){"use strict";function e(e){var t=e.changedTouches,n=t[0],r="";switch(e.type){case"touchstart":r="mousedown";break;case"touchmove":r="mousemove";break;case"touchend":r="mouseup";break;default:return}var a=document.createEvent("MouseEvent");a.initMouseEvent(r,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),t.length<2&&(n.target.dispatchEvent(a),e.preventDefault())}document.addEventListener("touchstart",e,!0),document.addEventListener("touchmove",e,!0),document.addEventListener("touchend",e,!0),document.addEventListener("touchcancel",e,!0);var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,i){try{var o=t[a](i),s=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})}},r=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},l=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},u={HTML:"http://www.w3.org/1999/xhtml",MATH:"http://www.w3.org/1998/Math/MathML",SE:"http://svg-edit.googlecode.com",SVG:"http://www.w3.org/2000/svg",XLINK:"http://www.w3.org/1999/xlink",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"},d=function(){var e={};return Object.entries(u).forEach(function(t){var n=l(t,2),r=n[0],a=n[1];e[a]=r.toLowerCase()}),e};!function(){if(!("SVGPathSeg"in window)){var e=function(){function e(t,n,a){r(this,e),this.pathSegType=t,this.pathSegTypeAsLetter=n,this._owningPathSegList=a}return a(e,[{key:"_segmentChanged",value:function(){this._owningPathSegList&&this._owningPathSegList.segmentChanged(this)}}]),e}();e.prototype.classname="SVGPathSeg",e.PATHSEG_UNKNOWN=0,e.PATHSEG_CLOSEPATH=1,e.PATHSEG_MOVETO_ABS=2,e.PATHSEG_MOVETO_REL=3,e.PATHSEG_LINETO_ABS=4,e.PATHSEG_LINETO_REL=5,e.PATHSEG_CURVETO_CUBIC_ABS=6,e.PATHSEG_CURVETO_CUBIC_REL=7,e.PATHSEG_CURVETO_QUADRATIC_ABS=8,e.PATHSEG_CURVETO_QUADRATIC_REL=9,e.PATHSEG_ARC_ABS=10,e.PATHSEG_ARC_REL=11,e.PATHSEG_LINETO_HORIZONTAL_ABS=12,e.PATHSEG_LINETO_HORIZONTAL_REL=13,e.PATHSEG_LINETO_VERTICAL_ABS=14,e.PATHSEG_LINETO_VERTICAL_REL=15,e.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS=16,e.PATHSEG_CURVETO_CUBIC_SMOOTH_REL=17,e.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS=18,e.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL=19;var t=function(t){function n(t){return r(this,n),s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_CLOSEPATH,"z",t))}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegClosePath]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter}},{key:"clone",value:function(){return new n(void 0)}}]),n}(),n=function(t){function n(t,a,i){r(this,n);var o=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_MOVETO_ABS,"M",t));return o._x=a,o._y=i,o}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegMovetoAbs]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y)}}]),n}();Object.defineProperties(n.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0}});var i=function(t){function n(t,a,i){r(this,n);var o=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_MOVETO_REL,"m",t));return o._x=a,o._y=i,o}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegMovetoRel]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y)}}]),n}();Object.defineProperties(i.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0}});var l=function(t){function n(t,a,i){r(this,n);var o=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_LINETO_ABS,"L",t));return o._x=a,o._y=i,o}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegLinetoAbs]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y)}}]),n}();Object.defineProperties(l.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0}});var c=function(t){function n(t,a,i){r(this,n);var o=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_LINETO_REL,"l",t));return o._x=a,o._y=i,o}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegLinetoRel]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y)}}]),n}();Object.defineProperties(c.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0}});var u=function(t){function n(t,a,i,o,l,c,u){r(this,n);var d=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_CURVETO_CUBIC_ABS,"C",t));return d._x=a,d._y=i,d._x1=o,d._y1=l,d._x2=c,d._y2=u,d}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegCurvetoCubicAbs]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)}}]),n}();Object.defineProperties(u.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0},x1:{get:function(){return this._x1},set:function(e){this._x1=e,this._segmentChanged()},enumerable:!0},y1:{get:function(){return this._y1},set:function(e){this._y1=e,this._segmentChanged()},enumerable:!0},x2:{get:function(){return this._x2},set:function(e){this._x2=e,this._segmentChanged()},enumerable:!0},y2:{get:function(){return this._y2},set:function(e){this._y2=e,this._segmentChanged()},enumerable:!0}});var d=function(t){function n(t,a,i,o,l,c,u){r(this,n);var d=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_CURVETO_CUBIC_REL,"c",t));return d._x=a,d._y=i,d._x1=o,d._y1=l,d._x2=c,d._y2=u,d}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegCurvetoCubicRel]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)}}]),n}();Object.defineProperties(d.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0},x1:{get:function(){return this._x1},set:function(e){this._x1=e,this._segmentChanged()},enumerable:!0},y1:{get:function(){return this._y1},set:function(e){this._y1=e,this._segmentChanged()},enumerable:!0},x2:{get:function(){return this._x2},set:function(e){this._x2=e,this._segmentChanged()},enumerable:!0},y2:{get:function(){return this._y2},set:function(e){this._y2=e,this._segmentChanged()},enumerable:!0}});var h=function(t){function n(t,a,i,o,l){r(this,n);var c=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_CURVETO_QUADRATIC_ABS,"Q",t));return c._x=a,c._y=i,c._x1=o,c._y1=l,c}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegCurvetoQuadraticAbs]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y,this._x1,this._y1)}}]),n}();Object.defineProperties(h.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0},x1:{get:function(){return this._x1},set:function(e){this._x1=e,this._segmentChanged()},enumerable:!0},y1:{get:function(){return this._y1},set:function(e){this._y1=e,this._segmentChanged()},enumerable:!0}});var f=function(t){function n(t,a,i,o,l){r(this,n);var c=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_CURVETO_QUADRATIC_REL,"q",t));return c._x=a,c._y=i,c._x1=o,c._y1=l,c}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegCurvetoQuadraticRel]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y,this._x1,this._y1)}}]),n}();Object.defineProperties(f.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0},x1:{get:function(){return this._x1},set:function(e){this._x1=e,this._segmentChanged()},enumerable:!0},y1:{get:function(){return this._y1},set:function(e){this._y1=e,this._segmentChanged()},enumerable:!0}});var p=function(t){function n(t,a,i,o,l,c,u,d){r(this,n);var h=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_ARC_ABS,"A",t));return h._x=a,h._y=i,h._r1=o,h._r2=l,h._angle=c,h._largeArcFlag=u,h._sweepFlag=d,h}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegArcAbs]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)}}]),n}();Object.defineProperties(p.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0},r1:{get:function(){return this._r1},set:function(e){this._r1=e,this._segmentChanged()},enumerable:!0},r2:{get:function(){return this._r2},set:function(e){this._r2=e,this._segmentChanged()},enumerable:!0},angle:{get:function(){return this._angle},set:function(e){this._angle=e,this._segmentChanged()},enumerable:!0},largeArcFlag:{get:function(){return this._largeArcFlag},set:function(e){this._largeArcFlag=e,this._segmentChanged()},enumerable:!0},sweepFlag:{get:function(){return this._sweepFlag},set:function(e){this._sweepFlag=e,this._segmentChanged()},enumerable:!0}});var g=function(t){function n(t,a,i,o,l,c,u,d){r(this,n);var h=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_ARC_REL,"a",t));return h._x=a,h._y=i,h._r1=o,h._r2=l,h._angle=c,h._largeArcFlag=u,h._sweepFlag=d,h}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegArcRel]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)}}]),n}();Object.defineProperties(g.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0},r1:{get:function(){return this._r1},set:function(e){this._r1=e,this._segmentChanged()},enumerable:!0},r2:{get:function(){return this._r2},set:function(e){this._r2=e,this._segmentChanged()},enumerable:!0},angle:{get:function(){return this._angle},set:function(e){this._angle=e,this._segmentChanged()},enumerable:!0},largeArcFlag:{get:function(){return this._largeArcFlag},set:function(e){this._largeArcFlag=e,this._segmentChanged()},enumerable:!0},sweepFlag:{get:function(){return this._sweepFlag},set:function(e){this._sweepFlag=e,this._segmentChanged()},enumerable:!0}});var v=function(t){function n(t,a){r(this,n);var i=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_LINETO_HORIZONTAL_ABS,"H",t));return i._x=a,i}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegLinetoHorizontalAbs]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x}},{key:"clone",value:function(){return new n(void 0,this._x)}}]),n}();Object.defineProperty(v.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0});var m=function(t){function n(t,a){r(this,n);var i=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_LINETO_HORIZONTAL_REL,"h",t));return i._x=a,i}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegLinetoHorizontalRel]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x}},{key:"clone",value:function(){return new n(void 0,this._x)}}]),n}();Object.defineProperty(m.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0});var _=function(t){function n(t,a){r(this,n);var i=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_LINETO_VERTICAL_ABS,"V",t));return i._y=a,i}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegLinetoVerticalAbs]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._y)}}]),n}();Object.defineProperty(_.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0});var y=function(t){function n(t,a){r(this,n);var i=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_LINETO_VERTICAL_REL,"v",t));return i._y=a,i}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegLinetoVerticalRel]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._y)}}]),n}();Object.defineProperty(y.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0});var b=function(t){function n(t,a,i,o,l){r(this,n);var c=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS,"S",t));return c._x=a,c._y=i,c._x2=o,c._y2=l,c}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegCurvetoCubicSmoothAbs]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y,this._x2,this._y2)}}]),n}();Object.defineProperties(b.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0},x2:{get:function(){return this._x2},set:function(e){this._x2=e,this._segmentChanged()},enumerable:!0},y2:{get:function(){return this._y2},set:function(e){this._y2=e,this._segmentChanged()},enumerable:!0}});var x=function(t){function n(t,a,i,o,l){r(this,n);var c=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_CURVETO_CUBIC_SMOOTH_REL,"s",t));return c._x=a,c._y=i,c._x2=o,c._y2=l,c}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegCurvetoCubicSmoothRel]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y,this._x2,this._y2)}}]),n}();Object.defineProperties(x.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0},x2:{get:function(){return this._x2},set:function(e){this._x2=e,this._segmentChanged()},enumerable:!0},y2:{get:function(){return this._y2},set:function(e){this._y2=e,this._segmentChanged()},enumerable:!0}});var w=function(t){function n(t,a,i){r(this,n);var o=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS,"T",t));return o._x=a,o._y=i,o}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegCurvetoQuadraticSmoothAbs]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y)}}]),n}();Object.defineProperties(w.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0}});var S=function(t){function n(t,a,i){r(this,n);var o=s(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL,"t",t));return o._x=a,o._y=i,o}return o(n,e),a(n,[{key:"toString",value:function(){return"[object SVGPathSegCurvetoQuadraticSmoothRel]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y)}}]),n}();Object.defineProperties(S.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0}}),SVGPathElement.prototype.createSVGPathSegClosePath=function(){return new t(void 0)},SVGPathElement.prototype.createSVGPathSegMovetoAbs=function(e,t){return new n(void 0,e,t)},SVGPathElement.prototype.createSVGPathSegMovetoRel=function(e,t){return new i(void 0,e,t)},SVGPathElement.prototype.createSVGPathSegLinetoAbs=function(e,t){return new l(void 0,e,t)},SVGPathElement.prototype.createSVGPathSegLinetoRel=function(e,t){return new c(void 0,e,t)},SVGPathElement.prototype.createSVGPathSegCurvetoCubicAbs=function(e,t,n,r,a,i){return new u(void 0,e,t,n,r,a,i)},SVGPathElement.prototype.createSVGPathSegCurvetoCubicRel=function(e,t,n,r,a,i){return new d(void 0,e,t,n,r,a,i)},SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticAbs=function(e,t,n,r){return new h(void 0,e,t,n,r)},SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticRel=function(e,t,n,r){return new f(void 0,e,t,n,r)},SVGPathElement.prototype.createSVGPathSegArcAbs=function(e,t,n,r,a,i,o){return new p(void 0,e,t,n,r,a,i,o)},SVGPathElement.prototype.createSVGPathSegArcRel=function(e,t,n,r,a,i,o){return new g(void 0,e,t,n,r,a,i,o)},SVGPathElement.prototype.createSVGPathSegLinetoHorizontalAbs=function(e){return new v(void 0,e)},SVGPathElement.prototype.createSVGPathSegLinetoHorizontalRel=function(e){return new m(void 0,e)},SVGPathElement.prototype.createSVGPathSegLinetoVerticalAbs=function(e){return new _(void 0,e)},SVGPathElement.prototype.createSVGPathSegLinetoVerticalRel=function(e){return new y(void 0,e)},SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothAbs=function(e,t,n,r){return new b(void 0,e,t,n,r)},SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothRel=function(e,t,n,r){return new x(void 0,e,t,n,r)},SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothAbs=function(e,t){return new w(void 0,e,t)},SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothRel=function(e,t){return new S(void 0,e,t)},"getPathSegAtLength"in SVGPathElement.prototype||(SVGPathElement.prototype.getPathSegAtLength=function(e){if(void 0===e||!isFinite(e))throw new Error("Invalid arguments.");var t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("d",this.getAttribute("d"));var n=t.pathSegList.numberOfItems-1;if(n<=0)return 0;do{if(t.pathSegList.removeItem(n),e>t.getTotalLength())break;n--}while(n>0);return n}),window.SVGPathSeg=e,window.SVGPathSegClosePath=t,window.SVGPathSegMovetoAbs=n,window.SVGPathSegMovetoRel=i,window.SVGPathSegLinetoAbs=l,window.SVGPathSegLinetoRel=c,window.SVGPathSegCurvetoCubicAbs=u,window.SVGPathSegCurvetoCubicRel=d,window.SVGPathSegCurvetoQuadraticAbs=h,window.SVGPathSegCurvetoQuadraticRel=f,window.SVGPathSegArcAbs=p,window.SVGPathSegArcRel=g,window.SVGPathSegLinetoHorizontalAbs=v,window.SVGPathSegLinetoHorizontalRel=m,window.SVGPathSegLinetoVerticalAbs=_,window.SVGPathSegLinetoVerticalRel=y,window.SVGPathSegCurvetoCubicSmoothAbs=b,window.SVGPathSegCurvetoCubicSmoothRel=x,window.SVGPathSegCurvetoQuadraticSmoothAbs=w,window.SVGPathSegCurvetoQuadraticSmoothRel=S}if(!("SVGPathSegList"in window&&"appendItem"in SVGPathSegList.prototype)){var k=function(){function e(t){r(this,e),this._pathElement=t,this._list=this._parsePath(this._pathElement.getAttribute("d")),this._mutationObserverConfig={attributes:!0,attributeFilter:["d"]},this._pathElementMutationObserver=new MutationObserver(this._updateListFromPathMutations.bind(this)),this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)}return a(e,[{key:"_checkPathSynchronizedToList",value:function(){this._updateListFromPathMutations(this._pathElementMutationObserver.takeRecords())}},{key:"_updateListFromPathMutations",value:function(e){if(this._pathElement){var t=!1;e.forEach(function(e){"d"===e.attributeName&&(t=!0)}),t&&(this._list=this._parsePath(this._pathElement.getAttribute("d")))}}},{key:"_writeListToPath",value:function(){this._pathElementMutationObserver.disconnect(),this._pathElement.setAttribute("d",e._pathSegArrayAsString(this._list)),this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)}},{key:"segmentChanged",value:function(e){this._writeListToPath()}},{key:"clear",value:function(){this._checkPathSynchronizedToList(),this._list.forEach(function(e){e._owningPathSegList=null}),this._list=[],this._writeListToPath()}},{key:"initialize",value:function(e){return this._checkPathSynchronizedToList(),this._list=[e],e._owningPathSegList=this,this._writeListToPath(),e}},{key:"_checkValidIndex",value:function(e){if(isNaN(e)||e<0||e>=this.numberOfItems)throw new Error("INDEX_SIZE_ERR")}},{key:"getItem",value:function(e){return this._checkPathSynchronizedToList(),this._checkValidIndex(e),this._list[e]}},{key:"insertItemBefore",value:function(e,t){return this._checkPathSynchronizedToList(),t>this.numberOfItems&&(t=this.numberOfItems),e._owningPathSegList&&(e=e.clone()),this._list.splice(t,0,e),e._owningPathSegList=this,this._writeListToPath(),e}},{key:"replaceItem",value:function(e,t){return this._checkPathSynchronizedToList(),e._owningPathSegList&&(e=e.clone()),this._checkValidIndex(t),this._list[t]=e,e._owningPathSegList=this,this._writeListToPath(),e}},{key:"removeItem",value:function(e){this._checkPathSynchronizedToList(),this._checkValidIndex(e);var t=this._list[e];return this._list.splice(e,1),this._writeListToPath(),t}},{key:"appendItem",value:function(e){return this._checkPathSynchronizedToList(),e._owningPathSegList&&(e=e.clone()),this._list.push(e),e._owningPathSegList=this,this._writeListToPath(),e}},{key:"_parsePath",value:function(e){if(!e||!e.length)return[];var t=this,n=function(){function e(){r(this,e),this.pathSegList=[]}return a(e,[{key:"appendSegment",value:function(e){this.pathSegList.push(e)}}]),e}(),i=function(){function e(t){r(this,e),this._string=t,this._currentIndex=0,this._endIndex=this._string.length,this._previousCommand=SVGPathSeg.PATHSEG_UNKNOWN,this._skipOptionalSpaces()}return a(e,[{key:"_isCurrentSpace",value:function(){var e=this._string[this._currentIndex];return e<=" "&&(" "===e||"\n"===e||"\t"===e||"\r"===e||"\f"===e)}},{key:"_skipOptionalSpaces",value:function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex++;return this._currentIndex<this._endIndex}},{key:"_skipOptionalSpacesOrDelimiter",value:function(){return!(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!==this._string.charAt(this._currentIndex))&&(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","===this._string.charAt(this._currentIndex)&&(this._currentIndex++,this._skipOptionalSpaces()),this._currentIndex<this._endIndex)}},{key:"hasMoreData",value:function(){return this._currentIndex<this._endIndex}},{key:"peekSegmentType",value:function(){var e=this._string[this._currentIndex];return this._pathSegTypeFromChar(e)}},{key:"_pathSegTypeFromChar",value:function(e){switch(e){case"Z":case"z":return SVGPathSeg.PATHSEG_CLOSEPATH;case"M":return SVGPathSeg.PATHSEG_MOVETO_ABS;case"m":return SVGPathSeg.PATHSEG_MOVETO_REL;case"L":return SVGPathSeg.PATHSEG_LINETO_ABS;case"l":return SVGPathSeg.PATHSEG_LINETO_REL;case"C":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS;case"c":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL;case"Q":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS;case"q":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL;case"A":return SVGPathSeg.PATHSEG_ARC_ABS;case"a":return SVGPathSeg.PATHSEG_ARC_REL;case"H":return SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS;case"h":return SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL;case"V":return SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS;case"v":return SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL;case"S":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS;case"s":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL;case"T":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS;case"t":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL;default:return SVGPathSeg.PATHSEG_UNKNOWN}}},{key:"_nextCommandHelper",value:function(e,t){return("+"===e||"-"===e||"."===e||e>="0"&&e<="9")&&t!==SVGPathSeg.PATHSEG_CLOSEPATH?t===SVGPathSeg.PATHSEG_MOVETO_ABS?SVGPathSeg.PATHSEG_LINETO_ABS:t===SVGPathSeg.PATHSEG_MOVETO_REL?SVGPathSeg.PATHSEG_LINETO_REL:t:SVGPathSeg.PATHSEG_UNKNOWN}},{key:"initialCommandIsMoveTo",value:function(){if(!this.hasMoreData())return!0;var e=this.peekSegmentType();return e===SVGPathSeg.PATHSEG_MOVETO_ABS||e===SVGPathSeg.PATHSEG_MOVETO_REL}},{key:"_parseNumber",value:function(){var e=0,t=0,n=1,r=0,a=1,i=1,o=this._currentIndex;if(this._skipOptionalSpaces(),this._currentIndex<this._endIndex&&"+"===this._string.charAt(this._currentIndex)?this._currentIndex++:this._currentIndex<this._endIndex&&"-"===this._string.charAt(this._currentIndex)&&(this._currentIndex++,a=-1),!(this._currentIndex===this._endIndex||(this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")&&"."!==this._string.charAt(this._currentIndex))){for(var s=this._currentIndex;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)this._currentIndex++;if(this._currentIndex!==s)for(var l=this._currentIndex-1,c=1;l>=s;)t+=c*(this._string.charAt(l--)-"0"),c*=10;if(this._currentIndex<this._endIndex&&"."===this._string.charAt(this._currentIndex)){if(this._currentIndex++,this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")return;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)n*=10,r+=(this._string.charAt(this._currentIndex)-"0")/n,this._currentIndex+=1}if(this._currentIndex!==o&&this._currentIndex+1<this._endIndex&&("e"===this._string.charAt(this._currentIndex)||"E"===this._string.charAt(this._currentIndex))&&"x"!==this._string.charAt(this._currentIndex+1)&&"m"!==this._string.charAt(this._currentIndex+1)){if(this._currentIndex++,"+"===this._string.charAt(this._currentIndex)?this._currentIndex++:"-"===this._string.charAt(this._currentIndex)&&(this._currentIndex++,i=-1),this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")return;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)e*=10,e+=this._string.charAt(this._currentIndex)-"0",this._currentIndex++}var u=t+r;if(u*=a,e&&(u*=Math.pow(10,i*e)),o!==this._currentIndex)return this._skipOptionalSpacesOrDelimiter(),u}}},{key:"_parseArcFlag",value:function(){if(!(this._currentIndex>=this._endIndex)){var e=!1,t=this._string.charAt(this._currentIndex++);if("0"===t)e=!1;else{if("1"!==t)return;e=!0}return this._skipOptionalSpacesOrDelimiter(),e}}},{key:"parseSegment",value:function(){var e=this._string[this._currentIndex],n=this._pathSegTypeFromChar(e);if(n===SVGPathSeg.PATHSEG_UNKNOWN){if(this._previousCommand===SVGPathSeg.PATHSEG_UNKNOWN)return null;if((n=this._nextCommandHelper(e,this._previousCommand))===SVGPathSeg.PATHSEG_UNKNOWN)return null}else this._currentIndex++;switch(this._previousCommand=n,n){case SVGPathSeg.PATHSEG_MOVETO_REL:return new SVGPathSegMovetoRel(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_MOVETO_ABS:return new SVGPathSegMovetoAbs(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_REL:return new SVGPathSegLinetoRel(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_ABS:return new SVGPathSegLinetoAbs(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL:return new SVGPathSegLinetoHorizontalRel(t,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS:return new SVGPathSegLinetoHorizontalAbs(t,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL:return new SVGPathSegLinetoVerticalRel(t,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS:return new SVGPathSegLinetoVerticalAbs(t,this._parseNumber());case SVGPathSeg.PATHSEG_CLOSEPATH:return this._skipOptionalSpaces(),new SVGPathSegClosePath(t);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL:var r={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicRel(t,r.x,r.y,r.x1,r.y1,r.x2,r.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:var a={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicAbs(t,a.x,a.y,a.x1,a.y1,a.x2,a.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:var i={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicSmoothRel(t,i.x,i.y,i.x2,i.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:var o={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicSmoothAbs(t,o.x,o.y,o.x2,o.y2);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL:var s={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoQuadraticRel(t,s.x,s.y,s.x1,s.y1);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS:var l={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoQuadraticAbs(t,l.x,l.y,l.x1,l.y1);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:return new SVGPathSegCurvetoQuadraticSmoothRel(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:return new SVGPathSegCurvetoQuadraticSmoothAbs(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_ARC_REL:var c={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegArcRel(t,c.x,c.y,c.x1,c.y1,c.arcAngle,c.arcLarge,c.arcSweep);case SVGPathSeg.PATHSEG_ARC_ABS:var u={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegArcAbs(t,u.x,u.y,u.x1,u.y1,u.arcAngle,u.arcLarge,u.arcSweep);default:throw new Error("Unknown path seg type.")}}}]),e}(),o=new n,s=new i(e);if(!s.initialCommandIsMoveTo())return[];for(;s.hasMoreData();){var l=s.parseSegment();if(!l)return[];o.appendSegment(l)}return o.pathSegList}}]),e}();k.prototype.classname="SVGPathSegList",Object.defineProperty(k.prototype,"numberOfItems",{get:function(){return this._checkPathSynchronizedToList(),this._list.length},enumerable:!0}),k._pathSegArrayAsString=function(e){var t="",n=!0;return e.forEach(function(e){n?(n=!1,t+=e._asPathString()):t+=" "+e._asPathString()}),t},Object.defineProperties(SVGPathElement.prototype,{pathSegList:{get:function(){return this._pathSegList||(this._pathSegList=new k(this)),this._pathSegList},enumerable:!0},normalizedPathSegList:{get:function(){return this.pathSegList},enumerable:!0},animatedPathSegList:{get:function(){return this.pathSegList},enumerable:!0},animatedNormalizedPathSegList:{get:function(){return this.pathSegList},enumerable:!0}}),window.SVGPathSegList=k}}();var h,f=jQuery,p=(!!document.createElementNS&&document.createElementNS(u.SVG,"svg").createSVGRect,navigator.userAgent),g=document.createElementNS(u.SVG,"svg"),v=!!window.opera,m=p.includes("AppleWebKit"),_=p.includes("Gecko/"),y=p.includes("MSIE"),b=p.includes("Chrome/"),x=(p.includes("Windows"),p.includes("Macintosh")),w="ontouchstart"in window,S=!!g.querySelector,k=!!document.evaluate,C=function(){var e=document.createElementNS(u.SVG,"path");e.setAttribute("d","M0,0 10,10");var t=e.pathSegList,n=e.createSVGPathSegLinetoAbs(5,5);try{return t.replaceItem(n,1),!0}catch(e){}return!1}(),A=function(){var e=document.createElementNS(u.SVG,"path");e.setAttribute("d","M0,0 10,10");var t=e.pathSegList,n=e.createSVGPathSegLinetoAbs(5,5);try{return t.insertItemBefore(n,1),!0}catch(e){}return!1}(),E=function(){var e=document.createElementNS(u.SVG,"svg"),t=document.createElementNS(u.SVG,"svg");document.documentElement.append(e),t.setAttribute("x",5),e.append(t);var n=document.createElementNS(u.SVG,"text");n.textContent="a",t.append(n);var r=n.getStartPositionOfChar(0).x;return e.remove(),0===r}(),P=function(){var e=document.createElementNS(u.SVG,"svg");document.documentElement.append(e);var t=document.createElementNS(u.SVG,"path");t.setAttribute("d","M0,0 C0,0 10,10 10,0"),e.append(t);var n=t.getBBox();return e.remove(),n.height>4&&n.height<5}(),G=function(){var e=document.createElementNS(u.SVG,"svg");document.documentElement.append(e);var t=document.createElementNS(u.SVG,"path");t.setAttribute("d","M0,0 10,0");var n=document.createElementNS(u.SVG,"path");n.setAttribute("d","M5,0 15,0");var r=document.createElementNS(u.SVG,"g");r.append(t,n),e.append(r);var a=r.getBBox();return e.remove(),15===a.width}(),I=(function(){var e=document.createElementNS(u.SVG,"rect");e.setAttribute("x",.1);var t=!e.cloneNode(!1).getAttribute("x").includes(",");t||f.alert('NOTE: This version of Opera is known to contain bugs in SVG-edit.\nPlease upgrade to the <a href="http://opera.com">latest version</a> in which the problems have been fixed.')}(),(h=document.createElementNS(u.SVG,"rect")).setAttribute("style","vector-effect:non-scaling-stroke"),"non-scaling-stroke"===h.style.vectorEffect),T=function(){var e=document.createElementNS(u.SVG,"rect").transform.baseVal,t=g.createSVGTransform();e.appendItem(t);var n=e.getItem(0);return n instanceof SVGTransform&&t instanceof SVGTransform&&n.type===t.type&&n.angle===t.angle&&n.matrix.a===t.matrix.a&&n.matrix.b===t.matrix.b&&n.matrix.c===t.matrix.c&&n.matrix.d===t.matrix.d&&n.matrix.e===t.matrix.e&&n.matrix.f===t.matrix.f}(),N=function(){return v},L=function(){return m},M=function(){return _},O=function(){return y},V=function(){return b},j=function(){return x},R=function(){return w},B=function(){return G},D=function(){return I};function U(e){var n=e.fn.attr;return e.fn.attr=function(e,r){var a=this.length;if(!a)return n.apply(this,arguments);for(var i=0;i<a;++i){var o=this[i];if("http://www.w3.org/2000/svg"!==o.namespaceURI)return n.apply(this,arguments);if(void 0!==r)o.setAttribute(e,r);else if(Array.isArray(e)){for(var s={},l=e.length;l--;){var c=e[l],u=o.getAttribute(c);(u||"0"===u)&&(u=isNaN(u)?u:u-0),s[c]=u}return s}if("object"!==(void 0===e?"undefined":t(e))){var d=o.getAttribute(e);return(d||"0"===d)&&(d=isNaN(d)?d:d-0),d}for(var h in e)o.setAttribute(h,e[h])}return this},e}var F=document.createElementNS(u.SVG,"svg");function H(e){var t=e.matrix,n="";switch(e.type){case 1:n="matrix("+[t.a,t.b,t.c,t.d,t.e,t.f].join(",")+")";break;case 2:n="translate("+t.e+","+t.f+")";break;case 3:n=t.a===t.d?"scale("+t.a+")":"scale("+t.a+","+t.d+")";break;case 4:var r=0,a=0;if(0!==e.angle){var i=1-t.a;a=(i*t.f+t.b*t.e)/(i*i+t.b*t.b),r=(t.e-t.b*a)/i}n="rotate("+e.angle+" "+r+","+a+")"}return n}var z={},q=function e(t){r(this,e),this._elem=t||null,this._xforms=[],this._update=function(){var e="";F.createSVGMatrix();for(var t=0;t<this.numberOfItems;++t){e+=H(this._list.getItem(t))+" "}this._elem.setAttribute("transform",e)},this._list=this,this._init=function(){var e=this,t=this._elem.getAttribute("transform");if(t)for(var n=/\s*((scale|matrix|rotate|translate)\s*\(.*?\))\s*,?\s*/,r=!0;r;)r=t.match(n),t=t.replace(n,""),r&&r[1]&&function(){var t=r[1].split(/\s*\(/),n=t[0],a=t[1].match(/\s*(.*?)\s*\)/);a[1]=a[1].replace(/(\d)-/g,"$1 -");var i=a[1].split(/[, ]+/),o="abcdef".split(""),s=F.createSVGMatrix();Object.values(i).forEach(function(e,t){i[t]=parseFloat(e),"matrix"===n&&(s[o[t]]=i[t])});var l=F.createSVGTransform(),c="set"+n.charAt(0).toUpperCase()+n.slice(1),u="matrix"===n?[s]:i;"scale"===n&&1===u.length?u.push(u[0]):"translate"===n&&1===u.length?u.push(0):"rotate"===n&&1===u.length&&u.push(0,0),l[c].apply(l,u),e._list.appendItem(l)}()},this._removeFromOtherLists=function(e){if(e){var t=!1;for(var n in z){for(var r=z[n],a=0,i=r._xforms.length;a<i;++a)if(r._xforms[a]===e){t=!0,r.removeItem(a);break}if(t)break}}},this.numberOfItems=0,this.clear=function(){this.numberOfItems=0,this._xforms=[]},this.initialize=function(e){this.numberOfItems=1,this._removeFromOtherLists(e),this._xforms=[e]},this.getItem=function(e){if(e<this.numberOfItems&&e>=0)return this._xforms[e];var t=new Error("DOMException with code=INDEX_SIZE_ERR");throw t.code=1,t},this.insertItemBefore=function(e,t){var n=null;if(t>=0)if(t<this.numberOfItems){this._removeFromOtherLists(e);var r=new Array(this.numberOfItems+1),a=void 0;for(a=0;a<t;++a)r[a]=this._xforms[a];r[a]=e;for(var i=a+1;a<this.numberOfItems;++i,++a)r[i]=this._xforms[a];this.numberOfItems++,this._xforms=r,n=e,this._list._update()}else n=this._list.appendItem(e);return n},this.replaceItem=function(e,t){var n=null;return t<this.numberOfItems&&t>=0&&(this._removeFromOtherLists(e),this._xforms[t]=e,n=e,this._list._update()),n},this.removeItem=function(e){if(e<this.numberOfItems&&e>=0){var t=this._xforms[e],n=new Array(this.numberOfItems-1),r=void 0;for(r=0;r<e;++r)n[r]=this._xforms[r];for(var a=r;a<this.numberOfItems-1;++a,++r)n[a]=this._xforms[r+1];return this.numberOfItems--,this._xforms=n,this._list._update(),t}var i=new Error("DOMException with code=INDEX_SIZE_ERR");throw i.code=1,i},this.appendItem=function(e){return this._removeFromOtherLists(e),this._xforms.push(e),this.numberOfItems++,this._list._update(),e}},Y=function(e){e.id&&z[e.id]&&delete z[e.id]},W=function(e){if(!T){var t=e.id||"temp",n=z[t];return n&&"temp"!==t||(z[t]=new q(e),z[t]._init(),n=z[t]),n}return e.transform?e.transform.baseVal:e.gradientTransform?e.gradientTransform.baseVal:e.patternTransform?e.patternTransform.baseVal:null},X=["x","x1","cx","rx","width"],Q=["y","y1","cy","ry","height"],K=["r","radius"].concat(X,Q),Z=void 0,$={},J=function(){return $},ee=function e(t){var n=Z.getRoundDigits();return isNaN(t)?Array.isArray(t)?e(t[0])+","+e(t[1]):parseFloat(t).toFixed(n)-0:+(+t).toFixed(n)},te=function(e,t){return t=t||Z.getBaseUnit(),ee(e/$[t])},ne=function(e,t){if(!isNaN(t))return t-0;if("%"===t.substr(-1)){var n=t.substr(0,t.length-1)/100,r=Z.getWidth(),a=Z.getHeight();return X.includes(e)?n*r:Q.includes(e)?n*a:n*Math.sqrt(r*r+a*a)/Math.sqrt(2)}var i=t.substr(-2);return t.substr(0,t.length-2)*$[i]},re=function(e,t,n){if(K.includes(e))return!isNaN(t)||(t=t.toLowerCase(),Object.keys($).some(function(e){return new RegExp("^-?[\\d\\.]+"+e+"$").test(t)}));if("id"===e){var r=!1;try{var a=Z.getElement(t);r=null==a||a===n}catch(e){}return r}return!0},ae={BEFORE_APPLY:"before_apply",AFTER_APPLY:"after_apply",BEFORE_UNAPPLY:"before_unapply",AFTER_UNAPPLY:"after_unapply"},ie=function(){function e(t,n,a,i){r(this,e),this.elem=t,this.text=i?"Move "+t.tagName+" to "+i:"Move "+t.tagName,this.oldNextSibling=n,this.oldParent=a,this.newNextSibling=t.nextSibling,this.newParent=t.parentNode}return a(e,[{key:"getText",value:function(){return this.text}},{key:"type",value:function(){return"svgedit.history.MoveElementCommand"}},{key:"apply",value:function(e){e&&e.handleHistoryEvent(ae.BEFORE_APPLY,this),this.elem=this.newParent.insertBefore(this.elem,this.newNextSibling),e&&e.handleHistoryEvent(ae.AFTER_APPLY,this)}},{key:"unapply",value:function(e){e&&e.handleHistoryEvent(ae.BEFORE_UNAPPLY,this),this.elem=this.oldParent.insertBefore(this.elem,this.oldNextSibling),e&&e.handleHistoryEvent(ae.AFTER_UNAPPLY,this)}},{key:"elements",value:function(){return[this.elem]}}]),e}();ie.type=ie.prototype.type;var oe=function(){function e(t,n){r(this,e),this.elem=t,this.text=n||"Create "+t.tagName,this.parent=t.parentNode,this.nextSibling=this.elem.nextSibling}return a(e,[{key:"type",value:function(){return"svgedit.history.InsertElementCommand"}},{key:"getText",value:function(){return this.text}},{key:"apply",value:function(e){e&&e.handleHistoryEvent(ae.BEFORE_APPLY,this),this.elem=this.parent.insertBefore(this.elem,this.nextSibling),e&&e.handleHistoryEvent(ae.AFTER_APPLY,this)}},{key:"unapply",value:function(e){e&&e.handleHistoryEvent(ae.BEFORE_UNAPPLY,this),this.parent=this.elem.parentNode,this.elem=this.elem.parentNode.removeChild(this.elem),e&&e.handleHistoryEvent(ae.AFTER_UNAPPLY,this)}},{key:"elements",value:function(){return[this.elem]}}]),e}();oe.type=oe.prototype.type;var se=function(){function e(t,n,a,i){r(this,e),this.elem=t,this.text=i||"Delete "+t.tagName,this.nextSibling=n,this.parent=a,Y(t)}return a(e,[{key:"type",value:function(){return"svgedit.history.RemoveElementCommand"}},{key:"getText",value:function(){return this.text}},{key:"apply",value:function(e){e&&e.handleHistoryEvent(ae.BEFORE_APPLY,this),Y(this.elem),this.parent=this.elem.parentNode,this.elem=this.parent.removeChild(this.elem),e&&e.handleHistoryEvent(ae.AFTER_APPLY,this)}},{key:"unapply",value:function(e){e&&e.handleHistoryEvent(ae.BEFORE_UNAPPLY,this),Y(this.elem),null==this.nextSibling&&window.console&&console.log("Error: reference element was lost"),this.parent.insertBefore(this.elem,this.nextSibling),e&&e.handleHistoryEvent(ae.AFTER_UNAPPLY,this)}},{key:"elements",value:function(){return[this.elem]}}]),e}();se.type=se.prototype.type;var le=function(){function e(t,n,a){for(var i in r(this,e),this.elem=t,this.text=a?"Change "+t.tagName+" "+a:"Change "+t.tagName,this.newValues={},this.oldValues=n,n)this.newValues[i]="#text"===i?t.textContent:"#href"===i?Et(t):t.getAttribute(i)}return a(e,[{key:"type",value:function(){return"svgedit.history.ChangeElementCommand"}},{key:"getText",value:function(){return this.text}},{key:"apply",value:function(e){e&&e.handleHistoryEvent(ae.BEFORE_APPLY,this);var t=!1;for(var n in this.newValues)this.newValues[n]?"#text"===n?this.elem.textContent=this.newValues[n]:"#href"===n?Pt(this.elem,this.newValues[n]):this.elem.setAttribute(n,this.newValues[n]):"#text"===n?this.elem.textContent="":(this.elem.setAttribute(n,""),this.elem.removeAttribute(n)),"transform"===n&&(t=!0);if(!t){var r=Ht(this.elem);if(r){var a=this.elem.getBBox(),i=["rotate(",r," ",a.x+a.width/2,",",a.y+a.height/2,")"].join("");i!==this.elem.getAttribute("transform")&&this.elem.setAttribute("transform",i)}}return e&&e.handleHistoryEvent(ae.AFTER_APPLY,this),!0}},{key:"unapply",value:function(e){e&&e.handleHistoryEvent(ae.BEFORE_UNAPPLY,this);var t=!1;for(var n in this.oldValues)this.oldValues[n]?"#text"===n?this.elem.textContent=this.oldValues[n]:"#href"===n?Pt(this.elem,this.oldValues[n]):this.elem.setAttribute(n,this.oldValues[n]):"#text"===n?this.elem.textContent="":this.elem.removeAttribute(n),"transform"===n&&(t=!0);if(!t){var r=Ht(this.elem);if(r){var a=this.elem.getBBox(),i=["rotate(",r," ",a.x+a.width/2,",",a.y+a.height/2,")"].join("");i!==this.elem.getAttribute("transform")&&this.elem.setAttribute("transform",i)}}return Y(this.elem),e&&e.handleHistoryEvent(ae.AFTER_UNAPPLY,this),!0}},{key:"elements",value:function(){return[this.elem]}}]),e}();le.type=le.prototype.type;var ce=function(){function e(t){r(this,e),this.text=t||"Batch Command",this.stack=[]}return a(e,[{key:"type",value:function(){return"svgedit.history.BatchCommand"}},{key:"getText",value:function(){return this.text}},{key:"apply",value:function(e){e&&e.handleHistoryEvent(ae.BEFORE_APPLY,this);for(var t=this.stack.length,n=0;n<t;++n)this.stack[n].apply(e);e&&e.handleHistoryEvent(ae.AFTER_APPLY,this)}},{key:"unapply",value:function(e){e&&e.handleHistoryEvent(ae.BEFORE_UNAPPLY,this);for(var t=this.stack.length-1;t>=0;t--)this.stack[t].unapply(e);e&&e.handleHistoryEvent(ae.AFTER_UNAPPLY,this)}},{key:"elements",value:function(){for(var e=[],t=this.stack.length;t--;)for(var n=this.stack[t].elements(),r=n.length;r--;)e.includes(n[r])||e.push(n[r]);return e}},{key:"addSubCommand",value:function(e){this.stack.push(e)}},{key:"isEmpty",value:function(){return!this.stack.length}}]),e}();ce.type=ce.prototype.type;var ue=function(){function e(t){r(this,e),this.handler_=t||null,this.undoStackPointer=0,this.undoStack=[],this.undoChangeStackPointer=-1,this.undoableChangeStack=[]}return a(e,[{key:"resetUndoStack",value:function(){this.undoStack=[],this.undoStackPointer=0}},{key:"getUndoStackSize",value:function(){return this.undoStackPointer}},{key:"getRedoStackSize",value:function(){return this.undoStack.length-this.undoStackPointer}},{key:"getNextUndoCommandText",value:function(){return this.undoStackPointer>0?this.undoStack[this.undoStackPointer-1].getText():""}},{key:"getNextRedoCommandText",value:function(){return this.undoStackPointer<this.undoStack.length?this.undoStack[this.undoStackPointer].getText():""}},{key:"undo",value:function(){this.undoStackPointer>0&&this.undoStack[--this.undoStackPointer].unapply(this.handler_)}},{key:"redo",value:function(){this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0&&this.undoStack[this.undoStackPointer++].apply(this.handler_)}},{key:"addCommandToHistory",value:function(e){this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0&&(this.undoStack=this.undoStack.splice(0,this.undoStackPointer)),this.undoStack.push(e),this.undoStackPointer=this.undoStack.length}},{key:"beginUndoableChange",value:function(e,t){for(var n=++this.undoChangeStackPointer,r=t.length,a=new Array(r),i=new Array(r);r--;){var o=t[r];null!=o&&(i[r]=o,a[r]=o.getAttribute(e))}this.undoableChangeStack[n]={attrName:e,oldValues:a,elements:i}}},{key:"finishUndoableChange",value:function(){for(var e=this.undoChangeStackPointer--,t=this.undoableChangeStack[e],n=t.attrName,r=new ce("Change "+n),a=t.elements.length;a--;){var i=t.elements[a];if(null!=i){var o={};o[n]=t.oldValues[a],o[n]!==i.getAttribute(n)&&r.addSubCommand(new le(i,o,n))}}return this.undoableChangeStack[e]=null,r}}]),e}(),de=Object.freeze({HistoryEventTypes:ae,MoveElementCommand:ie,InsertElementCommand:oe,RemoveElementCommand:se,ChangeElementCommand:le,BatchCommand:ce,UndoManager:ue}),he=document.createElementNS(u.SVG,"svg"),fe=function(e,t,n){return{x:n.a*e+n.c*t+n.e,y:n.b*e+n.d*t+n.f}},pe=function(e){return 1===e.a&&0===e.b&&0===e.c&&1===e.d&&0===e.e&&0===e.f},ge=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.reduceRight(function(e,t){return t.multiply(e)});return Math.abs(r.a)<1e-14&&(r.a=0),Math.abs(r.b)<1e-14&&(r.b=0),Math.abs(r.c)<1e-14&&(r.c=0),Math.abs(r.d)<1e-14&&(r.d=0),Math.abs(r.e)<1e-14&&(r.e=0),Math.abs(r.f)<1e-14&&(r.f=0),r},ve=function(e){if(!e)return!1;for(var t=e.numberOfItems;t--;){var n=e.getItem(t);if(1===n.type&&!pe(n.matrix))return!0}return!1},me=function(e,t,n,r,a){var i=fe(e,t,a),o=fe(e+n,t,a),s=fe(e,t+r,a),l=fe(e+n,t+r,a),c=Math.min(i.x,o.x,s.x,l.x),u=Math.max(i.x,o.x,s.x,l.x),d=Math.min(i.y,o.y,s.y,l.y);return{tl:i,tr:o,bl:s,br:l,aabox:{x:c,y:d,width:u-c,height:Math.max(i.y,o.y,s.y,l.y)-d}}},_e=function(e,t,n){if(null==e)return he.createSVGTransformFromMatrix(he.createSVGMatrix());if(t=t||0,n=n||e.numberOfItems-1,(t=parseInt(t,10))>(n=parseInt(n,10))){var r=n;n=t,t=r}for(var a=he.createSVGMatrix(),i=t;i<=n;++i){var o=i>=0&&i<e.numberOfItems?e.getItem(i).matrix:he.createSVGMatrix();a=ge(a,o)}return he.createSVGTransformFromMatrix(a)},ye=function(e){var t=W(e);return _e(t).matrix},be=function(e,t,n,r){var a=Math.PI/4,i=n-e,o=r-t,s=Math.atan2(o,i),l=Math.sqrt(i*i+o*o),c=Math.round(s/a)*a;return{x:e+l*Math.cos(c),y:t+l*Math.sin(c),a:c}},xe=function(e,t){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y},we=jQuery,Se={2:["x","y"],4:["x","y"],6:["x","y","x1","y1","x2","y2"],8:["x","y","x1","y1"],10:["x","y","r1","r2","angle","largeArcFlag","sweepFlag"],12:["x"],14:["y"],16:["x","y","x2","y2"],18:["x","y"]},ke={},Ce=function(e){Object.assign(ke,e.ui)},Ae=[],Ee=!0,Pe={},Ge=null,Ie=null,Te=function(e){Ie=e,Ae=[0,"ClosePath"];we.each(["Moveto","Lineto","CurvetoCubic","CurvetoQuadratic","Arc","LinetoHorizontal","LinetoVertical","CurvetoCubicSmooth","CurvetoQuadraticSmooth"],function(e,t){Ae.push(t+"Abs"),Ae.push(t+"Rel")})},Ne=function(e,t,n){var r=e.pathSegList;if(A)r.insertItemBefore(t,n);else{for(var a=r.numberOfItems,i=[],o=0;o<a;o++){var s=r.getItem(o);i.push(s)}r.clear();for(var l=0;l<a;l++)l===n&&r.appendItem(t),r.appendItem(i[l])}},Le=function(e,t){var n=e.path,r={x:t?t.x:e.item.x,y:t?t.y:e.item.y};n.matrix&&(r=fe(r.x,r.y,n.matrix));var a=Ie.getCurrentZoom();return r.x*=a,r.y*=a,r},Me=function(e,t){var n={x:e.x,y:e.y};t.matrix&&(e=fe(n.x,n.y,t.imatrix),n.x=e.x,n.y=e.y);var r=Ie.getCurrentZoom();return n.x/=r,n.y/=r,n},Oe=function(e,t,n){var r=Ve(),a=qt("pathpointgrip_"+e);if(!a){a=document.createElementNS(u.SVG,"circle");var i={id:"pathpointgrip_"+e,display:"none",r:4,fill:"#0FF",stroke:"#00F","stroke-width":2,cursor:"move",style:"pointer-events:all"};"pathNodeTooltip"in ke&&(i["xlink:title"]=ke.pathNodeTooltip),Yt(a,i),a=r.appendChild(a),we("#pathpointgrip_"+e).dblclick(function(){Ge&&Ge.setSegType()})}return t&&n&&Yt(a,{cx:t,cy:n,display:"inline"}),a},Ve=function(){var e=qt("pathpointgrip_container");e||((e=qt("selectorParentGroup").appendChild(document.createElementNS(u.SVG,"g"))).id="pathpointgrip_container");return e},je=function(e){var t=qt("ctrlpointgrip_"+e);if(t)return t;t=document.createElementNS(u.SVG,"circle");var n={id:"ctrlpointgrip_"+e,display:"none",r:4,fill:"#0FF",stroke:"#55F","stroke-width":1,cursor:"move",style:"pointer-events:all"};return"pathCtrlPtTooltip"in ke&&(n["xlink:title"]=ke.pathCtrlPtTooltip),Yt(t,n),Ve().append(t),t},Re=function(e){var t=qt("ctrlLine_"+e);return t||(t=document.createElementNS(u.SVG,"line"),Yt(t,{id:"ctrlLine_"+e,stroke:"#555","stroke-width":1,style:"pointer-events:none"}),Ve().append(t),t)},Be=function(e){var t=e.item,n=e.index;if(!("x1"in t&&"x2"in t))return null;var r={};Ve();for(var a=[Ge.segs[n-1].item,t],i=1;i<3;i++){var o=n+"c"+i,s=r["c"+i+"_line"]=Re(o),l=Le(e,{x:t["x"+i],y:t["y"+i]}),c=Le(e,{x:a[i-1].x,y:a[i-1].y});Yt(s,{x1:l.x,y1:l.y,x2:c.x,y2:c.y,display:"inline"}),r["c"+i+"_line"]=s;var u=r["c"+i]=je(o);Yt(u,{cx:l.x,cy:l.y,display:"inline"}),r["c"+i]=u}return r},De=function(e,t,n,r){var a=r||Ge.elem,i=a["createSVGPathSeg"+Ae[e]].apply(a,n);if(C)a.pathSegList.replaceItem(i,t);else{for(var o=a.pathSegList,s=o.numberOfItems,l=[],c=0;c<s;c++){var u=o.getItem(c);l.push(u)}o.clear();for(var d=0;d<s;d++)d===t?o.appendItem(i):o.appendItem(l[d])}},Ue=function(e,t){var n=e.index,r=qt("segline_"+n);if(!r){var a=Ve();r=document.createElementNS(u.SVG,"path"),Yt(r,{id:"segline_"+n,display:"none",fill:"none",stroke:"#0FF","stroke-width":2,style:"pointer-events:none",d:"M0,0 0,0"}),a.append(r)}if(t){var i=e.prev;if(!i)return r.setAttribute("display","none"),r;var o=Le(i);De(2,0,[o.x,o.y],r);for(var s=function(e,t){for(var n=Se[e],r=n.length,a=[],i=0;i<r;i++)a[i]=t[n[i]];return a}(e.type,e.item),l=0;l<s.length;l+=2){var c=Le(e,{x:s[l],y:s[l+1]});s[l]=c.x,s[l+1]=c.y}De(e.type,1,s,r)}return r},Fe=function(e,t,n){var r=e.x-n.x,a=e.y-n.y,i=t.x-n.x,o=t.y-n.y;if(!(0===r&&0===a||0===i&&0===o)){var s=Math.sqrt(r*r+a*a),l=Math.sqrt(i*i+o*o),c=Ie.getSVGRoot().createSVGPoint(),u=Ie.getSVGRoot().createSVGPoint(),d=Math.atan2(a,r),h=Math.atan2(o,i);d<0&&(d+=2*Math.PI),h<0&&(h+=2*Math.PI);var f=Math.abs(d-h),p=Math.abs(Math.PI-f)/2,g=void 0,v=void 0;return d-h>0?(g=f<Math.PI?d+p:d-p,v=f<Math.PI?h-p:h+p):(g=f<Math.PI?d-p:d+p,v=f<Math.PI?h+p:h-p),c.x=s*Math.cos(g)+n.x,c.y=s*Math.sin(g)+n.y,u.x=l*Math.cos(v)+n.x,u.y=l*Math.sin(v)+n.y,[c,u]}},He=function(){function e(t,n){r(this,e),this.selected=!1,this.index=t,this.item=n,this.type=n.pathSegType,this.ctrlpts=[],this.ptgrip=null,this.segsel=null}return a(e,[{key:"showCtrlPts",value:function(e){for(var t in this.ctrlpts)this.ctrlpts.hasOwnProperty(t)&&this.ctrlpts[t].setAttribute("display",e?"inline":"none")}},{key:"selectCtrls",value:function(e){we("#ctrlpointgrip_"+this.index+"c1, #ctrlpointgrip_"+this.index+"c2").attr("fill",e?"#0FF":"#EEE")}},{key:"show",value:function(e){this.ptgrip&&(this.ptgrip.setAttribute("display",e?"inline":"none"),this.segsel.setAttribute("display",e?"inline":"none"),this.showCtrlPts(e))}},{key:"select",value:function(e){this.ptgrip&&(this.ptgrip.setAttribute("stroke",e?"#0FF":"#00F"),this.segsel.setAttribute("display",e?"inline":"none"),this.ctrlpts&&this.selectCtrls(e),this.selected=e)}},{key:"addGrip",value:function(){this.ptgrip=function(e,t){var n=e.index,r=Oe(n);if(t){var a=Le(e);Yt(r,{cx:a.x,cy:a.y,display:"inline"})}return r}(this,!0),this.ctrlpts=Be(this),this.segsel=Ue(this,!0)}},{key:"update",value:function(e){if(this.ptgrip){var t=Le(this);Yt(this.ptgrip,{cx:t.x,cy:t.y}),Ue(this,!0),this.ctrlpts&&(e&&(this.item=Ge.elem.pathSegList.getItem(this.index),this.type=this.item.pathSegType),Be(this))}}},{key:"move",value:function(e,t){var n=this.item,r=this.ctrlpts?[n.x+=e,n.y+=t,n.x1,n.y1,n.x2+=e,n.y2+=t]:[n.x+=e,n.y+=t];if(De(this.type,this.index,r),this.next&&this.next.ctrlpts){var a=this.next.item,i=[a.x,a.y,a.x1+=e,a.y1+=t,a.x2,a.y2];De(this.next.type,this.next.index,i)}if(this.mate){var o=this.mate.item,s=[o.x+=e,o.y+=t];De(this.mate.type,this.mate.index,s)}this.update(!0),this.next&&this.next.update(!0)}},{key:"setLinked",value:function(e){var t=void 0,n=void 0,r=void 0;if(2===e){if(n=1,!(t=this.next))return;r=this.item}else{if(n=2,!(t=this.prev))return;r=t.item}var a=t.item;a["x"+n]=r.x+(r.x-this.item["x"+e]),a["y"+n]=r.y+(r.y-this.item["y"+e]);var i=[a.x,a.y,a.x1,a.y1,a.x2,a.y2];De(t.type,t.index,i),t.update(!0)}},{key:"moveCtrl",value:function(e,t,n){var r=this.item;r["x"+e]+=t,r["y"+e]+=n;var a=[r.x,r.y,r.x1,r.y1,r.x2,r.y2];De(this.type,this.index,a),this.update(!0)}},{key:"setType",value:function(e,t){De(e,this.index,t),this.type=e,this.item=Ge.elem.pathSegList.getItem(this.index),this.showCtrlPts(6===e),this.ctrlpts=Be(this),this.update(!0)}}]),e}(),ze=function(){function e(t){if(r(this,e),!t||"path"!==t.tagName)throw new Error("svgedit.path.Path constructed without a <path> element");this.elem=t,this.segs=[],this.selected_pts=[],Ge=this,this.init()}return a(e,[{key:"init",value:function(){we(Ve()).find("*").each(function(){we(this).attr("display","none")});var e=this.elem.pathSegList,t=e.numberOfItems;this.segs=[],this.selected_pts=[],this.first_seg=null;for(var n=0;n<t;n++){var r=e.getItem(n),a=new He(n,r);a.path=this,this.segs.push(a)}for(var i=this.segs,o=null,s=0;s<t;s++){var l=i[s],c=s+1>=t?null:i[s+1],u=s-1<0?null:i[s-1];if(2===l.type){if(u&&1!==u.type){var d=i[o];d.next=i[o+1],d.next.prev=d,d.addGrip()}o=s}else if(c&&1===c.type)l.next=i[o+1],l.next.prev=l,l.mate=i[o],l.addGrip(),null==this.first_seg&&(this.first_seg=l);else if(c)1!==l.type&&(l.addGrip(),c&&2!==c.type&&(l.next=c,l.next.prev=l));else if(1!==l.type){var h=i[o];h.next=i[o+1],h.next.prev=h,h.addGrip(),l.addGrip(),this.first_seg||(this.first_seg=i[o])}}return this}},{key:"eachSeg",value:function(e){for(var t=this.segs.length,n=0;n<t;n++){if(!1===e.call(this.segs[n],n))break}}},{key:"addSeg",value:function(e){var t=this.segs[e];if(t.prev){var n=t.prev,r=void 0,a=void 0,i=void 0;switch(t.item.pathSegType){case 4:a=(t.item.x+n.item.x)/2,i=(t.item.y+n.item.y)/2,r=this.elem.createSVGPathSegLinetoAbs(a,i);break;case 6:var o=(n.item.x+t.item.x1)/2,s=(t.item.x1+t.item.x2)/2,l=(t.item.x2+t.item.x)/2,c=(o+s)/2,u=(s+l)/2;a=(c+u)/2;var d=(n.item.y+t.item.y1)/2,h=(t.item.y1+t.item.y2)/2,f=(t.item.y2+t.item.y)/2,p=(d+h)/2,g=(h+f)/2;i=(p+g)/2,r=this.elem.createSVGPathSegCurvetoCubicAbs(a,i,o,d,c,p);var v=[t.item.x,t.item.y,u,g,l,f];De(t.type,e,v)}Ne(this.elem,r,e)}}},{key:"deleteSeg",value:function(e){var t=this.segs[e],n=this.elem.pathSegList;t.show(!1);var r=t.next;if(t.mate){var a=[r.item.x,r.item.y];De(2,r.index,a),De(4,t.index,a),n.removeItem(t.mate.index)}else if(t.prev)n.removeItem(e);else{var i=[r.item.x,r.item.y];De(2,t.next.index,i),n.removeItem(e)}}},{key:"subpathIsClosed",value:function(e){var t=!1;return Ge.eachSeg(function(n){return n<=e||2!==this.type&&(1===this.type?(t=!0,!1):void 0)}),t}},{key:"removePtFromSelection",value:function(e){var t=this.selected_pts.indexOf(e);-1!==t&&(this.segs[e].select(!1),this.selected_pts.splice(t,1))}},{key:"clearSelection",value:function(){this.eachSeg(function(){this.select(!1)}),this.selected_pts=[]}},{key:"storeD",value:function(){this.last_d=this.elem.getAttribute("d")}},{key:"show",value:function(e){return this.eachSeg(function(){this.show(e)}),e&&this.selectPt(this.first_seg.index),this}},{key:"movePts",value:function(e,t){for(var n=this.selected_pts.length;n--;){this.segs[this.selected_pts[n]].move(e,t)}}},{key:"moveCtrl",value:function(e,t){var n=this.segs[this.selected_pts[0]];n.moveCtrl(this.dragctrl,e,t),Ee&&n.setLinked(this.dragctrl)}},{key:"setSegType",value:function(e){this.storeD();for(var t=this.selected_pts.length,n=void 0;t--;){var r=this.selected_pts[t],a=this.segs[r],i=a.prev;if(i){if(!e)n="Toggle Path Segment Type",e=6===a.type?4:6;e=Number(e);var o=a.item.x,s=a.item.y,l=i.item.x,c=i.item.y,u=void 0;switch(e){case 6:if(a.olditem){var d=a.olditem;u=[o,s,d.x1,d.y1,d.x2,d.y2]}else{var h=o-l,f=s-c;u=[o,s,l+h/3,c+f/3,o-h/3,s-f/3]}break;case 4:u=[o,s],a.olditem=a.item}a.setType(e,u)}}Ge.endChanges(n)}},{key:"selectPt",value:function(e,t){this.clearSelection(),null==e&&this.eachSeg(function(t){this.prev&&(e=t)}),this.addPtsToSelection(e),t&&(this.dragctrl=t,Ee&&this.segs[e].setLinked(t))}},{key:"update",value:function(){var e=this.elem;return Ht(e)?(this.matrix=ye(e),this.imatrix=this.matrix.inverse()):(this.matrix=null,this.imatrix=null),this.eachSeg(function(t){this.item=e.pathSegList.getItem(t),this.update()}),this}},{key:"endChanges",value:function(e){L()&&Ie.resetD(this.elem);var t=new le(this.elem,{d:this.last_d},e);Ie.endChanges({cmd:t,elem:this.elem})}},{key:"addPtsToSelection",value:function(e){Array.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++){var n=e[t];this.segs[n].ptgrip&&!this.selected_pts.includes(n)&&n>=0&&this.selected_pts.push(n)}this.selected_pts.sort();var r=this.selected_pts.length,a=[];for(a.length=r;r--;){var i=this.selected_pts[r],o=this.segs[i];o.select(!0),a[r]=o.ptgrip}var s=this.subpathIsClosed(this.selected_pts[0]);Ie.addPtsToSelection({grips:a,closedSubpath:s})}}]),e}(),qe=function(e){var t=Pe[e.id];return t||(t=Pe[e.id]=new ze(e)),t},Ye=function(e){e in Pe&&delete Pe[e]},We=void 0,Xe=void 0,Qe=void 0,Ke=void 0,Ze=void 0,$e=function(e,t){var n=e-Qe,r=t-Ke,a=Math.sqrt(n*n+r*r),i=Math.atan2(r,n)+Ze;return n=a*Math.cos(i)+Qe,r=a*Math.sin(i)+Ke,n-=We,r-=Xe,a=Math.sqrt(n*n+r*r),i=Math.atan2(r,n)-Ze,{x:a*Math.cos(i)+We,y:a*Math.sin(i)+Xe}},Je=function(){var e=Ge.elem;if(Ze=Ht(e,!0)){var t=Ge.oldbbox;Qe=t.x+t.width/2,Ke=t.y+t.height/2;var n=Nt(e);We=n.x+n.width/2,Xe=n.y+n.height/2;var r=We-Qe,a=Xe-Ke,i=Math.sqrt(r*r+a*a),o=Math.atan2(a,r)+Ze;We=i*Math.cos(o)+Qe,Xe=i*Math.sin(o)+Ke;for(var s=e.pathSegList,l=s.numberOfItems;l;){l-=1;var c=s.getItem(l),u=c.pathSegType;if(1!==u){var d=$e(c.x,c.y),h=[d.x,d.y];if(null!=c.x1&&null!=c.x2){var f=$e(c.x1,c.y1),p=$e(c.x2,c.y2);h.splice(h.length,0,f.x,f.y,p.x,p.y)}De(u,l,h)}}n=Nt(e);var g=Ie.getSVGRoot().createSVGTransform(),v=W(e);g.setRotate(180*Ze/Math.PI,We,Xe),v.replaceItem(g,0)}},et=[0,"z","M","m","L","l","C","c","Q","q","A","a","H","h","V","v","S","s","T","t"],tt=function(e,t){for(var n=e.pathSegList,r=n.numberOfItems,a=0,i=0,o="",s=null,l=0;l<r;++l){var c=n.getItem(l),u=c.x||0,d=c.y||0,h=c.x1||0,f=c.y1||0,p=c.x2||0,g=c.y2||0,v=c.pathSegType,m=et[v]["to"+(t?"Lower":"Upper")+"Case"]();switch(v){case 1:o+="z",s&&!t&&(a=s[0],i=s[1]);break;case 12:u-=a;case 13:t?(a+=u,m="l"):(a=u+=a,m="L"),o+=nt(m,[[u,i]]);break;case 14:d-=i;case 15:t?(i+=d,m="l"):(i=d+=i,m="L"),o+=nt(m,[[a,d]]);break;case 2:case 4:case 18:u-=a,d-=i;case 5:case 3:case 19:t?(a+=u,i+=d):(a=u+=a,i=d+=i),2!==v&&3!==v||(s=[a,i]),o+=nt(m,[[u,d]]);break;case 6:u-=a,h-=a,p-=a,d-=i,f-=i,g-=i;case 7:t?(a+=u,i+=d):(h+=a,p+=a,f+=i,g+=i,a=u+=a,i=d+=i),o+=nt(m,[[h,f],[p,g],[u,d]]);break;case 8:u-=a,h-=a,d-=i,f-=i;case 9:t?(a+=u,i+=d):(h+=a,f+=i,a=u+=a,i=d+=i),o+=nt(m,[[h,f],[u,d]]);break;case 10:u-=a,d-=i;case 11:t?(a+=u,i+=d):(a=u+=a,i=d+=i),o+=nt(m,[[c.r1,c.r2]],[c.angle,c.largeArcFlag?1:0,c.sweepFlag?1:0],[u,d]);break;case 16:u-=a,p-=a,d-=i,g-=i;case 17:t?(a+=u,i+=d):(p+=a,g+=i,a=u+=a,i=d+=i),o+=nt(m,[[p,g],[u,d]])}}return o};function nt(e,t,n,r){we.each(t,function(e,n){t[e]=ee(n)});var a=e+t.join(" ");return n&&(a+=" "+n.join(" ")),r&&(a+=" "+ee(r)),a}var rt,at,it,ot,st,lt=(rt=!1,at=void 0,it=void 0,ot=null,st=!1,{mouseDown:function(e,t,n,r){var a=void 0;if("path"!==Ie.getCurrentMode()){if(Ge){Ge.storeD();var i=void 0;if("pathpointgrip_"===(a=e.target.id).substr(0,14)){i=Ge.cur_pt=parseInt(a.substr(14),10),Ge.dragging=[n,r];var o=Ge.segs[i];e.shiftKey?o.selected?Ge.removePtFromSelection(i):Ge.addPtsToSelection(i):((Ge.selected_pts.length<=1||!o.selected)&&Ge.clearSelection(),Ge.addPtsToSelection(i))}else if(a.startsWith("ctrlpointgrip_")){Ge.dragging=[n,r];var s=a.split("_")[1].split("c");i=Number(s[0]);var l=Number(s[1]);Ge.selectPt(i,l)}if(!Ge.dragging){var c=Ie.getRubberBox();null==c&&(c=Ie.setRubberBox(Ie.selectorManager.getRubberBandBox()));var d=Ie.getCurrentZoom();Yt(c,{x:n*d,y:r*d,width:0,height:0,display:"inline"},100)}}}else{var h=n,f=r,p=Ie.getCurrentZoom(),g=h/p,v=f/p,m=qt("path_stretch_line");at=[g,v],Ie.getGridSnapping()&&(g=Xt(g),v=Xt(v),h=Xt(h),f=Xt(f)),m||(m=document.createElementNS(u.SVG,"path"),Yt(m,{id:"path_stretch_line",stroke:"#22C","stroke-width":"0.5",fill:"none"}),m=qt("selectorParentGroup").appendChild(m)),m.setAttribute("display","inline");var _=void 0,y=Ie.getDrawnPath();if(y){for(var b=y.pathSegList,x=b.numberOfItems,w=6/p,S=!1;x;){x--;var k=b.getItem(x),C=k.x,A=k.y;if(g>=C-w&&g<=C+w&&v>=A-w&&v<=A+w){S=!0;break}}a=Ie.getId(),Ye(a);var E=qt(a),P=void 0,G=void 0,I=b.numberOfItems;if(S){if(x<=1&&I>=2){var T=b.getItem(0).x,N=b.getItem(0).y;P=4===(G=m.pathSegList.getItem(1)).pathSegType?y.createSVGPathSegLinetoAbs(T,N):y.createSVGPathSegCurvetoCubicAbs(T,N,G.x1/p,G.y1/p,T,N);var L=y.createSVGPathSegClosePath();b.appendItem(P),b.appendItem(L)}else if(I<3)return!1;if(we(m).remove(),y=Ie.setDrawnPath(null),Ie.setStarted(!1),rt){Ge.matrix&&Ie.remapElement(E,{},Ge.matrix.inverse());var M=E.getAttribute("d"),O=we(Ge.elem).attr("d");return we(Ge.elem).attr("d",O+M),we(E).remove(),Ge.matrix&&Je(),Te(),lt.toEditMode(Ge.elem),Ge.selectPt(),!1}}else{if(!we.contains(Ie.getContainer(),Ie.getMouseTarget(e)))return console.log("Clicked outside canvas"),!1;var V=y.pathSegList.numberOfItems,j=y.pathSegList.getItem(V-1),R=j.x,B=j.y;if(e.shiftKey){var D=be(R,B,g,v);g=D.x,v=D.y}P=4===(G=m.pathSegList.getItem(1)).pathSegType?y.createSVGPathSegLinetoAbs(Ie.round(g),Ie.round(v)):y.createSVGPathSegCurvetoCubicAbs(Ie.round(g),Ie.round(v),G.x1/p,G.y1/p,G.x2/p,G.y2/p),y.pathSegList.appendItem(P),g*=p,v*=p,m.setAttribute("d",["M",g,v,g,v].join(" ")),_=V,rt&&(_+=Ge.segs.length),Oe(_,g,v)}}else{var U="M"+g+","+v+" ";y=Ie.setDrawnPath(Ie.addSvgElementFromJson({element:"path",curStyles:!0,attr:{d:U,id:Ie.getNextId(),opacity:Ie.getOpacity()/2}})),m.setAttribute("d",["M",h,f,h,f].join(" ")),_=rt?Ge.segs.length:0,Oe(_,h,f)}}},mouseMove:function(e,t){var n=Ie.getCurrentZoom();st=!0;var r=Ie.getDrawnPath();if("path"!==Ie.getCurrentMode())if(Ge.dragging){var a=Me({x:Ge.dragging[0],y:Ge.dragging[1]},Ge),i=Me({x:e,y:t},Ge),o=i.x-a.x,s=i.y-a.y;Ge.dragging=[e,t],Ge.dragctrl?Ge.moveCtrl(o,s):Ge.movePts(o,s)}else Ge.selected_pts=[],Ge.eachSeg(function(e){if(this.next||this.prev){var t=Ie.getRubberBox().getBBox(),n=Le(this),r={x:n.x,y:n.y,width:0,height:0},a=xe(t,r);this.select(a),a&&Ge.selected_pts.push(this.index)}});else{if(!r)return;var l=r.pathSegList,c=l.numberOfItems-1;if(at){var u=je("1c1"),d=je("0c2");u.setAttribute("cx",e),u.setAttribute("cy",t),u.setAttribute("display","inline");var h=at[0],f=at[1],p=h+(h-e/n),g=f+(f-t/n);d.setAttribute("cx",p*n),d.setAttribute("cy",g*n),d.setAttribute("display","inline");var v=Re(1);if(Yt(v,{x1:e,y1:t,x2:p*n,y2:g*n,display:"inline"}),0===c)it=[e,t];else{var m=l.getItem(c-1),_=m.x,y=m.y;6===m.pathSegType?(_+=_-m.x2,y+=y-m.y2):it&&(_=it[0]/n,y=it[1]/n),De(6,c,[h,f,_,y,p,g],r)}}else{var b=qt("path_stretch_line");if(b){var x=l.getItem(c);if(6===x.pathSegType){var w=x.x+(x.x-x.x2),S=x.y+(x.y-x.y2);De(6,1,[e,t,w*n,S*n,e,t],b)}else it?De(6,1,[e,t,it[0],it[1],e,t],b):De(4,1,[e,t],b)}}}},mouseUp:function(e,t,n,r){var a=Ie.getDrawnPath();if("path"===Ie.getCurrentMode())return at=null,a||(t=qt(Ie.getId()),Ie.setStarted(!1),it=null),{keep:!0,element:t};var i=Ie.getRubberBox();if(Ge.dragging){var o=Ge.cur_pt;Ge.dragging=!1,Ge.dragctrl=!1,Ge.update(),st&&Ge.endChanges("Move path point(s)"),e.shiftKey||st||Ge.selectPt(o)}else i&&"none"!==i.getAttribute("display")?(i.setAttribute("display","none"),i.getAttribute("width")<=2&&i.getAttribute("height")<=2&&lt.toSelectMode(e.target)):lt.toSelectMode(e.target);st=!1},toEditMode:function(e){Ge=qe(e),Ie.setCurrentMode("pathedit"),Ie.clearSelection(),Ge.show(!0).update(),Ge.oldbbox=Nt(Ge.elem),rt=!1},toSelectMode:function(e){var t=e===Ge.elem;Ie.setCurrentMode("select"),Ge.show(!1),ot=!1,Ie.clearSelection(),Ge.matrix&&Je(),t&&(Ie.call("selected",[e]),Ie.addToSelection([e],!0))},addSubPath:function(e){e?(Ie.setCurrentMode("path"),rt=!0):(lt.clear(!0),lt.toEditMode(Ge.elem))},select:function(e){ot===e?(lt.toEditMode(e),Ie.setCurrentMode("pathedit")):ot=e},reorient:function(){var e=Ie.getSelectedElements()[0];if(e&&0!==Ht(e)){var t=new ce("Reorient path"),n={d:e.getAttribute("d"),transform:e.getAttribute("transform")};t.addSubCommand(new le(e,n)),Ie.clearSelection(),this.resetOrientation(e),Ie.addCommandToHistory(t),qe(e).show(!1).matrix=null,this.clear(),Ie.addToSelection([e],!0),Ie.call("changed",Ie.getSelectedElements())}},clear:function(e){var t=Ie.getDrawnPath();if(ot=null,t){var n=qt(Ie.getId());we(qt("path_stretch_line")).remove(),we(n).remove(),we(qt("pathpointgrip_container")).find("*").attr("display","none"),it=null,Ie.setDrawnPath(null),Ie.setStarted(!1)}else"pathedit"===Ie.getCurrentMode()&&this.toSelectMode();Ge&&Ge.init().show(!1)},resetOrientation:function(e){if(null==e||"path"!==e.nodeName)return!1;var t=W(e),n=_e(t).matrix;t.clear(),e.removeAttribute("transform");for(var r=e.pathSegList,a=r.numberOfItems,i=function(t){var a=r.getItem(t),i=a.pathSegType;if(1===i)return"continue";var o=[];we.each(["",1,2],function(e,t){var r=a["x"+t],i=a["y"+t];if(void 0!==r&&void 0!==i){var s=fe(r,i,n);o.splice(o.length,0,s.x,s.y)}}),De(i,t,o,e)},o=0;o<a;++o)i(o);!function(e,t){for(var n=Nt(e),r=0;r<2;r++){var a=0===r?"fill":"stroke",i=e.getAttribute(a);if(i&&i.startsWith("url(")){var o=zt(i);if("linearGradient"===o.tagName){var s=o.getAttribute("x1")||0,l=o.getAttribute("y1")||0,c=o.getAttribute("x2")||1,u=o.getAttribute("y2")||0;s=n.width*s+n.x,l=n.height*l+n.y,c=n.width*c+n.x,u=n.height*u+n.y;var d=fe(s,l,t),h=fe(c,u,t),f={};f.x1=(d.x-n.x)/n.width,f.y1=(d.y-n.y)/n.height,f.x2=(h.x-n.x)/n.width,f.y2=(h.y-n.y)/n.height;var p=o.cloneNode(!0);we(p).attr(f),p.id=Ie.getNextId(),Gt().append(p),e.setAttribute(a,"url(#"+p.id+")")}}}}(e,n)},zoomChange:function(){"pathedit"===Ie.getCurrentMode()&&Ge.update()},getNodePoint:function(){var e=Ge.selected_pts.length?Ge.selected_pts[0]:1,t=Ge.segs[e];return{x:t.item.x,y:t.item.y,type:t.type}},linkControlPoints:function(e){Ee=e},clonePathNode:function(){Ge.storeD();for(var e=Ge.selected_pts,t=e.length,n=[];t--;){var r=e[t];Ge.addSeg(r),n.push(r+t),n.push(r+t+1)}Ge.init().addPtsToSelection(n),Ge.endChanges("Clone path node(s)")},opencloseSubPath:function(){var e=Ge.selected_pts;if(1===e.length){var t=Ge.elem,n=t.pathSegList,r=e[0],a=null,i=null;if(Ge.eachSeg(function(e){return 2===this.type&&e<=r&&(i=this.item),e<=r||(2===this.type?(a=e,!1):1===this.type?(a=!1,!1):void 0)}),null==a&&(a=Ge.segs.length-1),!1!==a){var o=t.createSVGPathSegLinetoAbs(i.x,i.y),s=t.createSVGPathSegClosePath();return a===Ge.segs.length-1?(n.appendItem(o),n.appendItem(s)):(Ne(t,s,a),Ne(t,o,a)),void Ge.init().selectPt(a+1)}if(Ge.segs[r].mate)return n.removeItem(r),n.removeItem(r),void Ge.init().selectPt(r-1);for(var l=void 0,c=void 0,u=0;u<n.numberOfItems;u++){var d=n.getItem(u);if(2===d.pathSegType)l=u;else if(u===r)n.removeItem(l);else if(1===d.pathSegType&&r<u){c=u-1,n.removeItem(u);break}}for(var h=r-l-1;h--;)Ne(t,n.getItem(l),c);var f=n.getItem(l);De(2,l,[f.x,f.y]),Ge.init().selectPt(0)}},deletePathNode:function(){if(lt.canDeleteNodes){Ge.storeD();for(var e=Ge.selected_pts,t=e.length;t--;){var n=e[t];Ge.deleteSeg(n)}if(function e(){var t=Ge.elem.pathSegList,n=t.numberOfItems,r=function(e,n){for(;n--;)t.removeItem(e)};if(n<=1)return!0;for(;n--;){var a=t.getItem(n);if(1===a.pathSegType){var i=t.getItem(n-1),o=t.getItem(n-2);if(2===i.pathSegType){r(n-1,2),e();break}if(2===o.pathSegType){r(n-2,3),e();break}}else if(2===a.pathSegType&&n>0){var s=t.getItem(n-1).pathSegType;if(2===s){r(n-1,1),e();break}if(1===s&&t.numberOfItems-1===n){r(n,1),e();break}}}return!1}(),Ge.elem.pathSegList.numberOfItems<=1)return lt.toSelectMode(Ge.elem),void Ie.canvas.deleteSelectedElements();if(Ge.init(),Ge.clearSelection(),window.opera){var r=we(Ge.elem);r.attr("d",r.attr("d"))}Ge.endChanges("Delete path node(s)")}},smoothPolylineIntoPath:function(e){var t=void 0,n=e.points,r=n.numberOfItems;if(r>=4){var a=n.getItem(0),i=null,o=[];for(o.push(["M",a.x,",",a.y," C"].join("")),t=1;t<=r-4;t+=3){var s=n.getItem(t),l=n.getItem(t+1),c=n.getItem(t+2);if(i){var u=Fe(i,s,a);if(u&&2===u.length){var d=o[o.length-1].split(",");d[2]=u[0].x,d[3]=u[0].y,o[o.length-1]=d.join(","),s=u[1]}}o.push([s.x,s.y,l.x,l.y,c.x,c.y].join(",")),a=c,i=l}for(o.push("L");t<r;){var h=n.getItem(t);o.push([h.x,h.y].join(",")),t++}o=o.join(" "),e=Ie.addSvgElementFromJson({element:"path",curStyles:!0,attr:{id:Ie.getId(),d:o,fill:"none"}})}return e},setSegType:function(e){Ge.setSegType(e)},moveNode:function(e,t){var n=Ge.selected_pts;if(n.length){Ge.storeD();var r=Ge.segs[n[0]],a={x:0,y:0};a[e]=t-r.item[e],r.move(a.x,a.y),Ge.endChanges("Move path point")}},fixEnd:function(e){for(var t=e.pathSegList,n=t.numberOfItems,r=void 0,a=0;a<n;++a){var i=t.getItem(a);if(2===i.pathSegType&&(r=i),1===i.pathSegType){var o=t.getItem(a-1);if(o.x!==r.x||o.y!==r.y){var s=e.createSVGPathSegLinetoAbs(r.x,r.y);Ne(e,s,a),lt.fixEnd(e);break}}}L()&&Ie.resetD(e)},convertPath:tt}),ct=U(jQuery),ut="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",dt="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use".split(","),ht=null,ft=null,pt=null,gt=null,vt=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/,"&#x27;")},mt=function(e){if(e=bt(e),window.btoa)return window.btoa(e);var t=[];t.length=4*Math.floor((e.length+2)/3);var n=0,r=0;do{var a=e.charCodeAt(n++),i=e.charCodeAt(n++),o=e.charCodeAt(n++),s=a>>2,l=(3&a)<<4|i>>4,c=(15&i)<<2|o>>6,u=63&o;isNaN(i)?c=u=64:isNaN(o)&&(u=64),t[r++]=ut.charAt(s),t[r++]=ut.charAt(l),t[r++]=ut.charAt(c),t[r++]=ut.charAt(u)}while(n<e.length);return t.join("")},_t=function(e){if(window.atob)return yt(window.atob(e));e=e.replace(/[^A-Za-z0-9+/=]/g,"");var t="",n=0;do{var r=ut.indexOf(e.charAt(n++)),a=ut.indexOf(e.charAt(n++)),i=ut.indexOf(e.charAt(n++)),o=ut.indexOf(e.charAt(n++)),s=r<<2|a>>4,l=(15&a)<<4|i>>2,c=(3&i)<<6|o;t+=String.fromCharCode(s),64!==i&&(t+=String.fromCharCode(l)),64!==o&&(t+=String.fromCharCode(c))}while(n<e.length);return yt(t)},yt=function(e){return decodeURIComponent(escape(e))},bt=function(e){return unescape(encodeURIComponent(e))},xt=function(e){if("undefined"==typeof Uint8Array||"undefined"==typeof Blob||"undefined"==typeof URL||!URL.createObjectURL)return"";for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],r=atob(t[1]),a=r.length,i=new Uint8Array(a);a--;)i[a]=r.charCodeAt(a);var o=new Blob([i],{type:n});return URL.createObjectURL(o)},wt=function(e){return e&&"undefined"!=typeof URL&&URL.createObjectURL?URL.createObjectURL(e):""},St=function(){if("undefined"==typeof Blob)return"";var e=new Blob(["<html><head><title>SVG-edit</title></head><body>&nbsp;</body></html>"],{type:"text/html"});return wt(e)}(),kt=function(e){e.includes("<svg:svg")&&(e=e.replace(/<(\/?)svg:/g,"<$1").replace("xmlns:svg","xmlns"));var t=void 0,n=void 0;try{(n=window.DOMParser?new DOMParser:new window.ActiveXObject("Microsoft.XMLDOM")).async=!1}catch(e){throw new Error("XML Parser could not be instantiated")}try{t=n.loadXML?!!n.loadXML(e)&&n:n.parseFromString(e,"text/xml")}catch(e){throw new Error("Error parsing XML string")}return t},Ct=function e(t,n){if(t&&1===t.nodeType){n(t);for(var r=t.childNodes.length;r--;)e(t.childNodes.item(r),n)}},At=function(e){if(e){if(e.startsWith('url("'))return e.substring(5,e.indexOf('"',6));if(e.startsWith("url('"))return e.substring(5,e.indexOf("'",6));if(e.startsWith("url("))return e.substring(4,e.indexOf(")"))}return null},Et=function(e){return e.getAttributeNS(u.XLINK,"href")},Pt=function(e,t){e.setAttributeNS(u.XLINK,"xlink:href",t)},Gt=function(){var e=ht.getSVGContent(),t=e.getElementsByTagNameNS(u.SVG,"defs");return t.length>0?t=t[0]:(t=e.ownerDocument.createElementNS(u.SVG,"defs"),e.firstChild?e.insertBefore(t,e.firstChild.nextSibling):e.append(t)),t},It=function(e){for(var t=e.pathSegList,n=t.numberOfItems,r=[[],[]],a=t.getItem(0),i=[a.x,a.y],o=0;o<n;o++){var s=t.getItem(o);void 0!==s.x&&(r[0].push(i[0]),r[1].push(i[1]),s.x1?function(){for(var e=[s.x1,s.y1],t=[s.x2,s.y2],n=[s.x,s.y],a=function(a){var o=function(r){return Math.pow(1-r,3)*i[a]+3*Math.pow(1-r,2)*r*e[a]+3*(1-r)*Math.pow(r,2)*t[a]+Math.pow(r,3)*n[a]},s=6*i[a]-12*e[a]+6*t[a],l=-3*i[a]+9*e[a]-9*t[a]+3*n[a],c=3*e[a]-3*i[a];if(0===l){if(0===s)return"continue";var u=-c/s;return u>0&&u<1&&r[a].push(o(u)),"continue"}var d=Math.pow(s,2)-4*c*l;if(d<0)return"continue";var h=(-s+Math.sqrt(d))/(2*l);h>0&&h<1&&r[a].push(o(h));var f=(-s-Math.sqrt(d))/(2*l);f>0&&f<1&&r[a].push(o(f))},o=0;o<2;o++)a(o);i=n}():(r[0].push(s.x),r[1].push(s.y)))}var l=Math.min.apply(null,r[0]),c=Math.max.apply(null,r[0])-l,u=Math.min.apply(null,r[1]);return{x:l,y:u,width:c,height:Math.max.apply(null,r[1])-u}};function Tt(e){if(B())try{return e.getBBox()}catch(e){}var t=ct.data(e,"ref"),n=null,r=void 0,a=void 0;t?(a=ct(t).children().clone().attr("visibility","hidden"),ct(gt).append(a),n=a.filter("line, path")):n=ct(e).find("line, path");var i=!1;if(n.length)if(n.each(function(){var e=this.getBBox();e.width&&e.height||(i=!0)}),i){var o=t?a:ct(e).children();r=Bt(o)}else r=e.getBBox();else r=e.getBBox();return t&&a.remove(),r}var Nt=function(e){var t=e||ht.geSelectedElements()[0];if(1!==e.nodeType)return null;var n,r=t.nodeName,a=null;switch(r){case"text":""===t.textContent?(t.textContent="a",a=t.getBBox(),t.textContent=""):t.getBBox&&(a=t.getBBox());break;case"path":P?t.getBBox&&(a=t.getBBox()):a=It(t);break;case"g":case"a":a=Tt(t);break;default:if("use"===r&&(a=Tt(t)),"use"===r||"foreignObject"===r&&L()){if(a||(a=t.getBBox()),!L()){var i={};i.width=a.width,i.height=a.height,i.x=a.x+parseFloat(t.getAttribute("x")||0),i.y=a.y+parseFloat(t.getAttribute("y")||0),a=i}}else if(dt.includes(r))if(t)try{a=t.getBBox()}catch(e){var o=t.getExtentOfChar(0),s=t.getComputedTextLength();a={x:o.x,y:o.y,width:s,height:o.height}}else{var l=ct(t).closest("foreignObject");l.length&&l[0].getBBox&&(a=l[0].getBBox())}}return a&&(a={x:(n=a).x,y:n.y,width:n.width,height:n.height}),a},Lt=function(e){var t="";return ct.each(e,function(e,n){var r=n[1];t+=n[0];for(var a=0;a<r.length;a+=2)t+=r[a]+","+r[a+1]+" "}),t},Mt=function(e){var t=1.81,n=void 0,r=void 0,a=void 0,i=void 0;switch(e.tagName){case"ellipse":case"circle":var o=r=ct(e).attr(["rx","ry","cx","cy"]),s=o.cx,l=o.cy,c=r;a=c.rx,i=c.ry,"circle"===e.tagName&&(a=i=ct(e).attr("r")),n=Lt([["M",[s-a,l]],["C",[s-a,l-i/t,s-a/t,l-i,s,l-i]],["C",[s+a/t,l-i,s+a,l-i/t,s+a,l]],["C",[s+a,l+i/t,s+a/t,l+i,s,l+i]],["C",[s-a/t,l+i,s-a,l+i/t,s-a,l]],["Z",[]]]);break;case"path":n=e.getAttribute("d");break;case"line":n="M"+(r=ct(e).attr(["x1","y1","x2","y2"])).x1+","+r.y1+"L"+r.x2+","+r.y2;break;case"polyline":n="M"+e.getAttribute("points");break;case"polygon":n="M"+e.getAttribute("points")+" Z";break;case"rect":var u=ct(e).attr(["rx","ry"]);a=u.rx,i=u.ry;var d=e.getBBox(),h=d.x,f=d.y,p=d.width,g=d.height;t=4-t,n=Lt(a||i?[["M",[h,f+i]],["C",[h,f+i/t,h+a/t,f,h+a,f]],["L",[h+p-a,f]],["C",[h+p-a/t,f,h+p,f+i/t,h+p,f+i]],["L",[h+p,f+g-i]],["C",[h+p,f+g-i/t,h+p-a/t,f+g,h+p-a,f+g]],["L",[h+a,f+g]],["C",[h+a/t,f+g,h,f+g-i/t,h,f+g-i]],["L",[h,f+i]],["Z",[]]]:[["M",[h,f]],["L",[h+p,f]],["L",[h+p,f+g]],["L",[h,f+g]],["L",[h,f]],["Z",[]]])}return n},Ot=function(e){var t={};return ct.each(["marker-start","marker-end","marker-mid","filter","clip-path"],function(){var n=e.getAttribute(this);n&&(t[this]=n)}),t},Vt=function(e,t,n){var r=t({element:"path",attr:Ot(e)}),a=e.getAttribute("transform");a&&r.setAttribute("transform",a);var i=e.parentNode;e.nextSibling?e.before(r):i.append(r);var o=Mt(e);o?r.setAttribute("d",o):r.remove(),n.resetOrientation(r);var s=!1;try{s=r.getBBox()}catch(e){}return r.remove(),s};var jt=function(e,t,n){var r=Nt(e);if(!r)return null;var a=W(e),i=Ft(a),o=ve(a);if(i||o){var s=!1;if(function(e,t){var n=e%90;return t||!(n>-.001&&n<.001||n<-89.99||n>89.99)}(i,o)){if(["ellipse","path","line","polyline","polygon"].includes(e.tagName))r=s=Vt(e,t,n);else if("rect"===e.tagName){var l=e.getAttribute("rx"),c=e.getAttribute("ry");(l||c)&&(r=s=Vt(e,t,n))}}if(!s){var u=_e(a).matrix;r=me(r.x,r.y,r.width,r.height,u).aabox}}return r};function Rt(e){var t=e.getAttribute("stroke-width");return isNaN(t)||"none"===e.getAttribute("stroke")?0:t/2}var Bt=function(e,t,n){if(!e||!e.length)return!1;var r=void 0;if(ct.each(e,function(){r||this.parentNode&&(r=jt(this,t,n))}),void 0===r)return null;var a=r.x+r.width,i=r.y+r.height,o=r.x,s=r.y;if(1===e.length){var l=Rt(e[0]);o-=l,s-=l,a+=l,i+=l}else ct.each(e,function(e,r){var l=jt(r,t,n);if(l){var c=Rt(r);o=Math.min(o,l.x-c),s=Math.min(s,l.y-c),1===r.nodeType&&(a=Math.max(a,l.x+l.width+c),i=Math.max(i,l.y+l.height+c))}});return r.x=o,r.y=s,r.width=a-o,r.height=i-s,r},Dt=function(e){e||(e=ct(ht.getSVGContent()).children());var t=[];return ct(e).children().each(function(e,n){n.getBBox&&t.push(n)}),t.reverse()},Ut=function(e){return e||(e=Dt()),Bt(e,ht.addSvgElementFromJson,ht.pathActions)},Ft=function(e,t){if(!e)return 0;for(var n=e.numberOfItems,r=0;r<n;++r){var a=e.getItem(r);if(4===a.type)return t?a.angle*Math.PI/180:a.angle}return 0},Ht=function(e,t){var n=e||ht.getSelectedElements()[0],r=W(n);return Ft(r,t)},zt=function(e){return qt(At(e).substr(1))},qt=S?function(e){return gt.querySelector("#"+e)}:k?function(e){return ft.evaluate('svg:svg[@id="svgroot"]//svg:*[@id="'+e+'"]',pt,function(){return u.SVG},9,null).singleNodeValue}:function(e){return ct(gt).find("[id="+e+"]")[0]},Yt=function(e,t,n,r){for(var a in t){var i="xml:"===a.substr(0,4)?u.XML:"xlink:"===a.substr(0,6)?u.XLINK:null;i?e.setAttributeNS(i,a,t[a]):r?(o=e,s=a,l=t[a],o.setAttribute(s,l)):e.setAttribute(a,t[a])}var o,s,l},Wt=function(e){var t={"fill-opacity":1,"stop-opacity":1,opacity:1,stroke:"none","stroke-dasharray":"none","stroke-linejoin":"miter","stroke-linecap":"butt","stroke-opacity":1,"stroke-width":1,rx:0,ry:0};for(var n in"ellipse"===e.nodeName&&(delete t.rx,delete t.ry),t){var r=t[n];e.getAttribute(n)===String(r)&&e.removeAttribute(n)}},Xt=function(e){var t=ht.getBaseUnit(),n=ht.getSnappingStep();return"px"!==t&&(n*=J()[t]),e=Math.round(e/n)*n},Qt=function(e){ct(e).click(function(e){e.preventDefault()})},Kt=jQuery,Zt={},$t=function(e){Object.keys(Zt).length||Kt("#cmenu_canvas").append("<li class='separator'>");var t=e.shortcut||"";Kt("#cmenu_canvas").append("<li class='disabled'><a href='#"+e.id+"'>"+e.label+"<span class='shortcut'>"+t+"</span></a></li>")};function Jt(e,t){["id","class","type"].forEach(function(n){n in t&&(e[n]=t[n])})}var en,tn,nn=(en=n(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",rn(t,i({},n,{returnDefault:!0})));case 1:case"end":return e.stop()}},e,this)})),function(e,t){return en.apply(this,arguments)}),rn=(tn=n(regeneratorRuntime.mark(function e(t,n){var r=n.global,a=n.returnDefault;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!!("svgEditor"in window&&window.svgEditor&&!1===window.svgEditor.modules)){e.next=3;break}return e.abrupt("return",on(t,void 0,{returnDefault:a}));case 3:return e.next=5,an(t);case 5:return e.abrupt("return",window[r]);case 6:case"end":return e.stop()}},e,this)})),function(e,t){return tn.apply(this,arguments)});function an(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Array.isArray(e)?Promise.all(e.map(function(e){return an(e,t)})):new Promise(function(n,r){var a=document.createElement("script"),i=function(){a.onerror=null,a.onload=null,a.remove(),a.src=""};a.defer="defer",Jt(a,t),a.onerror=function(){r(new Error("Failed to import: "+e)),i()},a.onload=function(){n(),i()},a.src=e,document.head.append(a)})}function on(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).returnDefault,r=void 0!==n&&n;return Array.isArray(e)?Promise.all(e.map(function(e){return on(e,t)})):new Promise(function(n,a){var i="$importModule$"+Math.random().toString(32).slice(2),o=document.createElement("script"),s=function(){delete window[i],o.onerror=null,o.onload=null,o.remove(),URL.revokeObjectURL(o.src),o.src=""};Jt(o,t),o.defer="defer",o.type="module",o.onerror=function(){a(new Error("Failed to import: "+e)),s()},o.onload=function(){n(window[i]),s()};var l="import * as m from '"+function(e){var t=document.createElement("a");return t.setAttribute("href",e),t.cloneNode(!1).href}(e).replace(/'/g,"\\'")+"'; window."+i+" = "+(r?"m.default || ":"")+"m;",c=new Blob([l],{type:"text/javascript"});o.src=URL.createObjectURL(c),document.head.append(o)})}var sn=jQuery,ln=function(){function e(t,n,a){if(r(this,e),this.name_=t,this.group_=a?null:n,a){var i=a.ownerDocument;this.group_=i.createElementNS(u.SVG,"g");var o=i.createElementNS(u.SVG,"title");o.textContent=t,this.group_.append(o),n?sn(n).after(this.group_):a.append(this.group_)}cn(this.group_),Ct(this.group_,function(e){e.setAttribute("style","pointer-events:inherit")}),this.group_.setAttribute("style",a?"pointer-events:all":"pointer-events:none")}return a(e,[{key:"getName",value:function(){return this.name_}},{key:"getGroup",value:function(){return this.group_}},{key:"activate",value:function(){this.group_.setAttribute("style","pointer-events:all")}},{key:"deactivate",value:function(){this.group_.setAttribute("style","pointer-events:none")}},{key:"setVisible",value:function(e){var t=void 0===e||e?"inline":"none";this.group_.getAttribute("display")!==t&&this.group_.setAttribute("display",t)}},{key:"isVisible",value:function(){return"none"!==this.group_.getAttribute("display")}},{key:"getOpacity",value:function(){var e=this.group_.getAttribute("opacity");return null===e||void 0===e?1:parseFloat(e)}},{key:"setOpacity",value:function(e){"number"==typeof e&&e>=0&&e<=1&&this.group_.setAttribute("opacity",e)}},{key:"appendChildren",value:function(e){for(var t=0;t<e.length;++t)this.group_.append(e[t])}},{key:"getTitleElement",value:function(){for(var e=this.group_.childNodes.length,t=0;t<e;++t){var n=this.group_.childNodes.item(t);if(n&&"title"===n.tagName)return n}return null}},{key:"setName",value:function(e,t){var n=this.name_;e=vt(e);var r=this.getTitleElement();return r?(sn(r).empty(),r.textContent=e,this.name_=e,t&&t.changeElement(r,{"#text":n}),this.name_):null}},{key:"removeGroup",value:function(){var e=this.group_.parentNode.removeChild(this.group_);return this.group_=void 0,e}}]),e}();function cn(e){var t=e.getAttribute("class");null!==t&&void 0!==t&&t.length?ln.CLASS_REGEX.test(t)||e.setAttribute("class",t+" "+ln.CLASS_NAME):e.setAttribute("class",ln.CLASS_NAME)}ln.CLASS_NAME="layer",ln.CLASS_REGEX=new RegExp("(\\s|^)"+ln.CLASS_NAME+"(\\s|$)");var un=function(){function e(t){r(this,e),this.undoManager_=t,this.currentBatchCommand_=null,this.batchCommandStack_=[]}return a(e,[{key:"startBatchCommand",value:function(e){return this.undoManager_?(this.currentBatchCommand_=new ce(e),this.batchCommandStack_.push(this.currentBatchCommand_),this):this}},{key:"endBatchCommand",value:function(){if(!this.undoManager_)return this;if(this.currentBatchCommand_){var e=this.currentBatchCommand_;this.batchCommandStack_.pop();var t=this.batchCommandStack_.length;this.currentBatchCommand_=t?this.batchCommandStack_[t-1]:null,this.addCommand_(e)}return this}},{key:"moveElement",value:function(e,t,n,r){return this.undoManager_?(this.addCommand_(new ie(e,t,n,r)),this):this}},{key:"insertElement",value:function(e,t){return this.undoManager_?(this.addCommand_(new oe(e,t)),this):this}},{key:"removeElement",value:function(e,t,n,r){return this.undoManager_?(this.addCommand_(new se(e,t,n,r)),this):this}},{key:"changeElement",value:function(e,t,n){return this.undoManager_?(this.addCommand_(new le(e,t,n)),this):this}},{key:"addCommand_",value:function(e){if(!this.undoManager_)return this;this.currentBatchCommand_?this.currentBatchCommand_.addSubCommand(e):this.undoManager_.addCommandToHistory(e)}}]),e}();un.NO_HISTORY=new un;var dn=jQuery,hn="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use".split(","),fn={LET_DOCUMENT_DECIDE:0,ALWAYS_RANDOMIZE:1,NEVER_RANDOMIZE:2},pn=fn.LET_DOCUMENT_DECIDE,gn=[];function vn(e){return e||new un(bn.undoMgr)}function mn(e){for(var t=1;e.includes("Layer "+t);)t++;return"Layer "+t}var _n=function(){function e(t,n){if(r(this,e),!t||!t.tagName||!t.namespaceURI||"svg"!==t.tagName||t.namespaceURI!==u.SVG)throw new Error("Error: svgedit.draw.Drawing instance initialized without a <svg> element");this.svgElem_=t,this.obj_num=0,this.idPrefix=n||"svg_",this.releasedNums=[],this.all_layers=[],this.layer_map={},this.current_layer=null,this.nonce_="";var a=this.svgElem_.getAttributeNS(u.SE,"nonce");a&&pn!==fn.NEVER_RANDOMIZE?this.nonce_=a:pn===fn.ALWAYS_RANDOMIZE&&this.setNonce(Math.floor(100001*Math.random()))}return a(e,[{key:"getElem_",value:function(e){return this.svgElem_.querySelector?this.svgElem_.querySelector("#"+e):dn(this.svgElem_).find("[id="+e+"]")[0]}},{key:"getSvgElem",value:function(){return this.svgElem_}},{key:"getNonce",value:function(){return this.nonce_}},{key:"setNonce",value:function(e){this.svgElem_.setAttributeNS(u.XMLNS,"xmlns:se",u.SE),this.svgElem_.setAttributeNS(u.SE,"se:nonce",e),this.nonce_=e}},{key:"clearNonce",value:function(){this.nonce_=""}},{key:"getId",value:function(){return this.nonce_?this.idPrefix+this.nonce_+"_"+this.obj_num:this.idPrefix+this.obj_num}},{key:"getNextId",value:function(){var e=this.obj_num,t=!1;this.releasedNums.length>0?(this.obj_num=this.releasedNums.pop(),t=!0):this.obj_num++;for(var n=this.getId();this.getElem_(n);)t&&(this.obj_num=e,t=!1),this.obj_num++,n=this.getId();return t&&(this.obj_num=e),n}},{key:"releaseId",value:function(e){var t=this.idPrefix+(this.nonce_?this.nonce_+"_":"");if("string"!=typeof e||!e.startsWith(t))return!1;var n=parseInt(e.substr(t.length),10);return!("number"!=typeof n||n<=0||this.releasedNums.includes(n))&&(this.releasedNums.push(n),!0)}},{key:"getNumLayers",value:function(){return this.all_layers.length}},{key:"hasLayer",value:function(e){return void 0!==this.layer_map[e]}},{key:"getLayerName",value:function(e){return e>=0&&e<this.getNumLayers()?this.all_layers[e].getName():""}},{key:"getCurrentLayer",value:function(){return this.current_layer?this.current_layer.getGroup():null}},{key:"getLayerByName",value:function(e){var t=this.layer_map[e];return t?t.getGroup():null}},{key:"getCurrentLayerName",value:function(){return this.current_layer?this.current_layer.getName():""}},{key:"setCurrentLayerName",value:function(e,t){var n=null;if(this.current_layer){var r=this.current_layer.getName();(n=this.current_layer.setName(e,t))&&(delete this.layer_map[r],this.layer_map[n]=this.current_layer)}return n}},{key:"setCurrentLayerPosition",value:function(e){var t=this.getNumLayers();if(!this.current_layer||e<0||e>=t)return null;var n=void 0;for(n=0;n<t&&this.all_layers[n]!==this.current_layer;++n);if(n===t)return null;if(n!==e){var r=this.current_layer.getGroup(),a=r.nextSibling,i=null;return e>n?e<t-1&&(i=this.all_layers[e+1].getGroup()):i=this.all_layers[e].getGroup(),this.svgElem_.insertBefore(r,i),this.identifyLayers(),this.setCurrentLayer(this.getLayerName(e)),{currentGroup:r,oldNextSibling:a}}return null}},{key:"mergeLayer",value:function(e){var t=this.current_layer.getGroup(),n=dn(t).prev()[0];if(n){e.startBatchCommand("Merge Layer");var r=t.nextSibling;for(e.removeElement(t,r,this.svgElem_);t.firstChild;){var a=t.firstChild;if("title"!==a.localName){var i=a.nextSibling;n.append(a),e.moveElement(a,i,t)}else e.removeElement(a,a.nextSibling,t),a.remove()}this.current_layer.removeGroup();var o=this.all_layers.indexOf(this.current_layer);if(o>0){var s=this.current_layer.getName();this.current_layer=this.all_layers[o-1],this.all_layers.splice(o,1),delete this.layer_map[s]}e.endBatchCommand()}}},{key:"mergeAllLayers",value:function(e){for(this.current_layer=this.all_layers[this.all_layers.length-1],e.startBatchCommand("Merge all Layers");this.all_layers.length>1;)this.mergeLayer(e);e.endBatchCommand()}},{key:"setCurrentLayer",value:function(e){var t=this.layer_map[e];return!!t&&(this.current_layer&&this.current_layer.deactivate(),this.current_layer=t,this.current_layer.activate(),!0)}},{key:"deleteCurrentLayer",value:function(){if(this.current_layer&&this.getNumLayers()>1){var e=this.current_layer.removeGroup();return this.identifyLayers(),e}return null}},{key:"identifyLayers",value:function(){this.all_layers=[],this.layer_map={};for(var e,t=this.svgElem_.childNodes.length,n=[],r=[],a=null,i=!1,o=0;o<t;++o){var s=this.svgElem_.childNodes.item(o);if(s&&1===s.nodeType)if("g"===s.tagName){i=!0;var l=dn("title",e=s).text()||(N()&&e.querySelectorAll?dn(e.querySelectorAll("title")).text():"");l?(r.push(l),a=new ln(l,s),this.all_layers.push(a),this.layer_map[l]=a):n.push(s)}else hn.includes(s.nodeName)&&n.push(s)}n.length>0||!i?((a=new ln(mn(r),null,this.svgElem_)).appendChildren(n),this.all_layers.push(a),this.layer_map[name]=a):a.activate(),this.current_layer=a}},{key:"createLayer",value:function(e,t){this.current_layer&&this.current_layer.deactivate(),(void 0===e||null===e||""===e||this.layer_map[e])&&(e=mn(Object.keys(this.layer_map)));var n=new ln(e,null,this.svgElem_);return t&&(t.startBatchCommand("Create Layer"),t.insertElement(n.getGroup()),t.endBatchCommand()),this.all_layers.push(n),this.layer_map[e]=n,this.current_layer=n,n.getGroup()}},{key:"cloneLayer",value:function(e,t){if(!this.current_layer)return null;this.current_layer.deactivate(),(void 0===e||null===e||""===e||this.layer_map[e])&&(e=mn(Object.keys(this.layer_map)));for(var n=this.current_layer.getGroup(),r=new ln(e,n,this.svgElem_),a=r.getGroup(),i=n.childNodes,o=0;o<i.length;o++){var s=i[o];"title"!==s.localName&&a.append(this.copyElem(s))}t&&(t.startBatchCommand("Duplicate Layer"),t.insertElement(a),t.endBatchCommand());var l=this.all_layers.indexOf(this.current_layer);return l>=0?this.all_layers.splice(l+1,0,r):this.all_layers.push(r),this.layer_map[e]=r,this.current_layer=r,a}},{key:"getLayerVisibility",value:function(e){var t=this.layer_map[e];return!!t&&t.isVisible()}},{key:"setLayerVisibility",value:function(e,t){if("boolean"!=typeof t)return null;var n=this.layer_map[e];return n?(n.setVisible(t),n.getGroup()):null}},{key:"getLayerOpacity",value:function(e){var t=this.layer_map[e];return t?t.getOpacity():null}},{key:"setLayerOpacity",value:function(e,t){if(!("number"!=typeof t||t<0||t>1)){var n=this.layer_map[e];n&&n.setOpacity(t)}}},{key:"copyElem",value:function(e){var t=this;return function e(t,n){var r=document.createElementNS(t.namespaceURI,t.nodeName);if(ct.each(t.attributes,function(e,t){"-moz-math-font-style"!==t.localName&&r.setAttributeNS(t.namespaceURI,t.nodeName,t.value)}),r.removeAttribute("id"),r.id=n(),L()&&"path"===t.nodeName){var a=tt(t);r.setAttribute("d",a)}if(ct.each(t.childNodes,function(t,a){switch(a.nodeType){case 1:r.append(e(a,n));break;case 3:r.textContent=a.nodeValue}}),ct(t).data("gsvg"))ct(r).data("gsvg",r.firstChild);else if(ct(t).data("symbol")){var i=ct(t).data("symbol");ct(r).data("ref",i).data("symbol",i)}else"image"===r.tagName&&Qt(r);return r}(e,function(){return t.getNextId()})}}]),e}(),yn=function(e,t){(pn=!1===e?fn.NEVER_RANDOMIZE:fn.ALWAYS_RANDOMIZE)!==fn.ALWAYS_RANDOMIZE||t.getNonce()?pn===fn.NEVER_RANDOMIZE&&t.getNonce()&&t.clearNonce():t.setNonce(Math.floor(100001*Math.random()))},bn=void 0,xn=function(e){bn=e},wn=function(){Sn(),bn.getCurrentDrawing().identifyLayers()},Sn=function(){var e=gn.length;if(e){for(var t=0;t<e;t++){var n=gn[t],r=bn.elData(n,"orig_opac");1!==r?n.setAttribute("opacity",r):n.removeAttribute("opacity"),n.setAttribute("style","pointer-events: inherit")}gn=[],bn.clearSelection(!0),bn.call("contextset",null)}bn.setCurrentGroup(null)},kn=function(e){Sn(),"string"==typeof e&&(e=qt(e)),bn.setCurrentGroup(e),dn(e).parentsUntil("#svgcontent").andSelf().siblings().each(function(){var e=this.getAttribute("opacity")||1;bn.elData(this,"orig_opac",e),this.setAttribute("opacity",.33*e),this.setAttribute("style","pointer-events: none"),gn.push(this)}),bn.clearSelection(),bn.call("contextset",bn.getCurrentGroup())},Cn=Object.freeze({Drawing:_n,randomizeIds:yn,init:xn,identifyLayers:wn,createLayer:function(e,t){var n=bn.getCurrentDrawing().createLayer(e,vn(t));bn.clearSelection(),bn.call("changed",[n])},cloneLayer:function(e,t){var n=bn.getCurrentDrawing().cloneLayer(e,vn(t));bn.clearSelection(),Sn(),bn.call("changed",[n])},deleteCurrentLayer:function(){var e=bn.getCurrentDrawing().getCurrentLayer(),t=e.nextSibling,n=e.parentNode;if(e=bn.getCurrentDrawing().deleteCurrentLayer()){var r=new ce("Delete Layer");return r.addSubCommand(new se(e,t,n)),bn.addCommandToHistory(r),bn.clearSelection(),bn.call("changed",[n]),!0}return!1},setCurrentLayer:function(e){var t=bn.getCurrentDrawing().setCurrentLayer(vt(e));return t&&bn.clearSelection(),t},renameCurrentLayer:function(e){var t=bn.getCurrentDrawing(),n=t.getCurrentLayer();if(n&&t.setCurrentLayerName(e,vn()))return bn.call("changed",[n]),!0;return!1},setCurrentLayerPosition:function(e){var t=bn.getCurrentDrawing().setCurrentLayerPosition(e);return!!t&&(bn.addCommandToHistory(new ie(t.currentGroup,t.oldNextSibling,bn.getSVGContent())),!0)},setLayerVisibility:function(e,t){var n=bn.getCurrentDrawing(),r=n.getLayerVisibility(e),a=n.setLayerVisibility(e,t);if(!a)return!1;var i=r?"inline":"none";return bn.addCommandToHistory(new le(a,{display:i},"Layer Visibility")),a===n.getCurrentLayer()&&(bn.clearSelection(),bn.pathActions.clear()),!0},moveSelectedToLayer:function(e){var t=bn.getCurrentDrawing().getLayerByName(e);if(!t)return!1;for(var n=new ce("Move Elements to Layer"),r=bn.getSelectedElements(),a=r.length;a--;){var i=r[a];if(i){var o=i.nextSibling,s=i.parentNode;t.append(i),n.addSubCommand(new ie(i,o,s))}}return bn.addCommandToHistory(n),!0},mergeLayer:function(e){bn.getCurrentDrawing().mergeLayer(vn(e)),bn.clearSelection(),Sn(),bn.changeSvgcontent()},mergeAllLayers:function(e){bn.getCurrentDrawing().mergeAllLayers(vn(e)),bn.clearSelection(),Sn(),bn.changeSvgcontent()},leaveContext:Sn,setContext:kn,Layer:ln}),An=d(),En={a:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","mask","opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","xlink:href","xlink:title"],circle:["class","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","r","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],clipPath:["class","clipPathUnits","id"],defs:[],style:["type"],desc:[],ellipse:["class","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],feGaussianBlur:["class","color-interpolation-filters","id","requiredFeatures","stdDeviation"],filter:["class","color-interpolation-filters","filterRes","filterUnits","height","id","primitiveUnits","requiredFeatures","width","x","xlink:href","y"],foreignObject:["class","font-size","height","id","opacity","requiredFeatures","style","transform","width","x","y"],g:["class","clip-path","clip-rule","id","display","fill","fill-opacity","fill-rule","filter","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","font-family","font-size","font-style","font-weight","text-anchor"],image:["class","clip-path","clip-rule","filter","height","id","mask","opacity","requiredFeatures","style","systemLanguage","transform","width","x","xlink:href","xlink:title","y"],line:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","x1","x2","y1","y2"],linearGradient:["class","id","gradientTransform","gradientUnits","requiredFeatures","spreadMethod","systemLanguage","x1","x2","xlink:href","y1","y2"],marker:["id","class","markerHeight","markerUnits","markerWidth","orient","preserveAspectRatio","refX","refY","systemLanguage","viewBox"],mask:["class","height","id","maskContentUnits","maskUnits","width","x","y"],metadata:["class","id"],path:["class","clip-path","clip-rule","d","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],pattern:["class","height","id","patternContentUnits","patternTransform","patternUnits","requiredFeatures","style","systemLanguage","viewBox","width","x","xlink:href","y"],polygon:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","id","class","marker-end","marker-mid","marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],polyline:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","marker-end","marker-mid","marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],radialGradient:["class","cx","cy","fx","fy","gradientTransform","gradientUnits","id","r","requiredFeatures","spreadMethod","systemLanguage","xlink:href"],rect:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask","opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","width","x","y"],stop:["class","id","offset","requiredFeatures","stop-color","stop-opacity","style","systemLanguage"],svg:["class","clip-path","clip-rule","filter","id","height","mask","preserveAspectRatio","requiredFeatures","style","systemLanguage","viewBox","width","x","xmlns","xmlns:se","xmlns:xlink","y"],switch:["class","id","requiredFeatures","systemLanguage"],symbol:["class","fill","fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","opacity","preserveAspectRatio","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","viewBox"],text:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","transform","x","xml:space","y"],textPath:["class","id","method","requiredFeatures","spacing","startOffset","style","systemLanguage","transform","xlink:href"],title:[],tspan:["class","clip-path","clip-rule","dx","dy","fill","fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","rotate","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","textLength","transform","x","xml:space","y"],use:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","transform","width","x","xlink:href","y"],annotation:["encoding"],"annotation-xml":["encoding"],maction:["actiontype","other","selection"],math:["class","id","display","xmlns"],menclose:["notation"],merror:[],mfrac:["linethickness"],mi:["mathvariant"],mmultiscripts:[],mn:[],mo:["fence","lspace","maxsize","minsize","rspace","stretchy"],mover:[],mpadded:["lspace","width","height","depth","voffset"],mphantom:[],mprescripts:[],mroot:[],mrow:["xlink:href","xlink:type","xmlns:xlink"],mspace:["depth","height","width"],msqrt:[],mstyle:["displaystyle","mathbackground","mathcolor","mathvariant","scriptlevel"],msub:[],msubsup:[],msup:[],mtable:["align","columnalign","columnlines","columnspacing","displaystyle","equalcolumns","equalrows","frame","rowalign","rowlines","rowspacing","width"],mtd:["columnalign","columnspan","rowalign","rowspan"],mtext:[],mtr:["columnalign","rowalign"],munder:[],munderover:[],none:[],semantics:[]},Pn={};Object.entries(En).forEach(function(e){var t=l(e,2),n=t[0],r=t[1],a={};Object.entries(r).forEach(function(e){var t=l(e,2),n=(t[0],t[1]);if(n.includes(":")){var r=n.split(":");a[r[1]]=u[r[0].toUpperCase()]}else a[n]="xmlns"===n?u.XMLNS:null}),Pn[n]=a});var Gn=function e(t){if(3===t.nodeType&&(t.nodeValue=t.nodeValue.replace(/^\s+|\s+$/g,""),t.nodeValue.length||t.remove()),1===t.nodeType){var n=t.ownerDocument,r=t.parentNode;if(n&&r){var a=En[t.nodeName],i=Pn[t.nodeName];if(void 0!==a){for(var o=[],s=t.attributes.length;s--;){var c=t.attributes.item(s),d=c.nodeName,h=c.localName,f=c.namespaceURI;if(i.hasOwnProperty(h)&&f===i[h]&&f!==u.XMLNS||f===u.XMLNS&&An[c.value]||((d.startsWith("se:")||d.startsWith("data-"))&&o.push([d,c.value]),t.removeAttributeNS(f,h)),M())switch(d){case"transform":case"gradientTransform":case"patternTransform":var p=c.value.replace(/(\d)-/g,"$1 -");t.setAttribute(d,p)}if("style"===d){for(var g=c.value.split(";"),v=g.length;v--;){var m=g[v].split(":"),_=l(m,2),y=_[0],b=_[1],x=(y||"").trim(),w=(b||"").trim();a.includes(x)&&t.setAttribute(x,w)}t.removeAttribute("style")}}Object.values(o).forEach(function(e){var n=l(e,2),r=n[0],a=n[1];t.setAttributeNS(u.SE,r,a)});var S=Et(t);if(S&&["filter","linearGradient","pattern","radialGradient","textPath","use"].includes(t.nodeName)&&"#"!==S[0]&&(Pt(t,""),t.removeAttributeNS(u.XLINK,"href")),"use"===t.nodeName&&!Et(t))return void t.remove();for(Object.values(["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],function(e){var n=t.getAttribute(e);n&&(n=At(n))&&"#"!==n[0]&&(t.setAttribute(e,""),t.removeAttribute(e))}),s=t.childNodes.length;s--;)e(t.childNodes.item(s))}else{for(var k=[];t.hasChildNodes();)k.push(r.insertBefore(t.firstChild,t));t.remove();for(var C=k.length;C--;)e(k[C])}}}},In=jQuery,Tn=[0,"z","M","m","L","l","C","c","Q","q","A","a","H","h","V","v","S","s","T","t"],Nn=null,Ln=function(e,t,n){for(var r=function(e,t){return fe(e,t,n)},a=function(e){return n.a*e},i=function(e){return n.d*e},o=Nn.getGridSnapping()&&"svg"===e.parentNode.parentNode.localName,s=function(){if(o)for(var n in t)t[n]=Xt(t[n]);Yt(e,t,1e3,!0)},l=Nt(e),c=0;c<2;c++){var u=0===c?"fill":"stroke",d=e.getAttribute(u);if(d&&d.startsWith("url(")&&(n.a<0||n.d<0)){var h=zt(d).cloneNode(!0);if(n.a<0){var f=h.getAttribute("x1"),p=h.getAttribute("x2");h.setAttribute("x1",-(f-1)),h.setAttribute("x2",-(p-1))}if(n.d<0){var g=h.getAttribute("y1"),v=h.getAttribute("y2");h.setAttribute("y1",-(g-1)),h.setAttribute("y2",-(v-1))}h.id=Nn.getDrawing().getNextId(),Gt().append(h),e.setAttribute(u,"url(#"+h.id+")")}}var m=e.tagName;if("g"===m||"text"===m||"tspan"===m||"use"===m)if(1!==n.a||0!==n.b||0!==n.c||1!==n.d||0===n.e&&0===n.f){var _=W(e),y=Nn.getSVGRoot().createSVGTransform();y.setMatrix(ge(_e(_).matrix,n)),_.clear(),_.appendItem(y)}else{var b=_e(e).matrix,x=ge(b.inverse(),n,b);t.x=parseFloat(t.x)+x.e,t.y=parseFloat(t.y)+x.f}switch(m){case"foreignObject":case"rect":case"image":if("image"===m&&(n.a<0||n.d<0)){var w=W(e),S=Nn.getSVGRoot().createSVGTransform();S.setMatrix(ge(_e(w).matrix,n)),w.clear(),w.appendItem(S)}else{var k=r(t.x,t.y);t.width=a(t.width),t.height=i(t.height),t.x=k.x+Math.min(0,t.width),t.y=k.y+Math.min(0,t.height),t.width=Math.abs(t.width),t.height=Math.abs(t.height)}s();break;case"ellipse":var C=r(t.cx,t.cy);t.cx=C.x,t.cy=C.y,t.rx=a(t.rx),t.ry=i(t.ry),t.rx=Math.abs(t.rx),t.ry=Math.abs(t.ry),s();break;case"circle":var A=r(t.cx,t.cy);t.cx=A.x,t.cy=A.y;var E=me(l.x,l.y,l.width,l.height,n),P=E.tr.x-E.tl.x,G=E.bl.y-E.tl.y;t.r=Math.min(P/2,G/2),t.r&&(t.r=Math.abs(t.r)),s();break;case"line":var I=r(t.x1,t.y1),T=r(t.x2,t.y2);t.x1=I.x,t.y1=I.y,t.x2=T.x,t.y2=T.y;case"text":case"tspan":case"use":s();break;case"g":var N=In(e).data("gsvg");N&&Yt(N,t,1e3,!0);break;case"polyline":case"polygon":for(var L=t.points.length,M=0;M<L;++M){var O=t.points[M],V=r(O.x,O.y),j=V.x,R=V.y;t.points[M].x=j,t.points[M].y=R}for(var B="",D=0;D<L;++D){var U=t.points[D];B+=U.x+","+U.y+" "}e.setAttribute("points",B);break;case"path":var F=e.pathSegList,H=F.numberOfItems;t.d=[];for(var z=0;z<H;++z){var q=F.getItem(z);t.d[z]={type:q.pathSegType,x:q.x,y:q.y,x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,r1:q.r1,r2:q.r2,angle:q.angle,largeArcFlag:q.largeArcFlag,sweepFlag:q.sweepFlag}}H=t.d.length;var Y=t.d[0],X=r(Y.x,Y.y);t.d[0].x=X.x,t.d[0].y=X.y;for(var Q=1;Q<H;++Q){var K=t.d[Q];if(K.type%2==0){var Z=r(void 0!==K.x?K.x:X.x,void 0!==K.y?K.y:X.y),$=r(K.x1,K.y1),J=r(K.x2,K.y2);K.x=Z.x,K.y=Z.y,K.x1=$.x,K.y1=$.y,K.x2=J.x,K.y2=J.y,K.r1=a(K.r1),K.r2=i(K.r2)}else K.x=a(K.x),K.y=i(K.y),K.x1=a(K.x1),K.y1=i(K.y1),K.x2=a(K.x2),K.y2=i(K.y2),K.r1=a(K.r1),K.r2=i(K.r2)}var ee="";H=t.d.length;for(var te=0;te<H;++te){var ne=t.d[te],re=ne.type;switch(ee+=Tn[re],re){case 13:case 12:ee+=ne.x+" ";break;case 15:case 14:ee+=ne.y+" ";break;case 3:case 5:case 19:case 2:case 4:case 18:ee+=ne.x+","+ne.y+" ";break;case 7:case 6:ee+=ne.x1+","+ne.y1+" "+ne.x2+","+ne.y2+" "+ne.x+","+ne.y+" ";break;case 9:case 8:ee+=ne.x1+","+ne.y1+" "+ne.x+","+ne.y+" ";break;case 11:case 10:ee+=ne.r1+","+ne.r2+" "+ne.angle+" "+ +ne.largeArcFlag+" "+ +ne.sweepFlag+" "+ne.x+","+ne.y+" ";break;case 17:case 16:ee+=ne.x2+","+ne.y2+" "+ne.x+","+ne.y+" "}}e.setAttribute("d",ee)}},Mn=U(jQuery),On=void 0,Vn=function(e,t,n){var r=zt(e).firstChild,a=W(r),i=On.getSVGRoot().createSVGTransform();i.setTranslate(t,n),a.appendItem(i),jn(r)},jn=function e(t){if(null==t)return null;if("svg"===t.nodeName&&navigator.userAgent.includes("Firefox/20"))return null;var n=On.getSVGRoot(),r=W(t);if(r&&r.numberOfItems>0){for(var a=r.numberOfItems,i=a;a--;){var o=r.getItem(a);if(0===o.type)r.removeItem(a);else if(1===o.type){if(pe(o.matrix)){if(1===i)return t.removeAttribute("transform"),null;r.removeItem(a)}}else 4===o.type&&0===o.angle&&r.removeItem(a)}if(1===r.numberOfItems&&Ht(t))return null}if(!r||0===r.numberOfItems)return t.setAttribute("transform",""),t.removeAttribute("transform"),null;if(r){for(var s=[],l=r.numberOfItems;l--;){var c=r.getItem(l);1===c.type?s.push([c.matrix,l]):s.length&&(s=[])}if(2===s.length){var d=n.createSVGTransformFromMatrix(ge(s[1][0],s[0][0]));r.removeItem(s[0][1]),r.removeItem(s[1][1]),r.insertItemBefore(d,s[1][1])}if((l=r.numberOfItems)>=2&&1===r.getItem(l-2).type&&2===r.getItem(l-1).type){var h=n.createSVGTransform(),f=ge(r.getItem(l-2).matrix,r.getItem(l-1).matrix);h.setMatrix(f),r.removeItem(l-2),r.removeItem(l-2),r.appendItem(h)}}switch(t.tagName){case"line":case"polyline":case"polygon":case"path":break;default:if(1===r.numberOfItems&&1===r.getItem(0).type||2===r.numberOfItems&&1===r.getItem(0).type&&4===r.getItem(0).type)return null}var p=Mn(t).data("gsvg"),g=new ce("Transform"),v={},m=null,_=[];switch(t.tagName){case"line":_=["x1","y1","x2","y2"];break;case"circle":_=["cx","cy","r"];break;case"ellipse":_=["cx","cy","rx","ry"];break;case"foreignObject":case"rect":case"image":_=["width","height","x","y"];break;case"use":case"text":case"tspan":_=["x","y"];break;case"polygon":case"polyline":(m={}).points=t.getAttribute("points");var y=t.points,b=y.numberOfItems;v.points=new Array(b);for(var x=0;x<b;++x){var w=y.getItem(x);v.points[x]={x:w.x,y:w.y}}break;case"path":(m={}).d=t.getAttribute("d"),v.d=t.getAttribute("d")}_.length?(v=Mn(t).attr(_),Mn.each(v,function(e,t){v[e]=ne(e,t)})):p&&(v={x:Mn(p).attr("x")||0,y:Mn(p).attr("y")||0}),null==m&&(m=Mn.extend(!0,{},v),Mn.each(m,function(e,t){m[e]=ne(e,t)})),m.transform=On.getStartTransform()||"";var S=void 0,k=void 0;if("g"===t.tagName&&!p||"a"===t.tagName){var C=Nt(t);S={x:C.x+C.width/2,y:C.y+C.height/2},k=fe(C.x+C.width/2,C.y+C.height/2,_e(r).matrix);var A=n.createSVGMatrix(),E=Ht(t);if(E){var P=E*Math.PI/180,G=void 0;G=Math.abs(P)>1e-10?Math.sin(P)/(1-Math.cos(P)):2/P;for(var I=0;I<r.numberOfItems;++I){var T=r.getItem(I);if(4===T.type){var N=T.matrix;S.y=(G*N.e+N.f)/2,S.x=(N.e-G*N.f)/2,r.removeItem(I);break}}}var M=r.numberOfItems,O=0,V=0,j=0,R=void 0;M&&(R=r.getItem(0).matrix);var B=void 0;if(M>=3&&3===r.getItem(M-2).type&&2===r.getItem(M-3).type&&2===r.getItem(M-1).type){j=3;for(var D=r.getItem(M-3).matrix,U=r.getItem(M-2).matrix,F=r.getItem(M-1).matrix,H=t.childNodes,z=H.length;z--;){var q=H.item(z);if(O=0,V=0,1===q.nodeType){var Y=W(q);if(!Y)continue;var X=_e(Y).matrix,Q=Ht(q);if(B=On.getStartTransform(),On.setStartTransform(q.getAttribute("transform")),Q||ve(Y)){var K=n.createSVGTransform();K.setMatrix(ge(D,U,F,X)),Y.clear(),Y.appendItem(K)}else{var Z=ge(X.inverse(),F,X),$=n.createSVGMatrix();$.e=-Z.e,$.f=-Z.f;var J=ge($.inverse(),X.inverse(),D,U,F,X,Z.inverse()),ee=n.createSVGTransform(),te=n.createSVGTransform(),re=n.createSVGTransform();ee.setTranslate(Z.e,Z.f),te.setScale(J.a,J.d),re.setTranslate($.e,$.f),Y.appendItem(re),Y.appendItem(te),Y.appendItem(ee)}g.addSubCommand(e(q)),On.setStartTransform(B)}}r.removeItem(M-1),r.removeItem(M-2),r.removeItem(M-3)}else if(M>=3&&1===r.getItem(M-1).type){j=3,A=_e(r).matrix;var ae=n.createSVGTransform();ae.setMatrix(A),r.clear(),r.appendItem(ae)}else if((1===M||M>1&&3!==r.getItem(1).type)&&2===r.getItem(0).type){j=2;var ie=_e(r).matrix;r.removeItem(0);var oe=_e(r).matrix.inverse(),se=ge(oe,ie);if(O=se.e,V=se.f,0!==O||0!==V){for(var ue=t.childNodes,de=ue.length,he=[];de--;){var me=ue.item(de);if(1===me.nodeType){if(me.getAttribute("clip-path")){var ye=me.getAttribute("clip-path");he.includes(ye)||(Vn(ye,O,V),he.push(ye))}B=On.getStartTransform(),On.setStartTransform(me.getAttribute("transform"));var be=W(me);if(be){var xe=n.createSVGTransform();xe.setTranslate(O,V),be.numberOfItems?be.insertItemBefore(xe,0):be.appendItem(xe),g.addSubCommand(e(me));for(var we=t.getElementsByTagNameNS(u.SVG,"use"),Se="#"+me.id,ke=we.length;ke--;){var Ce=we.item(ke);if(Se===Et(Ce)){var Ae=n.createSVGTransform();Ae.setTranslate(-O,-V),W(Ce).insertItemBefore(Ae,0),g.addSubCommand(e(Ce))}}On.setStartTransform(B)}}}he=[],On.setStartTransform(B)}}else{if(1!==M||1!==r.getItem(0).type||E){if(E){var Ee=n.createSVGTransform();Ee.setRotate(E,k.x,k.y),r.numberOfItems?r.insertItemBefore(Ee,0):r.appendItem(Ee)}return 0===r.numberOfItems&&t.removeAttribute("transform"),null}j=1;for(var Pe=r.getItem(0).matrix,Ge=t.childNodes,Ie=Ge.length;Ie--;){var Te=Ge.item(Ie);if(1===Te.nodeType){B=On.getStartTransform(),On.setStartTransform(Te.getAttribute("transform"));var Ne=W(Te);if(!Ne)continue;var Le=ge(Pe,_e(Ne).matrix),Me=n.createSVGTransform();Me.setMatrix(Le),Ne.clear(),Ne.appendItem(Me,0),g.addSubCommand(e(Te)),On.setStartTransform(B);var Oe=Te.getAttribute("stroke-width");if("none"!==Te.getAttribute("stroke")&&!isNaN(Oe)){var Ve=(Math.abs(Le.a)+Math.abs(Le.d))/2;Te.setAttribute("stroke-width",Oe*Ve)}}}r.clear()}if(2===j){if(E){k={x:S.x+R.e,y:S.y+R.f};var je=n.createSVGTransform();je.setRotate(E,k.x,k.y),r.numberOfItems?r.insertItemBefore(je,0):r.appendItem(je)}}else if(3===j){var Re=_e(r).matrix,Be=n.createSVGTransform();Be.setRotate(E,S.x,S.y);var De=Be.matrix,Ue=n.createSVGTransform();Ue.setRotate(E,k.x,k.y);var Fe=Ue.matrix.inverse(),He=Re.inverse(),ze=ge(He,Fe,De,Re);if(O=ze.e,V=ze.f,0!==O||0!==V)for(var qe=t.childNodes,Ye=qe.length;Ye--;){var We=qe.item(Ye);if(1===We.nodeType){B=On.getStartTransform(),On.setStartTransform(We.getAttribute("transform"));var Xe=W(We),Qe=n.createSVGTransform();Qe.setTranslate(O,V),Xe.numberOfItems?Xe.insertItemBefore(Qe,0):Xe.appendItem(Qe),g.addSubCommand(e(We)),On.setStartTransform(B)}}E&&(r.numberOfItems?r.insertItemBefore(Ue,0):r.appendItem(Ue))}}else{var Ke=Nt(t);if(!Ke&&"path"!==t.tagName)return null;var Ze=n.createSVGMatrix(),$e=Ht(t);if($e){S={x:Ke.x+Ke.width/2,y:Ke.y+Ke.height/2},k=fe(Ke.x+Ke.width/2,Ke.y+Ke.height/2,_e(r).matrix);for(var Je=$e*Math.PI/180,et=Math.abs(Je)>1e-10?Math.sin(Je)/(1-Math.cos(Je)):2/Je,tt=0;tt<r.numberOfItems;++tt){var nt=r.getItem(tt);if(4===nt.type){var rt=nt.matrix;S.y=(et*rt.e+rt.f)/2,S.x=(rt.e-et*rt.f)/2,r.removeItem(tt);break}}}var at=0,it=r.numberOfItems;if(!L()){var ot=t.getAttribute("fill");if(ot&&ot.startsWith("url(")){var st=zt(ot),lt="pattern";if(st.tagName!==lt&&(lt="gradient"),"userSpaceOnUse"===st.getAttribute(lt+"Units")){Ze=_e(r).matrix;var ct=W(st),ut=_e(ct).matrix,dt="matrix("+[(Ze=ge(Ze,ut)).a,Ze.b,Ze.c,Ze.d,Ze.e,Ze.f].join(",")+")";st.setAttribute(lt+"Transform",dt)}}}if(it>=3&&3===r.getItem(it-2).type&&2===r.getItem(it-3).type&&2===r.getItem(it-1).type)at=3,Ze=_e(r,it-3,it-1).matrix,r.removeItem(it-1),r.removeItem(it-2),r.removeItem(it-3);else if(4===it&&1===r.getItem(it-1).type){at=3,Ze=_e(r).matrix;var ht=n.createSVGTransform();ht.setMatrix(Ze),r.clear(),r.appendItem(ht),Ze=n.createSVGMatrix()}else if((1===it||it>1&&3!==r.getItem(1).type)&&2===r.getItem(0).type){at=2;var ft=r.getItem(0).matrix,pt=_e(r,1).matrix,gt=pt.inverse();Ze=ge(gt,ft,pt),r.removeItem(0)}else{if(1!==it||1!==r.getItem(0).type||$e){if(at=4,$e){var vt=n.createSVGTransform();vt.setRotate($e,k.x,k.y),r.numberOfItems?r.insertItemBefore(vt,0):r.appendItem(vt)}return 0===r.numberOfItems&&t.removeAttribute("transform"),null}switch(Ze=_e(r).matrix,t.tagName){case"line":v=Mn(t).attr(["x1","y1","x2","y2"]);case"polyline":case"polygon":if(v.points=t.getAttribute("points"),v.points){var mt=t.points,_t=mt.numberOfItems;v.points=new Array(_t);for(var yt=0;yt<_t;++yt){var bt=mt.getItem(yt);v.points[yt]={x:bt.x,y:bt.y}}}case"path":v.d=t.getAttribute("d"),at=1,r.clear()}}if(1!==at&&2!==at&&3!==at||Ln(t,v,Ze),2===at){if($e){ve(r)||(k={x:S.x+Ze.e,y:S.y+Ze.f});var xt=n.createSVGTransform();xt.setRotate($e,k.x,k.y),r.numberOfItems?r.insertItemBefore(xt,0):r.appendItem(xt)}if("text"===t.tagName)for(var wt=t.childNodes,St=wt.length;St--;){var kt=wt.item(St);if("tspan"===kt.tagName){var Ct={x:Mn(kt).attr("x")||0,y:Mn(kt).attr("y")||0};Ln(kt,Ct,Ze)}}}else if(3===at&&$e){var At=_e(r).matrix,Pt=n.createSVGTransform();Pt.setRotate($e,S.x,S.y);var Gt=Pt.matrix,It=n.createSVGTransform();It.setRotate($e,k.x,k.y);var Tt=It.matrix.inverse(),Lt=At.inverse(),Mt=ge(Lt,Tt,Gt,At);Ln(t,v,Mt),$e&&(r.numberOfItems?r.insertItemBefore(It,0):r.appendItem(It))}}return 0===r.numberOfItems&&t.removeAttribute("transform"),g.addSubCommand(new le(t,m)),g},Rn=jQuery,Bn=void 0,Dn=void 0,Un=void 0,Fn=R()?10:4,Hn=function(){function e(t,n,a){r(this,e),this.id=t,this.selectedElement=n,this.locked=!0,this.selectorGroup=Bn.createSVGElement({element:"g",attr:{id:"selectorGroup"+this.id}}),this.selectorRect=this.selectorGroup.appendChild(Bn.createSVGElement({element:"path",attr:{id:"selectedBox"+this.id,fill:"none",stroke:"#22C","stroke-width":"1","stroke-dasharray":"5,5",style:"pointer-events:none"}})),this.gripCoords={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null},this.reset(this.selectedElement,a)}return a(e,[{key:"reset",value:function(e,t){this.locked=!0,this.selectedElement=e,this.resize(t),this.selectorGroup.setAttribute("display","inline")}},{key:"updateGripCursors",value:function(e){var t=void 0,n=[],r=Math.round(e/45);for(t in r<0&&(r+=8),Un.selectorGrips)n.push(t);for(;r>0;)n.push(n.shift()),r--;var a=0;for(t in Un.selectorGrips)Un.selectorGrips[t].setAttribute("style","cursor:"+n[a]+"-resize"),a++}},{key:"showGrips",value:function(e){var t=e?"inline":"none";Un.selectorGripsGroup.setAttribute("display",t);var n=this.selectedElement;this.hasGrips=e,n&&e&&(this.selectorGroup.append(Un.selectorGripsGroup),this.updateGripCursors(Ht(n)))}},{key:"resize",value:function(e){var t=this.selectorRect,n=Un,r=n.selectorGrips,a=this.selectedElement,i=a.getAttribute("stroke-width"),o=Bn.getCurrentZoom(),s=1/o;"none"===a.getAttribute("stroke")||isNaN(i)||(s+=i/2);var l=a.tagName;"text"===l&&(s+=2/o);var c=W(a),u=_e(c).matrix;if(u.e*=o,u.f*=o,e||(e=Nt(a)),"g"===l&&!Rn.data(a,"gsvg")){var d=Bt([a.childNodes]);d&&(e=d)}var h=e.x,f=e.y,p=e.width,g=e.height;e={x:h,y:f,width:p,height:g},s*=o;var v=me(h*o,f*o,p*o,g*o,u),m=v.aabox,_=m.x-s,y=m.y-s,b=m.width+2*s,x=m.height+2*s,w=_+b/2,S=y+x/2,k=Ht(a);if(k){var C=Bn.svgRoot().createSVGTransform();C.setRotate(-k,w,S);var A=C.matrix;v.tl=fe(v.tl.x,v.tl.y,A),v.tr=fe(v.tr.x,v.tr.y,A),v.bl=fe(v.bl.x,v.bl.y,A),v.br=fe(v.br.x,v.br.y,A);var E=v.tl,P=E.x,G=E.y,I=E.x,T=E.y,N=Math.min,L=Math.max;_=P=N(P,N(v.tr.x,N(v.bl.x,v.br.x)))-s,y=G=N(G,N(v.tr.y,N(v.bl.y,v.br.y)))-s,b=(I=L(I,L(v.tr.x,L(v.bl.x,v.br.x)))+s)-P,x=(T=L(T,L(v.tr.y,L(v.bl.y,v.br.y)))+s)-G}var M="M"+_+","+y+" L"+(_+b)+","+y+" "+(_+b)+","+(y+x)+" "+_+","+(y+x)+"z";t.setAttribute("d",M);var O=k?"rotate("+[k,w,S].join(",")+")":"";for(var V in this.selectorGroup.setAttribute("transform",O),this.gripCoords={nw:[_,y],ne:[_+b,y],sw:[_,y+x],se:[_+b,y+x],n:[_+b/2,y],w:[_,y+x/2],e:[_+b,y+x/2],s:[_+b/2,y+x]},this.gripCoords){var j=this.gripCoords[V];r[V].setAttribute("cx",j[0]),r[V].setAttribute("cy",j[1])}n.rotateGripConnector.setAttribute("x1",_+b/2),n.rotateGripConnector.setAttribute("y1",y),n.rotateGripConnector.setAttribute("x2",_+b/2),n.rotateGripConnector.setAttribute("y2",y-5*Fn),n.rotateGrip.setAttribute("cx",_+b/2),n.rotateGrip.setAttribute("cy",y-5*Fn)}}]),e}(),zn=function(){function e(){r(this,e),this.selectorParentGroup=null,this.rubberBandBox=null,this.selectors=[],this.selectorMap={},this.selectorGrips={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null},this.selectorGripsGroup=null,this.rotateGripConnector=null,this.rotateGrip=null,this.initGroup()}return a(e,[{key:"initGroup",value:function(){for(var e in this.selectorParentGroup&&this.selectorParentGroup.parentNode&&this.selectorParentGroup.remove(),this.selectorParentGroup=Bn.createSVGElement({element:"g",attr:{id:"selectorParentGroup"}}),this.selectorGripsGroup=Bn.createSVGElement({element:"g",attr:{display:"none"}}),this.selectorParentGroup.append(this.selectorGripsGroup),Bn.svgRoot().append(this.selectorParentGroup),this.selectorMap={},this.selectors=[],this.rubberBandBox=null,this.selectorGrips){var t=Bn.createSVGElement({element:"circle",attr:{id:"selectorGrip_resize_"+e,fill:"#22C",r:Fn,style:"cursor:"+e+"-resize","stroke-width":2,"pointer-events":"all"}});Rn.data(t,"dir",e),Rn.data(t,"type","resize"),this.selectorGrips[e]=this.selectorGripsGroup.appendChild(t)}if(this.rotateGripConnector=this.selectorGripsGroup.appendChild(Bn.createSVGElement({element:"line",attr:{id:"selectorGrip_rotateconnector",stroke:"#22C","stroke-width":"1"}})),this.rotateGrip=this.selectorGripsGroup.appendChild(Bn.createSVGElement({element:"circle",attr:{id:"selectorGrip_rotate",fill:"lime",r:Fn,stroke:"#22C","stroke-width":2,style:"cursor:url("+Dn.imgPath+"rotate.png) 12 12, auto;"}})),Rn.data(this.rotateGrip,"type","rotate"),!Rn("#canvasBackground").length){var n=Dn.dimensions,r=Bn.createSVGElement({element:"svg",attr:{id:"canvasBackground",width:n[0],height:n[1],x:0,y:0,overflow:L()?"none":"visible",style:"pointer-events:none"}}),a=Bn.createSVGElement({element:"rect",attr:{width:"100%",height:"100%",x:0,y:0,"stroke-width":1,stroke:"#000",fill:"#FFF",style:"pointer-events:none"}});r.append(a),Bn.svgRoot().insertBefore(r,Bn.svgContent())}}},{key:"requestSelector",value:function(e,n){if(null==e)return null;var r=this.selectors.length;if("object"===t(this.selectorMap[e.id]))return this.selectorMap[e.id].locked=!0,this.selectorMap[e.id];for(var a=0;a<r;++a)if(this.selectors[a]&&!this.selectors[a].locked)return this.selectors[a].locked=!0,this.selectors[a].reset(e,n),this.selectorMap[e.id]=this.selectors[a],this.selectors[a];return this.selectors[r]=new Hn(r,e,n),this.selectorParentGroup.append(this.selectors[r].selectorGroup),this.selectorMap[e.id]=this.selectors[r],this.selectors[r]}},{key:"releaseSelector",value:function(e){if(null!=e){var t=this.selectors.length,n=this.selectorMap[e.id];n.locked||console.log("WARNING! selector was released but was already unlocked");for(var r=0;r<t;++r)if(this.selectors[r]&&this.selectors[r]===n){delete this.selectorMap[e.id],n.locked=!1,n.selectedElement=null,n.showGrips(!1);try{n.selectorGroup.setAttribute("display","none")}catch(e){}break}}}},{key:"getRubberBandBox",value:function(){return this.rubberBandBox||(this.rubberBandBox=this.selectorParentGroup.appendChild(Bn.createSVGElement({element:"rect",attr:{id:"selectorRubberBand",fill:"#22C","fill-opacity":.15,stroke:"#22C","stroke-width":.5,display:"none",style:"pointer-events:none"}}))),this.rubberBandBox}}]),e}(),qn=U(jQuery),Yn=ie,Wn=oe,Xn=se,Qn=le,Kn=ce,Zn=ue,$n=ae;window.console||(window.console={},window.console.log=function(e){},window.console.dir=function(e){}),window.opera&&(window.console.log=function(e){opera.postError(e)},window.console.dir=function(e){});var Jn=function e(a,i){r(this,e);var o={show_outside_canvas:!0,selectNew:!0,dimensions:[640,480]};i&&qn.extend(o,i);var s=o.dimensions,l=this,c=a.ownerDocument,h=c.importNode(kt('<svg id="svgroot" xmlns="'+u.SVG+'" xlinkns="'+u.XLINK+'" width="'+s[0]+'" height="'+s[1]+'" x="'+s[0]+'" y="'+s[1]+'" overflow="visible"><defs><filter id="canvashadow" filterUnits="objectBoundingBox"><feGaussianBlur in="SourceAlpha" stdDeviation="4" result="blur"/><feOffset in="blur" dx="5" dy="5" result="offsetBlur"/><feMerge><feMergeNode in="offsetBlur"/><feMergeNode in="SourceGraphic"/></feMerge></filter></defs></svg>').documentElement,!0);a.append(h);var f=c.createElementNS(u.SVG,"svg");(l.clearSvgContentElement=function(){qn(f).empty(),qn(f).attr({id:"svgcontent",width:s[0],height:s[1],x:s[0],y:s[1],overflow:o.show_outside_canvas?"visible":"hidden",xmlns:u.SVG,"xmlns:se":u.SE,"xmlns:xlink":u.XLINK}).appendTo(h);var e=c.createComment(" Created with SVG-edit - https://github.com/SVG-Edit/svgedit");f.append(e)})();var p="svg_";l.setIdPrefix=function(e){p=e},l.current_drawing_=new _n(f,p);var g=l.getCurrentDrawing=function(){return l.current_drawing_},v=1,m=null,_={shape:{fill:("none"===o.initFill.color?"":"#")+o.initFill.color,fill_paint:null,fill_opacity:o.initFill.opacity,stroke:"#"+o.initStroke.color,stroke_paint:null,stroke_opacity:o.initStroke.opacity,stroke_width:o.initStroke.width,stroke_dasharray:"none",stroke_linejoin:"miter",stroke_linecap:"butt",opacity:o.initOpacity}};_.text=qn.extend(!0,{},_.shape),qn.extend(_.text,{fill:"#000000",stroke_width:o.text&&o.text.stroke_width,font_size:o.text&&o.text.font_size,font_family:o.text&&o.text.font_family});var y=_.shape,b=[],x=this.getJsonFromSvgElement=function(e){if(3===e.nodeType)return e.nodeValue;for(var t,n={element:e.tagName,attr:{},children:[]},r=0;t=e.attributes[r];r++)n.attr[t.name]=t.value;for(var a,i=0;a=e.childNodes[i];i++)n.children[i]=x(a);return n},w=this.addSvgElementFromJson=function(e){if("string"==typeof e)return c.createTextNode(e);var t=qt(e.attr.id),n=g().getCurrentLayer();if(t&&e.element!==t.tagName&&(t.remove(),t=null),!t){var r=e.namespace||u.SVG;t=c.createElementNS(r,e.element),n&&(m||n).append(t)}return e.curStyles&&Yt(t,{fill:y.fill,stroke:y.stroke,"stroke-width":y.stroke_width,"stroke-dasharray":y.stroke_dasharray,"stroke-linejoin":y.stroke_linejoin,"stroke-linecap":y.stroke_linecap,"stroke-opacity":y.stroke_opacity,"fill-opacity":y.fill_opacity,opacity:y.opacity/2,style:"pointer-events:inherit"},100),Yt(t,e.attr,100),Wt(t),e.children&&e.children.forEach(function(e){t.append(w(e))}),t};l.getTransformList=W,l.matrixMultiply=ge,l.hasMatrixTransform=ve,l.transformListToTransform=_e,function(e){Z=e;var t=document.createElementNS(u.SVG,"svg");document.body.append(t);var n=document.createElementNS(u.SVG,"rect");n.setAttribute("width","1em"),n.setAttribute("height","1ex"),n.setAttribute("x","1in"),t.append(n);var r=n.getBBox();t.remove();var a=r.x;$={em:r.width,ex:r.height,in:a,cm:a/2.54,mm:a/25.4,pt:a/72,pc:a/6,px:1,"%":0}}({getBaseUnit:function(){return o.baseUnit},getElement:qt,getHeight:function(){return f.getAttribute("height")/v},getWidth:function(){return f.getAttribute("width")/v},getRoundDigits:function(){return ce.round_digits}}),l.convertToNum=ne;var S,k=function(){return f},C=this.getSelectedElems=function(){return b},A=lt;ht=S={pathActions:A,getSVGContent:k,addSvgElementFromJson:w,getSelectedElements:C,getDOMDocument:function(){return c},getDOMContainer:function(){return a},getSVGRoot:function(){return h},getBaseUnit:function(){return o.baseUnit},getSnappingStep:function(){return o.snappingStep}},ft=S.getDOMDocument(),pt=S.getDOMContainer(),gt=S.getSVGRoot(),l.findDefs=Gt,l.getUrlFromAttr=At,l.getHref=Et,l.setHref=Pt,l.getBBox=Nt,l.getRotationAngle=Ht,l.getElem=qt,l.getRefElem=zt,l.assignAttributes=Yt,this.cleanupElement=Wt;var P=function(){return o.gridSnapping};!function(e){Nn=e}({getDrawing:function(){return g()},getSVGRoot:function(){return h},getGridSnapping:P}),this.remapElement=Ln,function(e){On=e}({getSVGRoot:function(){return h},getStartTransform:function(){return Ee},setStartTransform:function(e){Ee=e}}),this.recalculateDimensions=jn;var G=d();l.sanitizeSvg=Gn;var I=l.undoMgr=new Zn({handleHistoryEvent:function(e,t){var n=$n;if(e===n.BEFORE_UNAPPLY||e===n.BEFORE_APPLY)l.clearSelection();else if(e===n.AFTER_APPLY||e===n.AFTER_UNAPPLY){var r=t.elements();l.pathActions.clear(),F("changed",r);var a=t.type(),i=e===n.AFTER_APPLY;if(a===Yn.type())(i?t.newParent:t.oldParent)===f&&wn();else if(a===Wn.type()||a===Xn.type())t.parent===f&&wn(),a===Wn.type()?i&&se(t.elem):i||se(t.elem),"use"===t.elem.tagName&&Bt(t.elem);else if(a===Qn.type()){"title"===t.elem.tagName&&t.elem.parentNode.parentNode===f&&wn();var o=i?t.newValues:t.oldValues;o.stdDeviation&&l.setBlurOffsets(t.elem.parentNode,o.stdDeviation)}}}}),T=function(e){l.undoMgr.addCommandToHistory(e)},N=this.getZoom=function(){return v},j=this.round=function(e){return parseInt(e*v,10)/v};!function(e,t){Dn=e,Bn=t,Un=new zn}(o,{createSVGElement:function(e){return l.addSvgElementFromJson(e)},svgRoot:function(){return h},svgContent:function(){return f},getCurrentZoom:N});var R=this.selectorManager=Un,B=l.getNextId=function(){return g().getNextId()},U=l.getId=function(){return g().getId()},F=function(e,t){if(Fe[e])return Fe[e](window,t)},H=function(e){b.map(function(e){null!=e&&R.releaseSelector(e)}),b=[],e||F("selected",b)},Y=function(e,t){if(e.length){for(var n=0;n<b.length&&null!=b[n];)++n;for(var r=e.length;r--;){var a=e[r];if(a){var i=Nt(a);if(i&&("a"===a.tagName&&1===a.childNodes.length&&(a=a.firstChild),!b.includes(a))){b[n]=a,n++;var o=R.requestSelector(a,i);b.length>1&&o.showGrips(!1)}}}for(F("selected",b),t||1===b.length?R.requestSelector(b[0]).showGrips(!0):R.requestSelector(b[0]).showGrips(!1),b.sort(function(e,t){return e&&t&&e.compareDocumentPosition?3-(6&t.compareDocumentPosition(e)):null==e?1:void 0});null==b[0];)b.shift(0)}},X=function(){return y.opacity},Q=this.getMouseTarget=function(e){if(null==e)return null;var t=e.target;if(t.correspondingUseElement&&(t=t.correspondingUseElement),[u.MATH,u.HTML].includes(t.namespaceURI)&&"svgcanvas"!==t.id)for(;"foreignObject"!==t.nodeName;)if(!(t=t.parentNode))return h;var n=g().getCurrentLayer();if([h,a,f,n].includes(t))return h;if(qn(t).closest("#selectorParentGroup").length)return R.selectorParentGroup;for(;t.parentNode!==(m||n);)t=t.parentNode;return t};l.pathActions=A,Te({selectorManager:R,canvas:l,call:F,resetD:function(e){e.setAttribute("d",A.convertPath(e))},round:j,clearSelection:H,addToSelection:Y,addCommandToHistory:T,remapElement:Ln,addSvgElementFromJson:w,getGridSnapping:P,getOpacity:X,getSelectedElements:C,getContainer:function(){return a},setStarted:function(e){Ae=e},getRubberBox:function(){return Oe},setRubberBox:function(e){return Oe=e},addPtsToSelection:function(e){var t=e.closedSubpath,n=e.grips;A.canDeleteNodes=!0,A.closed_subpath=t,F("pointsAdded",{closedSubpath:t,grips:n}),F("selected",n)},endChanges:function(e){var t=e.cmd,n=e.elem;T(t),F("changed",[n])},getCurrentZoom:N,getId:U,getNextId:B,getMouseTarget:Q,getCurrentMode:function(){return Ie},setCurrentMode:function(e){return Ie=e},getDrawnPath:function(){return bt},setDrawnPath:function(e){return bt=e},getSVGRoot:function(){return h}});var K={},re="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use",ae=["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],ie=qn.data,oe=document.createElementNS(u.SVG,"animate");qn(oe).attr({attributeName:"opacity",begin:"indefinite",dur:1,fill:"freeze"}).appendTo(h);var se=function e(t){var n=qn(t).attr(ae);for(var r in n){var a=n[r];if(a&&a.startsWith("url(")){var i=At(a).substr(1);qt(i)||(Gt().append(Se[i]),delete Se[i])}}var o=t.getElementsByTagName("*");if(o.length)for(var s=0,l=o.length;s<l;s++)e(o[s])},le={},ce={round_digits:5},ue={},he=_.text,we={},Se={},ke=o.imgPath+"logo.png",Ae=!1,Ee=null,Ie="select",Ne="none",Le=y,Me=null,Oe=null,Ve=[],je=null,Re=this.runExtensions=function(e,t,n){var r=!!n&&[];return qn.each(we,function(a,i){i&&e in i&&(n?r.push(i[e](t)):r=i[e](t))}),r};this.addExtension=function(e,t){var n=void 0;if(e in we)console.log('Cannot add extension "'+e+'", an extension by that name already exists.');else{var r=qn.extend(l.getPrivateMethods(),{svgroot:h,svgcontent:f,nonce:g().getNonce(),selectorManager:R});"function"==typeof t?n=t(r):(n=t).callback&&(n.callback=n.callback.bind(n,r)),we[e]=n,F("extension_added",n)}};var Be=this.getIntersectionList=function(e){if(null==Oe)return null;var t=m||g().getCurrentLayer(),n=void 0;if(e)(n=f.createSVGRect()).x=e.x,n.y=e.y,n.width=e.width,n.height=e.height;else{n=Oe.getBBox();var r=f.createSVGRect();for(var a in n)r[a]=n[a]/v;n=r}var i=null;if(O||"function"==typeof h.getIntersectionList&&(n.x+=parseInt(f.getAttribute("x"),10),n.y+=parseInt(f.getAttribute("y"),10),i=h.getIntersectionList(n,t)),null==i||"function"!=typeof i.item){i=[],Ve.length||(Ve=De(t));for(var o=Ve.length;o--;)n.width&&xe(n,Ve[o].bbox)&&i.push(Ve[o].elem)}return i};this.getStrokedBBox=Ut,this.getVisibleElements=Dt;var De=this.getVisibleElementsAndBBoxes=function(e){e||(e=qn(f).children());var t=[];return qn(e).children().each(function(e,n){n.getBBox&&t.push({elem:n,bbox:Ut([n])})}),t.reverse()},Ue=this.groupSvgElem=function(e){var t=document.createElementNS(u.SVG,"g");e.replaceWith(t),qn(t).append(e).data("gsvg",e)[0].id=B()},Fe={};l.call=F,l.bind=function(e,t){var n=Fe[e];return Fe[e]=t,n},this.prepareSvg=function(e){this.sanitizeSvg(e.documentElement);for(var t=e.getElementsByTagNameNS(u.SVG,"path"),n=0,r=t.length;n<r;++n){var a=t[n];a.setAttribute("d",A.convertPath(a)),A.fixEnd(a)}};var He=function(e){if(!M())return e;var t=e.cloneNode(!0);return e.before(t),e.remove(),R.releaseSelector(e),b[0]=t,R.requestSelector(t).showGrips(!0),t};this.setRotationAngle=function(e,t){e=parseFloat(e);var n=b[0],r=n.getAttribute("transform"),a=Nt(n),i=a.x+a.width/2,o=a.y+a.height/2,s=W(n);s.numberOfItems>0&&(4===s.getItem(0).type&&s.removeItem(0));if(0!==e){var l=fe(i,o,_e(s).matrix),c=h.createSVGTransform();c.setRotate(e,l.x,l.y),s.numberOfItems?s.insertItemBefore(c,0):s.appendItem(c)}else 0===s.numberOfItems&&n.removeAttribute("transform");if(!t){var u=n.getAttribute("transform");n.setAttribute("transform",r),nn("transform",u,b),F("changed",b)}var d=R.requestSelector(b[0]);d.resize(),d.updateGripCursors(e)};var ze=this.recalculateAllSelectedDimensions=function(){for(var e=new Kn("none"===Ne?"position":"size"),t=b.length;t--;){var n=b[t],r=jn(n);r&&e.addSubCommand(r)}e.isEmpty()||(T(e),F("changed",b))},qe=function(e){console.log([e.a,e.b,e.c,e.d,e.e,e.f])},We=null;this.clearSelection=H,this.addToSelection=Y;var Xe=this.selectOnly=function(e,t){H(!0),Y(e,t)};this.removeFromSelection=function(e){if(null!=b[0]&&e.length){for(var t=[],n=b.length,r=0;r<n;++r){var a=b[r];a&&(e.includes(a)?R.releaseSelector(a):t.push(a))}b=t}},this.selectAllInCurrentLayer=function(){var e=g().getCurrentLayer();e&&(Ie="select",Xe(qn(m||e).children()))};var Qe,Ke,Ze,$e,Je,et,tt,nt,rt,at,it,ot,st,ut,dt,yt,bt=null;Qe={minx:null,miny:null,maxx:null,maxy:null},Ke=null,Ze=null,$e=null,Je=null,et=null,tt={},nt=0,rt={x:0,y:0},at={x:0,y:0},it={x:0,y:0},ot={x:0,y:0},st={x:0,y:0},ut={x:0,y:0},dt=void 0,yt=function(e){var t={x:0,y:0},n=rt,r=at,a=it,i=ot,o=e*e,s=o*e,l=[[-1,3,-3,1],[3,-6,3,0],[-3,0,3,0],[1,4,1,0]];return t.x=1/6*((n.x*l[0][0]+r.x*l[0][1]+a.x*l[0][2]+i.x*l[0][3])*s+(n.x*l[1][0]+r.x*l[1][1]+a.x*l[1][2]+i.x*l[1][3])*o+(n.x*l[2][0]+r.x*l[2][1]+a.x*l[2][2]+i.x*l[2][3])*e+(n.x*l[3][0]+r.x*l[3][1]+a.x*l[3][2]+i.x*l[3][3])),t.y=1/6*((n.y*l[0][0]+r.y*l[0][1]+a.y*l[0][2]+i.y*l[0][3])*s+(n.y*l[1][0]+r.y*l[1][1]+a.y*l[1][2]+i.y*l[1][3])*o+(n.y*l[2][0]+r.y*l[2][1]+a.y*l[2][2]+i.y*l[2][3])*e+(n.y*l[3][0]+r.y*l[3][1]+a.y*l[3][2]+i.y*l[3][3])),{x:t.x,y:t.y}},qn(a).mousedown(function(e){if(!l.spaceKey&&1!==e.button){var t=2===e.button;e.altKey&&l.cloneSelectedElements(0,0),We=qn("#svgcontent g")[0].getScreenCTM().inverse();var n=fe(e.pageX,e.pageY,We),r=n.x*v,a=n.y*v;e.preventDefault(),t&&(Ie="select",je=n);var i=r/v,s=a/v,c=Q(e);"a"===c.tagName&&1===c.childNodes.length&&(c=c.firstChild);var u=i;Je=Ze=i;var d=s;if(et=$e=s,o.gridSnapping&&(i=Xt(i),s=Xt(s),Ze=Xt(Ze),$e=Xt($e)),c===R.selectorParentGroup&&null!=b[0]){var f=e.target,p=ie(f,"type");"rotate"===p?Ie="rotate":"resize"===p&&(Ie="resize",Ne=ie(f,"dir")),c=b[0]}Ee=c.getAttribute("transform");var g=void 0,m=void 0,_=W(c);switch(Ie){case"select":if(Ae=!0,Ne="none",t&&(Ae=!1),c!==h){if(b.includes(c)||(e.shiftKey||H(!0),Y([c]),Me=c,A.clear()),!t)for(g=0;g<b.length;++g)if(null!=b[g]){var x=W(b[g]);x.numberOfItems?x.insertItemBefore(h.createSVGTransform(),0):x.appendItem(h.createSVGTransform())}}else t||(H(),Ie="multiselect",null==Oe&&(Oe=R.getRubberBandBox()),Yt(Oe,{x:Je*=v,y:et*=v,width:0,height:0,display:"inline"},100));break;case"zoom":Ae=!0,null==Oe&&(Oe=R.getRubberBandBox()),Yt(Oe,{x:u*v,y:u*v,width:0,height:0,display:"inline"},100);break;case"resize":Ae=!0,Ze=i,$e=s,tt=Nt(qn("#selectedBox0")[0]);var S={};qn.each(tt,function(e,t){S[e]=t/v}),tt=S;var k=Ht(c)?1:0;if(ve(_))_.insertItemBefore(h.createSVGTransform(),k),_.insertItemBefore(h.createSVGTransform(),k),_.insertItemBefore(h.createSVGTransform(),k);else if(_.appendItem(h.createSVGTransform()),_.appendItem(h.createSVGTransform()),_.appendItem(h.createSVGTransform()),D()){var C=L(),E=void 0;C&&(E=function(e){var t=e.getAttributeNS(null,"stroke");e.removeAttributeNS(null,"stroke"),null!==t&&setTimeout(function(){e.setAttributeNS(null,"stroke",t)},0)}),c.style.vectorEffect="non-scaling-stroke",C&&E(c);var P=c.getElementsByTagName("*"),G=P.length;for(g=0;g<G;g++)P[g].style&&(P[g].style.vectorEffect="non-scaling-stroke",C&&E(P[g]))}break;case"fhellipse":case"fhrect":case"fhpath":it.x=u,it.y=d,Ae=!0,Ke=u+","+d+" ",m=0===parseFloat(y.stroke_width)?1:y.stroke_width,w({element:"polyline",curStyles:!0,attr:{points:Ke,id:B(),fill:"none",opacity:y.opacity/2,"stroke-linecap":"round",style:"pointer-events:none"}}),Qe.minx=u,Qe.maxx=u,Qe.miny=d,Qe.maxy=d;break;case"image":Ae=!0;var I=w({element:"image",attr:{x:i,y:s,width:0,height:0,id:B(),opacity:y.opacity/2,style:"pointer-events:inherit"}});Pt(I,ke),Qt(I);break;case"square":case"rect":Ae=!0,Ze=i,$e=s,w({element:"rect",curStyles:!0,attr:{x:i,y:s,width:0,height:0,id:B(),opacity:y.opacity/2}});break;case"line":Ae=!0,m=0===Number(y.stroke_width)?1:y.stroke_width,w({element:"line",curStyles:!0,attr:{x1:i,y1:s,x2:i,y2:s,id:B(),stroke:y.stroke,"stroke-width":m,"stroke-dasharray":y.stroke_dasharray,"stroke-linejoin":y.stroke_linejoin,"stroke-linecap":y.stroke_linecap,"stroke-opacity":y.stroke_opacity,fill:"none",opacity:y.opacity/2,style:"pointer-events:none"}});break;case"circle":Ae=!0,w({element:"circle",curStyles:!0,attr:{cx:i,cy:s,r:0,id:B(),opacity:y.opacity/2}});break;case"ellipse":Ae=!0,w({element:"ellipse",curStyles:!0,attr:{cx:i,cy:s,rx:0,ry:0,id:B(),opacity:y.opacity/2}});break;case"text":Ae=!0,w({element:"text",curStyles:!0,attr:{x:i,y:s,id:B(),fill:he.fill,"stroke-width":he.stroke_width,"font-size":he.font_size,"font-family":he.font_family,"text-anchor":"middle","xml:space":"preserve",opacity:y.opacity}});break;case"path":case"pathedit":Ze*=v,$e*=v,A.mouseDown(e,c,Ze,$e),Ae=!0;break;case"textedit":Ze*=v,$e*=v,St.mouseDown(e,c,Ze,$e),Ae=!0;break;case"rotate":Ae=!0,l.undoMgr.beginUndoableChange("transform",b)}var T=Re("mouseDown",{event:e,start_x:Ze,start_y:$e,selectedElements:b},!0);qn.each(T,function(e,t){t&&t.started&&(Ae=!0)})}}).mousemove(function(e){if(Ae&&1!==e.button&&!l.spaceKey){var t=void 0,n=void 0,r=void 0,a=void 0,i=void 0,s=void 0,c=void 0,u=void 0,d=void 0,f=b[0],p=fe(e.pageX,e.pageY,We),g=p.x*v,m=p.y*v,_=qt(U()),y=g/v,x=y,w=m/v,S=w;o.gridSnapping&&(x=Xt(x),S=Xt(S)),e.preventDefault();var k=void 0;switch(Ie){case"select":if(null!==b[0]){if(i=x-Ze,s=S-$e,o.gridSnapping&&(i=Xt(i),s=Xt(s)),e.shiftKey){var C=n=be(Ze,$e,x,S);x=C.x,S=C.y}if(0!==i||0!==s){for(c=b.length,t=0;t<c&&null!=(f=b[t]);++t){var E=h.createSVGTransform();k=W(f),E.setTranslate(i,s),k.numberOfItems?k.replaceItem(E,0):k.appendItem(E),R.requestSelector(f).resize()}F("transition",b)}}break;case"multiselect":y*=v,w*=v,Yt(Oe,{x:Math.min(Je,y),y:Math.min(et,w),width:Math.abs(y-Je),height:Math.abs(w-et)},100);var P=b.slice(),G=[],I=Be();for(c=I.length,t=0;t<c;++t){var T=I[t];b.includes(T)||G.push(T);var N=P.indexOf(T);-1!==N&&P.splice(N,1)}P.length>0&&l.removeFromSelection(P),G.length>0&&l.addToSelection(G);break;case"resize":k=W(f);var L=ve(k),M=(d=L?tt:Nt(f)).x,O=d.y,V=d,j=V.width,B=V.height;if(i=x-Ze,s=S-$e,o.gridSnapping&&(i=Xt(i),s=Xt(s),B=Xt(B),j=Xt(j)),u=Ht(f)){var D=Math.sqrt(i*i+s*s),H=Math.atan2(s,i)-u*Math.PI/180;i=D*Math.cos(H),s=D*Math.sin(H)}Ne.includes("n")||Ne.includes("s")||(s=0),Ne.includes("e")||Ne.includes("w")||(i=0);var z=0,q=0,Y=B?(B+s)/B:1,X=j?(j+i)/j:1;Ne.includes("n")&&(Y=B?(B-s)/B:1,q=B),Ne.includes("w")&&(X=j?(j-i)/j:1,z=j);var Q=h.createSVGTransform(),K=h.createSVGTransform(),Z=h.createSVGTransform();if(o.gridSnapping&&(M=Xt(M),z=Xt(z),O=Xt(O),q=Xt(q)),Q.setTranslate(-(M+z),-(O+q)),e.shiftKey&&(1===X?X=Y:Y=X),K.setScale(X,Y),Z.setTranslate(M+z,O+q),L){var $=u?1:0;k.replaceItem(Q,2+$),k.replaceItem(K,1+$),k.replaceItem(Z,Number($))}else{var J=k.numberOfItems;k.replaceItem(Z,J-3),k.replaceItem(K,J-2),k.replaceItem(Q,J-1)}R.requestSelector(f).resize(),F("transition",b);break;case"zoom":y*=v,w*=v,Yt(Oe,{x:Math.min(Je*v,y),y:Math.min(et*v,w),width:Math.abs(y-Je*v),height:Math.abs(w-et*v)},100);break;case"text":Yt(_,{x:x,y:S},1e3);break;case"line":o.gridSnapping&&(x=Xt(x),S=Xt(S));var ee=x,te=S;e.shiftKey&&(ee=(n=be(Ze,$e,ee,te)).x,te=n.y),_.setAttributeNS(null,"x2",ee),_.setAttributeNS(null,"y2",te);break;case"foreignObject":case"square":case"rect":case"image":var ne="square"===Ie||e.shiftKey,re=Math.abs(x-Ze),ae=Math.abs(S-$e),ie=void 0,oe=void 0;ne?(re=ae=Math.max(re,ae),ie=Ze<x?Ze:Ze-re,oe=$e<S?$e:$e-ae):(ie=Math.min(Ze,x),oe=Math.min($e,S)),o.gridSnapping&&(re=Xt(re),ae=Xt(ae),ie=Xt(ie),oe=Xt(oe)),Yt(_,{width:re,height:ae,x:ie,y:oe},1e3);break;case"circle":var se=qn(_).attr(["cx","cy"]);r=se.cx,a=se.cy;var le=Math.sqrt((x-r)*(x-r)+(S-a)*(S-a));o.gridSnapping&&(le=Xt(le)),_.setAttributeNS(null,"r",le);break;case"ellipse":var ce=qn(_).attr(["cx","cy"]);r=ce.cx,a=ce.cy,o.gridSnapping&&(x=Xt(x),r=Xt(r),S=Xt(S),a=Xt(a)),_.setAttributeNS(null,"rx",Math.abs(x-r));var ue=Math.abs(e.shiftKey?x-r:S-a);_.setAttributeNS(null,"ry",ue);break;case"fhellipse":case"fhrect":Qe.minx=Math.min(y,Qe.minx),Qe.maxx=Math.max(y,Qe.maxx),Qe.miny=Math.min(w,Qe.miny),Qe.maxy=Math.max(w,Qe.maxy);case"fhpath":if(ot.x=y,ot.y=w,rt.x&&rt.y)for(t=0;t<9;t++)dt=t/10,st=yt((t+1)/10),ut=st,st=yt(dt),(nt+=Math.sqrt((ut.x-st.x)*(ut.x-st.x)+(ut.y-st.y)*(ut.y-st.y)))>.8&&(Ke+=+st.x+","+st.y+" ",_.setAttributeNS(null,"points",Ke),nt-=.8);rt={x:at.x,y:at.y},at={x:it.x,y:it.y},it={x:ot.x,y:ot.y};break;case"path":case"pathedit":if(x*=v,S*=v,o.gridSnapping&&(x=Xt(x),S=Xt(S),Ze=Xt(Ze),$e=Xt($e)),e.shiftKey){var de=Ge,he=void 0,pe=void 0;de?(he=de.dragging?de.dragging[0]:Ze,pe=de.dragging?de.dragging[1]:$e):(he=Ze,pe=$e);var ge=n=be(he,pe,x,S);x=ge.x,S=ge.y}Oe&&"none"!==Oe.getAttribute("display")&&(y*=v,w*=v,Yt(Oe,{x:Math.min(Je*v,y),y:Math.min(et*v,w),width:Math.abs(y-Je*v),height:Math.abs(w-et*v)},100)),A.mouseMove(x,S);break;case"textedit":x*=v,S*=v,St.mouseMove(g,m);break;case"rotate":r=(d=Nt(f)).x+d.width/2,a=d.y+d.height/2;var me=ye(f),_e=fe(r,a,me);r=_e.x,a=_e.y,u=(Math.atan2(a-S,r-x)*(180/Math.PI)-90)%360,o.gridSnapping&&(u=Xt(u)),e.shiftKey&&(u=45*Math.round(u/45)),l.setRotationAngle(u<-180?360+u:u,!0),F("transition",b)}Re("mouseMove",{event:e,mouse_x:g,mouse_y:m,selected:f})}}).click(function(e){return e.preventDefault(),!1}).dblclick(function(e){var t=e.target.parentNode;if(t!==m){var n=Q(e),r=n.tagName;if("text"===r&&"textedit"!==Ie){var a=fe(e.pageX,e.pageY,We);St.select(n,a.x,a.y)}"g"!==r&&"a"!==r||!Ht(n)||(on(n),n=b[0],H(!0)),m&&Sn(),"g"!==t.tagName&&"a"!==t.tagName||t===g().getCurrentLayer()||n===R.selectorParentGroup||kn(n)}}).mouseup(function(e){if(2!==e.button){var t=Me;if(Me=null,Ae){var n=fe(e.pageX,e.pageY,We),r=n.x*v,a=n.y*v,i=r/v,s=a/v,c=qt(U()),u=!1,d=i,h=s;Ae=!1;var f=void 0,p=void 0;switch(Ie){case"resize":case"multiselect":null!=Oe&&(Oe.setAttribute("display","none"),Ve=[]),Ie="select";case"select":if(null!=b[0]){if(null==b[1]){var m=b[0];switch(m.tagName){case"g":case"use":case"image":case"foreignObject":break;default:Le.fill=m.getAttribute("fill"),Le.fill_opacity=m.getAttribute("fill-opacity"),Le.stroke=m.getAttribute("stroke"),Le.stroke_opacity=m.getAttribute("stroke-opacity"),Le.stroke_width=m.getAttribute("stroke-width"),Le.stroke_dasharray=m.getAttribute("stroke-dasharray"),Le.stroke_linejoin=m.getAttribute("stroke-linejoin"),Le.stroke_linecap=m.getAttribute("stroke-linecap")}"text"===m.tagName&&(he.font_size=m.getAttribute("font-size"),he.font_family=m.getAttribute("font-family")),R.requestSelector(m).showGrips(!0)}if(ze(),d!==Je||h!==et)for(var _=b.length,x=0;x<_&&null!=b[x];++x)b[x].firstChild||R.requestSelector(b[x]).resize();else p=e.target,"path"===b[0].nodeName&&null==b[1]?A.select(b[0]):e.shiftKey&&t!==p&&l.removeFromSelection([p]);if(D()){var S=b[0];S&&(S.removeAttribute("style"),Ct(S,function(e){e.removeAttribute("style")}))}}return;case"zoom":null!=Oe&&Oe.setAttribute("display","none");var k=e.shiftKey?.5:2;return void F("zoomed",{x:Math.min(Je,d),y:Math.min(et,h),width:Math.abs(d-Je),height:Math.abs(h-et),factor:k});case"fhpath":nt=0,rt={x:0,y:0},at={x:0,y:0},it={x:0,y:0},ot={x:0,y:0};var C=c.getAttribute("points"),E=C.indexOf(",");(u=E>=0?C.indexOf(",",E+1)>=0:C.indexOf(" ",C.indexOf(" ")+1)>=0)&&(c=A.smoothPolylineIntoPath(c));break;case"line":f=qn(c).attr(["x1","x2","y1","y2"]),u=f.x1!==f.x2||f.y1!==f.y2;break;case"foreignObject":case"square":case"rect":case"image":f=qn(c).attr(["width","height"]),u=f.width||f.height||"image"===Ie;break;case"circle":u="0"!==c.getAttribute("r");break;case"ellipse":f=qn(c).attr(["rx","ry"]),u=f.rx||f.ry;break;case"fhellipse":Qe.maxx-Qe.minx>0&&Qe.maxy-Qe.miny>0&&(c=w({element:"ellipse",curStyles:!0,attr:{cx:(Qe.minx+Qe.maxx)/2,cy:(Qe.miny+Qe.maxy)/2,rx:(Qe.maxx-Qe.minx)/2,ry:(Qe.maxy-Qe.miny)/2,id:U()}}),F("changed",[c]),u=!0);break;case"fhrect":Qe.maxx-Qe.minx>0&&Qe.maxy-Qe.miny>0&&(c=w({element:"rect",curStyles:!0,attr:{x:Qe.minx,y:Qe.miny,width:Qe.maxx-Qe.minx,height:Qe.maxy-Qe.miny,id:U()}}),F("changed",[c]),u=!0);break;case"text":u=!0,Xe([c]),St.start(c);break;case"path":c=null,Ae=!0;var P=A.mouseUp(e,c,r,a);c=P.element,u=P.keep;break;case"pathedit":u=!0,c=null,A.mouseUp(e);break;case"textedit":u=!1,c=null,St.mouseUp(e,r,a);break;case"rotate":u=!0,c=null,Ie="select";var G=l.undoMgr.finishUndoableChange();G.isEmpty()||T(G),ze(),F("changed",b)}var I=Re("mouseUp",{event:e,mouse_x:r,mouse_y:a},!0);if(qn.each(I,function(e,t){t&&(u=t.keep||u,c=t.element,Ae=t.started||Ae)}),u||null==c){if(null!=c){l.addedNew=!0;var N=.2,L=void 0;if(oe.beginElement&&parseFloat(c.getAttribute("opacity"))!==y.opacity){L=qn(oe).clone().attr({to:y.opacity,dur:N}).appendTo(c);try{L[0].beginElement()}catch(e){}}else N=0;setTimeout(function(){L&&L.remove(),c.setAttribute("opacity",y.opacity),c.setAttribute("style","pointer-events:inherit"),Wt(c),"path"===Ie?A.toEditMode(c):o.selectNew&&Xe([c],!0),T(new Wn(c)),F("changed",[c])},1e3*N)}}else{for(g().releaseId(U()),c.remove(),c=null,p=e.target;p&&p.parentNode&&p.parentNode.parentNode&&"g"===p.parentNode.parentNode.tagName;)p=p.parentNode;"path"===Ie&&bt||!p||!p.parentNode||"selectorParentGroup"===p.parentNode.id||"svgcanvas"===p.id||"svgroot"===p.id||(l.setMode("select"),Xe([p],!0))}Ee=null}}}),qn(a).bind("mousewheel DOMMouseScroll",function(e){if(e.shiftKey){e.preventDefault();var t=e.originalEvent;We=qn("#svgcontent g")[0].getScreenCTM().inverse();var n=qn("#workarea"),r=o.showRulers?16:0,a=fe(t.pageX,t.pageY,We),i=n.width(),s=n.height(),c=i-15-r,u=s-15-r,d=c*We.a,h=u*We.d,f=n.offset(),p=f.left+r,g=f.top+r,m=t.wheelDelta?t.wheelDelta:t.detail?-t.detail:0;if(m){var _=Math.max(.75,Math.min(4/3,m)),y=void 0,b=void 0;_>1?(y=Math.ceil(c/d*_*100)/100,b=Math.ceil(u/h*_*100)/100):(y=Math.floor(c/d*_*100)/100,b=Math.floor(u/h*_*100)/100);var x=Math.min(y,b);if((x=Math.min(10,Math.max(.01,x)))!==v){_=x/v;var w=fe(p,g,We),S={x:(a.x-(a.x-w.x)/_)*x-r+i/2,y:(a.y-(a.y-w.y)/_)*x-r+s/2};l.setZoom(x),qn("#zoom").val((100*x).toFixed(1)),F("updateCanvas",{center:!1,newCtr:S}),F("zoomDone")}}}});var St=l.textActions=function(){var e=void 0,t=void 0,n=void 0,r=void 0,a=void 0,i=[],o=void 0,s=void 0,c=void 0,d=void 0,f=void 0;function p(e){var s=""===t.value;if(qn(t).focus(),!arguments.length)if(s)e=0;else{if(t.selectionEnd!==t.selectionStart)return;e=t.selectionEnd}var l=i[e];s||t.setSelectionRange(e,e),(n=qt("text_cursor"))||(n=document.createElementNS(u.SVG,"line"),Yt(n,{id:"text_cursor",stroke:"#333","stroke-width":1}),n=qt("selectorParentGroup").appendChild(n)),a||(a=setInterval(function(){var e="none"===n.getAttribute("display");n.setAttribute("display",e?"inline":"none")},600));var c=w(l.x,o.y),d=w(l.x,o.y+o.height);Yt(n,{x1:c.x,y1:c.y,x2:d.x,y2:d.y,visibility:"visible",display:"inline"}),r&&r.setAttribute("d","")}function g(e,a,s){if(e!==a){s||t.setSelectionRange(e,a),(r=qt("text_selectblock"))||(r=document.createElementNS(u.SVG,"path"),Yt(r,{id:"text_selectblock",fill:"green",opacity:.5,style:"pointer-events:none"}),qt("selectorParentGroup").append(r));var l=i[e],c=i[a];n.setAttribute("visibility","hidden");var d=w(l.x,o.y),h=w(l.x+(c.x-l.x),o.y),f=w(l.x,o.y+o.height),g=w(l.x+(c.x-l.x),o.y+o.height),v="M"+d.x+","+d.y+" L"+h.x+","+h.y+" "+g.x+","+g.y+" "+f.x+","+f.y+"z";Yt(r,{d:v,display:"inline"})}else p(a)}function m(t,n){var r=h.createSVGPoint();if(r.x=t,r.y=n,1===i.length)return 0;var a=e.getCharNumAtPosition(r);a<0?(a=i.length-2,t<=i[0].x&&(a=0)):a>=i.length-2&&(a=i.length-2);var o=i[a];return t>o.x+o.width/2&&a++,a}function _(e,t){p(m(e,t))}function y(e,n,r){var a=t.selectionStart,i=m(e,n);g(Math.min(a,i),Math.max(a,i),!r)}function x(e,t){var n={x:e,y:t};if(n.x/=v,n.y/=v,s){var r=fe(n.x,n.y,s.inverse());n.x=r.x,n.y=r.y}return n}function w(e,t){var n={x:e,y:t};if(s){var r=fe(n.x,n.y,s);n.x=r.x,n.y=r.y}return n.x*=v,n.y*=v,n}function S(t){g(0,e.textContent.length),qn(this).unbind(t)}function k(t){if(f&&e){var n=fe(t.pageX,t.pageY,We),r=x(n.x*v,n.y*v),a=m(r.x,r.y),i=e.textContent,o=i.substr(0,a).replace(/[a-z0-9]+$/i,"").length,s=i.substr(a).match(/^[a-z0-9]+/i);g(o,(s?s[0].length:0)+a),qn(t.target).click(S),setTimeout(function(){qn(t.target).unbind("click",S)},300)}}return{select:function(t,n,r){e=t,St.toEditMode(n,r)},start:function(t){e=t,St.toEditMode()},mouseDown:function(e,n,r,a){var i=x(r,a);t.focus(),_(i.x,i.y),c=r,d=a},mouseMove:function(e,t){var n=x(e,t);y(n.x,n.y)},mouseUp:function(t,n,r){var a=x(n,r);y(a.x,a.y,!0),t.target!==e&&n<c+2&&n>c-2&&r<d+2&&r>d-2&&St.toSelectMode(!0)},setCursor:p,toEditMode:function(t,n){if(f=!1,Ie="textedit",R.requestSelector(e).showGrips(!1),R.requestSelector(e),St.init(),qn(e).css("cursor","text"),arguments.length){var r=x(t,n);_(r.x,r.y)}else p();setTimeout(function(){f=!0},300)},toSelectMode:function(i){Ie="select",clearInterval(a),a=null,r&&qn(r).attr("display","none"),n&&qn(n).attr("visibility","hidden"),qn(e).css("cursor","move"),i&&(H(),qn(e).css("cursor","move"),F("selected",[e]),Y([e],!0)),e&&!e.textContent.length&&l.deleteSelectedElements(),qn(t).blur(),e=!1},setInputElem:function(e){t=e},clear:function(){"textedit"===Ie&&St.toSelectMode()},init:function(n){if(e){var r=void 0,a=void 0;e.parentNode||(e=b[0],R.requestSelector(e).showGrips(!1));var c=e.textContent.length,u=e.getAttribute("transform");for(o=Nt(e),s=u?ye(e):null,(i=[]).length=c,t.focus(),qn(e).unbind("dblclick",k).dblclick(k),c||(a={x:o.x+o.width/2,width:0}),r=0;r<c;r++){var d=e.getStartPositionOfChar(r);if(a=e.getEndPositionOfChar(r),!E){var h=l.contentW*v;d.x-=h,a.x-=h,d.x/=v,a.x/=v}i[r]={x:d.x,y:o.y,width:a.x-d.x,height:o.height}}i.push({x:a.x,width:0}),g(t.selectionStart,t.selectionEnd,!0)}}}}(),Tt=this.removeUnusedDefElems=function(){var e=f.getElementsByTagNameNS(u.SVG,"defs");if(!e||!e.length)return 0;var t=[],n=0,r=["fill","stroke","filter","marker-start","marker-mid","marker-end"],a=r.length,i=f.getElementsByTagNameNS(u.SVG,"*"),o=i.length,s=void 0,l=void 0;for(s=0;s<o;s++){var c=i[s];for(l=0;l<a;l++){var d=At(c.getAttribute(r[l]));d&&t.push(d.substr(1))}var h=Et(c);h&&h.startsWith("#")&&t.push(h.substr(1))}var p=qn(e).find("linearGradient, radialGradient, filter, marker, svg, symbol");for(s=p.length;s--;){var g=p[s],v=g.id;t.includes(v)||(Se[v]=g,g.remove(),n++)}return n};function Lt(){H();var e=[],t=[],n={feGaussianBlur:K.exportNoBlur,foreignObject:K.exportNoforeignObject,"[stroke-dasharray]":K.exportNoDashArray},r=qn(f);return"font"in qn("<canvas>")[0].getContext("2d")||(n.text=K.exportNoText),qn.each(n,function(n,a){r.find(n).length&&(t.push(n),e.push(a))}),{issues:e,issueCodes:t}}this.svgCanvasToString=function(){for(;Tt()>0;);A.clear(!0),qn.each(f.childNodes,function(e,t){e&&8===t.nodeType&&t.data.includes("Created with")&&f.firstChild.before(t)}),m&&(Sn(),Xe([m]));var e=[];qn(f).find("g:data(gsvg)").each(function(){for(var t=this.attributes,n=t.length,r=0;r<n;r++)"id"!==t[r].nodeName&&"style"!==t[r].nodeName||n--;if(n<=0){var a=this.firstChild;e.push(a),qn(this).replaceWith(a)}});var t=this.svgToString(f,0);return e.length&&qn(e).each(function(){Ue(this)}),t},this.svgToString=function(e,t){var n=[],r=o.baseUnit,a=new RegExp("^-?[\\d\\.]+"+r+"$");if(e){Wt(e);var i=Array.from(e.attributes),s=void 0,l=e.childNodes;for(i.sort(function(e,t){return e.name>t.name?-1:1}),s=0;s<t;s++)n.push(" ");if(n.push("<"),n.push(e.nodeName),"svgcontent"===e.id){var c=Zt();"px"!==r&&(c.w=te(c.w,r)+r,c.h=te(c.h,r)+r),n.push(' width="'+c.w+'" height="'+c.h+'" xmlns="'+u.SVG+'"');var d={};qn(e).find("*").andSelf().each(function(){var e=this.namespaceURI;e&&!d[e]&&G[e]&&"xmlns"!==G[e]&&"xml"!==G[e]&&(d[e]=!0,n.push(" xmlns:"+G[e]+'="'+e+'"')),qn.each(this.attributes,function(e,t){var r=t.namespaceURI;r&&!d[r]&&"xmlns"!==G[r]&&"xml"!==G[r]&&(d[r]=!0,n.push(" xmlns:"+G[r]+'="'+r+'"'))})}),s=i.length;for(var h=["width","height","xmlns","x","y","viewBox","id","overflow"];s--;){var f=i[s],p=vt(f.value);f.nodeName.startsWith("xmlns:")||(""===p||h.includes(f.localName)||f.namespaceURI&&!G[f.namespaceURI]||(n.push(" "),n.push(f.nodeName),n.push('="'),n.push(p),n.push('"')))}}else{if("defs"===e.nodeName&&!e.firstChild)return;var g=["-moz-math-font-style","_moz-math-font-style"];for(s=i.length-1;s>=0;s--){var v=i[s],m=vt(v.value);if(!g.includes(v.localName)&&""!==m){if(m.startsWith("pointer-events"))continue;if("class"===v.localName&&m.startsWith("se_"))continue;if(n.push(" "),"d"===v.localName&&(m=A.convertPath(e,!0)),isNaN(m)?a.test(m)&&(m=ee(m)+r):m=ee(m),ce.apply&&"image"===e.nodeName&&"href"===v.localName&&ce.images&&"embed"===ce.images){var _=le[m];_&&(m=_)}v.namespaceURI&&v.namespaceURI!==u.SVG&&!G[v.namespaceURI]||(n.push(v.nodeName),n.push('="'),n.push(m),n.push('"'))}}}if(e.hasChildNodes()){n.push(">"),t++;var y=!1;for(s=0;s<l.length;s++){var b=l.item(s);switch(b.nodeType){case 1:n.push("\n"),n.push(this.svgToString(l.item(s),t));break;case 3:var x=b.nodeValue.replace(/^\s+|\s+$/g,"");""!==x&&(y=!0,n.push(String(vt(x))));break;case 4:n.push("\n"),n.push(new Array(t+1).join(" ")),n.push("<![CDATA["),n.push(b.nodeValue),n.push("]]>");break;case 8:n.push("\n"),n.push(new Array(t+1).join(" ")),n.push("\x3c!--"),n.push(b.data),n.push("--\x3e")}}if(t--,!y)for(n.push("\n"),s=0;s<t;s++)n.push(" ");n.push("</"),n.push(e.nodeName),n.push(">")}else n.push("/>")}return n.join("")},this.embedImage=function(e,t){qn(new Image).load(function(){var n=document.createElement("canvas");n.width=this.width,n.height=this.height,n.getContext("2d").drawImage(this,0,0);try{var r=";svgedit_url="+encodeURIComponent(e);r=n.toDataURL().replace(";base64",r+";base64"),le[e]=r}catch(t){le[e]=!1}ke=e,t&&t(le[e])}).attr("src",e)},this.setGoodImage=function(e){ke=e},this.open=function(){},this.save=function(e){H(),e&&qn.extend(ce,e),ce.apply=!0;var t=this.svgCanvasToString();F("saved",t)};var jt=void 0;this.rasterExport=function(e,t,r,a){var i,s=this,c="image/"+e.toLowerCase(),u=Lt(),d=u.issues,h=u.issueCodes,f=this.svgCanvasToString();return new Promise((i=n(regeneratorRuntime.mark(function n(i,u){var p,g,v,m,_,y,b;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(b=function(){var n={datauri:_,bloburl:y,svg:f,issues:d,issueCodes:h,type:e,mimeType:c,quality:t,exportWindowName:r};F("exported",n),a&&a(n),i(n)},jt){n.next=6;break}return n.next=4,rn(o.canvgPath+"canvg.js",{global:"canvg"});case 4:p=n.sent,jt=p.canvg;case 6:return g=e||"PNG",qn("#export_canvas").length||qn("<canvas>",{id:"export_canvas"}).hide().appendTo("body"),(v=qn("#export_canvas")[0]).width=l.contentW,v.height=l.contentH,n.next=13,jt(v,f);case 13:if(m=("ICO"===g?"BMP":g).toLowerCase(),_=t?v.toDataURL("image/"+m,t):v.toDataURL("image/"+m),y=void 0,!v.toBlob){n.next=19;break}return v.toBlob(function(e){y=wt(e),b()},c,t),n.abrupt("return");case 19:y=xt(_),b();case 21:case"end":return n.stop()}},n,s)})),function(e,t){return i.apply(this,arguments)}))},this.exportPDF=function(e,t,r){var a,i=this,s=this;return new Promise((a=n(regeneratorRuntime.mark(function n(a,l){var c,u,d,h,f,p,g,v,m,_,y;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(window.jsPDF){n.next=6;break}return n.next=3,an(["jspdf/underscore-min.js","jspdf/jspdf.min.js"]);case 3:return c=!("svgEditor"in window&&window.svgEditor&&!1===window.svgEditor.modules),n.next=6,an(o.jspdfPath+"jspdf.plugin.svgToPdf.js",{type:c?"module":"text/javascript"});case 6:u=Zt(),d=u.w>u.h?"landscape":"portrait",h=jsPDF({orientation:d,unit:"pt",format:[u.w,u.h]}),f=$t(),h.setProperties({title:f}),p=Lt(),g=p.issues,v=p.issueCodes,m=s.svgCanvasToString(),h.addSVG(m,0,0),(_={svg:m,issues:g,issueCodes:v,exportWindowName:e})[y=t||"dataurlstring"]=h.output(y),r&&r(_),a(_),F("exportedPDF",_);case 21:case"end":return n.stop()}},n,i)})),function(e,t){return a.apply(this,arguments)}))},this.getSvgString=function(){return ce.apply=!1,this.svgCanvasToString()},this.randomizeIds=function(e){arguments.length>0&&!1===e?yn(!1,g()):yn(!0,g())};var Rt=this.uniquifyElems=function(e){var t={},n=["filter","linearGradient","pattern","radialGradient","symbol","textPath","use"];for(var r in Ct(e,function(e){if(1===e.nodeType){e.id&&(e.id in t||(t[e.id]={elem:null,attrs:[],hrefs:[]}),t[e.id].elem=e),qn.each(ae,function(n,r){var a=e.getAttributeNode(r);if(a){var i=At(a.value),o=i?i.substr(1):null;o&&(o in t||(t[o]={elem:null,attrs:[],hrefs:[]}),t[o].attrs.push(a))}});var r=Et(e);if(r&&n.includes(e.nodeName)){var a=r.substr(1);a&&(a in t||(t[a]={elem:null,attrs:[],hrefs:[]}),t[a].hrefs.push(e))}}}),t)if(r){var a=t[r].elem;if(a){var i=B();a.id=i;for(var o=t[r].attrs,s=o.length;s--;){var l=o[s];l.ownerElement.setAttribute(l.name,"url(#"+i+")")}for(var c=t[r].hrefs,u=c.length;u--;){var d=c[u];Pt(d,"#"+i)}}}},Bt=this.setUseData=function(e){var t=qn(e);"use"!==e.tagName&&(t=t.find("use")),t.each(function(){var e=Et(this).substr(1),t=qt(e);t&&(qn(this).data("ref",t),"symbol"!==t.tagName&&"svg"!==t.tagName||qn(this).data("symbol",t).data("ref",t))})},Ft=this.convertGradients=function(e){var t=qn(e).find("linearGradient, radialGradient");!t.length&&L()&&(t=qn(e).find("*").filter(function(){return this.tagName.includes("Gradient")})),t.each(function(){if("userSpaceOnUse"===qn(this).attr("gradientUnits")){var e=qn(f).find('[fill="url(#'+this.id+')"],[stroke="url(#'+this.id+')"]');if(!e.length)return;var t=Nt(e[0]);if(!t)return;if("linearGradient"===this.tagName){var n=qn(this).attr(["x1","y1","x2","y2"]),r=this.gradientTransform.baseVal;if(r&&r.numberOfItems>0){var a=_e(r).matrix,i=fe(n.x1,n.y1,a),o=fe(n.x2,n.y2,a);n.x1=i.x,n.y1=i.y,n.x2=o.x,n.y2=o.y,this.removeAttribute("gradientTransform")}qn(this).attr({x1:(n.x1-t.x)/t.width,y1:(n.y1-t.y)/t.height,x2:(n.x2-t.x)/t.width,y2:(n.y2-t.y)/t.height}),this.removeAttribute("gradientUnits")}}})},Kt=this.convertToGroup=function(e){e||(e=b[0]);var t=qn(e),n=new Kn,r=void 0;if(t.data("gsvg")){var a=e.firstChild,i=qn(a).attr(["x","y"]);qn(e.firstChild.firstChild).unwrap(),qn(e).removeData("gsvg");var o=W(e),s=h.createSVGTransform();s.setTranslate(i.x,i.y),o.appendItem(s),jn(e),F("selected",[e])}else if(t.data("symbol")){e=t.data("symbol"),r=t.attr("transform");var l=t.attr(["x","y"]),d=e.getAttribute("viewBox");if(d){var p=d.split(" ");l.x-=+p[0],l.y-=+p[1]}r+=" translate("+(l.x||0)+","+(l.y||0)+")";var g=t.prev();n.addSubCommand(new Xn(t[0],t[0].nextSibling,t[0].parentNode)),t.remove();var v=qn(f).find("use:data(symbol)").length,m=c.createElementNS(u.SVG,"g"),_=e.childNodes,y=void 0;for(y=0;y<_.length;y++)m.append(_[y].cloneNode(!0));if(M()){var x=qn(Gt()).children("linearGradient,radialGradient,pattern").clone();qn(m).append(x)}r&&m.setAttribute("transform",r);var w=e.parentNode;if(Rt(m),M()&&qn(Gt()).append(qn(m).find("linearGradient,radialGradient,pattern")),m.id=B(),g.after(m),w){if(!v){var S=e.nextSibling;e.remove(),n.addSubCommand(new Xn(e,S,w))}n.addSubCommand(new Wn(m))}Bt(m),M()?Ft(Gt()):Ft(m),function(e,t){if(e&&1===e.nodeType){for(var n=e.childNodes.length;n--;)Ct(e.childNodes.item(n),t);t(e)}}(m,function(e){try{jn(e)}catch(e){console.log(e)}}),qn(m).find(re).each(function(){this.id||(this.id=B())}),Xe([m]);var k=on(m,!0);k&&n.addSubCommand(k),T(n)}else console.log("Unexpected element to ungroup:",e)};this.setSvgString=function(e,t){try{var n=kt(e);if(n.firstElementChild&&n.firstElementChild.namespaceURI!==u.SVG)return!1;this.prepareSvg(n);var r=new Kn("Change Source"),a=f.nextSibling,i=h.removeChild(f);r.addSubCommand(new Xn(i,a,h)),f=c.adoptNode?c.adoptNode(n.documentElement):c.importNode(n.documentElement,!0),h.append(f);var s=qn(f);l.current_drawing_=new _n(f,p);var d=g().getNonce();d?F("setnonce",d):F("unsetnonce"),s.find("image").each(function(){var e=this;Qt(e);var t=Et(this);if(t){if(t.startsWith("data:")){var n=t.match(/svgedit_url=(.*?);/);if(n){var r=decodeURIComponent(n[1]);qn(new Image).load(function(){e.setAttributeNS(u.XLINK,"xlink:href",r)}).attr("src",r)}}l.embedImage(t)}}),s.find("svg").each(function(){if(!qn(this).closest("defs").length){Rt(this);var e=this.parentNode;1===e.childNodes.length&&"g"===e.nodeName?(qn(e).data("gsvg",this),e.id=e.id||B()):Ue(this)}}),M()&&s.find("linearGradient, radialGradient, pattern").appendTo(Gt()),Bt(s),Ft(s[0]);var m={id:"svgcontent",overflow:o.show_outside_canvas?"visible":"hidden"},_=!1;if(s.attr("viewBox")){var y=s.attr("viewBox").split(" ");m.width=y[2],m.height=y[3]}else qn.each(["width","height"],function(e,t){var n=s.attr(t)||"100%";"%"===String(n).substr(-1)?_=!0:m[t]=ne(t,n)});if(wn(),s.children().find(re).each(function(){this.id||(this.id=B())}),_){var b=Ut();m.width=b.width+b.x,m.height=b.height+b.y}m.width<=0&&(m.width=100),m.height<=0&&(m.height=100),s.attr(m),this.contentW=m.width,this.contentH=m.height,r.addSubCommand(new Wn(f));var x=s.attr(["width","height"]);r.addSubCommand(new Qn(h,x)),v=1,z={},H(),Pe={},h.append(R.selectorParentGroup),t||T(r),F("changed",[f])}catch(e){return console.log(e),!1}return!0},this.importSvgString=function(e){var t=void 0,n=void 0,r=void 0;try{var a=mt(e.length+e).substr(0,32),i=!1;ue[a]&&qn(ue[a].symbol).parents("#svgroot").length&&(i=!0);var o=new Kn("Import Image"),s=void 0;if(i)s=ue[a].symbol,n=ue[a].xform;else{var l=kt(e);this.prepareSvg(l);var d=void 0;d=c.adoptNode?c.adoptNode(l.documentElement):c.importNode(l.documentElement,!0),Rt(d);var h=ne("width",d.getAttribute("width")),p=ne("height",d.getAttribute("height")),v=d.getAttribute("viewBox"),_=v?v.split(" "):[0,0,h,p];for(t=0;t<4;++t)_[t]=+_[t];var y=+f.getAttribute("height");n="translate(0) "+(n=p>h?"scale("+y/3/_[3]+")":"scale("+y/3/_[2]+")")+" translate(0)",s=c.createElementNS(u.SVG,"symbol");var b=Gt();for(M()&&qn(d).find("linearGradient, radialGradient, pattern").appendTo(b);d.firstChild;){var x=d.firstChild;s.append(x)}for(var w=d.attributes,S=0;S<w.length;S++){var k=w[S];s.setAttribute(k.nodeName,k.value)}s.id=B(),ue[a]={symbol:s,xform:n},Gt().append(s),o.addSubCommand(new Wn(s))}(r=c.createElementNS(u.SVG,"use")).id=B(),Pt(r,"#"+s.id),(m||g().getCurrentLayer()).append(r),o.addSubCommand(new Wn(r)),H(),r.setAttribute("transform",n),jn(r),qn(r).data("symbol",s).data("ref",s),Y([r]),T(o),F("changed",[f])}catch(e){return console.log(e),null}return r},["identifyLayers","createLayer","cloneLayer","deleteCurrentLayer","setCurrentLayer","renameCurrentLayer","setCurrentLayerPosition","setLayerVisibility","moveSelectedToLayer","mergeLayer","mergeAllLayers","leaveContext","setContext"].forEach(function(e){l[e]=Cn[e]}),xn({pathActions:A,getCurrentGroup:function(){return m},setCurrentGroup:function(e){m=e},getSelectedElements:C,getSVGContent:k,undoMgr:I,elData:ie,getCurrentDrawing:g,clearSelection:H,call:F,addCommandToHistory:T,changeSvgcontent:function(){F("changed",[f])}}),this.clear=function(){A.clear(),H(),l.clearSvgContentElement(),l.current_drawing_=new _n(f),l.createLayer("Layer 1"),l.undoMgr.resetUndoStack(),R.initGroup(),Oe=R.getRubberBandBox(),F("cleared")},this.linkControlPoints=A.linkControlPoints,this.getContentElem=function(){return f},this.getRootElem=function(){return h};var Zt=this.getResolution=function(){return{w:f.getAttribute("width")/v,h:f.getAttribute("height")/v,zoom:v}};this.getSnapToGrid=function(){return o.gridSnapping},this.getVersion=function(){return"svgcanvas.js ($Rev$)"},this.setUiStrings=function(e){Object.assign(K,e.notification),Ce(e)},this.setConfig=function(e){Object.assign(o,e)},this.getTitle=function(e){if(e=e||b[0]){for(var t=(e=qn(e).data("gsvg")||qn(e).data("symbol")||e).childNodes,n=0;n<t.length;n++)if("title"===t[n].nodeName)return t[n].textContent;return""}},this.setGroupTitle=function(e){var t=b[0];t=qn(t).data("gsvg")||t;var n=qn(t).children("title"),r=new Kn("Set Label"),a=void 0;if(e.length)n.length?(a=n[0],r.addSubCommand(new Qn(a,{"#text":a.textContent})),a.textContent=e):((a=c.createElementNS(u.SVG,"title")).textContent=e,qn(t).prepend(a),r.addSubCommand(new Wn(a)));else{var i=n.nextSibling;r.addSubCommand(new Xn(n[0],i,t)),n.remove()}T(r)};var $t=this.getDocumentTitle=function(){return l.getTitle(f)};this.setDocumentTitle=function(e){for(var t=f.childNodes,n=!1,r="",a=new Kn("Change Image Title"),i=0;i<t.length;i++)if("title"===t[i].nodeName){r=(n=t[i]).textContent;break}n||(n=c.createElementNS(u.SVG,"title"),f.insertBefore(n,f.firstChild)),e.length?n.textContent=e:n.remove(),a.addSubCommand(new Qn(n,{"#text":r})),T(a)},this.getEditorNS=function(e){return e&&f.setAttribute("xmlns:se",u.SE),u.SE},this.setResolution=function(e,t){var n=Zt(),r=n.w,a=n.h,i=void 0;if("fit"===e){var o=Ut();if(!o)return!1;i=new Kn("Fit Canvas to Content");var s=Dt();Y(s);var c=[],u=[];qn.each(s,function(e,t){c.push(-1*o.x),u.push(-1*o.y)});var d=l.moveSelectedElements(c,u,!0);i.addSubCommand(d),H(),e=Math.round(o.width),t=Math.round(o.height)}return e===r&&t===a||(i||(i=new Kn("Change Image Dimensions")),e=ne("width",e),t=ne("height",t),f.setAttribute("width",e),f.setAttribute("height",t),this.contentW=e,this.contentH=t,i.addSubCommand(new Qn(f,{width:r,height:a})),f.setAttribute("viewBox",[0,0,e/v,t/v].join(" ")),i.addSubCommand(new Qn(f,{viewBox:["0 0",r,a].join(" ")})),T(i),F("changed",[f])),!0},this.getOffset=function(){return qn(f).attr(["x","y"])},this.setBBoxZoom=function(e,n,r){var a=.85,i=void 0,o=function(e){if(!e)return!1;var t=Math.round(n/e.width*100*a)/100,i=Math.round(r/e.height*100*a)/100,o=Math.min(t,i);return l.setZoom(o),{zoom:o,bbox:e}};if("object"===(void 0===e?"undefined":t(e))){if(0===(i=e).width||0===i.height){var s=i.zoom?i.zoom:v*i.factor;return l.setZoom(s),{zoom:v,bbox:i}}return o(i)}switch(e){case"selection":if(!b[0])return;var c=qn.map(b,function(e){if(e)return e});i=Ut(c);break;case"canvas":var u=Zt();a=.95,i={width:u.w,height:u.h,x:0,y:0};break;case"content":i=Ut();break;case"layer":i=Ut(Dt(g().getCurrentLayer()));break;default:return}return o(i)},this.setZoom=function(e){var t=Zt();f.setAttribute("viewBox","0 0 "+t.w/e+" "+t.h/e),v=e,qn.each(b,function(e,t){t&&R.requestSelector(t).resize()}),A.zoomChange(),Re("zoomChanged",e)},this.getMode=function(){return Ie},this.setMode=function(e){A.clear(!0),St.clear(),Le=b[0]&&"text"===b[0].nodeName?he:y,Ie=e},this.getColor=function(e){return Le[e]},this.setColor=function(e,t,n){y[e]=t,Le[e+"_paint"]={type:"solidColor"};var r=[];function a(e){"g"!==e.nodeName&&r.push(e)}for(var i=b.length;i--;){var o=b[i];o&&("g"===o.tagName?Ct(o,a):"fill"===e?"polyline"!==o.tagName&&"line"!==o.tagName&&r.push(o):r.push(o))}r.length>0&&(n?tn(e,t,r):(nn(e,t,r),F("changed",r)))};var Jt=this.setGradient=function(e){if(Le[e+"_paint"]&&"solidColor"!==Le[e+"_paint"].type){var t=l[e+"Grad"],n=en(t),r=Gt();n?t=n:(t=r.appendChild(c.importNode(t,!0))).id=B(),l.setColor(e,"url(#"+t.id+")")}},en=function(e){for(var t=Gt(),n=qn(t).find("linearGradient, radialGradient"),r=n.length,a=["r","cx","cy","fx","fy"];r--;){var i=n[r];if("linearGradient"===e.tagName){if(e.getAttribute("x1")!==i.getAttribute("x1")||e.getAttribute("y1")!==i.getAttribute("y1")||e.getAttribute("x2")!==i.getAttribute("x2")||e.getAttribute("y2")!==i.getAttribute("y2"))continue}else if("continue"===function(){var t=qn(e).attr(a),n=qn(i).attr(a),r=!1;if(qn.each(a,function(e,a){t[a]!==n[a]&&(r=!0)}),r)return"continue"}())continue;var o=e.getElementsByTagNameNS(u.SVG,"stop"),s=i.getElementsByTagNameNS(u.SVG,"stop");if(o.length===s.length){for(var l=o.length;l--;){var c=o[l],d=s[l];if(c.getAttribute("offset")!==d.getAttribute("offset")||c.getAttribute("stop-opacity")!==d.getAttribute("stop-opacity")||c.getAttribute("stop-color")!==d.getAttribute("stop-color"))break}if(-1===l)return i}}return null};this.setPaint=function(e,t){var n=new qn.jGraduate.Paint(t);switch(this.setPaintOpacity(e,n.alpha/100,!0),Le[e+"_paint"]=n,n.type){case"solidColor":this.setColor(e,"none"!==n.solidColor?"#"+n.solidColor:"none");break;case"linearGradient":case"radialGradient":l[e+"Grad"]=n[n.type],Jt(e)}},this.setStrokePaint=function(e){this.setPaint("stroke",e)},this.setFillPaint=function(e){this.setPaint("fill",e)},this.getStrokeWidth=function(){return Le.stroke_width},this.setStrokeWidth=function(e){if(0===e&&["line","path"].includes(Ie))l.setStrokeWidth(1);else{Le.stroke_width=e;for(var t=[],n=b.length;n--;){var r=b[n];r&&("g"===r.tagName?Ct(r,a):t.push(r))}t.length>0&&(nn("stroke-width",e,t),F("changed",b))}function a(e){"g"!==e.nodeName&&t.push(e)}},this.setStrokeAttr=function(e,t){y[e.replace("-","_")]=t;for(var n=[],r=b.length;r--;){var a=b[r];a&&("g"===a.tagName?Ct(a,function(e){"g"!==e.nodeName&&n.push(e)}):n.push(a))}n.length>0&&(nn(e,t,n),F("changed",b))},this.getStyle=function(){return y},this.getOpacity=X,this.setOpacity=function(e){y.opacity=e,nn("opacity",e)},this.getFillOpacity=function(){return y.fill_opacity},this.getStrokeOpacity=function(){return y.stroke_opacity},this.setPaintOpacity=function(e,t,n){y[e+"_opacity"]=t,n?tn(e+"-opacity",t):nn(e+"-opacity",t)},this.getPaintOpacity=function(e){return"fill"===e?this.getFillOpacity():this.getStrokeOpacity()},this.getBlur=function(e){var t=0;if(e&&e.getAttribute("filter")){var n=qt(e.id+"_blur");n&&(t=n.firstChild.getAttribute("stdDeviation"))}return t},function(){var e=null,t=null,n=!1;function r(){var n=l.undoMgr.finishUndoableChange();e.addSubCommand(n),T(e),e=null,t=null}l.setBlurNoUndo=function(e){if(t)if(0===e)tn("filter",""),n=!0;else{var r=b[0];n&&tn("filter","url(#"+r.id+"_blur)"),L()&&(console.log("e",r),r.removeAttribute("filter"),r.setAttribute("filter","url(#"+r.id+"_blur)")),tn("stdDeviation",e,[t.firstChild]),l.setBlurOffsets(t,e)}else l.setBlur(e)},l.setBlurOffsets=function(e,t){t>3?Yt(e,{x:"-50%",y:"-50%",width:"200%",height:"200%"},100):L()||(e.removeAttribute("x"),e.removeAttribute("y"),e.removeAttribute("width"),e.removeAttribute("height"))},l.setBlur=function(n,a){if(e)r();else{var i=b[0],o=i.id;t=qt(o+"_blur"),n-=0;var s=new Kn;if(t)0===n&&(t=null);else{var c=w({element:"feGaussianBlur",attr:{in:"SourceGraphic",stdDeviation:n}});(t=w({element:"filter",attr:{id:o+"_blur"}})).append(c),Gt().append(t),s.addSubCommand(new Wn(t))}var u={filter:i.getAttribute("filter")};if(0===n)return i.removeAttribute("filter"),void s.addSubCommand(new Qn(i,u));nn("filter","url(#"+o+"_blur)"),s.addSubCommand(new Qn(i,u)),l.setBlurOffsets(t,n),e=s,l.undoMgr.beginUndoableChange("stdDeviation",[t?t.firstChild:null]),a&&(l.setBlurNoUndo(n),r())}}}(),this.getBold=function(){var e=b[0];return null!=e&&"text"===e.tagName&&null==b[1]&&"bold"===e.getAttribute("font-weight")},this.setBold=function(e){var t=b[0];null!=t&&"text"===t.tagName&&null==b[1]&&nn("font-weight",e?"bold":"normal"),b[0].textContent||St.setCursor()},this.getItalic=function(){var e=b[0];return null!=e&&"text"===e.tagName&&null==b[1]&&"italic"===e.getAttribute("font-style")},this.setItalic=function(e){var t=b[0];null!=t&&"text"===t.tagName&&null==b[1]&&nn("font-style",e?"italic":"normal"),b[0].textContent||St.setCursor()},this.getFontFamily=function(){return he.font_family},this.setFontFamily=function(e){he.font_family=e,nn("font-family",e),b[0]&&!b[0].textContent&&St.setCursor()},this.setFontColor=function(e){he.fill=e,nn("fill",e)},this.getFontColor=function(){return he.fill},this.getFontSize=function(){return he.font_size},this.setFontSize=function(e){he.font_size=e,nn("font-size",e),b[0].textContent||St.setCursor()},this.getText=function(){var e=b[0];return null==e?"":e.textContent},this.setTextContent=function(e){nn("#text",e),St.init(e),St.setCursor()},this.setImageURL=function(e){var t=b[0];if(t){var n=qn(t).attr(["width","height"]),r=!n.width||!n.height,a=Et(t);if(a!==e)r=!0;else if(!r)return;var i=new Kn("Change Image URL");Pt(t,e),i.addSubCommand(new Qn(t,{"#href":a})),r?qn(new Image).load(function(){var e=qn(t).attr(["width","height"]);qn(t).attr({width:this.width,height:this.height}),R.requestSelector(t).resize(),i.addSubCommand(new Qn(t,e)),T(i),F("changed",[t])}).attr("src",e):T(i)}},this.setLinkURL=function(e){var t=b[0];if(t){if("a"!==t.tagName){var n=qn(t).parents("a");if(!n.length)return;t=n[0]}var r=Et(t);if(r!==e){var a=new Kn("Change Link URL");Pt(t,e),a.addSubCommand(new Qn(t,{"#href":r})),T(a)}}},this.setRectRadius=function(e){var t=b[0];if(null!=t&&"rect"===t.tagName){var n=t.getAttribute("rx");n!==String(e)&&(t.setAttribute("rx",e),t.setAttribute("ry",e),T(new Qn(t,{rx:n,ry:n},"Radius")),F("changed",[t]))}},this.makeHyperlink=function(e){l.groupSelectedElements("a",e)},this.removeHyperlink=function(){l.ungroupSelectedElement()},this.setSegType=function(e){A.setSegType(e)},this.convertToPath=function(e,t){if(null!=e){return t?Vt(e,w,A):function(e,t,n,r,a,i,o,s){var l=new o.BatchCommand("Convert element to Path"),c=n({element:"path",attr:t=ct.extend({},t,Ot(e))}),u=e.getAttribute("transform");u&&c.setAttribute("transform",u);var d=e.id,h=e.parentNode;e.nextSibling?e.before(c):h.append(c);var f=Mt(e);if(f){if(c.setAttribute("d",f),u){var p=W(c);ve(p)&&r.resetOrientation(c)}var g=e.nextSibling;return l.addSubCommand(new o.RemoveElementCommand(e,g,h)),l.addSubCommand(new o.InsertElementCommand(c)),a(),e.remove(),c.setAttribute("id",d),c.removeAttribute("visibility"),i([c],!0),s(l),c}return c.remove(),null}(e,{fill:y.fill,"fill-opacity":y.fill_opacity,stroke:y.stroke,"stroke-width":y.stroke_width,"stroke-dasharray":y.stroke_dasharray,"stroke-linejoin":y.stroke_linejoin,"stroke-linecap":y.stroke_linecap,"stroke-opacity":y.stroke_opacity,opacity:y.opacity,visibility:"hidden"},w,A,H,Y,de,T)}else{var n=b;qn.each(n,function(e,t){t&&l.convertToPath(t)})}};var tn=function(e,t,n){"pathedit"===Ie&&A.moveNode(e,t);for(var r=(n=n||b).length,a=["g","polyline","path"],i=["transform","opacity","filter"],o=function(){var o=n[r];if(null==o)return"continue";if(("x"===e||"y"===e)&&a.includes(o.tagName)){var s=Ut([o]),c="x"===e?t-s.x:0,u="y"===e?t-s.y:0;return l.moveSelectedElements(c*v,u*v,!0),"continue"}"g"===o.tagName&&i.includes(e);var d="#text"===e?o.textContent:o.getAttribute(e);if(null==d&&(d=""),d!==String(t)){"#text"===e?(o.textContent=t,/rotate/.test(o.getAttribute("transform"))&&(o=He(o))):"#href"===e?Pt(o,t):o.setAttribute(e,t),"textedit"===Ie&&"#text"!==e&&o.textContent.length&&St.toSelectMode(o),M()&&"text"===o.nodeName&&/rotate/.test(o.getAttribute("transform"))&&(String(t).startsWith("url")||["font-size","font-family","x","y"].includes(e)&&o.textContent)&&(o=He(o)),b.includes(o)&&setTimeout(function(){o.parentNode&&R.requestSelector(o).resize()},0);var f=Ht(o);if(0!==f&&"transform"!==e)for(var p=W(o),g=p.numberOfItems;g--;){if(4===p.getItem(g).type){p.removeItem(g);var m=Nt(o),_=fe(m.x+m.width/2,m.y+m.height/2,_e(p).matrix),y=_.x,x=_.y,w=h.createSVGTransform();w.setRotate(f,y,x),p.insertItemBefore(w,g);break}}}};r--;)o()},nn=this.changeSelectedAttribute=function(e,t,n){n=n||b,l.undoMgr.beginUndoableChange(e,n),tn(e,t,n);var r=l.undoMgr.finishUndoableChange();r.isEmpty()||T(r)};this.deleteSelectedElements=function(){for(var e=new Kn("Delete Elements"),t=b.length,n=[],r=0;r<t;++r){var a=b[r];if(null==a)break;var i=a.parentNode,o=a;R.releaseSelector(o),Ye(o.id),"a"===i.tagName&&1===i.childNodes.length&&(o=i,i=i.parentNode);var s=o.nextSibling,l=i.removeChild(o);n.push(a),e.addSubCommand(new Xn(l,s,i))}b=[],e.isEmpty()||T(e),F("changed",n),H()},this.cutSelectedElements=function(){l.copySelectedElements(),l.deleteSelectedElements()},this.copySelectedElements=function(){localStorage.setItem("svgedit_clipboard",JSON.stringify(b.map(function(e){return x(e)}))),qn("#cmenu_canvas").enableContextMenuItems("#paste,#paste_in_place")},this.pasteElements=function(e,t,n){var r=JSON.parse(localStorage.getItem("svgedit_clipboard")),a=r.length;if(a){var i=[],o=new Kn("Paste elements"),s={};for(r.forEach(function e(t){t.attr&&t.attr.id&&(s[t.attr.id]=B(),t.attr.id=s[t.attr.id]),t.children&&t.children.forEach(e)}),Re("IDsUpdated",{elems:r,changes:s},!0).forEach(function(e){e&&"remove"in e&&e.remove.forEach(function(e){r=r.filter(function(t){return t.attr.id!==e})})});a--;){var c=r[a];if(c){var u=w(c);i.push(u),o.addSubCommand(new Wn(u)),se(u)}}if(Xe(i),"in_place"!==e){var d=void 0,h=void 0;e?"point"===e&&(d=t,h=n):(d=je.x,h=je.y);var f=Ut(i),p=d-(f.x+f.width/2),g=h-(f.y+f.height/2),v=[],m=[];qn.each(i,function(e,t){v.push(p),m.push(g)});var _=l.moveSelectedElements(v,m,!1);_&&o.addSubCommand(_)}T(o),F("changed",i)}},this.groupSelectedElements=function(e,t){e||(e="g");var n="",r=void 0;switch(e){case"a":n="Make hyperlink",r="",arguments.length>1&&(r=t);break;default:e="g",n="Group Elements"}var a=new Kn(n),i=w({element:e,attr:{id:B()}});"a"===e&&Pt(i,r),a.addSubCommand(new Wn(i));for(var o=b.length;o--;){var s=b[o];if(null!=s){"a"===s.parentNode.tagName&&1===s.parentNode.childNodes.length&&(s=s.parentNode);var l=s.nextSibling,c=s.parentNode;i.append(s),a.addSubCommand(new Yn(s,l,c))}}a.isEmpty()||T(a),Xe([i],!0)};var on=this.pushGroupProperties=function(e,t){for(var n=e.childNodes,r=n.length,a=e.getAttribute("transform"),i=W(e),o=_e(i).matrix,s=new Kn("Push group properties"),c=Ht(e),u=qn(e).attr(["filter","opacity"]),d=void 0,f=void 0,p=void 0,v=g(),m=0;m<r;m++){var _=n[m];if(1===_.nodeType){if(null!==u.opacity&&1!==u.opacity){var y=Math.round((_.getAttribute("opacity")||1)*u.opacity*100)/100;nn("opacity",y,[_])}if(u.filter){var b=this.getBlur(_),x=b;f||(f=this.getBlur(e)),b?b=Number(f)+Number(b):0===b&&(b=f),x?d=zt(_.getAttribute("filter")):d?(d=v.copyElem(d),Gt().append(d)):d=zt(u.filter);var w="feGaussianBlur"===d.firstChild.tagName?"blur":"filter";d.id=_.id+"_"+w,nn("filter","url(#"+d.id+")",[_]),b&&(nn("stdDeviation",b,[d.firstChild]),l.setBlurOffsets(d,b))}var S=W(_);if(_.tagName.includes("Gradient")&&(S=null),S&&"defs"!==_.tagName&&i.numberOfItems){if(c&&1===i.numberOfItems){var k=i.getItem(0).matrix,C=h.createSVGMatrix(),A=Ht(_);A&&(C=S.getItem(0).matrix);var E=Nt(_),P=_e(S).matrix,G=fe(E.x+E.width/2,E.y+E.height/2,P),I=c+A,T=h.createSVGTransform();T.setRotate(I,G.x,G.y);var N=ge(k,C,T.matrix.inverse());if(A&&S.removeItem(0),I&&(S.numberOfItems?S.insertItemBefore(T,0):S.appendItem(T)),N.e||N.f){var L=h.createSVGTransform();L.setTranslate(N.e,N.f),S.numberOfItems?S.insertItemBefore(L,0):S.appendItem(L)}}else{var M=_.getAttribute("transform");(p={}).transform=M||"";var O=h.createSVGTransform(),V=_e(S).matrix,j=V.inverse(),R=ge(j,o,V);O.setMatrix(R),S.appendItem(O)}var B=jn(_);B&&s.addSubCommand(B)}}}if(a&&((p={}).transform=a,e.setAttribute("transform",""),e.removeAttribute("transform"),s.addSubCommand(new Qn(e,p))),t&&!s.isEmpty())return s};this.ungroupSelectedElement=function(){var e=b[0];if(e)if(qn(e).data("gsvg")||qn(e).data("symbol"))Kt(e);else{if("use"===e.tagName){var t=qt(Et(e).substr(1));return qn(e).data("symbol",t).data("ref",t),void Kt(e)}var n=qn(e).parents("a");if(n.length&&(e=n[0]),"g"===e.tagName||"a"===e.tagName){var r=new Kn("Ungroup Elements"),a=on(e,!0);a&&r.addSubCommand(a);for(var i=e.parentNode,o=e.nextSibling,s=new Array(e.childNodes.length),l=0;e.firstChild;){var c=e.firstChild,u=c.nextSibling,d=c.parentNode;if("title"!==c.tagName)s[l++]=c=i.insertBefore(c,o),r.addSubCommand(new Yn(c,u,d));else{var h=c.nextSibling;r.addSubCommand(new Xn(c,h,d)),c.remove()}}H();var f=e.nextSibling;e=i.removeChild(e),r.addSubCommand(new Xn(e,f,i)),r.isEmpty()||T(r),Y(s)}}},this.moveToTopSelectedElement=function(){var e=b[0];if(null!=e){var t=e,n=t.parentNode,r=t.nextSibling;r!==(t=t.parentNode.appendChild(t)).nextSibling&&(T(new Yn(t,r,n,"top")),F("changed",[t]))}},this.moveToBottomSelectedElement=function(){var e=b[0];if(null!=e){var t=e,n=t.parentNode,r=t.nextSibling,a=t.parentNode.firstChild;"title"===a.tagName&&(a=a.nextSibling),"defs"===a.tagName&&(a=a.nextSibling),r!==(t=t.parentNode.insertBefore(t,a)).nextSibling&&(T(new Yn(t,r,n,"bottom")),F("changed",[t]))}},this.moveUpDownSelected=function(e){var t=b[0];if(t){Ve=[];var n=void 0,r=void 0,a=qn(Be(Ut([t]))).toArray();if("Down"===e&&a.reverse(),qn.each(a,function(){if(r)return n=this,!1;this===t&&(r=!0)}),n){var i=t,o=i.parentNode,s=i.nextSibling;qn(n)["Down"===e?"before":"after"](i),s!==i.nextSibling&&(T(new Yn(i,s,o,"Move "+e)),F("changed",[i]))}}},this.moveSelectedElements=function(e,t,n){e.constructor!==Array&&(e/=v,t/=v),n=n||!0;for(var r=new Kn("position"),a=b.length;a--;){var i=b[a];if(null!=i){var o=h.createSVGTransform(),s=W(i);e.constructor===Array?o.setTranslate(e[a],t[a]):o.setTranslate(e,t),s.numberOfItems?s.insertItemBefore(o,0):s.appendItem(o);var l=jn(i);l&&r.addSubCommand(l),R.requestSelector(i).resize()}}if(!r.isEmpty())return n&&T(r),F("changed",b),r},this.cloneSelectedElements=function(e,t){var n=void 0,r=void 0,a=new Kn("Clone Elements"),i=b.length;for(b.sort(function(e,t){return qn(t).index()-qn(e).index()}),n=0;n<i&&null!=(r=b[n]);++n);var o=b.slice(0,n);this.clearSelection(!0);var s=g();for(n=o.length;n--;)r=o[n]=s.copyElem(o[n]),(m||s.getCurrentLayer()).append(r),a.addSubCommand(new Wn(r));a.isEmpty()||(Y(o.reverse()),this.moveSelectedElements(e,t,!1),T(a))},this.alignSelectedElements=function(e,t){var n=[],r=b.length;if(r){for(var a=Number.MAX_VALUE,i=Number.MIN_VALUE,o=Number.MAX_VALUE,s=Number.MIN_VALUE,c=Number.MIN_VALUE,u=Number.MIN_VALUE,d=0;d<r&&null!=b[d];++d){var h=b[d];switch(n[d]=Ut([h]),t){case"smallest":(("l"===e||"c"===e||"r"===e)&&(c===Number.MIN_VALUE||c>n[d].width)||("t"===e||"m"===e||"b"===e)&&(u===Number.MIN_VALUE||u>n[d].height))&&(a=n[d].x,o=n[d].y,i=n[d].x+n[d].width,s=n[d].y+n[d].height,c=n[d].width,u=n[d].height);break;case"largest":(("l"===e||"c"===e||"r"===e)&&(c===Number.MIN_VALUE||c<n[d].width)||("t"===e||"m"===e||"b"===e)&&(u===Number.MIN_VALUE||u<n[d].height))&&(a=n[d].x,o=n[d].y,i=n[d].x+n[d].width,s=n[d].y+n[d].height,c=n[d].width,u=n[d].height);break;default:n[d].x<a&&(a=n[d].x),n[d].y<o&&(o=n[d].y),n[d].x+n[d].width>i&&(i=n[d].x+n[d].width),n[d].y+n[d].height>s&&(s=n[d].y+n[d].height)}}"page"===t&&(a=0,o=0,i=l.contentW,s=l.contentH);for(var f=new Array(r),p=new Array(r),g=0;g<r&&null!=b[g];++g){var v=n[g];switch(f[g]=0,p[g]=0,e){case"l":f[g]=a-v.x;break;case"c":f[g]=(a+i)/2-(v.x+v.width/2);break;case"r":f[g]=i-(v.x+v.width);break;case"t":p[g]=o-v.y;break;case"m":p[g]=(o+s)/2-(v.y+v.height/2);break;case"b":p[g]=s-(v.y+v.height)}}this.moveSelectedElements(f,p)}},this.contentW=Zt().w,this.contentH=Zt().h,this.updateCanvas=function(e,t){h.setAttribute("width",e),h.setAttribute("height",t);var n=qn("#canvasBackground")[0],r=f.getAttribute("x"),a=f.getAttribute("y"),i=e/2-this.contentW*v/2,o=t/2-this.contentH*v/2;Yt(f,{width:this.contentW*v,height:this.contentH*v,x:i,y:o,viewBox:"0 0 "+this.contentW+" "+this.contentH}),Yt(n,{width:f.getAttribute("width"),height:f.getAttribute("height"),x:i,y:o});var s=qt("background_image");return s&&Yt(s,{width:"100%",height:"100%"}),R.selectorParentGroup.setAttribute("transform","translate("+i+","+o+")"),Re("canvasUpdated",{new_x:i,new_y:o,old_x:r,old_y:a,d_x:i-r,d_y:o-a}),{x:i,y:o,old_x:r,old_y:a,d_x:i-r,d_y:o-a}},this.setBackground=function(e,t){var n=qt("canvasBackground"),r=qn(n).find("rect")[0],a=qt("background_image");r.setAttribute("fill",e),t?(a||(a=c.createElementNS(u.SVG,"image"),Yt(a,{id:"background_image",width:"100%",height:"100%",preserveAspectRatio:"xMinYMin",style:"pointer-events:none"})),Pt(a,t),n.append(a)):a&&a.remove()},this.cycleElement=function(e){var t=void 0,n=b[0],r=!1,a=Dt(m||g().getCurrentLayer());if(a.length){if(null==n)r=a[t=e?a.length-1:0];else for(var i=a.length;i--;)if(a[i]===n){(t=e?i-1:i+1)>=a.length?t=0:t<0&&(t=a.length-1),r=a[t];break}Xe([r],!0),F("selected",b)}},this.clear(),this.getPrivateMethods=function(){return{addCommandToHistory:T,setGradient:Jt,addSvgElementFromJson:w,assignAttributes:Yt,BatchCommand:Kn,call:F,ChangeElementCommand:Qn,copyElem:function(e){return g().copyElem(e)},decode64:_t,encode64:mt,ffClone:He,findDefs:Gt,findDuplicateGradient:en,getElem:qt,getId:U,getIntersectionList:Be,getMouseTarget:Q,getNextId:B,getPathBBox:It,getTypeMap:J,getUrlFromAttr:At,hasMatrixTransform:ve,identifyLayers:wn,InsertElementCommand:Wn,isChrome:V,isIdentity:pe,isIE:O,logMatrix:qe,matrixMultiply:ge,MoveElementCommand:Yn,NS:u,preventClickDefault:Qt,recalculateAllSelectedDimensions:ze,recalculateDimensions:jn,remapElement:Ln,RemoveElementCommand:Xn,removeUnusedDefElems:Tt,round:j,runExtensions:Re,sanitizeSvg:Gn,SVGEditTransformList:q,text2xml:kt,toString:toString,transformBox:me,transformListToTransform:_e,transformPoint:fe,walkTree:Ct}}};var er={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"};window.console||(window.console={log:function(e){},dir:function(e){}}),Math.precision=function(e,t){return void 0===t&&(t=0),Math.round(e*Math.pow(10,t))/Math.pow(10,t)};var tr=jQuery,nr=void 0;function rr(e,t,n){var r=tr("#svg_editor").parent();Object.entries(t).forEach(function(t){var a=l(t,2),i=a[0],o=a[1];if(o||console.log(i),n&&(i="#"+i),r.find(i).length){var s=r.find(i)[0];switch(e){case"content":for(var c,u=0;c=s.childNodes[u];u++)if(3===c.nodeType&&c.textContent.trim()){c.textContent=o;break}break;case"title":s.title=o}}else console.log("Missing: "+i)})}var ar=void 0,ir=function(e){var t=ar.addLangData(nr);if(tr.each(t,function(t,n){n.data&&(e=tr.merge(e,n.data))}),e.tools){var n=e,r=n.tools,a=n.properties,i=n.config,o=n.layers,s=n.common,l=n.ui;rr("content",{curve_segments:a.curve_segments,fitToContent:r.fitToContent,fit_to_all:r.fit_to_all,fit_to_canvas:r.fit_to_canvas,fit_to_layer_content:r.fit_to_layer_content,fit_to_sel:r.fit_to_sel,icon_large:i.icon_large,icon_medium:i.icon_medium,icon_small:i.icon_small,icon_xlarge:i.icon_xlarge,image_opt_embed:i.image_opt_embed,image_opt_ref:i.image_opt_ref,includedImages:i.included_images,largest_object:r.largest_object,layersLabel:o.layers,page:r.page,relativeToLabel:r.relativeTo,selLayerLabel:o.move_elems_to,selectedPredefined:i.select_predefined,selected_objects:r.selected_objects,smallest_object:r.smallest_object,straight_segments:a.straight_segments,svginfo_bg_url:i.editor_img_url+":",svginfo_bg_note:i.editor_bg_note,svginfo_change_background:i.background,svginfo_dim:i.doc_dims,svginfo_editor_prefs:i.editor_prefs,svginfo_height:s.height,svginfo_icons:i.icon_size,svginfo_image_props:i.image_props,svginfo_lang:i.language,svginfo_title:i.doc_title,svginfo_width:s.width,tool_docprops_cancel:s.cancel,tool_docprops_save:s.ok,tool_source_cancel:s.cancel,tool_source_save:s.ok,tool_prefs_cancel:s.cancel,tool_prefs_save:s.ok,sidepanel_handle:o.layers.split("").join(" "),tool_clear:r.new_doc,tool_docprops:r.docprops,tool_export:r.export_img,tool_import:r.import_doc,tool_open:r.open_doc,tool_save:r.save_doc,svginfo_units_rulers:i.units_and_rulers,svginfo_rulers_onoff:i.show_rulers,svginfo_unit:i.base_unit,svginfo_grid_settings:i.grid,svginfo_snap_onoff:i.snapping_onoff,svginfo_snap_step:i.snapping_stepsize,svginfo_grid_color:i.grid_color},!0);var c={};for(var u in e.shape_cats)c['#shape_cats [data-cat="'+u+'"]']=e.shape_cats[u];setTimeout(function(){rr("content",c)},2e3);var d={};tr.each(["cut","copy","paste","paste_in_place","delete","group","ungroup","move_front","move_up","move_down","move_back"],function(){d['#cmenu_canvas a[href="#'+this+'"]']=r[this]}),tr.each(["dupe","merge_down","merge_all"],function(){d['#cmenu_layers a[href="#'+this+'"]']=o[this]}),d['#cmenu_layers a[href="#delete"]']=o.del,rr("content",d),rr("title",{align_relative_to:r.align_relative_to,circle_cx:a.circle_cx,circle_cy:a.circle_cy,circle_r:a.circle_r,cornerRadiusLabel:a.corner_radius,ellipse_cx:a.ellipse_cx,ellipse_cy:a.ellipse_cy,ellipse_rx:a.ellipse_rx,ellipse_ry:a.ellipse_ry,fill_color:a.fill_color,font_family:a.font_family,idLabel:a.id,image_height:a.image_height,image_url:a.image_url,image_width:a.image_width,layer_delete:o.del,layer_down:o.move_down,layer_new:o.new,layer_rename:o.rename,layer_moreopts:s.more_opts,layer_up:o.move_up,line_x1:a.line_x1,line_x2:a.line_x2,line_y1:a.line_y1,line_y2:a.line_y2,linecap_butt:a.linecap_butt,linecap_round:a.linecap_round,linecap_square:a.linecap_square,linejoin_bevel:a.linejoin_bevel,linejoin_miter:a.linejoin_miter,linejoin_round:a.linejoin_round,main_icon:r.main_menu,mode_connect:r.mode_connect,tools_shapelib_show:r.mode_shapelib,palette:l.palette_info,zoom_panel:l.zoom_level,path_node_x:a.node_x,path_node_y:a.node_y,rect_height_tool:a.rect_height,rect_width_tool:a.rect_width,seg_type:a.seg_type,selLayerNames:o.move_selected,selected_x:a.pos_x,selected_y:a.pos_y,stroke_color:a.stroke_color,stroke_style:a.stroke_style,stroke_width:a.stroke_width,svginfo_title:i.doc_title,text:a.text_contents,toggle_stroke_tools:l.toggle_stroke_tools,tool_add_subpath:r.add_subpath,tool_alignbottom:r.align_bottom,tool_aligncenter:r.align_center,tool_alignleft:r.align_left,tool_alignmiddle:r.align_middle,tool_alignright:r.align_right,tool_aligntop:r.align_top,tool_angle:a.angle,tool_blur:a.blur,tool_bold:a.bold,tool_circle:r.mode_circle,tool_clone:r.clone,tool_clone_multi:r.clone,tool_delete:r.del,tool_delete_multi:r.del,tool_ellipse:r.mode_ellipse,tool_eyedropper:r.mode_eyedropper,tool_fhellipse:r.mode_fhellipse,tool_fhpath:r.mode_fhpath,tool_fhrect:r.mode_fhrect,tool_font_size:a.font_size,tool_group_elements:r.group_elements,tool_make_link:r.make_link,tool_link_url:r.set_link_url,tool_image:r.mode_image,tool_italic:a.italic,tool_line:r.mode_line,tool_move_bottom:r.move_bottom,tool_move_top:r.move_top,tool_node_clone:r.node_clone,tool_node_delete:r.node_delete,tool_node_link:r.node_link,tool_opacity:a.opacity,tool_openclose_path:r.openclose_path,tool_path:r.mode_path,tool_position:r.align_to_page,tool_rect:r.mode_rect,tool_redo:r.redo,tool_reorient:r.reorient_path,tool_select:r.mode_select,tool_source:r.source_save,tool_square:r.mode_square,tool_text:r.mode_text,tool_topath:r.to_path,tool_undo:r.undo,tool_ungroup:r.ungroup,tool_wireframe:r.wireframe_mode,view_grid:r.toggle_grid,tool_zoom:r.mode_zoom,url_notice:r.no_embed},!0),ar.setLang(nr,e)}},or=function(){var e=n(regeneratorRuntime.mark(function e(t,n,r){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t?nr=t:((nr=tr.pref("lang"))||(navigator.userLanguage?nr=navigator.userLanguage:navigator.language&&(nr=navigator.language)),console.log("Lang: "+nr),n.includes(nr)||"test"===nr||(nr="en")),a=r.langPath+"lang."+nr+".js",e.t0=ir,e.next=5,nn(a,{global:"svgEditorLang_"+nr.replace(/-/g,"_")});case 5:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 7:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}();var sr=[function(e){function t(t){if("string"==typeof t.data){var n=t.handler,r=t.data.toLowerCase().split(" ");t.handler=function(t){if(this===t.target||!/textarea|select/i.test(t.target.nodeName)&&"text"!==t.target.type){var a="keypress"!==t.type&&e.hotkeys.specialKeys[t.which],i=String.fromCharCode(t.which).toLowerCase(),o="",s={};t.altKey&&"alt"!==a&&(o+="alt+"),t.ctrlKey&&"ctrl"!==a&&(o+="ctrl+"),t.metaKey&&!t.ctrlKey&&"meta"!==a&&(o+="meta+"),t.shiftKey&&"shift"!==a&&(o+="shift+"),a?s[o+a]=!0:(s[o+i]=!0,s[o+e.hotkeys.shiftNums[i]]=!0,"shift+"===o&&(s[e.hotkeys.shiftNums[i]]=!0));for(var l=0,c=r.length;l<c;l++)if(s[r[l]])return n.apply(this,arguments)}}}}return e.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta",219:"[",221:"]"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},e.each(["keydown","keyup","keypress"],function(){e.event.special[this]={add:t}}),e},function(e){return function(e,n){var r,a,i,o,s,l,c,u,d=Array.prototype.slice,h=decodeURIComponent,f=e.param,p=e.bbq=e.bbq||{},g=e.event.special,v="hashchange",m="querystring",_="fragment",y="elemUrlAttr",b="location",x="href",w="src",S=/^.*\?|#.*$/g,k=/^.*\#/,C={};function A(e){return"string"==typeof e}function E(e){var t=d.call(arguments,1);return function(){return e.apply(this,t.concat(d.call(arguments)))}}function P(t,a,o,s,l){var c,d,p,g,v;return s!==r?(v=(p=o.match(t?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/))[3]||"",2===l&&A(s)?d=s.replace(t?k:S,""):(g=i(p[2]),s=A(s)?i[t?_:m](s):s,d=2===l?s:1===l?e.extend({},s,g):e.extend({},g,s),d=f(d),t&&(d=d.replace(u,h))),c=p[1]+(t?"#":d||!p[1]?"?":"")+d+v):c=a(o!==r?o:n[b][x]),c}function G(e,t,n){return t===r||"boolean"==typeof t?(n=t,t=f[e?_:m]()):t=A(t)?t.replace(e?k:S,""):t,i(t,n)}function I(n,a,i,o){return A(i)||"object"===(void 0===i?"undefined":t(i))||(o=i,i=a,a=r),this.each(function(){var t=e(this),r=a||c()[(this.nodeName||"").toLowerCase()]||"",s=r&&t.attr(r)||"";t.attr(r,f[n](s,i,o))})}f[m]=E(P,0,function(e){return e.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}),f[_]=a=E(P,1,function(e){return e.replace(/^[^#]*#?(.*)$/,"$1")}),a.noEscape=function(t){t=t||"";var n=e.map(t.split(""),encodeURIComponent);u=new RegExp(n.join("|"),"g")},a.noEscape(",/"),e.deparam=i=function(t,n){var a={},i={true:!0,false:!1,null:null};return e.each(t.replace(/\+/g," ").split("&"),function(t,o){var s,l=o.split("="),c=h(l[0]),u=a,d=0,f=c.split("]["),p=f.length-1;if(/\[/.test(f[0])&&/\]$/.test(f[p])?(f[p]=f[p].replace(/\]$/,""),p=(f=f.shift().split("[").concat(f)).length-1):p=0,2===l.length)if(s=h(l[1]),n&&(s=s&&!isNaN(s)?+s:"undefined"===s?r:i[s]!==r?i[s]:s),p)for(;d<=p;d++)u=u[c=""===f[d]?u.length:f[d]]=d<p?u[c]||(f[d+1]&&isNaN(f[d+1])?{}:[]):s;else e.isArray(a[c])?a[c].push(s):a[c]!==r?a[c]=[a[c],s]:a[c]=s;else c&&(a[c]=n?r:"")}),a},i[m]=E(G,0),i[_]=o=E(G,1),e[y]||(e[y]=function(t){return e.extend(C,t)})({a:x,base:x,iframe:w,img:w,input:w,form:"action",link:x,script:w}),c=e[y],e.fn[m]=E(I,m),e.fn[_]=E(I,_),p.pushState=s=function(e,t){A(e)&&/^#/.test(e)&&t===r&&(t=2);var i=e!==r,o=a(n[b][x],i?e:{},i?t:2);n[b][x]=o+(/#/.test(o)?"":"#")},p.getState=l=function(e,t){return e===r||"boolean"==typeof e?o(e):o(t)[e]},p.removeState=function(t){var n={};t!==r&&(n=l(),e.each(e.isArray(t)?t:arguments,function(e,t){delete n[t]})),s(n,2)},g[v]=e.extend(g[v],{add:function(t){var n;function o(e){var t=e[_]=a();e.getState=function(e,n){return e===r||"boolean"==typeof e?i(t,e):i(t,n)[e]},n.apply(this,arguments)}if(e.isFunction(t))return n=t,o;n=t.handler,t.handler=o}})}(e,window),function(e,t,n){var r,a,i,o,s,l,c=e.event.special,u="location",d="hashchange",h="href",f=e.browser,p=document.documentMode,g=f.msie&&(void 0===p||p<8),v="on"+d in t&&!g;function m(e){return(e=e||t[u][h]).replace(/^[^#]*#?(.*)$/,"$1")}e[d+"Delay"]=100,c[d]=e.extend(c[d],{setup:function(){if(v)return!1;e(r.start)},teardown:function(){if(v)return!1;e(r.stop)}}),(l={}).start=function(){if(!a){var n=m();o||(o=s=function(e){return e},g&&(i=e('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow,s=function(){return m(i.document[u][h])},(o=function(e,t){if(e!==t){var n=i.document;n.open().close(),n[u].hash="#"+e}})(m()))),function r(){var i=m(),l=s(n);i!==n?(o(n=i,l),e(t).trigger(d)):l!==n&&(t[u][h]=t[u][h].replace(/#.*/,"")+"#"+l),a=setTimeout(r,e[d+"Delay"])}()}},l.stop=function(){i||(a&&clearTimeout(a),a=0)},r=l}(e,window),e},function(e){var t={},n=void 0;return e.svgIcons=function(r,a){var i="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xlink",s=a.w||24,l=a.h||24,c=void 0,u=void 0,d=void 0,h=!1,f=!1,p=0,g=!!window.opera,v="data:image/svg+xml;charset=utf-8;base64,",m=void 0;if(a.svgz){m=e('<object data="'+r+'" type=image/svg+xml>').appendTo("body").hide();try{u=m[0].contentDocument,m.load(y),y(0,!0)}catch(e){k()}}else{var _=new DOMParser;e.ajax({url:r,dataType:"string",success:function(t){t?(u=_.parseFromString(t,"text/xml"),e(function(){y("ajax")})):e(k)},error:function(t){window.opera?e(function(){k()}):t.responseText?((u=_.parseFromString(t.responseText,"text/xml")).childNodes.length||e(k),e(function(){y("ajax")})):e(k)}})}function y(t,n){if("ajax"!==t){if(f)return;var r=(u=m[0].contentDocument)&&u.getElementById("svg_eof");if(!(r||n&&r))return void(++p<50?setTimeout(y,20):(k(),f=!0));f=!0}if(c=e(u.firstChild).children(),a.no_img)setTimeout(function(){h||S()},500);else{var i=v+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNzUiIGhlaWdodD0iMjc1Ij48L3N2Zz4%3D";d=e(new Image).attr({src:i,width:0,height:0}).appendTo("body").load(function(){S(!0)}).error(function(){S()})}}var b=function(e,t,n,r){if(g&&t.css("visibility","hidden"),a.replace){r&&t.attr("id",n);var i=e.attr("class");i&&t.attr("class","svg_icon "+i),e.replaceWith(t)}else e.append(t);g&&setTimeout(function(){t.removeAttr("style")},1)},x=void 0,w=function(e,n){void 0!==a.id_match&&!1===a.id_match||b(x,e,n,!0),t[n]=e};function S(r,u){if(!h){a.no_img&&(r=!1);var f=void 0;if(r&&(f=e(document.createElement("div"))).hide().appendTo("body"),u){var p=a.fallback_path||"";e.each(u,function(t,n){x=e("#"+t);var r=e(new Image).attr({class:"svg_icon",src:p+n,width:s,height:l,alt:"icon"});w(r,t)})}else for(var _=c.length,y=0;y<_;y++){var S=c[y],k=S.id;if("svg_eof"===k)break;x=e("#"+k);var A=document.createElementNS(i,"svg");A.setAttributeNS(null,"viewBox",[0,0,s,l].join(" "));var E=S.getElementsByTagNameNS(i,"svg")[0],P=E.getAttribute("width"),G=E.getAttribute("height");E.removeAttribute("width"),E.removeAttribute("height"),E.getAttribute("viewBox")||E.setAttribute("viewBox",[0,0,P,G].join(" ")),A.setAttribute("xmlns",i),A.setAttribute("width",s),A.setAttribute("height",l),A.setAttribute("xmlns:xlink",o),A.setAttribute("class","svg_icon"),g||(E=E.cloneNode(!0)),A.append(E);var I=void 0;if(r){f.empty().append(A);var T=v+C(unescape(encodeURIComponent((new XMLSerializer).serializeToString(A))));I=e(new Image).attr({class:"svg_icon",src:T})}else I=n(e(A),y);w(I,k)}a.placement&&e.each(a.placement,function(a,i){t[i]&&e(a).each(function(a){var o=t[i].clone();a>0&&!r&&(o=n(o,a,!0)),b(e(this),o,i)})}),u||(r&&f.remove(),m&&m.remove(),d&&d.remove()),a.resize&&e.resizeSvgIcons(a.resize),h=!0,a.callback&&a.callback(t)}}function k(){if(r.includes(".svgz")){var t=r.replace(".svgz",".svg");window.console&&console.log(".svgz failed, trying with .svg"),e.svgIcons(t,a)}else a.fallback&&S(!1,a.fallback)}function C(e){if(window.btoa)return window.btoa(e);var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=new Array(4*Math.floor((e.length+2)/3)),r=0,a=0;do{var i=e.charCodeAt(r++),o=e.charCodeAt(r++),s=e.charCodeAt(r++),l=i>>2,c=(3&i)<<4|o>>4,u=(15&o)<<2|s>>6,d=63&s;isNaN(o)?u=d=64:isNaN(s)&&(d=64),n[a++]=t.charAt(l),n[a++]=t.charAt(c),n[a++]=t.charAt(u),n[a++]=t.charAt(d)}while(r<e.length);return n.join("")}n=function(e,t,n){var r=e.find("defs");if(!r.length)return e;var a=void 0;a=g?r.find("*").filter(function(){return!!this.id}):r.find("[id]");var i=e[0].getElementsByTagName("*"),o=i.length;return a.each(function(e){var n=this.id,r="x"+n+t+e;this.id=r;var a="url(#"+n+")",s="url(#"+r+")";for(e=0;e<o;e++){var l=i[e];l.getAttribute("fill")===a&&l.setAttribute("fill",s),l.getAttribute("stroke")===a&&l.setAttribute("stroke",s),l.getAttribute("filter")===a&&l.setAttribute("filter",s)}}),e}},e.getSvgIcon=function(e,r){var a=t[e];return r&&a&&(a=n(a,0,!0).clone(!0)),a},e.resizeSvgIcons=function(t){var n=!e(".svg_icon:first").length;e.each(t,function(t,r){var a=Array.isArray(r),i=a?r[0]:r,o=a?r[1]:r;n&&(t=t.replace(/\.svg_icon/g,"svg")),e(t).each(function(){this.setAttribute("width",i),this.setAttribute("height",o),window.opera&&window.widget&&(this.parentNode.style.width=i+"px",this.parentNode.style.height=o+"px")})})},e},function(e){e.loadingStylesheets||(e.loadingStylesheets=[]),e.loadingStylesheets.includes("jgraduate/css/jgraduate.css")||e.loadingStylesheets.push("jgraduate/css/jgraduate.css"),e.jGraduate={Paint:function(e){var t=e||{};if(this.alpha=isNaN(t.alpha)?100:t.alpha,t.copy)switch(this.type=t.copy.type,this.alpha=t.copy.alpha,this.solidColor=null,this.linearGradient=null,this.radialGradient=null,this.type){case"none":break;case"solidColor":this.solidColor=t.copy.solidColor;break;case"linearGradient":this.linearGradient=t.copy.linearGradient.cloneNode(!0);break;case"radialGradient":this.radialGradient=t.copy.radialGradient.cloneNode(!0)}else t.linearGradient?(this.type="linearGradient",this.solidColor=null,this.radialGradient=null,this.linearGradient=t.linearGradient.cloneNode(!0)):t.radialGradient?(this.type="radialGradient",this.solidColor=null,this.linearGradient=null,this.radialGradient=t.radialGradient.cloneNode(!0)):t.solidColor?(this.type="solidColor",this.solidColor=t.solidColor):(this.type="none",this.solidColor=null,this.linearGradient=null,this.radialGradient=null)}},e.fn.jGraduateDefaults={paint:new e.jGraduate.Paint,window:{pickerTitle:"Drag markers to pick a paint"},images:{clientPath:"images/"},newstop:"inverse"};var n=navigator.userAgent.includes("Gecko/");function r(e,t,r){var a=document.createElementNS(er.svg,e);return function(e,t){if(n)for(var r in t)e.setAttribute(r,t[r]);else for(var a in t){var i=t[a],o=e[a];o&&"SVGLength"===o.constructor?o.baseVal.value=i:e.setAttribute(a,i)}}(a,t),r&&r.append(a),a}return e.fn.jGraduate=function(n){var a=arguments;return this.each(function(){var i=e(this),o=e.extend(!0,{},e.fn.jGraduateDefaults,n),s=i.attr("id"),l="#"+i.attr("id")+" ";if(l){var c=function(){switch(i.paint.type){case"radialGradient":i.paint.linearGradient=null;break;case"linearGradient":i.paint.radialGradient=null;break;case"solidColor":i.paint.radialGradient=i.paint.linearGradient=null}"function"==typeof i.okCallback&&i.okCallback(i.paint),i.hide()},u=function(){"function"==typeof i.cancelCallback&&i.cancelCallback(),i.hide()};e.extend(!0,i,{paint:new e.jGraduate.Paint({copy:o.paint}),okCallback:"function"==typeof a[1]&&a[1]||null,cancelCallback:"function"==typeof a[2]&&a[2]||null});var d=null,h=e(window);"none"===i.paint.type&&(i.paint=e.jGraduate.Paint({solidColor:"ffffff"})),i.addClass("jGraduate_Picker"),i.html('<ul class="jGraduate_tabs"><li class="jGraduate_tab_color jGraduate_tab_current" data-type="col">Solid Color</li><li class="jGraduate_tab_lingrad" data-type="lg">Linear Gradient</li><li class="jGraduate_tab_radgrad" data-type="rg">Radial Gradient</li></ul><div class="jGraduate_colPick"></div><div class="jGraduate_gradPick"></div><div class="jGraduate_LightBox"></div><div id="'+s+'_jGraduate_stopPicker" class="jGraduate_stopPicker"></div>');var f=e(l+"> .jGraduate_colPick"),p=e(l+"> .jGraduate_gradPick");p.html('<div id="'+s+'_jGraduate_Swatch" class="jGraduate_Swatch"><h2 class="jGraduate_Title">'+o.window.pickerTitle+'</h2><div id="'+s+'_jGraduate_GradContainer" class="jGraduate_GradContainer"></div><div id="'+s+'_jGraduate_StopSlider" class="jGraduate_StopSlider"></div></div><div class="jGraduate_Form jGraduate_Points jGraduate_lg_field"><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Begin Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+s+'_jGraduate_x1" size="3" title="Enter starting x value between 0.0 and 1.0"/><label>y:</label><input type="text" id="'+s+'_jGraduate_y1" size="3" title="Enter starting y value between 0.0 and 1.0"/></div></div><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">End Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+s+'_jGraduate_x2" size="3" title="Enter ending x value between 0.0 and 1.0"/><label>y:</label><input type="text" id="'+s+'_jGraduate_y2" size="3" title="Enter ending y value between 0.0 and 1.0"/></div></div></div><div class="jGraduate_Form jGraduate_Points jGraduate_rg_field"><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Center Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+s+'_jGraduate_cx" size="3" title="Enter x value between 0.0 and 1.0"/><label>y:</label><input type="text" id="'+s+'_jGraduate_cy" size="3" title="Enter y value between 0.0 and 1.0"/></div></div><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Focal Point</label><div class="jGraduate_Form_Section"><label>Match center: <input type="checkbox" checked="checked" id="'+s+'_jGraduate_match_ctr"/></label><br/><label>x:</label><input type="text" id="'+s+'_jGraduate_fx" size="3" title="Enter x value between 0.0 and 1.0"/><label>y:</label><input type="text" id="'+s+'_jGraduate_fy" size="3" title="Enter y value between 0.0 and 1.0"/></div></div></div><div class="jGraduate_StopSection jGraduate_SpreadMethod"><label class="jGraduate_Form_Heading">Spread method</label><div class="jGraduate_Form_Section"><select class="jGraduate_spreadMethod"><option value=pad selected>Pad</option><option value=reflect>Reflect</option><option value=repeat>Repeat</option></select></div></div><div class="jGraduate_Form"><div class="jGraduate_Slider jGraduate_RadiusField jGraduate_rg_field"><label class="prelabel">Radius:</label><div id="'+s+'_jGraduate_Radius" class="jGraduate_SliderBar jGraduate_Radius" title="Click to set radius"><img id="'+s+'_jGraduate_RadiusArrows" class="jGraduate_RadiusArrows" src="'+o.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+s+'_jGraduate_RadiusInput" size="3" value="100"/>%</label></div><div class="jGraduate_Slider jGraduate_EllipField jGraduate_rg_field"><label class="prelabel">Ellip:</label><div id="'+s+'_jGraduate_Ellip" class="jGraduate_SliderBar jGraduate_Ellip" title="Click to set Ellip"><img id="'+s+'_jGraduate_EllipArrows" class="jGraduate_EllipArrows" src="'+o.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+s+'_jGraduate_EllipInput" size="3" value="0"/>%</label></div><div class="jGraduate_Slider jGraduate_AngleField jGraduate_rg_field"><label class="prelabel">Angle:</label><div id="'+s+'_jGraduate_Angle" class="jGraduate_SliderBar jGraduate_Angle" title="Click to set Angle"><img id="'+s+'_jGraduate_AngleArrows" class="jGraduate_AngleArrows" src="'+o.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+s+'_jGraduate_AngleInput" size="3" value="0"/>deg</label></div><div class="jGraduate_Slider jGraduate_OpacField"><label class="prelabel">Opac:</label><div id="'+s+'_jGraduate_Opac" class="jGraduate_SliderBar jGraduate_Opac" title="Click to set Opac"><img id="'+s+'_jGraduate_OpacArrows" class="jGraduate_OpacArrows" src="'+o.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+s+'_jGraduate_OpacInput" size="3" value="100"/>%</label></div></div><div class="jGraduate_OkCancel"><input type="button" id="'+s+'_jGraduate_Ok" class="jGraduate_Ok" value="OK"/><input type="button" id="'+s+'_jGraduate_Cancel" class="jGraduate_Cancel" value="Cancel"/></div>');var g=256,v=g-0,m=g-0,_={};e(".jGraduate_SliderBar").width(145);var y=e("#"+s+"_jGraduate_GradContainer")[0],b=r("svg",{id:s+"_jgraduate_svg",width:g,height:g,xmlns:er.svg},y),x=i.paint.type,w=i.paint[x],S=w,k=i.paint.alpha,C="solidColor"===x;switch(x){case"solidColor":case"linearGradient":if(C||(S.id=s+"_lg_jgraduate_grad",w=S=b.appendChild(S)),r("radialGradient",{id:s+"_rg_jgraduate_grad"},b),"linearGradient"===x)break;case"radialGradient":C||(S.id=s+"_rg_jgraduate_grad",w=S=b.appendChild(S)),r("linearGradient",{id:s+"_lg_jgraduate_grad"},b)}var A=void 0;if(C){w=S=e("#"+s+"_lg_jgraduate_grad")[0],Ne(0,"#"+(d=i.paint[x]),1);var E=t(o.newstop);if("string"===E)switch(o.newstop){case"same":Ne(1,"#"+d,1);break;case"inverse":for(var P="",G=0;G<6;G+=2){var I=(255-parseInt(d.substr(G,2),16)).toString(16);I.length<2&&(I=0+I),P+=I}Ne(1,"#"+P,1);break;case"white":Ne(1,"#ffffff",1);break;case"black":Ne(1,"#000000",1)}else if("object"===E){var T="opac"in o.newstop?o.newstop.opac:1;Ne(1,o.newstop.color||"#"+d,T)}}var N=parseFloat(w.getAttribute("x1")||0),L=parseFloat(w.getAttribute("y1")||0),M=parseFloat(w.getAttribute("x2")||1),O=parseFloat(w.getAttribute("y2")||0),V=parseFloat(w.getAttribute("cx")||.5),j=parseFloat(w.getAttribute("cy")||.5),R=parseFloat(w.getAttribute("fx")||V),B=parseFloat(w.getAttribute("fy")||j),D=r("rect",{id:s+"_jgraduate_rect",x:0,y:0,width:v,height:m,fill:"url(#"+s+"_jgraduate_grad)","fill-opacity":k/100},b),U=e("<div/>").attr({class:"grad_coord jGraduate_lg_field",title:"Begin Stop"}).text(1).css({top:L*g,left:N*g}).data("coord","start").appendTo(y),F=U.clone().text(2).css({top:O*g,left:M*g}).attr("title","End stop").data("coord","end").appendTo(y),H=e("<div/>").attr({class:"grad_coord jGraduate_rg_field",title:"Center stop"}).text("C").css({top:j*g,left:V*g}).data("coord","center").appendTo(y),z=H.clone().text("F").css({top:B*g,left:R*g,display:"none"}).attr("title","Focus point").data("coord","focus").appendTo(y);z[0].id=s+"_jGraduate_focusCoord";var q=void 0;e.each(["x1","y1","x2","y2","cx","cy","fx","fy"],function(t,n){var r=isNaN(n[1]),a=S.getAttribute(n);a||(a=r?"0.5":"x2"===n?"1.0":"0.0"),_[n]=e("#"+s+"_jGraduate_"+n).val(a).change(function(){isNaN(parseFloat(this.value))||this.value<0?this.value=0:this.value>1&&(this.value=1),("f"!==n[0]||q)&&(r&&"radialGradient"===x||!r&&"linearGradient"===x)&&S.setAttribute(n,this.value);var e=r?"c"===n[0]?H:z:"1"===n[1]?U:F,t=n.includes("x")?"left":"top";e.css(t,this.value*g)}).change()});var Y=e("#"+s+"_jGraduate_StopSlider"),W=void 0,X=void 0,Q=void 0,K=r("path",{d:"m9.75,-6l-19.5,19.5m0,-19.5l19.5,19.5",fill:"none",stroke:"#D00","stroke-width":5,display:"none"},void 0),Z=void 0,$=1,J=1,ee=0,te=V,ne=j,re=r("svg",{width:"100%",height:45},Y[0]),ae=r("image",{width:16,height:16},r("pattern",{width:16,height:16,patternUnits:"userSpaceOnUse",id:"jGraduate_trans"},re)),ie=o.images.clientPath+"map-opacity.png";ae.setAttributeNS(er.xlink,"xlink:href",ie),e(re).click(function(e){if(Z=Y.offset(),"path"!==e.target.tagName){var t=e.pageX-Z.left-8;Ne((t=t<10?10:t>g+10?g+10:t)/g,0,0,!0),e.stopPropagation()}}),e(re).mouseover(function(){re.append(K)}),A=r("g",{},re),r("line",{x1:10,y1:15,x2:g+10,y2:15,"stroke-width":2,stroke:"#000"},re);var oe=p.find(".jGraduate_spreadMethod").change(function(){S.setAttribute("spreadMethod",e(this).val())}),se=null,le=function(e){var t=e.pageX-he.left,n=e.pageY-he.top;t=t<0?0:t>g?g:t,n=n<0?0:n>g?g:n,se.css("left",t).css("top",n);var r=t/v,a=n/m,i=se.data("coord"),o=S;switch(i){case"start":_.x1.val(r),_.y1.val(a),o.setAttribute("x1",r),o.setAttribute("y1",a);break;case"end":_.x2.val(r),_.y2.val(a),o.setAttribute("x2",r),o.setAttribute("y2",a);break;case"center":_.cx.val(r),_.cy.val(a),o.setAttribute("cx",r),o.setAttribute("cy",a),te=r,ne=a,Oe();break;case"focus":_.fx.val(r),_.fy.val(a),o.setAttribute("fx",r),o.setAttribute("fy",a),Oe()}e.preventDefault()},ce=function e(){se=null,h.unbind("mousemove",le).unbind("mouseup",e)},ue=(W=S.getElementsByTagNameNS(er.svg,"stop")).length;if(ue<2){for(;ue<2;)S.append(document.createElementNS(er.svg,"stop")),++ue;W=S.getElementsByTagNameNS(er.svg,"stop")}for(var de=0;de<ue;de++)Ne(0,0,0,0,W[de]);oe.val(S.getAttribute("spreadMethod")||"pad");var he=void 0;q=!1,D.setAttribute("fill-opacity",k/100),e("#"+s+" div.grad_coord").mousedown(function(t){t.preventDefault(),se=e(this),he=se.parent().offset(),h.mousemove(le).mouseup(ce)}),e("#"+s+"_jGraduate_Ok").bind("click",function(){i.paint.type=x,i.paint[x]=S.cloneNode(!0),i.paint.solidColor=null,c()}),e("#"+s+"_jGraduate_Cancel").bind("click",function(e){u()}),"radialGradient"===x&&(q?z.show():(z.hide(),_.fx.val(""),_.fy.val(""))),e("#"+s+"_jGraduate_match_ctr")[0].checked=!q;var fe=void 0,pe=void 0;if(e("#"+s+"_jGraduate_match_ctr").change(function(){q=!this.checked,z.toggle(q),_.fx.val(""),_.fy.val("");var e=S;if(q){var t=fe||.5,n=pe||.5;e.setAttribute("fx",t),e.setAttribute("fy",n),_.fx.val(t),_.fy.val(n)}else fe=e.getAttribute("fx"),pe=e.getAttribute("fy"),e.removeAttribute("fx"),e.removeAttribute("fy")}),(ue=(W=S.getElementsByTagNameNS(er.svg,"stop")).length)<2){for(;ue<2;)S.append(document.createElementNS(er.svg,"stop")),++ue;W=S.getElementsByTagNameNS(er.svg,"stop")}var ge=void 0,ve=0,me=0;if("radialGradient"===x){var _e=S.gradientTransform.baseVal;if(2===_e.numberOfItems){var ye=_e.getItem(0),be=_e.getItem(1);if(2===ye.type&&3===be.type){var xe=be.matrix;1!==xe.a?ve=Math.round(100*-(1-xe.a)):1!==xe.d&&(ve=Math.round(100*(1-xe.d)))}}else if(3===_e.numberOfItems){var we=_e.getItem(0),Se=_e.getItem(1),ke=_e.getItem(2);if(4===we.type&&2===Se.type&&3===ke.type){me=Math.round(we.angle);var Ce=ke.matrix;1!==Ce.a?ve=Math.round(100*-(1-Ce.a)):1!==Ce.d&&(ve=Math.round(100*(1-Ce.d)))}}}var Ae={radius:{handle:"#"+s+"_jGraduate_RadiusArrows",input:"#"+s+"_jGraduate_RadiusInput",val:100*(S.getAttribute("r")||.5)},opacity:{handle:"#"+s+"_jGraduate_OpacArrows",input:"#"+s+"_jGraduate_OpacInput",val:i.paint.alpha||100},ellip:{handle:"#"+s+"_jGraduate_EllipArrows",input:"#"+s+"_jGraduate_EllipInput",val:ve},angle:{handle:"#"+s+"_jGraduate_AngleArrows",input:"#"+s+"_jGraduate_AngleInput",val:me}};e.each(Ae,function(t,n){var r=e(n.handle);r.mousedown(function(a){var i=r.parent();ge={type:t,elem:r,input:e(n.input),parent:i,offset:i.offset()},h.mousemove(Ee).mouseup(Pe),a.preventDefault()}),e(n.input).val(n.val).change(function(){var e="radialGradient"===x,n=+this.value,a=0;switch(t){case"radius":e&&S.setAttribute("r",n/100),a=Math.pow(n/100,.4)/2*145;break;case"opacity":i.paint.alpha=n,D.setAttribute("fill-opacity",n/100),a=1.45*n;break;case"ellip":if($=J=1,0===n){a=72.5;break}n>99.5&&(n=99.5),n>0?J=1-n/100:$=-n/100-1,a=(n+100)/2*145/100,e&&Oe();break;case"angle":a=(ee=n)/180,a+=.5,a*=145,e&&Oe()}a>145?a=145:a<0&&(a=0),r.css({"margin-left":a-5})}).change()});for(var Ee=function(e){!function(e){var t=ge.offset,n=ge.parent,r=e.pageX-t.left-parseInt(n.css("border-left-width"));r>145&&(r=145),r<=0&&(r=0);var a=r-5;switch(r/=145,ge.type){case"radius":(r=Math.pow(2*r,2.5))>.98&&r<1.02&&(r=1),r<=.01&&(r=.01),S.setAttribute("r",r);break;case"opacity":i.paint.alpha=parseInt(100*r),D.setAttribute("fill-opacity",r);break;case"ellip":$=1,J=1,r<.5?$=(r/=.5)<=0?.01:r:r>.5&&(J=(r=2-(r/=.5))<=0?.01:r),Oe(),J===1+(r-=1)&&(r=Math.abs(r));break;case"angle":r-=.5,ee=r*=180,Oe(),r/=100}ge.elem.css({"margin-left":a}),r=Math.round(100*r),ge.input.val(r)}(e),e.preventDefault()},Pe=function e(t){h.unbind("mousemove",Ee).unbind("mouseup",e),ge=null},Ge=(255*i.paint.alpha/100).toString(16);Ge.length<2;)Ge="0"+Ge;Ge=Ge.split(".")[0],d="none"===i.paint.solidColor?"":i.paint.solidColor+Ge,C||(d=W[0].getAttribute("stop-color")),e.extend(e.fn.jPicker.defaults.window,{alphaSupport:!0,effects:{type:"show",speed:0}}),f.jPicker({window:{title:o.window.pickerTitle},images:{clientPath:o.images.clientPath},color:{active:d,alphaSupport:!0}},function(e){i.paint.type="solidColor",i.paint.alpha=e.val("ahex")?Math.round(e.val("a")/255*100):100,i.paint.solidColor=e.val("hex")?e.val("hex"):"none",i.paint.radialGradient=null,c()},null,function(){u()});var Ie=e(l+" .jGraduate_tabs li");Ie.click(function(){Ie.removeClass("jGraduate_tab_current"),e(this).addClass("jGraduate_tab_current"),e(l+" > div").hide();var t=e(this).attr("data-type");if(e(l+" .jGraduate_gradPick").show(),"rg"===t||"lg"===t){e(".jGraduate_"+t+"_field").show(),e(".jGraduate_"+("lg"===t?"rg":"lg")+"_field").hide(),e("#"+s+"_jgraduate_rect")[0].setAttribute("fill","url(#"+s+"_"+t+"_jgraduate_grad)"),x="lg"===t?"linearGradient":"radialGradient",e("#"+s+"_jGraduate_OpacInput").val(i.paint.alpha).change();var n=e("#"+s+"_"+t+"_jgraduate_grad")[0];if(S!==n){var r=e(S).find("stop");e(n).empty().append(r),S=n;var a=oe.val();S.setAttribute("spreadMethod",a)}q="rg"===t&&null!=S.getAttribute("fx")&&!(V===R&&j===B),e("#"+s+"_jGraduate_focusCoord").toggle(q),q&&(e("#"+s+"_jGraduate_match_ctr")[0].checked=!1)}else e(l+" .jGraduate_gradPick").hide(),e(l+" .jGraduate_colPick").show()}),e(l+" > div").hide(),Ie.removeClass("jGraduate_tab_current");var Te=void 0;switch(i.paint.type){case"linearGradient":Te=e(l+" .jGraduate_tab_lingrad");break;case"radialGradient":Te=e(l+" .jGraduate_tab_radgrad");break;default:Te=e(l+" .jGraduate_tab_color")}i.show(),setTimeout(function(){Te.addClass("jGraduate_tab_current").click()},10)}else alert("Container element must have an id attribute to maintain unique id strings for sub-elements.");function Ne(t,n,a,i,l){var c=l||r("stop",{"stop-color":n,"stop-opacity":a,offset:t},S);l?(n=l.getAttribute("stop-color"),a=l.getAttribute("stop-opacity"),t=l.getAttribute("offset")):S.append(c),null===a&&(a=1);var u="M-6.2,0.9c3.6-4,6.7-4.3,6.7-12.4c-0.2,7.9,3.1,8.8,6.5,12.4c3.5,3.8,2.9,9.6,0,12.3c-3.1,2.8-10.4,2.7-13.2,0C-9.6,9.9-9.4,4.4-6.2,0.9z",d=r("path",{d:u,fill:"url(#jGraduate_trans)",transform:"translate("+(10+t*g)+", 26)"},A),f=r("path",{d:u,fill:n,"fill-opacity":a,transform:"translate("+(10+t*g)+", 26)",stroke:"#000","stroke-width":1.5},A);return e(f).mousedown(function(e){return Le(this),Q=X,h.mousemove(Ve).mouseup(Me),Z=Y.offset(),e.preventDefault(),!1}).data("stop",c).data("bg",d).dblclick(function(){e("div.jGraduate_LightBox").show();for(var t=this,r=+c.getAttribute("stop-opacity")||1,a=c.getAttribute("stop-color")||1,i=(255*parseFloat(r)).toString(16);i.length<2;)i="0"+i;n=a.substr(1)+i,e("#"+s+"_jGraduate_stopPicker").css({left:100,bottom:15}).jPicker({window:{title:"Pick the start color and opacity for the gradient"},images:{clientPath:o.images.clientPath},color:{active:n,alphaSupport:!0}},function(n,i){a=n.val("hex")?"#"+n.val("hex"):"none",r=null!==n.val("a")?n.val("a")/256:1,t.setAttribute("fill",a),t.setAttribute("fill-opacity",r),c.setAttribute("stop-color",a),c.setAttribute("stop-opacity",r),e("div.jGraduate_LightBox").hide(),e("#"+s+"_jGraduate_stopPicker").hide()},null,function(){e("div.jGraduate_LightBox").hide(),e("#"+s+"_jGraduate_stopPicker").hide()})}),e(S).find("stop").each(function(){var r=e(this);if(+this.getAttribute("offset")>t){if(!n){var a=this.getAttribute("stop-color"),i=this.getAttribute("stop-opacity");c.setAttribute("stop-color",a),f.setAttribute("fill",a),c.setAttribute("stop-opacity",null===i?1:i),f.setAttribute("fill-opacity",null===i?1:i)}return r.before(c),!1}}),i&&Le(f),c}function Le(e){X&&X.setAttribute("stroke","#000"),e.setAttribute("stroke","blue"),(X=e).parentNode.append(X)}function Me(){h.unbind("mousemove",Ve),"none"!==K.getAttribute("display")&&function(){K.setAttribute("display","none");var t=e(X),n=t.data("stop"),r=t.data("bg");e([X,n,r]).remove()}(),Q=null}function Oe(){var e=ee?"rotate("+ee+","+te+","+ne+") ":"";if(1===$&&1===J)S.removeAttribute("gradientTransform");else{var t=-te*($-1),n=-ne*(J-1);S.setAttribute("gradientTransform",e+"translate("+t+","+n+") scale("+$+","+J+")")}}function Ve(t){var n=t.pageX-Z.left,r=t.pageY-Z.top,a="translate("+(n=n<10?10:n>g+10?g+10:n)+", 26)";r<-60||r>130?(K.setAttribute("display","block"),K.setAttribute("transform",a)):K.setAttribute("display","none"),Q.setAttribute("transform",a),e.data(Q,"bg").setAttribute("transform",a);var i=e.data(Q,"stop"),o=(n-10)/g;i.setAttribute("offset",o);var s=0;e(S).find("stop").each(function(t){var n=this.getAttribute("offset"),r=e(this);n<s&&(r.prev().before(r),W=e(S).find("stop")),s=n})}})},e},function(e){return e.loadingStylesheets||(e.loadingStylesheets=[]),e.loadingStylesheets.includes("spinbtn/JQuerySpinBtn.css")||e.loadingStylesheets.push("spinbtn/JQuerySpinBtn.css"),e.fn.SpinButton=function(t){function n(t,n){for(var r=document.body,a=t[n];(t=t.offsetParent)&&t!==r;)e.browser.msie&&"relative"===t.currentStyle.position||(a+=t[n]);return a}return t=t||{},this.each(function(){this.repeating=!1,this.spinCfg={min:isNaN(parseFloat(t.min))?null:Number(t.min),max:isNaN(parseFloat(t.max))?null:Number(t.max),step:t.step?Number(t.step):1,stepfunc:t.stepfunc||!1,page:t.page?Number(t.page):10,upClass:t.upClass||"up",downClass:t.downClass||"down",reset:t.reset||this.value,delay:t.delay?Number(t.delay):500,interval:t.interval?Number(t.interval):100,_btn_width:20,_direction:null,_delay:null,_repeat:null,callback:t.callback||null},this.spinCfg.smallStep=t.smallStep||this.spinCfg.step/2,this.adjustValue=function(e){var t=void 0;t=isNaN(this.value)?this.spinCfg.reset:"function"==typeof this.spinCfg.stepfunc?this.spinCfg.stepfunc(this,e):Number((Number(this.value)+Number(e)).toFixed(5)),null!==this.spinCfg.min&&(t=Math.max(t,this.spinCfg.min)),null!==this.spinCfg.max&&(t=Math.min(t,this.spinCfg.max)),this.value=t,"function"==typeof this.spinCfg.callback&&this.spinCfg.callback(this)},e(this).addClass(t.spinClass||"spin-button").mousemove(function(r){var a=r.pageX||r.x,i=r.pageY||r.y,o=r.target,s=t.stateObj.tool_scale||1,l=e(o).height()/2,c=a>n(o,"offsetLeft")+o.offsetWidth*s-this.spinCfg._btn_width?i<n(o,"offsetTop")+l*s?1:-1:0;if(c!==this.spinCfg._direction){switch(c){case 1:e(this).removeClass(this.spinCfg.downClass).addClass(this.spinCfg.upClass);break;case-1:e(this).removeClass(this.spinCfg.upClass).addClass(this.spinCfg.downClass);break;default:e(this).removeClass(this.spinCfg.upClass).removeClass(this.spinCfg.downClass)}this.spinCfg._direction=c}}).mouseout(function(){e(this).removeClass(this.spinCfg.upClass).removeClass(this.spinCfg.downClass),this.spinCfg._direction=null,window.clearInterval(this.spinCfg._repeat),window.clearTimeout(this.spinCfg._delay)}).mousedown(function(e){var t=this;if(0===e.button&&0!==this.spinCfg._direction){var n=e.shiftKey?this.spinCfg.smallStep:this.spinCfg.step,r=function(){t.adjustValue(t.spinCfg._direction*n)};r(),this.spinCfg._delay=window.setTimeout(function(){r(),t.spinCfg._repeat=window.setInterval(r,t.spinCfg.interval)},this.spinCfg.delay)}}).mouseup(function(e){window.clearInterval(this.spinCfg._repeat),window.clearTimeout(this.spinCfg._delay)}).dblclick(function(t){e.browser.msie&&this.adjustValue(this.spinCfg._direction*this.spinCfg.step)}).keydown(function(e){switch(e.keyCode){case 38:this.adjustValue(this.spinCfg.step);break;case 40:this.adjustValue(-this.spinCfg.step);break;case 33:this.adjustValue(this.spinCfg.page);break;case 34:this.adjustValue(-this.spinCfg.page)}}).keypress(function(e){if(this.repeating)switch(e.keyCode){case 38:this.adjustValue(this.spinCfg.step);break;case 40:this.adjustValue(-this.spinCfg.step);break;case 33:this.adjustValue(this.spinCfg.page);break;case 34:this.adjustValue(-this.spinCfg.page)}else this.repeating=!0}).keyup(function(e){switch(this.repeating=!1,e.keyCode){case 38:case 40:case 33:case 34:case 13:this.adjustValue(0)}}).bind("mousewheel",function(e){e.wheelDelta>=120?this.adjustValue(this.spinCfg.step):e.wheelDelta<=-120&&this.adjustValue(-this.spinCfg.step),e.preventDefault()}).change(function(e){this.adjustValue(0)}),this.addEventListener&&this.addEventListener("DOMMouseScroll",function(e){e.detail>0?this.adjustValue(-this.spinCfg.step):e.detail<0&&this.adjustValue(this.spinCfg.step),e.preventDefault()},!1)})},e},U,function(e){var t=e(window),n=e(document);return e.extend(e.fn,{contextMenu:function(r,a){return void 0!==r.menu&&(void 0===r.inSpeed&&(r.inSpeed=150),void 0===r.outSpeed&&(r.outSpeed=75),0===r.inSpeed&&(r.inSpeed=-1),0===r.outSpeed&&(r.outSpeed=-1),e(this).each(function(){var i=e(this),o=e(i).offset(),s=e("#"+r.menu);s.addClass("contextMenu"),e(this).bind("mousedown",function(l){var c=l;e(this).mouseup(function(l){var u=e(this);if(u.unbind("mouseup"),2===c.button||r.allowLeft||c.ctrlKey&&j()){if(l.stopPropagation(),e(".contextMenu").hide(),i.hasClass("disabled"))return!1;var d=l.pageX,h=l.pageY,f=t.width()-s.width(),p=t.height()-s.height();d>f-15&&(d=f-15),h>p-30&&(h=p-30),n.unbind("click"),s.css({top:h,left:d}).fadeIn(r.inSpeed),s.find("A").mouseover(function(){s.find("LI.hover").removeClass("hover"),e(this).parent().addClass("hover")}).mouseout(function(){s.find("LI.hover").removeClass("hover")}),n.keypress(function(e){switch(e.keyCode){case 38:s.find("LI.hover").length?(s.find("LI.hover").removeClass("hover").prevAll("LI:not(.disabled)").eq(0).addClass("hover"),s.find("LI.hover").length||s.find("LI:last").addClass("hover")):s.find("LI:last").addClass("hover");break;case 40:s.find("LI.hover").length?(s.find("LI.hover").removeClass("hover").nextAll("LI:not(.disabled)").eq(0).addClass("hover"),s.find("LI.hover").length||s.find("LI:first").addClass("hover")):s.find("LI:first").addClass("hover");break;case 13:s.find("LI.hover A").trigger("click");break;case 27:n.trigger("click")}}),s.find("A").unbind("mouseup"),s.find("LI:not(.disabled) A").mouseup(function(){return n.unbind("click").unbind("keypress"),e(".contextMenu").hide(),a&&a(e(this).attr("href").substr(1),e(u),{x:d-o.left,y:h-o.top,docX:d,docY:h}),!1}),setTimeout(function(){n.click(function(){return n.unbind("click").unbind("keypress"),s.fadeOut(r.outSpeed),!1})},0)}})}),e.browser.mozilla?e("#"+r.menu).each(function(){e(this).css({MozUserSelect:"none"})}):e.browser.msie?e("#"+r.menu).each(function(){e(this).bind("selectstart.disableTextSelect",function(){return!1})}):e("#"+r.menu).each(function(){e(this).bind("mousedown.disableTextSelect",function(){return!1})}),e(i).add(e("UL.contextMenu")).bind("contextmenu",function(){return!1})}),e(this))},disableContextMenuItems:function(t){return void 0===t?(e(this).find("LI").addClass("disabled"),e(this)):(e(this).each(function(){if(void 0!==t)for(var n=t.split(","),r=0;r<n.length;r++)e(this).find('A[href="'+n[r]+'"]').parent().addClass("disabled")}),e(this))},enableContextMenuItems:function(t){return void 0===t?(e(this).find("LI.disabled").removeClass("disabled"),e(this)):(e(this).each(function(){if(void 0!==t)for(var n=t.split(","),r=0;r<n.length;r++)e(this).find('A[href="'+n[r]+'"]').parent().removeClass("disabled")}),e(this))},disableContextMenu:function(){return e(this).each(function(){e(this).addClass("disabled")}),e(this)},enableContextMenu:function(){return e(this).each(function(){e(this).removeClass("disabled")}),e(this)},destroyContextMenu:function(){return e(this).each(function(){e(this).unbind("mousedown").unbind("mouseup")}),e(this)}}),e},function(e){e.loadingStylesheets||(e.loadingStylesheets=[]);function n(t,n){var r=this;function a(n){var a=t.offset();u={l:0|a.left,t:0|a.top},clearTimeout(d),d=setTimeout(function(){s.call(r,n)},0),e(document).bind("mousemove",i).bind("mouseup",o),n.preventDefault()}function i(e){return clearTimeout(d),d=setTimeout(function(){s.call(r,e)},0),e.stopPropagation(),e.preventDefault(),!1}function o(t){return e(document).unbind("mouseup",o).unbind("mousemove",i),t.stopPropagation(),t.preventDefault(),!1}function s(e){var n=t.w,a=t.h,i=e.pageX-u.l,o=e.pageY-u.t;i<0?i=0:i>n&&(i=n),o<0?o=0:o>a&&(o=a),l.call(r,"xy",{x:i/n*v+p,y:o/a*y+m})}function l(e,t,n){if(void 0===t)switch(void 0!==e&&null!=e||(e="xy"),e.toLowerCase()){case"x":return h;case"y":return f;case"xy":default:return{x:h,y:f}}if(null==n||n!==r){var a=!1,i=void 0,o=void 0;switch(null==e&&(e="xy"),e.toLowerCase()){case"x":i=t&&(t.x&&0|t.x||0|t)||0;break;case"y":o=t&&(t.y&&0|t.y||0|t)||0;break;case"xy":default:i=t&&t.x&&0|t.x||0,o=t&&t.y&&0|t.y||0}null!=i&&(i<p?i=p:i>g&&(i=g),h!==i&&(h=i,a=!0)),null!=o&&(o<m?o=m:o>_&&(o=_),f!==o&&(f=o,a=!0)),a&&function(e){for(var t=0;t<x.length;t++)x[t].call(r,r,e)}.call(r,n||r)}}function c(e){"function"==typeof e&&x.push(e)}var u=void 0,d=void 0,h=0,f=0,p=0,g=100,v=100,m=0,_=100,y=100,b=t.find("img:first"),x=[];e.extend(!0,r,{val:l,range:function(e,t){if(void 0===t)switch(void 0!==e&&null!=e||(e="all"),e.toLowerCase()){case"minx":return p;case"maxx":return g;case"rangex":return{minX:p,maxX:g,rangeX:v};case"miny":return m;case"maxy":return _;case"rangey":return{minY:m,maxY:_,rangeY:y};case"all":default:return{minX:p,maxX:g,rangeX:v,minY:m,maxY:_,rangeY:y}}var n=void 0,r=void 0,a=void 0,i=void 0;switch(null==e&&(e="all"),e.toLowerCase()){case"minx":n=t&&(t.minX&&0|t.minX||0|t)||0;break;case"maxx":r=t&&(t.maxX&&0|t.maxX||0|t)||0;break;case"rangex":n=t&&t.minX&&0|t.minX||0,r=t&&t.maxX&&0|t.maxX||0;break;case"miny":a=t&&(t.minY&&0|t.minY||0|t)||0;break;case"maxy":i=t&&(t.maxY&&0|t.maxY||0|t)||0;break;case"rangey":a=t&&t.minY&&0|t.minY||0,i=t&&t.maxY&&0|t.maxY||0;break;case"all":default:n=t&&t.minX&&0|t.minX||0,r=t&&t.maxX&&0|t.maxX||0,a=t&&t.minY&&0|t.minY||0,i=t&&t.maxY&&0|t.maxY||0}null!=n&&p!==n&&(v=g-(p=n)),null!=r&&g!==r&&(v=(g=r)-p),null!=a&&m!==a&&(y=_-(m=a)),null!=i&&_!==i&&(y=(_=i)-m)},bind:c,unbind:function(e){if("function"==typeof e)for(var t=void 0;t=x.includes(e);)x.splice(t,1)},destroy:function(){e(document).unbind("mouseup",o).unbind("mousemove",i),t.unbind("mousedown",a),t=null,b=null,x=null}}),b.src=n.arrow&&n.arrow.image,b.w=n.arrow&&n.arrow.width||b.width(),b.h=n.arrow&&n.arrow.height||b.height(),t.w=n.map&&n.map.width||t.width(),t.h=n.map&&n.map.height||t.height(),t.bind("mousedown",a),c.call(r,function(){var e=t.w,n=t.h,r=b.w,a=b.h,i=0,o=0;setTimeout(function(){v>0&&(i=h===g?e:h/v*e|0),y>0&&(o=f===_?n:f/y*n|0),r>=e?i=(e>>1)-(r>>1):i-=r>>1,a>=n?o=(n>>1)-(a>>1):o-=a>>1,b.css({left:i+"px",top:o+"px"})},0)})}e.loadingStylesheets.includes("jgraduate/css/jPicker.css")||e.loadingStylesheets.push("jgraduate/css/jPicker.css"),e.jPicker={List:[],Color:function t(n){r(this,t);var a=this;function i(e){for(var t=0;t<g.length;t++)g[t].call(a,a,e)}function o(e,t,n){var r=Boolean(t);if(r&&""===t.ahex&&(t.ahex="00000000"),!r){if(void 0!==e&&null!=e&&""!==e||(e="all"),null==l)return null;switch(e.toLowerCase()){case"ahex":return s.rgbaToHex({r:l,g:c,b:u,a:d});case"hex":return o("ahex").substring(0,6);case"all":return{r:l,g:c,b:u,a:d,h:h,s:f,v:p,hex:o.call(a,"hex"),ahex:o.call(a,"ahex")};default:for(var g={},v=0;v<e.length;v++)switch(e.charAt(v)){case"r":1===e.length?g=l:g.r=l;break;case"g":1===e.length?g=c:g.g=c;break;case"b":1===e.length?g=u:g.b=u;break;case"a":1===e.length?g=d:g.a=d;break;case"h":1===e.length?g=h:g.h=h;break;case"s":1===e.length?g=f:g.s=f;break;case"v":1===e.length?g=p:g.v=p}return e.length?g:o.call(a,"all")}}if(null==n||n!==a){null==e&&(e="");var m=!1;if(null==t)return null!=l&&(l=null,m=!0),null!=c&&(c=null,m=!0),null!=u&&(u=null,m=!0),null!=d&&(d=null,m=!0),null!=h&&(h=null,m=!0),null!=f&&(f=null,m=!0),null!=p&&(p=null,m=!0),void(m&&i.call(a,n||a));switch(e.toLowerCase()){case"ahex":case"hex":var _=s.hexToRgba(t&&(t.ahex||t.hex)||t||"none");o.call(a,"rgba",{r:_.r,g:_.g,b:_.b,a:"ahex"===e?_.a:null!=d?d:255},n);break;default:if(t&&(null!=t.ahex||null!=t.hex))return void o.call(a,"ahex",t.ahex||t.hex||"00000000",n);var y={},b=!1,x=!1;void 0===t.r||e.includes("r")||(e+="r"),void 0===t.g||e.includes("g")||(e+="g"),void 0===t.b||e.includes("b")||(e+="b"),void 0===t.a||e.includes("a")||(e+="a"),void 0===t.h||e.includes("h")||(e+="h"),void 0===t.s||e.includes("s")||(e+="s"),void 0===t.v||e.includes("v")||(e+="v");for(var w=0;w<e.length;w++)switch(e.charAt(w)){case"r":if(x)continue;b=!0,y.r=t&&t.r&&0|t.r||t&&0|t||0,y.r<0?y.r=0:y.r>255&&(y.r=255),l!==y.r&&(l=y.r,m=!0);break;case"g":if(x)continue;b=!0,y.g=t&&t.g&&0|t.g||t&&0|t||0,y.g<0?y.g=0:y.g>255&&(y.g=255),c!==y.g&&(c=y.g,m=!0);break;case"b":if(x)continue;b=!0,y.b=t&&t.b&&0|t.b||t&&0|t||0,y.b<0?y.b=0:y.b>255&&(y.b=255),u!==y.b&&(u=y.b,m=!0);break;case"a":y.a=t&&null!=t.a?0|t.a:null!=t?0|t:255,y.a<0?y.a=0:y.a>255&&(y.a=255),d!==y.a&&(d=y.a,m=!0);break;case"h":if(b)continue;x=!0,y.h=t&&t.h&&0|t.h||t&&0|t||0,y.h<0?y.h=0:y.h>360&&(y.h=360),h!==y.h&&(h=y.h,m=!0);break;case"s":if(b)continue;x=!0,y.s=t&&null!=t.s?0|t.s:null!=t?0|t:100,y.s<0?y.s=0:y.s>100&&(y.s=100),f!==y.s&&(f=y.s,m=!0);break;case"v":if(b)continue;x=!0,y.v=t&&null!=t.v?0|t.v:null!=t?0|t:100,y.v<0?y.v=0:y.v>100&&(y.v=100),p!==y.v&&(p=y.v,m=!0)}if(m){if(b){l=l||0,c=c||0,u=u||0;var S=s.rgbToHsv({r:l,g:c,b:u});h=S.h,f=S.s,p=S.v}else if(x){h=h||0,f=null!=f?f:100,p=null!=p?p:100;var k=s.hsvToRgb({h:h,s:f,v:p});l=k.r,c=k.g,u=k.b}d=null!=d?d:255,i.call(a,n||a)}}}}var l=void 0,c=void 0,u=void 0,d=void 0,h=void 0,f=void 0,p=void 0,g=[];e.extend(!0,a,{val:o,bind:function(e){"function"==typeof e&&g.push(e)},unbind:function(e){if("function"==typeof e)for(var t=void 0;t=g.includes(e);)g.splice(t,1)},destroy:function(){g=null}}),n&&(null!=n.ahex?o("ahex",n):null!=n.hex?o((null!=n.a?"a":"")+"hex",null!=n.a?{ahex:n.hex+s.intToHex(n.a)}:n):null!=n.r&&null!=n.g&&null!=n.b?o("rgb"+(null!=n.a?"a":""),n):null!=n.h&&null!=n.s&&null!=n.v&&o("hsv"+(null!=n.a?"a":""),n))},ColorMethods:{hexToRgba:function(e){if(""===e||"none"===e)return{r:null,g:null,b:null,a:null};var t="00",n="00",r="00",a="255";return 6===(e=this.validateHex(e)).length&&(e+="ff"),e.length>6?(t=e.substring(0,2),n=e.substring(2,4),r=e.substring(4,6),a=e.substring(6,e.length)):(e.length>4&&(t=e.substring(4,e.length),e=e.substring(0,4)),e.length>2&&(n=e.substring(2,e.length),e=e.substring(0,2)),e.length>0&&(r=e.substring(0,e.length))),{r:this.hexToInt(t),g:this.hexToInt(n),b:this.hexToInt(r),a:this.hexToInt(a)}},validateHex:function(e){return(e=e.toLowerCase().replace(/[^a-f0-9]/g,"")).length>8&&(e=e.substring(0,8)),e},rgbaToHex:function(e){return this.intToHex(e.r)+this.intToHex(e.g)+this.intToHex(e.b)+this.intToHex(e.a)},intToHex:function(e){var t=(0|e).toString(16);return 1===t.length&&(t="0"+t),t.toLowerCase()},hexToInt:function(e){return parseInt(e,16)},rgbToHsv:function(e){var t=e.r/255,n=e.g/255,r=e.b/255,a={h:0,s:0,v:0},i=0,o=0;t>=n&&t>=r?(o=t,i=n>r?r:n):n>=r&&n>=t?(o=n,i=t>r?r:t):(o=r,i=n>t?t:n),a.v=o,a.s=o?(o-i)/o:0;var s=void 0;return a.s?(s=o-i,a.h=t===o?(n-r)/s:n===o?2+(r-t)/s:4+(t-n)/s,a.h=parseInt(60*a.h),a.h<0&&(a.h+=360)):a.h=0,a.s=100*a.s|0,a.v=100*a.v|0,a},hsvToRgb:function(e){var t={r:0,g:0,b:0,a:100},n=e.h,r=e.s,a=e.v;if(0===r)t.r=t.g=t.b=0===a?0:255*a/100|0;else{360===n&&(n=0);var i=0|(n/=60),o=n-i,s=(a/=100)*(1-(r/=100)),l=a*(1-r*o),c=a*(1-r*(1-o));switch(i){case 0:t.r=a,t.g=c,t.b=s;break;case 1:t.r=l,t.g=a,t.b=s;break;case 2:t.r=s,t.g=a,t.b=c;break;case 3:t.r=s,t.g=l,t.b=a;break;case 4:t.r=c,t.g=s,t.b=a;break;case 5:t.r=a,t.g=s,t.b=l}t.r=255*t.r|0,t.g=255*t.g|0,t.b=255*t.b|0}return t}}};var a=e.jPicker,i=a.Color,o=a.List,s=a.ColorMethods;return e.fn.jPicker=function(r){var a=arguments;return this.each(function(){var l=this,c=e.extend(!0,{},e.fn.jPicker.defaults,r);"input"===e(l).get(0).nodeName.toLowerCase()&&(e.extend(!0,c,{window:{bindToInput:!0,expandable:!0,input:e(l)}}),""===e(l).val()?(c.color.active=new i({hex:null}),c.color.current=new i({hex:null})):s.validateHex(e(l).val())&&(c.color.active=new i({hex:e(l).val(),a:c.color.active.val("a")}),c.color.current=new i({hex:e(l).val(),a:c.color.active.val("a")}))),c.window.expandable?e(l).after('<span class="jPicker"><span class="Icon"><span class="Color">&nbsp;</span><span class="Alpha">&nbsp;</span><span class="Image" title="Click To Open Color Picker">&nbsp;</span><span class="Container">&nbsp;</span></span></span>'):c.window.liveUpdate=!1;var u=parseFloat(navigator.appVersion.split("MSIE")[1])<7&&document.body.filters;function d(e){var t=V.active,n=t.val("hex"),r=void 0,a=void 0;switch(c.color.mode=e,e){case"h":if(setTimeout(function(){g.call(l,F,"transparent"),m.call(l,z,0),_.call(l,z,100),m.call(l,q,260),_.call(l,q,100),g.call(l,H,"transparent"),m.call(l,W,0),_.call(l,W,100),m.call(l,X,260),_.call(l,X,100),m.call(l,Q,260),_.call(l,Q,100),m.call(l,K,260),_.call(l,K,100),m.call(l,$,260),_.call(l,$,100)},0),J.range("all",{minX:0,maxX:100,minY:0,maxY:100}),ee.range("rangeY",{minY:0,maxY:360}),null==t.val("ahex"))break;J.val("xy",{x:t.val("s"),y:100-t.val("v")},J),ee.val("y",360-t.val("h"),ee);break;case"s":if(setTimeout(function(){g.call(l,F,"transparent"),m.call(l,z,-260),m.call(l,q,-520),m.call(l,W,-260),m.call(l,X,-520),m.call(l,$,260),_.call(l,$,100)},0),J.range("all",{minX:0,maxX:360,minY:0,maxY:100}),ee.range("rangeY",{minY:0,maxY:100}),null==t.val("ahex"))break;J.val("xy",{x:t.val("h"),y:100-t.val("v")},J),ee.val("y",100-t.val("s"),ee);break;case"v":if(setTimeout(function(){g.call(l,F,"000000"),m.call(l,z,-780),m.call(l,q,260),g.call(l,H,n),m.call(l,W,-520),m.call(l,X,260),_.call(l,X,100),m.call(l,$,260),_.call(l,$,100)},0),J.range("all",{minX:0,maxX:360,minY:0,maxY:100}),ee.range("rangeY",{minY:0,maxY:100}),null==t.val("ahex"))break;J.val("xy",{x:t.val("h"),y:100-t.val("s")},J),ee.val("y",100-t.val("v"),ee);break;case"r":if(r=-1040,a=-780,J.range("all",{minX:0,maxX:255,minY:0,maxY:255}),ee.range("rangeY",{minY:0,maxY:255}),null==t.val("ahex"))break;J.val("xy",{x:t.val("b"),y:255-t.val("g")},J),ee.val("y",255-t.val("r"),ee);break;case"g":if(r=-1560,a=-1820,J.range("all",{minX:0,maxX:255,minY:0,maxY:255}),ee.range("rangeY",{minY:0,maxY:255}),null==t.val("ahex"))break;J.val("xy",{x:t.val("b"),y:255-t.val("r")},J),ee.val("y",255-t.val("g"),ee);break;case"b":if(r=-2080,a=-2860,J.range("all",{minX:0,maxX:255,minY:0,maxY:255}),ee.range("rangeY",{minY:0,maxY:255}),null==t.val("ahex"))break;J.val("xy",{x:t.val("r"),y:255-t.val("g")},J),ee.val("y",255-t.val("b"),ee);break;case"a":if(setTimeout(function(){g.call(l,F,"transparent"),m.call(l,z,-260),m.call(l,q,-520),m.call(l,W,260),m.call(l,X,260),_.call(l,X,100),m.call(l,$,0),_.call(l,$,100)},0),J.range("all",{minX:0,maxX:360,minY:0,maxY:100}),ee.range("rangeY",{minY:0,maxY:255}),null==t.val("ahex"))break;J.val("xy",{x:t.val("h"),y:100-t.val("v")},J),ee.val("y",255-t.val("a"),ee);break;default:throw new Error("Invalid Mode")}switch(e){case"h":break;case"s":case"v":case"a":setTimeout(function(){_.call(l,z,100),_.call(l,W,100),m.call(l,Q,260),_.call(l,Q,100),m.call(l,K,260),_.call(l,K,100)},0);break;case"r":case"g":case"b":setTimeout(function(){g.call(l,F,"transparent"),g.call(l,H,"transparent"),_.call(l,W,100),_.call(l,z,100),m.call(l,z,r),m.call(l,q,r-260),m.call(l,W,a-780),m.call(l,X,a-520),m.call(l,Q,a),m.call(l,K,a-260),m.call(l,$,260),_.call(l,$,100)},0)}null!=t.val("ahex")&&h.call(l,t)}function h(e,t){(null==t||t!==ee&&t!==J)&&function(e,t){if(t!==J)switch(c.color.mode){case"h":var n=e.val("sv");J.val("xy",{x:null!=n?n.s:100,y:100-(null!=n?n.v:100)},t);break;case"s":case"a":var r=e.val("hv");J.val("xy",{x:r&&r.h||0,y:100-(null!=r?r.v:100)},t);break;case"v":var a=e.val("hs");J.val("xy",{x:a&&a.h||0,y:100-(null!=a?a.s:100)},t);break;case"r":var i=e.val("bg");J.val("xy",{x:i&&i.b||0,y:255-(i&&i.g||0)},t);break;case"g":var o=e.val("br");J.val("xy",{x:o&&o.b||0,y:255-(o&&o.r||0)},t);break;case"b":var s=e.val("rg");J.val("xy",{x:s&&s.r||0,y:255-(s&&s.g||0)},t)}if(t!==ee)switch(c.color.mode){case"h":ee.val("y",360-(e.val("h")||0),t);break;case"s":var l=e.val("s");ee.val("y",100-(null!=l?l:100),t);break;case"v":var u=e.val("v");ee.val("y",100-(null!=u?u:100),t);break;case"r":ee.val("y",255-(e.val("r")||0),t);break;case"g":ee.val("y",255-(e.val("g")||0),t);break;case"b":ee.val("y",255-(e.val("b")||0),t);break;case"a":var d=e.val("a");ee.val("y",255-(null!=d?d:255),t)}}.call(l,e,t),setTimeout(function(){(function(e){try{var t=e.val("all");ne.css({backgroundColor:t&&"#"+t.hex||"transparent"}),_.call(l,ne,t&&Math.precision(100*t.a/255,4)||0)}catch(e){}}).call(l,e),function(e){switch(c.color.mode){case"h":g.call(l,F,new i({h:e.val("h")||0,s:100,v:100}).val("hex"));break;case"s":case"a":var t=e.val("s");_.call(l,q,100-(null!=t?t:100));break;case"v":var n=e.val("v");_.call(l,z,null!=n?n:100);break;case"r":_.call(l,q,Math.precision((e.val("r")||0)/255*100,4));break;case"g":_.call(l,q,Math.precision((e.val("g")||0)/255*100,4));break;case"b":_.call(l,q,Math.precision((e.val("b")||0)/255*100))}var r=e.val("a");_.call(l,Y,Math.precision(100*(255-(r||0))/255,4))}.call(l,e),function(e){switch(c.color.mode){case"h":var t=e.val("a");_.call(l,Z,Math.precision(100*(255-(t||0))/255,4));break;case"s":var n=e.val("hva"),r=new i({h:n&&n.h||0,s:100,v:null!=n?n.v:100});g.call(l,H,r.val("hex")),_.call(l,X,100-(null!=n?n.v:100)),_.call(l,Z,Math.precision(100*(255-(n&&n.a||0))/255,4));break;case"v":var a=e.val("hsa"),o=new i({h:a&&a.h||0,s:null!=a?a.s:100,v:100});g.call(l,H,o.val("hex")),_.call(l,Z,Math.precision(100*(255-(a&&a.a||0))/255,4));break;case"r":case"g":case"b":var s=e.val("rgba"),u=0,d=0;"r"===c.color.mode?(u=s&&s.b||0,d=s&&s.g||0):"g"===c.color.mode?(u=s&&s.b||0,d=s&&s.r||0):"b"===c.color.mode&&(u=s&&s.r||0,d=s&&s.g||0);var h=d>u?u:d;_.call(l,X,u>d?Math.precision((u-d)/(255-d)*100,4):0),_.call(l,Q,d>u?Math.precision((d-u)/(255-u)*100,4):0),_.call(l,K,Math.precision(h/255*100,4)),_.call(l,Z,Math.precision(100*(255-(s&&s.a||0))/255,4));break;case"a":var f=e.val("a");g.call(l,H,e.val("hex")||"000000"),_.call(l,Z,null!=f?0:100),_.call(l,$,null!=f?100:0)}}.call(l,e)},0)}function f(e,t){var n=V.active;if(t===J||null!=n.val()){var r=e.val("all");switch(c.color.mode){case"h":n.val("sv",{s:r.x,v:100-r.y},t);break;case"s":case"a":n.val("hv",{h:r.x,v:100-r.y},t);break;case"v":n.val("hs",{h:r.x,s:100-r.y},t);break;case"r":n.val("gb",{g:255-r.y,b:r.x},t);break;case"g":n.val("rb",{r:255-r.y,b:r.x},t);break;case"b":n.val("rg",{r:r.x,g:255-r.y},t)}}}function p(e,t){var n=V.active;if(t===ee||null!=n.val())switch(c.color.mode){case"h":n.val("h",{h:360-e.val("y")},t);break;case"s":n.val("s",{s:100-e.val("y")},t);break;case"v":n.val("v",{v:100-e.val("y")},t);break;case"r":n.val("r",{r:255-e.val("y")},t);break;case"g":n.val("g",{g:255-e.val("y")},t);break;case"b":n.val("b",{b:255-e.val("y")},t);break;case"a":n.val("a",255-e.val("y"),t)}}function g(e,t){e.css({backgroundColor:t&&6===t.length&&"#"+t||"transparent"})}function v(e,t){u&&(t.includes("AlphaBar.png")||t.includes("Bars.png")||t.includes("Maps.png"))?(e.attr("pngSrc",t),e.css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+t+"', sizingMethod='scale')"})):e.css({backgroundImage:"url('"+t+"')"})}function m(e,t){e.css({top:t+"px"})}function _(e,t){if(e.css({visibility:t>0?"visible":"hidden"}),t>0&&t<100)if(u){var n=e.attr("pngSrc");null!=n&&(n.includes("AlphaBar.png")||n.includes("Bars.png")||n.includes("Maps.png"))?e.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+n+"', sizingMethod='scale') progid:DXImageTransform.Microsoft.Alpha(opacity="+t+")"}):e.css({opacity:Math.precision(t/100,4)})}else e.css({opacity:Math.precision(t/100,4)});else if(0===t||100===t)if(u){var r=e.attr("pngSrc");null!=r&&(r.includes("AlphaBar.png")||r.includes("Bars.png")||r.includes("Maps.png"))?e.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+r+"', sizingMethod='scale')"}):e.css({opacity:""})}else e.css({opacity:""})}function y(){V.active.val("ahex",V.current.val("ahex"))}function b(t){e(this).parents("tbody:first").find('input:radio[value!="'+t.target.value+'"]').removeAttr("checked"),d.call(l,t.target.value)}function x(){y.call(l)}function w(){y.call(l),c.window.expandable&&N.call(l),"function"==typeof fe&&fe.call(l,V.active,ie)}function S(){(function(){V.current.val("ahex",V.active.val("ahex"))}).call(l),c.window.expandable&&N.call(l),"function"==typeof de&&de.call(l,V.active,ae)}function k(){T.call(l)}function C(e,t){var n=e.val("hex");re.css({backgroundColor:n&&"#"+n||"transparent"}),_.call(l,re,Math.precision(100*(e.val("a")||0)/255,4))}function A(e,t){var n=e.val("hex"),r=e.val("va");se.css({backgroundColor:n&&"#"+n||"transparent"}),_.call(l,le,Math.precision(100*(255-(r&&r.a||0))/255,4)),c.window.bindToInput&&c.window.updateInputColor&&c.window.input.css({backgroundColor:n&&"#"+n||"transparent",color:null==r||r.v>75?"#000000":"#ffffff"})}function E(t){j=parseInt(U.css("left")),R=parseInt(U.css("top")),B=t.pageX,D=t.pageY,e(document).bind("mousemove",P).bind("mouseup",G),t.preventDefault()}function P(t){return U.css({left:j-(B-t.pageX)+"px",top:R-(D-t.pageY)+"px"}),c.window.expandable&&!e.support.boxModel&&U.prev().css({left:U.css("left"),top:U.css("top")}),t.stopPropagation(),t.preventDefault(),!1}function G(t){return e(document).unbind("mousemove",P).unbind("mouseup",G),t.stopPropagation(),t.preventDefault(),!1}function I(t){return t.preventDefault(),t.stopPropagation(),V.active.val("ahex",e(this).attr("title")||null,t.target),!1}function T(){function t(){if(c.window.expandable&&!e.support.boxModel){var t=U.find("table:first");U.before("<iframe/>"),U.prev().css({width:t.width(),height:U.height(),opacity:0,position:"absolute",left:U.css("left"),top:U.css("top")})}}switch(V.current.val("ahex",V.active.val("ahex")),c.window.expandable&&(e(document.body).children("div.jPicker.Container").css({zIndex:10}),U.css({zIndex:20})),c.window.effects.type){case"fade":U.fadeIn(c.window.effects.speed.show,t);break;case"slide":U.slideDown(c.window.effects.speed.show,t);break;case"show":default:U.show(c.window.effects.speed.show,t)}}function N(){function t(){c.window.expandable&&U.css({zIndex:10}),c.window.expandable&&!e.support.boxModel&&U.prev().remove()}switch(c.window.effects.type){case"fade":U.fadeOut(c.window.effects.speed.hide,t);break;case"slide":U.slideUp(c.window.effects.speed.hide,t);break;case"show":default:U.hide(c.window.effects.speed.hide,t)}}function L(){var r=c.window,a=r.expandable?e(l).next().find(".Container:first"):null;(U=r.expandable?e("<div/>"):e(l)).addClass("jPicker Container"),r.expandable&&U.hide(),U.get(0).onselectstart=function(e){if("input"!==e.target.nodeName.toLowerCase())return!1};var o=V.active.val("all");r.alphaPrecision<0?r.alphaPrecision=0:r.alphaPrecision>2&&(r.alphaPrecision=2);var s='<table class="jPicker" cellpadding="0" cellspacing="0"><tbody>'+(r.expandable?'<tr><td class="Move" colspan="5">&nbsp;</td></tr>':"")+'<tr><td rowspan="9"><h2 class="Title">'+(r.title||O.text.title)+'</h2><div class="Map"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><img src="'+M.clientPath+M.colorMap.arrow.file+'" class="Arrow"/></div></td><td rowspan="9"><div class="Bar"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><span class="Map4">&nbsp;</span><span class="Map5">&nbsp;</span><span class="Map6">&nbsp;</span><img src="'+M.clientPath+M.colorBar.arrow.file+'" class="Arrow"/></div></td><td colspan="2" class="Preview">'+O.text.newColor+'<div><span class="Active" title="'+O.tooltips.colors.newColor+'">&nbsp;</span><span class="Current" title="'+O.tooltips.colors.currentColor+'">&nbsp;</span></div>'+O.text.currentColor+'</td><td rowspan="9" class="Button"><input type="button" class="Ok" value="'+O.text.ok+'" title="'+O.tooltips.buttons.ok+'"/><input type="button" class="Cancel" value="'+O.text.cancel+'" title="'+O.tooltips.buttons.cancel+'"/><hr/><div class="Grid">&nbsp;</div></td></tr><tr class="Hue"><td class="Radio"><label title="'+O.tooltips.hue.radio+'"><input type="radio" value="h"'+("h"===c.color.mode?' checked="checked"':"")+'/>H:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=o?o.h:"")+'" title="'+O.tooltips.hue.textbox+'"/>&nbsp;&deg;</td></tr><tr class="Saturation"><td class="Radio"><label title="'+O.tooltips.saturation.radio+'"><input type="radio" value="s"'+("s"===c.color.mode?' checked="checked"':"")+'/>S:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=o?o.s:"")+'" title="'+O.tooltips.saturation.textbox+'"/>&nbsp;%</td></tr><tr class="Value"><td class="Radio"><label title="'+O.tooltips.value.radio+'"><input type="radio" value="v"'+("v"===c.color.mode?' checked="checked"':"")+'/>V:</label><br/><br/></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=o?o.v:"")+'" title="'+O.tooltips.value.textbox+'"/>&nbsp;%<br/><br/></td></tr><tr class="Red"><td class="Radio"><label title="'+O.tooltips.red.radio+'"><input type="radio" value="r"'+("r"===c.color.mode?' checked="checked"':"")+'/>R:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=o?o.r:"")+'" title="'+O.tooltips.red.textbox+'"/></td></tr><tr class="Green"><td class="Radio"><label title="'+O.tooltips.green.radio+'"><input type="radio" value="g"'+("g"===c.color.mode?' checked="checked"':"")+'/>G:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=o?o.g:"")+'" title="'+O.tooltips.green.textbox+'"/></td></tr><tr class="Blue"><td class="Radio"><label title="'+O.tooltips.blue.radio+'"><input type="radio" value="b"'+("b"===c.color.mode?' checked="checked"':"")+'/>B:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=o?o.b:"")+'" title="'+O.tooltips.blue.textbox+'"/></td></tr><tr class="Alpha"><td class="Radio">'+(r.alphaSupport?'<label title="'+O.tooltips.alpha.radio+'"><input type="radio" value="a"'+("a"===c.color.mode?' checked="checked"':"")+"/>A:</label>":"&nbsp;")+'</td><td class="Text">'+(r.alphaSupport?'<input type="text" maxlength="'+(3+r.alphaPrecision)+'" value="'+(null!=o?Math.precision(100*o.a/255,r.alphaPrecision):"")+'" title="'+O.tooltips.alpha.textbox+'"/>&nbsp;%':"&nbsp;")+'</td></tr><tr class="Hex"><td colspan="2" class="Text"><label title="'+O.tooltips.hex.textbox+'">#:<input type="text" maxlength="6" class="Hex" value="'+(null!=o?o.hex:"")+'"/></label>'+(r.alphaSupport?'<input type="text" maxlength="2" class="AHex" value="'+(null!=o?o.ahex.substring(6):"")+'" title="'+O.tooltips.hex.alpha+'"/></td>':"&nbsp;")+"</tr></tbody></table>";r.expandable?(U.html(s),e(document.body).children("div.jPicker.Container").length?e(document.body).children("div.jPicker.Container:last").after(U):e(document.body).prepend(U),U.mousedown(function(){e(document.body).children("div.jPicker.Container").css({zIndex:10}),U.css({zIndex:20})}),U.css({left:"left"===r.position.x?a.offset().left-530-("center"===r.position.y?25:0)+"px":"center"===r.position.x?a.offset().left-260+"px":"right"===r.position.x?a.offset().left-10+("center"===r.position.y?25:0)+"px":"screenCenter"===r.position.x?(e(document).width()>>1)-260+"px":a.offset().left+parseInt(r.position.x)+"px",position:"absolute",top:"top"===r.position.y?a.offset().top-312+"px":"center"===r.position.y?a.offset().top-156+"px":"bottom"===r.position.y?a.offset().top+25+"px":a.offset().top+parseInt(r.position.y)+"px"})):(U=e(l)).html(s);var u=U.find("tbody:first");F=u.find("div.Map:first"),H=u.find("div.Bar:first");var g=F.find("span"),m=H.find("span");z=g.filter(".Map1:first"),q=g.filter(".Map2:first"),Y=g.filter(".Map3:first"),W=m.filter(".Map1:first"),X=m.filter(".Map2:first"),Q=m.filter(".Map3:first"),K=m.filter(".Map4:first"),Z=m.filter(".Map5:first"),$=m.filter(".Map6:first"),(J=new n(F,{map:{width:M.colorMap.width,height:M.colorMap.height},arrow:{image:M.clientPath+M.colorMap.arrow.file,width:M.colorMap.arrow.width,height:M.colorMap.arrow.height}})).bind(f),(ee=new n(H,{map:{width:M.colorBar.width,height:M.colorBar.height},arrow:{image:M.clientPath+M.colorBar.arrow.file,width:M.colorBar.arrow.width,height:M.colorBar.arrow.height}})).bind(p),te=new function(t,n,r,a){var i=this,o=t.find("td.Text input");function s(e){if(""!==e.target.value||e.target===b.get(0)||(null==r||e.target===r.get(0))&&null!=r){if(!u(e))return e;switch(e.target){case f.get(0):switch(e.keyCode){case 38:return f.val(d.call(i,1+(f.val()<<0),0,255)),n.val("r",f.val(),e.target),!1;case 40:return f.val(d.call(i,(f.val()<<0)-1,0,255)),n.val("r",f.val(),e.target),!1}break;case p.get(0):switch(e.keyCode){case 38:return p.val(d.call(i,1+(p.val()<<0),0,255)),n.val("g",p.val(),e.target),!1;case 40:return p.val(d.call(i,(p.val()<<0)-1,0,255)),n.val("g",p.val(),e.target),!1}break;case g.get(0):switch(e.keyCode){case 38:return g.val(d.call(i,1+(g.val()<<0),0,255)),n.val("b",g.val(),e.target),!1;case 40:return g.val(d.call(i,(g.val()<<0)-1,0,255)),n.val("b",g.val(),e.target),!1}break;case v&&v.get(0):switch(e.keyCode){case 38:return v.val(d.call(i,parseFloat(v.val())+1,0,100)),n.val("a",Math.precision(255*v.val()/100,a),e.target),!1;case 40:return v.val(d.call(i,parseFloat(v.val())-1,0,100)),n.val("a",Math.precision(255*v.val()/100,a),e.target),!1}break;case m.get(0):switch(e.keyCode){case 38:return m.val(d.call(i,1+(m.val()<<0),0,360)),n.val("h",m.val(),e.target),!1;case 40:return m.val(d.call(i,(m.val()<<0)-1,0,360)),n.val("h",m.val(),e.target),!1}break;case _.get(0):switch(e.keyCode){case 38:return _.val(d.call(i,1+(_.val()<<0),0,100)),n.val("s",_.val(),e.target),!1;case 40:return _.val(d.call(i,(_.val()<<0)-1,0,100)),n.val("s",_.val(),e.target),!1}break;case y.get(0):switch(e.keyCode){case 38:return y.val(d.call(i,1+(y.val()<<0),0,100)),n.val("v",y.val(),e.target),!1;case 40:return y.val(d.call(i,(y.val()<<0)-1,0,100)),n.val("v",y.val(),e.target),!1}}}}function l(e){if(""!==e.target.value||e.target===b.get(0)||(null==r||e.target===r.get(0))&&null!=r){if(!u(e))return e;switch(e.target){case f.get(0):f.val(d.call(i,f.val(),0,255)),n.val("r",f.val(),e.target);break;case p.get(0):p.val(d.call(i,p.val(),0,255)),n.val("g",p.val(),e.target);break;case g.get(0):g.val(d.call(i,g.val(),0,255)),n.val("b",g.val(),e.target);break;case v&&v.get(0):v.val(d.call(i,v.val(),0,100)),n.val("a",Math.precision(255*v.val()/100,a),e.target);break;case m.get(0):m.val(d.call(i,m.val(),0,360)),n.val("h",m.val(),e.target);break;case _.get(0):_.val(d.call(i,_.val(),0,100)),n.val("s",_.val(),e.target);break;case y.get(0):y.val(d.call(i,y.val(),0,100)),n.val("v",y.val(),e.target);break;case b.get(0):b.val(b.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6)),r&&r.val(b.val()),n.val("hex",""!==b.val()?b.val():null,e.target);break;case r&&r.get(0):r.val(r.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6)),b.val(r.val()),n.val("hex",""!==r.val()?r.val():null,e.target);break;case x&&x.get(0):x.val(x.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,2)),n.val("a",null!=x.val()?parseInt(x.val(),16):null,e.target)}}}function c(e){if(null!=n.val())switch(e.target){case f.get(0):f.val(n.val("r"));break;case p.get(0):p.val(n.val("g"));break;case g.get(0):g.val(n.val("b"));break;case v&&v.get(0):v.val(Math.precision(100*n.val("a")/255,a));break;case m.get(0):m.val(n.val("h"));break;case _.get(0):_.val(n.val("s"));break;case y.get(0):y.val(n.val("v"));break;case b.get(0):case r&&r.get(0):b.val(n.val("hex")),r&&r.val(n.val("hex"));break;case x&&x.get(0):x.val(n.val("ahex").substring(6))}}function u(e){switch(e.keyCode){case 9:case 16:case 29:case 37:case 39:return!1;case"c".charCodeAt():case"v".charCodeAt():if(e.ctrlKey)return!1}return!0}function d(e,t,n){return""===e||isNaN(e)?t:e>n?n:e<t?t:e}function h(e,t){var n=e.val("all");t!==f.get(0)&&f.val(null!=n?n.r:""),t!==p.get(0)&&p.val(null!=n?n.g:""),t!==g.get(0)&&g.val(null!=n?n.b:""),v&&t!==v.get(0)&&v.val(null!=n?Math.precision(100*n.a/255,a):""),t!==m.get(0)&&m.val(null!=n?n.h:""),t!==_.get(0)&&_.val(null!=n?n.s:""),t!==y.get(0)&&y.val(null!=n?n.v:""),t!==b.get(0)&&(r&&t!==r.get(0)||!r)&&b.val(null!=n?n.hex:""),r&&t!==r.get(0)&&t!==b.get(0)&&r.val(null!=n?n.hex:""),x&&t!==x.get(0)&&x.val(null!=n?n.ahex.substring(6):"")}var f=o.eq(3),p=o.eq(4),g=o.eq(5),v=o.length>7?o.eq(6):null,m=o.eq(0),_=o.eq(1),y=o.eq(2),b=o.eq(o.length>7?7:6),x=o.length>7?o.eq(8):null;e.extend(!0,i,{destroy:function(){f.add(p).add(g).add(v).add(m).add(_).add(y).add(b).add(r).add(x).unbind("keyup",l).unbind("blur",c),f.add(p).add(g).add(v).add(m).add(_).add(y).unbind("keydown",s),n.unbind(h),f=null,p=null,g=null,v=null,m=null,_=null,y=null,b=null,x=null}}),f.add(p).add(g).add(v).add(m).add(_).add(y).add(b).add(r).add(x).bind("keyup",l).bind("blur",c),f.add(p).add(g).add(v).add(m).add(_).add(y).bind("keydown",s),n.bind(h)}(u,V.active,r.expandable&&r.bindToInput?r.input:null,r.alphaPrecision);var y=null!=o?o.hex:null,P=u.find(".Preview"),G=u.find(".Button");if(ne=P.find(".Active:first").css({backgroundColor:y&&"#"+y||"transparent"}),re=P.find(".Current:first").css({backgroundColor:y&&"#"+y||"transparent"}).bind("click",x),_.call(l,re,Math.precision(100*V.current.val("a"))/255,4),ae=G.find(".Ok:first").bind("click",S),ie=G.find(".Cancel:first").bind("click",w),oe=G.find(".Grid:first"),setTimeout(function(){v.call(l,z,M.clientPath+"Maps.png"),v.call(l,q,M.clientPath+"Maps.png"),v.call(l,Y,M.clientPath+"map-opacity.png"),v.call(l,W,M.clientPath+"Bars.png"),v.call(l,X,M.clientPath+"Bars.png"),v.call(l,Q,M.clientPath+"Bars.png"),v.call(l,K,M.clientPath+"Bars.png"),v.call(l,Z,M.clientPath+"bar-opacity.png"),v.call(l,$,M.clientPath+"AlphaBar.png"),v.call(l,P.find("div:first"),M.clientPath+"preview-opacity.png")},0),u.find("td.Radio input").bind("click",b),V.quickList&&V.quickList.length>0){for(var N="",L=0;L<V.quickList.length;L++){"string"===t(V.quickList[L]).toString().toLowerCase()&&(V.quickList[L]=new i({hex:V.quickList[L]}));var j=V.quickList[L].val("a"),R=V.quickList[L].val("ahex");!r.alphaSupport&&R&&(R=R.substring(0,6)+"ff");var B=V.quickList[L].val("hex");R||(R="00000000"),N+='<span class="QuickColor"'+(R&&' title="#'+R+'"'||"none")+' style="background-color:'+(B&&"#"+B||"")+";"+(B?"":"background-image:url("+M.clientPath+"NoColor.png)")+(r.alphaSupport&&j&&j<255?";opacity:"+Math.precision(j/255,4)+";filter:Alpha(opacity="+Math.precision(j/2.55,4)+")":"")+'">&nbsp;</span>'}v.call(l,oe,M.clientPath+"bar-opacity.png"),oe.html(N),oe.find(".QuickColor").click(I)}d.call(l,c.color.mode),V.active.bind(h),"function"==typeof he&&V.active.bind(he),V.current.bind(C),r.expandable?(l.icon=a.parents(".Icon:first"),se=l.icon.find(".Color:first").css({backgroundColor:y&&"#"+y||"transparent"}),le=l.icon.find(".Alpha:first"),v.call(l,le,M.clientPath+"bar-opacity.png"),_.call(l,le,Math.precision(100*(255-(null!=o?o.a:0))/255,4)),ce=l.icon.find(".Image:first").css({backgroundImage:"url('"+M.clientPath+M.picker.file+"')"}).bind("click",k),r.bindToInput&&r.updateInputColor&&r.input.css({backgroundColor:y&&"#"+y||"transparent",color:null==o||o.v>75?"#000000":"#ffffff"}),ue=u.find(".Move:first").bind("mousedown",E),V.active.bind(A)):T.call(l)}var M=c.images,O=c.localization,V={active:"string"===t(c.color.active).toString().toLowerCase()?new i({ahex:!c.window.alphaSupport&&c.color.active?c.color.active.substring(0,6)+"ff":c.color.active}):new i({ahex:!c.window.alphaSupport&&c.color.active.val("ahex")?c.color.active.val("ahex").substring(0,6)+"ff":c.color.active.val("ahex")}),current:"string"===t(c.color.active).toString().toLowerCase()?new i({ahex:!c.window.alphaSupport&&c.color.active?c.color.active.substring(0,6)+"ff":c.color.active}):new i({ahex:!c.window.alphaSupport&&c.color.active.val("ahex")?c.color.active.val("ahex").substring(0,6)+"ff":c.color.active.val("ahex")}),quickList:c.color.quickList},j=null,R=null,B=null,D=null,U=null,F=null,H=null,z=null,q=null,Y=null,W=null,X=null,Q=null,K=null,Z=null,$=null,J=null,ee=null,te=null,ne=null,re=null,ae=null,ie=null,oe=null,se=null,le=null,ce=null,ue=null,de="function"==typeof a[1]?a[1]:null,he="function"==typeof a[2]?a[2]:null,fe="function"==typeof a[3]?a[3]:null;e.extend(!0,l,{commitCallback:de,liveCallback:he,cancelCallback:fe,color:V,show:T,hide:N,destroy:function(){U.find("td.Radio input").unbind("click",b),re.unbind("click",x),ie.unbind("click",w),ae.unbind("click",S),c.window.expandable&&(ce.unbind("click",k),ue.unbind("mousedown",E),l.icon=null),U.find(".QuickColor").unbind("click",I),F=null,H=null,z=null,q=null,Y=null,W=null,X=null,Q=null,K=null,Z=null,$=null,J.destroy(),J=null,ee.destroy(),ee=null,te.destroy(),te=null,ne=null,re=null,ae=null,ie=null,oe=null,de=null,fe=null,he=null,U.html("");for(var e=0;e<o.length;e++)o[e]===l&&o.splice(e,1)}}),o.push(l),setTimeout(function(){L.call(l)},0)})},e.fn.jPicker.defaults={window:{title:null,effects:{type:"slide",speed:{show:"slow",hide:"fast"}},position:{x:"screenCenter",y:"top"},expandable:!1,liveUpdate:!0,alphaSupport:!1,alphaPrecision:0,updateInputColor:!0},color:{mode:"h",active:new i({ahex:"#ffcc00ff"}),quickList:[new i({h:360,s:33,v:100}),new i({h:360,s:66,v:100}),new i({h:360,s:100,v:100}),new i({h:360,s:100,v:75}),new i({h:360,s:100,v:50}),new i({h:180,s:0,v:100}),new i({h:30,s:33,v:100}),new i({h:30,s:66,v:100}),new i({h:30,s:100,v:100}),new i({h:30,s:100,v:75}),new i({h:30,s:100,v:50}),new i({h:180,s:0,v:90}),new i({h:60,s:33,v:100}),new i({h:60,s:66,v:100}),new i({h:60,s:100,v:100}),new i({h:60,s:100,v:75}),new i({h:60,s:100,v:50}),new i({h:180,s:0,v:80}),new i({h:90,s:33,v:100}),new i({h:90,s:66,v:100}),new i({h:90,s:100,v:100}),new i({h:90,s:100,v:75}),new i({h:90,s:100,v:50}),new i({h:180,s:0,v:70}),new i({h:120,s:33,v:100}),new i({h:120,s:66,v:100}),new i({h:120,s:100,v:100}),new i({h:120,s:100,v:75}),new i({h:120,s:100,v:50}),new i({h:180,s:0,v:60}),new i({h:150,s:33,v:100}),new i({h:150,s:66,v:100}),new i({h:150,s:100,v:100}),new i({h:150,s:100,v:75}),new i({h:150,s:100,v:50}),new i({h:180,s:0,v:50}),new i({h:180,s:33,v:100}),new i({h:180,s:66,v:100}),new i({h:180,s:100,v:100}),new i({h:180,s:100,v:75}),new i({h:180,s:100,v:50}),new i({h:180,s:0,v:40}),new i({h:210,s:33,v:100}),new i({h:210,s:66,v:100}),new i({h:210,s:100,v:100}),new i({h:210,s:100,v:75}),new i({h:210,s:100,v:50}),new i({h:180,s:0,v:30}),new i({h:240,s:33,v:100}),new i({h:240,s:66,v:100}),new i({h:240,s:100,v:100}),new i({h:240,s:100,v:75}),new i({h:240,s:100,v:50}),new i({h:180,s:0,v:20}),new i({h:270,s:33,v:100}),new i({h:270,s:66,v:100}),new i({h:270,s:100,v:100}),new i({h:270,s:100,v:75}),new i({h:270,s:100,v:50}),new i({h:180,s:0,v:10}),new i({h:300,s:33,v:100}),new i({h:300,s:66,v:100}),new i({h:300,s:100,v:100}),new i({h:300,s:100,v:75}),new i({h:300,s:100,v:50}),new i({h:180,s:0,v:0}),new i({h:330,s:33,v:100}),new i({h:330,s:66,v:100}),new i({h:330,s:100,v:100}),new i({h:330,s:100,v:75}),new i({h:330,s:100,v:50}),new i]},images:{clientPath:"/jPicker/images/",colorMap:{width:256,height:256,arrow:{file:"mappoint.gif",width:15,height:15}},colorBar:{width:20,height:256,arrow:{file:"rangearrows.gif",width:20,height:7}},picker:{file:"picker.gif",width:25,height:24}},localization:{text:{title:"Drag Markers To Pick A Color",newColor:"new",currentColor:"current",ok:"OK",cancel:"Cancel"},tooltips:{colors:{newColor:"New Color - Press &ldquo;OK&rdquo; To Commit",currentColor:"Click To Revert To Original Color"},buttons:{ok:"Commit To This Color Selection",cancel:"Cancel And Revert To Original Color"},hue:{radio:"Set To &ldquo;Hue&rdquo; Color Mode",textbox:"Enter A &ldquo;Hue&rdquo; Value (0-360&deg;)"},saturation:{radio:"Set To &ldquo;Saturation&rdquo; Color Mode",textbox:"Enter A &ldquo;Saturation&rdquo; Value (0-100%)"},value:{radio:"Set To &ldquo;Value&rdquo; Color Mode",textbox:"Enter A &ldquo;Value&rdquo; Value (0-100%)"},red:{radio:"Set To &ldquo;Red&rdquo; Color Mode",textbox:"Enter A &ldquo;Red&rdquo; Value (0-255)"},green:{radio:"Set To &ldquo;Green&rdquo; Color Mode",textbox:"Enter A &ldquo;Green&rdquo; Value (0-255)"},blue:{radio:"Set To &ldquo;Blue&rdquo; Color Mode",textbox:"Enter A &ldquo;Blue&rdquo; Value (0-255)"},alpha:{radio:"Set To &ldquo;Alpha&rdquo; Color Mode",textbox:"Enter A &ldquo;Alpha&rdquo; Value (0-100)"},hex:{textbox:"Enter A &ldquo;Hex&rdquo; Color Value (#000000-#ffffff)",alpha:"Enter A &ldquo;Alpha&rdquo; Value (#00-#ff)"}}}},e}].reduce(function(e,t){return t(e)},jQuery);sr.loadingStylesheets.includes("svg-editor.css")||sr.loadingStylesheets.push("svg-editor.css");sr.loadingStylesheets.some(function(e){return!Array.isArray(e)||"images/logo.png"!==e[0]})&&sr.loadingStylesheets.push(["images/logo.png",{favicon:!0}]);var lr={tool_scale:1,exportWindowCt:0,langChanged:!1,showSaveWarning:!1,storagePromptClosed:!1},cr=[],ur={lang:"",iconsize:"",bkgd_color:"#FFF",bkgd_url:"",img_save:"embed",save_notice_done:!1,export_notice_done:!1},dr=["ext-overview_window.js","ext-markers.js","ext-connector.js","ext-eyedropper.js","ext-shapes.js","ext-imagelib.js","ext-grid.js","ext-polygon.js","ext-star.js","ext-panning.js","ext-storage.js"],hr={canvasName:"default",canvas_expansion:3,initFill:{color:"FF0000",opacity:1},initStroke:{width:5,color:"000000",opacity:1},text:{stroke_width:0,font_size:24,font_family:"serif"},initOpacity:1,colorPickerCSS:null,initTool:"select",exportWindowType:"new",wireframe:!1,showlayers:!1,no_save_warning:!1,imgPath:"images/",langPath:"locale/",extPath:"extensions/",canvgPath:"canvg/",jspdfPath:"jspdf/",extIconsPath:"extensions/",jGraduatePath:"jgraduate/images/",dimensions:[640,480],gridSnapping:!1,gridColor:"#000",baseUnit:"px",snappingStep:10,showRulers:!0,preventAllURLConfig:!1,preventURLContentLoading:!1,lockExtensions:!1,noDefaultExtensions:!1,showGrid:!1,noStorageOnLoad:!1,forceStorage:!1,emptyStorageOnDecline:!1},fr=lr.uiStrings={},pr=void 0,gr=void 0,vr=!1,mr=!1,_r=!1,yr={},br={extensions:[],stylesheets:[],allowedOrigins:[]};function xr(e,t){var n=!1!==pr.setSvgString(e);t=t||sr.noop,n?t(!0):sr.alert(fr.notification.errorLoadingSVG,function(){t(!1)})}return sr.pref=function(e,t){return t?(yr[e]=t,void(lr.curPrefs=yr)):e in yr?yr[e]:ur[e]},lr.putLocale=or,lr.readLang=ir,lr.loadContentAndPrefs=function(){if(br.forceStorage||!br.noStorageOnLoad&&document.cookie.match(/(?:^|;\s*)store=(?:prefsAndContent|prefsOnly)/)){if(lr.storage&&(br.forceStorage||!br.noStorageOnLoad&&document.cookie.match(/(?:^|;\s*)store=prefsAndContent/))){var e="svgedit-"+br.canvasName,t=lr.storage.getItem(e);t&&lr.loadFromString(t)}for(var n in ur)if(ur.hasOwnProperty(n)){var r="svg-edit-"+n;if(lr.storage){var a=lr.storage.getItem(r);a&&(ur[n]=String(a))}else if(window.widget)ur[n]=window.widget.preferenceForKey(r);else{var i=document.cookie.match(new RegExp("(?:^|;\\s*)"+(o=encodeURIComponent(r),s=void 0,String(o).replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\"+(s||"")+"-]","g"),"\\$&"))+"=([^;]+)"));ur[n]=i?decodeURIComponent(i[1]):""}}var o,s}},lr.setConfig=function(e,n){function r(e,n,r){e[n]&&"object"===t(e[n])?sr.extend(!0,e[n],r):e[n]=r}n=n||{},sr.each(e,function(a,i){if(e.hasOwnProperty(a))if(ur.hasOwnProperty(a)){if(!1===n.overwrite&&(br.preventAllURLConfig||yr.hasOwnProperty(a)))return;!0===n.allowInitialUserOverride?ur[a]=i:sr.pref(a,i)}else if(["extensions","stylesheets","allowedOrigins"].includes(a)){if(!1===n.overwrite&&(br.preventAllURLConfig||["allowedOrigins","stylesheets"].includes(a)||"extensions"===a&&br.lockExtensions))return;br[a]=br[a].concat(i)}else if(hr.hasOwnProperty(a)){if(!1===n.overwrite&&(br.preventAllURLConfig||br.hasOwnProperty(a)))return;if(br.hasOwnProperty(a)){if(!1===n.overwrite)return;r(br,a,i)}else!0===n.allowInitialUserOverride?r(hr,a,i):hr[a]&&"object"===t(hr[a])?(br[a]={},sr.extend(!0,br[a],i)):br[a]=i}}),lr.curConfig=br},lr.setCustomHandlers=function(e){lr.ready(function(){e.open&&(sr('#tool_open > input[type="file"]').remove(),sr("#tool_open").show(),pr.open=e.open),e.save&&(lr.showSaveWarning=!1,pr.bind("saved",e.save)),e.exportImage&&(mr=e.exportImage,pr.bind("exported",mr)),e.exportPDF&&(_r=e.exportPDF,pr.bind("exportedPDF",_r))})},lr.randomizeIds=function(){pr.randomizeIds(arguments)},lr.init=function(){!("svgEditor"in window&&window.svgEditor&&!1===window.svgEditor.modules)||Object.assign(hr,{langPath:"../dist/locale/",extPath:"../dist/extensions/",canvgPath:"../dist/",jspdfPath:"../dist/"});try{"localStorage"in window&&(lr.storage=localStorage)}catch(e){}var e=[];function r(){yr=sr.extend(!0,{},ur,yr),lr.curPrefs=yr}function a(){(br=sr.extend(!0,{},hr,br)).noDefaultExtensions||(br.extensions=br.extensions.concat(dr)),sr.each(["extensions","stylesheets","allowedOrigins"],function(e,t){br[t]=sr.grep(br[t],function(e,n){return n===br[t].indexOf(e)})}),lr.curConfig=br}sr("#lang_select option").each(function(){e.push(this.value)}),function(){var e=void 0,t=void 0;if(gr=sr.deparam.querystring(!0),sr.isEmptyObject(gr))a(),lr.loadContentAndPrefs(),r();else{if(gr.dimensions&&(gr.dimensions=gr.dimensions.split(",")),gr.bkgd_color&&(gr.bkgd_color="#"+gr.bkgd_color),gr.extensions&&(gr.extensions=gr.extensions.match(/[:/\\]/)?"":gr.extensions.split(",")),sr.each(["extPath","imgPath","extIconsPath","canvgPath","langPath","jGraduatePath","jspdfPath"],function(e){gr[e]&&delete gr[e]}),lr.setConfig(gr,{overwrite:!1}),a(),!br.preventURLContentLoading){if(e=gr.source,t=sr.param.querystring(),e||t.includes("source=data:")&&(e=t.match(/source=(data:[^&]*)/)[1]),e)return void(e.startsWith("data:")?lr.loadFromDataURI(e):lr.loadFromString(e));if(gr.url)return void lr.loadFromURL(gr.url)}gr.noStorageOnLoad&&!br.forceStorage||lr.loadContentAndPrefs(),r()}}();var i,o=lr.setIcon=function(e,t,n){var r="string"==typeof t?sr.getSvgIcon(t,!0):t.clone();r?sr(e).empty().append(r):console.log("NOTE: Icon image missing: "+t)},s=(i=n(regeneratorRuntime.mark(function t(){var r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all(br.extensions.map(function(){var e=n(regeneratorRuntime.mark(function e(t){var n,a,i,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.match(/^ext-(.+)\.js/)){e.next=3;break}return e.abrupt("return");case 3:return a=br.extPath+t,e.next=6,nn(a,{global:"svgEditorExtension_"+n[1].replace(/-/g,"_")});case 6:return i=e.sent,o=i.name,s=i.init,e.abrupt("return",lr.addExtension(o,s&&s.bind(lr)||i));case 9:case"end":return e.stop()}},e,r)}));return function(t){return e.apply(this,arguments)}}()));case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.log(t.t0);case 8:return t.abrupt("return",lr.putLocale(null,e,br));case 9:case"end":return t.stop()}},t,this,[[0,5]])})),function(){return i.apply(this,arguments)}),d={tool_scale:lr.tool_scale},h=function(){sr(".tools_flyout").each(function(){var e=sr("#"+this.id+"_show"),t=e.offset(),n=e.outerWidth();sr(this).css({left:(t.left+n)*lr.tool_scale,top:t.top})})},f=function(){var e=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,t=document.getElementsByTagName("script")[0];for(var n in t.style)if(e.test(n))return n.match(e)[0];return"WebkitOpacity"in t.style?"Webkit":"KhtmlOpacity"in t.style?"Khtml":""}(),p=lr.setIconSize=function(e){var t="#tools_top .toolset, #editor_panel > *, #history_panel > *,        #main_button, #tools_left > *, #path_node_panel > *, #multiselected_panel > *,        #g_panel > *, #tool_font_size > *, .tools_flyout",n=sr(t),r=1;if("number"==typeof e)r=e;else{r={s:.75,m:1,l:1.25,xl:1.5}[e]}d.tool_scale=lr.tool_scale=r,h();var a=n.parents(":hidden");a.css("visibility","hidden").show(),function(e,t){var n=["top","left","bottom","right"];e.each(function(){for(var e=sr(this),r=e.outerWidth()*(t-1),a=e.outerHeight()*(t-1),i=0;i<4;i++){var o=n[i],s=e.data("orig_margin-"+o);null==s&&(s=parseInt(e.css("margin-"+o),10),e.data("orig_margin-"+o,s));var l=s*t;"right"===o?l+=r:"bottom"===o&&(l+=a),e.css("margin-"+o,l)}})}(n,r),a.css("visibility","visible").hide(),sr.pref("iconsize",e),sr("#iconsize").val(e);var i={"#tools_top":{left:50+sr("#main_button").width(),height:72},"#tools_left":{width:31,top:74},"div#workarea":{left:38,top:74}},o=sr("#tool_size_rules");if(o.length?o.empty():o=sr('<style id="tool_size_rules"></style>').appendTo("head"),"m"!==e){var s="";sr.each(i,function(t,n){t="#svg_editor "+t.replace(/,/g,", #svg_editor"),s+=t+"{",sr.each(n,function(t,n){var a=void 0;"number"==typeof n?a=n*r+"px":(n[e]||n.all)&&(a=n[e]||n.all),s+=t+":"+a+";"}),s+="}"});var l="-"+f.toLowerCase()+"-";s+=t+"{"+l+"transform: scale("+r+");} #svg_editor div.toolset .toolset {"+l+"transform: scale(1); margin: 1px !important;} #svg_editor .ui-slider {"+l+"transform: scale("+1/r+");}",o.text(s)}h()};sr.svgIcons(br.imgPath+"svg_edit_icons.svg",{w:24,h:24,id_match:!1,no_img:!L(),fallback_path:br.imgPath,fallback:{new_image:"clear.png",save:"save.png",open:"open.png",source:"source.png",docprops:"document-properties.png",wireframe:"wireframe.png",undo:"undo.png",redo:"redo.png",select:"select.png",select_node:"select_node.png",pencil:"fhpath.png",pen:"line.png",square:"square.png",rect:"rect.png",fh_rect:"freehand-square.png",circle:"circle.png",ellipse:"ellipse.png",fh_ellipse:"freehand-circle.png",path:"path.png",text:"text.png",image:"image.png",zoom:"zoom.png",clone:"clone.png",node_clone:"node_clone.png",delete:"delete.png",node_delete:"node_delete.png",group:"shape_group_elements.png",ungroup:"shape_ungroup.png",move_top:"move_top.png",move_bottom:"move_bottom.png",to_path:"to_path.png",link_controls:"link_controls.png",reorient:"reorient.png",align_left:"align-left.png",align_center:"align-center.png",align_right:"align-right.png",align_top:"align-top.png",align_middle:"align-middle.png",align_bottom:"align-bottom.png",go_up:"go-up.png",go_down:"go-down.png",ok:"save.png",cancel:"cancel.png",arrow_right:"flyouth.png",arrow_down:"dropdown.gif"},placement:{"#logo":"logo","#tool_clear div,#layer_new":"new_image","#tool_save div":"save","#tool_export div":"export","#tool_open div div":"open","#tool_import div div":"import","#tool_source":"source","#tool_docprops > div":"docprops","#tool_wireframe":"wireframe","#tool_undo":"undo","#tool_redo":"redo","#tool_select":"select","#tool_fhpath":"pencil","#tool_line":"pen","#tool_rect,#tools_rect_show":"rect","#tool_square":"square","#tool_fhrect":"fh_rect","#tool_ellipse,#tools_ellipse_show":"ellipse","#tool_circle":"circle","#tool_fhellipse":"fh_ellipse","#tool_path":"path","#tool_text,#layer_rename":"text","#tool_image":"image","#tool_zoom":"zoom","#tool_clone,#tool_clone_multi":"clone","#tool_node_clone":"node_clone","#layer_delete,#tool_delete,#tool_delete_multi":"delete","#tool_node_delete":"node_delete","#tool_add_subpath":"add_subpath","#tool_openclose_path":"open_path","#tool_move_top":"move_top","#tool_move_bottom":"move_bottom","#tool_topath":"to_path","#tool_node_link":"link_controls","#tool_reorient":"reorient","#tool_group_elements":"group_elements","#tool_ungroup":"ungroup","#tool_unlink_use":"unlink_use","#tool_alignleft, #tool_posleft":"align_left","#tool_aligncenter, #tool_poscenter":"align_center","#tool_alignright, #tool_posright":"align_right","#tool_aligntop, #tool_postop":"align_top","#tool_alignmiddle, #tool_posmiddle":"align_middle","#tool_alignbottom, #tool_posbottom":"align_bottom","#cur_position":"align","#linecap_butt,#cur_linecap":"linecap_butt","#linecap_round":"linecap_round","#linecap_square":"linecap_square","#linejoin_miter,#cur_linejoin":"linejoin_miter","#linejoin_round":"linejoin_round","#linejoin_bevel":"linejoin_bevel","#url_notice":"warning","#layer_up":"go_up","#layer_down":"go_down","#layer_moreopts":"context_menu","#layerlist td.layervis":"eye","#tool_source_save,#tool_docprops_save,#tool_prefs_save":"ok","#tool_source_cancel,#tool_docprops_cancel,#tool_prefs_cancel":"cancel","#rwidthLabel, #iwidthLabel":"width","#rheightLabel, #iheightLabel":"height","#cornerRadiusLabel span":"c_radius","#angleLabel":"angle","#linkLabel,#tool_make_link,#tool_make_link_multi":"globe_link","#zoomLabel":"zoom","#tool_fill label":"fill","#tool_stroke .icon_label":"stroke","#group_opacityLabel":"opacity","#blurLabel":"blur","#font_sizeLabel":"fontsize",".flyout_arrow_horiz":"arrow_right",".dropdown button, #main_button .dropdown":"arrow_down","#palette .palette_item:first, #fill_bg, #stroke_bg":"no_color"},resize:{"#logo .svg_icon":28,".flyout_arrow_horiz .svg_icon":5,".layer_button .svg_icon, #layerlist td.layervis .svg_icon":14,".dropdown button .svg_icon":7,"#main_button .dropdown .svg_icon":9,".palette_item:first .svg_icon":15,"#fill_bg .svg_icon, #stroke_bg .svg_icon":16,".toolbar_button button .svg_icon":16,".stroke_tool div div .svg_icon":20,"#tools_bottom label .svg_icon":18},callback:function(e){sr(".toolbar_button button > svg, .toolbar_button button > img").each(function(){sr(this).parent().prepend(this)});var t=sr("#tools_left"),n=void 0;t.length&&(n=t.offset().top+t.outerHeight());var r=sr.pref("iconsize");function a(e){switch(e){case"jgraduate/css/jPicker.css":return 1;case"jgraduate/css/jgraduate.css":return 2;case"svg-editor.css":return 3;case"spinbtn/JQuerySpinBtn.css":return 4;default:return 1/0}}lr.setIconSize(r||(sr(window).height()<n?"s":"m")),sr(".tools_flyout").each(function(){var e=sr("#"+this.id+"_show"),t=e.attr("data-curopt");if(!e.children("svg, img").length){var n=sr(t).children().clone();n.length&&(n[0].removeAttribute("style"),e.append(n))}});var i=sr.loadingStylesheets.sort(function(e,t){var n=a(e),r=a(t);return n===r?0:n>r});if(br.stylesheets.length){var o,s=(i=[].concat(c(new Set(br.stylesheets)))).indexOf("@default");if(s>-1)(o=i).splice.apply(o,[s,1].concat(c(sr.loadingStylesheets)))}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.before,r=t.after,a=t.favicon,i=t.canvas,o=t.image,s=void 0===o||o,c=t.acceptErrors;return e=Array.isArray(e)?e:[e],Promise.all(e.map(function(e){var t={};if(Array.isArray(e)){var o=l(e,2);e=o[0];var u=o[1];t=void 0===u?{}:u}var d=t.favicon,h=void 0===d?a:d,f=t,p=f.before,g=void 0===p?n:p,v=f.after,m=void 0===v?r:v,_=f.canvas,y=void 0===_?i:_,b=f.image,x=void 0===b?s:b;function w(){g?g.before(S):m?m.after(S):document.head.appendChild(S)}var S=document.createElement("link");return new Promise(function(n,r){if(c&&(r="function"==typeof c?function(a){c({error:a,stylesheetURL:e,options:t,resolve:n,reject:r})}:n),e.endsWith(".css")?h=!1:e.endsWith(".ico")&&(h=!0),h){if(S.rel="shortcut icon",S.type="image/x-icon",!1===x)return S.href=e,w(),void n(S);var a=document.createElement("canvas");a.width=16,a.height=16;var i=a.getContext("2d"),o=document.createElement("img");return o.addEventListener("error",function(e){r(e)}),o.addEventListener("load",function(){i.drawImage(o,0,0),S.href=y?a.toDataURL("image/x-icon"):e,w(),n(S)}),void(o.src=e)}S.rel="stylesheet",S.type="text/css",S.href=e,w(),S.addEventListener("error",function(e){r(e)}),S.addEventListener("load",function(){n(S)})})}))})(i,{acceptErrors:function(e){var t=e.stylesheetURL,n=e.reject,r=e.resolve;sr.loadingStylesheets.includes(t)?n(new Error("Missing expected stylesheet: "+t)):r()}}).then(function(){sr("#svg_container")[0].style.visibility="visible",lr.runCallbacks(),setTimeout(function(){sr(".flyout_arrow_horiz:empty").each(function(){sr(this).append(sr.getSvgIcon("arrow_right").width(5).height(5))})},1)})}}),lr.canvas=pr=new Jn(document.getElementById("svgcanvas"),br);var g=j()?"meta+":"ctrl+",v=pr.pathActions,m=pr.undoMgr,_=sr("#workarea"),y=sr("#cmenu_canvas"),b={fill:null,stroke:null},x=void 0,w=void 0,S=null,k=br.imgPath+"logo.png",C="crosshair",A="crosshair",E="toolbars";!function(){var e=window.opener||window.parent,t=void 0;if(e)try{(t=e.document.createEvent("Event")).initEvent("svgEditorReady",!0,!0),e.document.documentElement.dispatchEvent(t)}catch(e){}}(),function(){sr("#dialog_container").draggable({cancel:"#dialog_content, #dialog_buttons *",containment:"window"}).css("position","absolute");var e=sr("#dialog_box"),n=sr("#dialog_buttons"),r=sr("#dialog_content"),a=function(a,i,o,s,l,c,u){r.html("<p>"+i.replace(/\n/g,"</p><p>")+"</p>").toggleClass("prompt","prompt"===a),n.empty();var d=sr('<input type="button" value="'+fr.common.ok+'">').appendTo(n);"alert"!==a&&sr('<input type="button" value="'+fr.common.cancel+'">').appendTo(n).click(function(){e.hide(),o&&o(!1)});var h=void 0,f=void 0;if("prompt"===a)(h=sr('<input type="text">').prependTo(n)).val(s||""),h.bind("keydown","return",function(){d.click()});else if("select"===a){var p=sr('<div style="text-align:center;">');if(h=sr("<select>").appendTo(p),u){var g=sr("<label>").text(u.label);(f=sr('<input type="checkbox">').appendTo(g)).val(u.value),u.tooltip&&g.attr("title",u.tooltip),f.prop("checked",!!u.checked),p.append(sr("<div>").append(g))}sr.each(l||[],function(e,n){"object"===(void 0===n?"undefined":t(n))?h.append(sr("<option>").val(n.value).html(n.text)):h.append(sr("<option>").html(n))}),r.append(p),s&&h.val(s),c&&h.bind("change","return",c),h.bind("keydown","return",function(){d.click()})}else"process"===a&&d.hide();e.show(),d.click(function(){e.hide();var t="prompt"!==a&&"select"!==a||h.val();o&&(f?o(t,f.prop("checked")):o(t))}).focus(),"prompt"!==a&&"select"!==a||h.focus()};sr.alert=function(e,t){a("alert",e,t)},sr.confirm=function(e,t){a("confirm",e,t)},sr.process_cancel=function(e,t){a("process",e,t)},sr.prompt=function(e,t,n){a("prompt",e,n,t)},sr.select=function(e,t,n,r,i,o){a("select",e,n,i,t,r,o)}}();for(var P=function(){var e=sr(".tool_button_current");e.length&&"tool_select"!==e[0].id&&(e.removeClass("tool_button_current").addClass("tool_button"),sr("#tool_select").addClass("tool_button_current").removeClass("tool_button"),sr("#styleoverrides").text("#svgcanvas svg *{cursor:move;pointer-events:all} #svgcanvas svg{cursor:default}")),pr.setMode("select"),_.css("cursor","auto")},G=sr("title:first").text(),I=[],T=.1;T<1e5;T*=10)I.push(T),I.push(2*T),I.push(5*T);var N=function(e){var t=void 0,n=[],r=pr.getCurrentDrawing().getNumLayers();for(t=0;t<r;t++)n[t]=pr.getCurrentDrawing().getLayerName(t);if(e)for(t=0;t<r;++t)n[t]!==e&&pr.getCurrentDrawing().setLayerOpacity(n[t],.5);else for(t=0;t<r;++t)pr.getCurrentDrawing().setLayerOpacity(n[t],1)},V=function(){pr.clearSelection();for(var e=sr("#layerlist tbody").empty(),t=sr("#selLayerNames").empty(),n=pr.getCurrentDrawing(),r=n.getCurrentLayerName(),a=sr.getSvgIcon("eye"),i=pr.getCurrentDrawing().getNumLayers();i--;){var o=n.getLayerName(i),s=sr('<tr class="layer">').toggleClass("layersel",o===r),l=sr('<td class="layervis">').toggleClass("layerinvis",!n.getLayerVisibility(o)),c=sr('<td class="layername">'+o+"</td>");e.append(s.append(l,c)),t.append('<option value="'+o+'">'+o+"</option>")}if(void 0!==a){var u=a.clone();sr("td.layervis",e).append(u),sr.resizeSvgIcons({"td.layervis .svg_icon":14})}sr("#layerlist td.layername").mouseup(function(e){sr("#layerlist tr.layer").removeClass("layersel"),sr(this.parentNode).addClass("layersel"),pr.setCurrentLayer(this.textContent),e.preventDefault()}).mouseover(function(){N(this.textContent)}).mouseout(function(){N()}),sr("#layerlist td.layervis").click(function(){var e=sr(this.parentNode).prevAll().length,t=sr("#layerlist tr.layer:eq("+e+") td.layername").text(),n=sr(this).hasClass("layerinvis");pr.setLayerVisibility(t,n),sr(this).toggleClass("layerinvis")});for(var d=5-sr("#layerlist tr.layer").size();d-- >0;)e.append('<tr><td style="color:white">_</td><td/></tr>')},B=!1,D="",U=function(e,t){B||(B=!0,D=pr.getSvgString(),sr("#save_output_btns").toggle(!!t),sr("#tool_source_back").toggle(!t),sr("#svg_source_textarea").val(D),sr("#svg_source_editor").fadeIn(),sr("#svg_source_textarea").focus())},F=null,H=!1,z=function(){window.opera&&sr("<p/>").hide().appendTo("body").remove()};function q(e,t){var n=e.id,r=n.split("_"),a=r[0],i=r[1];t&&pr.setStrokeAttr("stroke-"+a,i),z(),o("#cur_"+a,n,20),sr(e).addClass("current").siblings().removeClass("current")}var Y=lr.toolButtonClick=function(e,t){if(sr(e).hasClass("disabled"))return!1;if(sr(e).parent().hasClass("tools_flyout"))return!0;return t||sr(".tools_flyout").fadeOut("normal"),sr("#styleoverrides").text(""),_.css("cursor","auto"),sr(".tool_button_current").removeClass("tool_button_current").addClass("tool_button"),sr(e).addClass("tool_button_current").removeClass("tool_button"),!0},W=lr.clickSelect=function(){Y("#tool_select")&&(pr.setMode("select"),sr("#styleoverrides").text("#svgcanvas svg *{cursor:move;pointer-events:all}, #svgcanvas svg{cursor:default}"))},X=lr.setImageURL=function(e){e||(e=k),pr.setImageURL(e),sr("#image_url").val(e),e.startsWith("data:")?(sr("#image_url").hide(),sr("#change_image_url").show()):(pr.embedImage(e,function(t){sr("#url_notice").toggle(!t),k=e}),sr("#image_url").show(),sr("#change_image_url").hide())};function Q(e,t){sr.pref("bkgd_color",e),sr.pref("bkgd_url",t),pr.setBackground(e,t)}function K(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cancelDeletes,t=void 0!==e&&e,n=pr.getHref(F);n=n.startsWith("data:")?"":n,sr.prompt(fr.notification.enterNewImgURL,n,function(e){e?X(e):t&&pr.deleteSelectedElements()})}function Z(e,t){t||(t=pr.getZoom()),e||(e=sr("#svgcanvas"));var n=void 0,r=void 0,a=pr.getContentElem(),i=J()[br.baseUnit];for(n=0;n<2;n++){var o=0===n,s=o?"x":"y",l=o?"width":"height",c=Number(a.getAttribute(s)),u=sr("#ruler_"+s+" canvas:first"),d=u.clone();u.replaceWith(d);var h=d[0],f=e[l](),p=f;h.parentNode.style[l]=p+"px";var g=h.getContext("2d"),v=void 0,m=void 0,_=void 0;if(g.fillStyle="rgb(200,0,0)",g.fillRect(0,0,h.width,h.height),d.siblings().remove(),f>=3e4){_=parseInt(f/3e4,10)+1,(v=[])[0]=g;var y=void 0;for(r=1;r<_;r++)h[l]=3e4,y=h.cloneNode(!0),h.parentNode.append(y),v[r]=y.getContext("2d");y[l]=f%3e4,f=3e4}h[l]=f;var b=i*t,x=50/b,w=1;for(r=0;r<I.length&&(w=m=I[r],!(x<=m));r++);var S=w*b;g.font="9px sans-serif";for(var k=c/b%w*b,C=k-S,A=0;k<p;){C+=S;var E=Math.round(k)+.5;o?(g.moveTo(E,15),g.lineTo(E,0)):(g.moveTo(15,E),g.lineTo(0,E)),m=(C-c)/b;var P=void 0;if(w>=1)P=Math.round(m);else{var G=String(w).split(".")[1].length;P=m.toFixed(G)}if(0!==P&&1e3!==P&&P%1e3==0&&(P=P/1e3+"K"),o)g.fillText(P,k+2,8);else{var T=String(P).split("");for(r=0;r<T.length;r++)g.fillText(T[r],1,k+9+9*r)}var N=S/10;for(r=1;r<10;r++){var L=Math.round(k+N*r)+.5;if(v&&L>f){if(A++,g.stroke(),A>=_){r=10,k=p;continue}g=v[A],k-=3e4,L=Math.round(k+N*r)+.5}var M=r%2?12:10;o?(g.moveTo(L,15),g.lineTo(L,M)):(g.moveTo(15,L),g.lineTo(M,L))}k+=S}g.strokeStyle="#000",g.stroke()}}var $=lr.updateCanvas=function(e,t){var n=pr.getZoom(),r=_,a=sr("#svgcanvas"),i=_.width(),o=_.height(),s=i,l=o,c=r[0].scrollLeft+s/2,u=r[0].scrollTop+l/2,d=br.canvas_expansion;i=Math.max(s,pr.contentW*n*d),o=Math.max(l,pr.contentH*n*d),i===s&&o===l?_.css("overflow","hidden"):_.css("overflow","scroll");var h=a.height()/2,f=a.width()/2;a.width(i).height(o);var p=o/2,g=i/2,v=pr.updateCanvas(i,o),m=g/f,y=i/2-s/2,b=o/2-l/2;t?(t.x+=v.x,t.y+=v.y):t={x:g+(c-f)*m,y:p+(u-h)*m};e?pr.contentW>r.width()?(_[0].scrollLeft=v.x-10,_[0].scrollTop=v.y-10):(r[0].scrollLeft=y,r[0].scrollTop=b):(r[0].scrollLeft=t.x-s/2,r[0].scrollTop=t.y-l/2),br.showRulers&&(Z(a,n),_.scroll()),!0===gr.storagePrompt||lr.storagePromptClosed||sr("#dialog_box").hide()},ee=function(){var e=void 0,t=void 0,n="none"===pr.getColor("fill"),r="none"===pr.getColor("stroke"),a=["#tool_fhpath","#tool_line"],i=["#tools_rect .tool_button","#tools_ellipse .tool_button","#tool_text","#tool_path"];if(r)for(e in a)sr(t=a[e]).hasClass("tool_button_current")&&W(),sr(t).addClass("disabled");else for(e in a)sr(t=a[e]).removeClass("disabled");if(r&&n)for(e in i)sr(t=i[e]).hasClass("tool_button_current")&&W(),sr(t).addClass("disabled");else for(e in i)sr(t=i[e]).removeClass("disabled");pr.runExtensions("toolButtonStateUpdate",{nofill:n,nostroke:r}),sr(".tools_flyout").each(function(){var e=sr("#"+this.id+"_show"),t=!1;sr(this).children().each(function(){sr(this).hasClass("disabled")||(t=!0)}),e.toggleClass("disabled",!t)}),z()},ne=function(){var e=F;null==e||e.parentNode||(e=null);var t=pr.getCurrentDrawing().getCurrentLayerName(),n=pr.getMode(),r="px"!==br.baseUnit?br.baseUnit:null,a="pathedit"===n,i=sr("#cmenu_canvas li");if(sr("#selected_panel, #multiselected_panel, #g_panel, #rect_panel, #circle_panel,#ellipse_panel, #line_panel, #text_panel, #image_panel, #container_panel, #use_panel, #a_panel").hide(),null!=e){var s=e.nodeName,l=pr.getRotationAngle(e);sr("#angle").val(l);var c=pr.getBlur(e);if(sr("#blur").val(c),sr("#blur_slider").slider("option","value",c),pr.addedNew&&"image"===s&&"image"===pr.getMode()&&(pr.getHref(e).startsWith("data:")||K({cancelDeletes:!0})),a||"pathedit"===n){var u=v.getNodePoint();if(sr("#tool_add_subpath").removeClass("push_button_pressed").addClass("tool_button"),sr("#tool_node_delete").toggleClass("disabled",!v.canDeleteNodes),o("#tool_openclose_path",v.closed_subpath?"open_path":"close_path"),u){var d=sr("#seg_type");r&&(u.x=te(u.x),u.y=te(u.y)),sr("#path_node_x").val(u.x),sr("#path_node_y").val(u.y),u.type?d.val(u.type).removeAttr("disabled"):d.val(4).attr("disabled","disabled")}return}if(sr("#selected_panel").show(),["line","circle","ellipse"].includes(s))sr("#xy_panel").hide();else{var h=void 0,f=void 0;if(["g","polyline","path"].includes(s)){var p=pr.getStrokedBBox([e]);p&&(h=p.x,f=p.y)}else h=e.getAttribute("x"),f=e.getAttribute("y");r&&(h=te(h),f=te(f)),sr("#selected_x").val(h||0),sr("#selected_y").val(f||0),sr("#xy_panel").show()}var g=!["image","text","path","g","use"].includes(s);sr("#tool_topath").toggle(g),sr("#tool_reorient").toggle("path"===s),sr("#tool_reorient").toggleClass("disabled",0===l);var _={g:[],a:[],rect:["rx","width","height"],image:["width","height"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],line:["x1","y1","x2","y2"],text:[],use:[]},b=e.tagName,x=null;if("a"===b&&(x=pr.getHref(e),sr("#g_panel").show()),"a"===e.parentNode.tagName&&(sr(e).siblings().length||(sr("#a_panel").show(),x=pr.getHref(e.parentNode))),sr("#tool_make_link, #tool_make_link").toggle(!x),x&&sr("#link_url").val(x),_[b]){var w=_[b];if(sr("#"+b+"_panel").show(),sr.each(w,function(t,n){var r=e.getAttribute(n);if("px"!==br.baseUnit&&e[n]){var a=e[n].baseVal.value;r=te(a)}sr("#"+b+"_"+n).val(r||0)}),"text"===b)sr("#text_panel").css("display","inline"),sr("#tool_font_size").css("display","inline"),pr.getItalic()?sr("#tool_italic").addClass("push_button_pressed").removeClass("tool_button"):sr("#tool_italic").removeClass("push_button_pressed").addClass("tool_button"),pr.getBold()?sr("#tool_bold").addClass("push_button_pressed").removeClass("tool_button"):sr("#tool_bold").removeClass("push_button_pressed").addClass("tool_button"),sr("#font_family").val(e.getAttribute("font-family")),sr("#font_size").val(e.getAttribute("font-size")),sr("#text").val(e.textContent),pr.addedNew&&setTimeout(function(){sr("#text").focus().select()},100);else if("image"===b&&"image"===pr.getMode())X(pr.getHref(e));else if("g"===b||"use"===b){sr("#container_panel").show();var S=pr.getTitle(),k=sr("#g_title")[0];k.value=S,function(e){var t=Math.min(Math.max(12+6*e.value.length,50),300);sr(e).width(t)}(k),sr("#g_title").prop("disabled","use"===b)}}i[("g"===b?"en":"dis")+"ableContextMenuItems"]("#ungroup"),i[("g"!==b&&H?"en":"dis")+"ableContextMenuItems"]("#group")}else H?(sr("#multiselected_panel").show(),i.enableContextMenuItems("#group").disableContextMenuItems("#ungroup")):i.disableContextMenuItems("#delete,#cut,#copy,#group,#ungroup,#move_front,#move_up,#move_down,#move_back");sr("#tool_undo").toggleClass("disabled",0===m.getUndoStackSize()),sr("#tool_redo").toggleClass("disabled",0===m.getRedoStackSize()),pr.addedNew=!1,e&&!a||H?(sr("#selLayerNames").removeAttr("disabled").val(t),y.enableContextMenuItems("#delete,#cut,#copy,#move_front,#move_up,#move_down,#move_back")):sr("#selLayerNames").attr("disabled","disabled")},ae=function(){if(!Wt){var e="#workarea.wireframe #svgcontent * { stroke-width: "+1/pr.getZoom()+"px; }";sr("#wireframe_rules").text(_.hasClass("wireframe")?e:"")}},ie="",oe=function(e){e=e||pr.getDocumentTitle();var t=G+(e?": "+e:"");sr("title:first").text(t)};function se(e){return e&&"g"===e.tagName&&ln.CLASS_REGEX.test(e.getAttribute("class"))}var le=function(){ae()},ce=pr.zoomChanged=function(e,t,n){var r=_,a=pr.setBBoxZoom(t,r.width()-15,r.height()-15);if(a){var i=a.zoom,o=a.bbox;i<.001?ue({value:.1}):(sr("#zoom").val((100*i).toFixed(1)),n?$():$(!1,{x:o.x*i+o.width*i/2,y:o.y*i+o.height*i/2}),"zoom"===pr.getMode()&&o.width&&P(),le())}},ue=function(e){var t=e.value/100;if(t<.001)e.value=.1;else{var n=pr.getZoom(),r=_;ce(window,{width:0,height:0,x:(r[0].scrollLeft+r.width()/2)/n,y:(r[0].scrollTop+r.height()/2)/n,zoom:t},!0)}};sr("#cur_context_panel").delegate("a","click",function(){var e=sr(this);return e.attr("data-root")?pr.leaveContext():pr.setContext(e.text()),pr.clearSelection(),!1});var de=function(){b.fill.prep(),b.stroke.prep()},he={},fe=function(){sr(".tools_flyout").each(function(){var e=sr("#"+this.id+"_show");if(!e.data("isLibrary")){var t=[];sr(this).children().each(function(){t.push(this.title)}),e[0].title=t.join(" / ")}})},pe=function(e){sr.each(e,function(t,n){var r=sr(t).children(),a=t+"_show",i=sr(a),o=!1;r.addClass("tool_button").unbind("click mousedown mouseup").each(function(t){var r=n[t];he[r.sel]=r.fn,r.isDefault&&(o=t);var s=function(t){var n=r;if("keydown"===t.type){var o=sr(n.parent+"_show").hasClass("tool_button_current"),s=sr(n.parent+"_show").attr("data-curopt");sr.each(e[r.parent],function(a,i){i.sel===s&&(n=t.shiftKey&&o?e[r.parent][a+1]||e[r.parent][0]:i)})}if(sr(this).hasClass("disabled"))return!1;Y(a)&&n.fn();var l=void 0;(l=n.icon?sr.getSvgIcon(n.icon,!0):sr(n.sel).children().eq(0).clone())[0].setAttribute("width",i.width()),l[0].setAttribute("height",i.height()),i.children(":not(.flyout_arrow_horiz)").remove(),i.append(l).attr("data-curopt",n.sel)};sr(this).mouseup(s),r.key&&sr(document).bind("keydown",r.key[0]+" shift+"+r.key[0],s)}),o?i.attr("data-curopt",n[o].sel):i.attr("data-curopt")||i.attr("data-curopt",n[0].sel);var s=void 0,l=sr(a).position();i.mousedown(function(e){if(i.hasClass("disabled"))return!1;var n=sr(t),r=l.left+34,a=-1*n.width(),o=n.data("shown_popop")?200:0;s=setTimeout(function(){i.data("isLibrary")?n.css("left",r).show():n.css("left",a).show().animate({left:r},150),n.data("shown_popop",!0)},o),e.preventDefault()}).mouseup(function(e){clearTimeout(s);var t=sr(this).attr("data-curopt");i.data("isLibrary")&&sr(a.replace("_show","")).is(":visible")?Y(a,!0):Y(a)&&he[t]&&he[t]()})}),fe(),h()},ge=function(e,t){return sr("<div>",{class:"tools_flyout",id:e}).appendTo("#svg_editor").append(t)},ve=function(e,t,n,r){var a=sr(e),i=r.dropUp;t=sr(t),i&&sr(e).addClass("dropup"),t.find("li").bind("mouseup",function(){r.seticon&&(o("#cur_"+a[0].id,sr(this).children()),sr(this).addClass("current").siblings().removeClass("current")),n.apply(this,arguments)});var s=!1;sr(window).mouseup(function(e){s||(a.removeClass("down"),t.hide(),t.css({top:0,left:0})),s=!1}),a.bind("mousedown",function(){var e=a.offset();i?(e.top-=t.height(),e.left+=8):e.top+=a.height(),t.offset(e),a.hasClass("down")?(t.hide(),t.css({top:0,left:0})):(t.show(),s=!0),a.toggleClass("down")}).hover(function(){s=!0}).mouseout(function(){s=!1}),r.multiclick&&t.mousedown(function(){s=!0})},me=[];pr.bind("selected",function(e,t){var n=pr.getMode();"select"===n&&P();var r="pathedit"===n;F=1===t.length||null==t[1]?t[0]:null,H=t.length>=2&&null!=t[1],null!=F&&(r||function(){var e=void 0,t=void 0;if(null!=F)switch(F.tagName){case"use":case"image":case"foreignObject":break;case"g":case"a":var n=F.getElementsByTagName("*"),r=null;for(e=0,t=n.length;e<t;e++){var a=n[e].getAttribute("stroke-width");0===e?r=a:r!==a&&(r=null)}sr("#stroke_width").val(null===r?"":r),b.fill.update(!0),b.stroke.update(!0);break;default:b.fill.update(!0),b.stroke.update(!0),sr("#stroke_width").val(F.getAttribute("stroke-width")||1),sr("#stroke_style").val(F.getAttribute("stroke-dasharray")||"none");var i=F.getAttribute("stroke-linejoin")||"miter";sr("#linejoin_"+i).length&&q(sr("#linejoin_"+i)[0]),i=F.getAttribute("stroke-linecap")||"butt",sr("#linecap_"+i).length&&q(sr("#linecap_"+i)[0])}if(null!=F){var o=100*(F.getAttribute("opacity")||1);sr("#group_opacity").val(o),sr("#opac_slider").slider("option","value",o),sr("#elem_id").val(F.id),sr("#elem_class").val(F.getAttribute("class"))}ee()}()),function(e,t){sr("#path_node_panel").toggle(e),sr("#tools_bottom_2,#tools_bottom_3").toggle(!e),e?(sr(".tool_button_current").removeClass("tool_button_current").addClass("tool_button"),sr("#tool_select").addClass("tool_button_current").removeClass("tool_button"),o("#tool_select","select_node"),H=!1,t.length&&(F=t[0])):setTimeout(function(){o("#tool_select","select")},1e3)}(r,t),ne(),pr.runExtensions("selectedChanged",{elems:t,selectedElement:F,multiselected:H})}),pr.bind("transition",function(e,t){var n=pr.getMode(),r=t[0];if(r){if(!(H=t.length>=2&&null!=t[1]))switch(n){case"rotate":var a=pr.getRotationAngle(r);sr("#angle").val(a),sr("#tool_reorient").toggleClass("disabled",0===a)}pr.runExtensions("elementTransition",{elems:t})}}),pr.bind("changed",function(e,t){var n=pr.getMode();"select"===n&&P();for(var r=0;r<t.length;++r){var a=t[r],i=a&&"svg"===a.tagName;i||se(a)?(V(),i&&$()):a&&F&&null==F.parentNode&&(F=a)}lr.showSaveWarning=!0,ne(),F&&"select"===n&&(b.fill.update(),b.stroke.update()),pr.runExtensions("elementChanged",{elems:t})}),pr.bind("saved",function(e,t){if(lr.showSaveWarning=!1,t='<?xml version="1.0"?>\n'+t,O())U(0,!0);else{var n=document.createElement("a");n.href="data:image/svg+xml;base64,"+mt(t),n.download="icon.svg",n.click();var r=sr.pref("save_notice_done");if("all"!==r){var a=fr.notification.saveFromBrowser.replace("%s","SVG");M()?t.includes("<defs")?(a+="\n\n"+fr.notification.defsFailOnSave,sr.pref("save_notice_done","all"),r="all"):sr.pref("save_notice_done","part"):sr.pref("save_notice_done","all"),"part"!==r&&alert(a)}}}),pr.bind("exported",function(e,t){var n=t.issues,r=t.exportWindowName;if(r&&(S=window.open(St||"",r)),S&&!S.closed){if(S.location.href=t.bloburl||t.datauri,"all"!==sr.pref("export_notice_done")){var a=fr.notification.saveFromBrowser.replace("%s",t.type);n.length&&(a+="\n\n"+fr.notification.noteTheseIssues+"\n • "+n.join("\n • ")),sr.pref("export_notice_done","all"),S.alert(a)}}else sr.alert(fr.notification.popupWindowBlocked)}),pr.bind("exportedPDF",function(e,t){var n=t.exportWindowName;n&&(S=window.open("",n)),S&&!S.closed?S.location.href=t.dataurlstring:sr.alert(fr.notification.popupWindowBlocked)}),pr.bind("zoomed",ce),pr.bind("zoomDone",le),pr.bind("updateCanvas",function(e,t){var n=t.center,r=t.newCtr;$(n,r)}),pr.bind("contextset",function(e,t){var n="";if(t){var r="";n='<a href="#" data-root="y">'+pr.getCurrentDrawing().getCurrentLayerName()+"</a>",sr(t).parentsUntil("#svgcontent > g").andSelf().each(function(){this.id&&(r+=" > "+this.id,n+=this!==t?' > <a href="#">'+this.id+"</a>":" > "+this.id)}),ie=r}else ie=null;sr("#cur_context_panel").toggle(!!t).html(n),oe()}),pr.bind("extension_added",function(e,t){if(t){var n=!1,r=!1,a=!0;if(t.langReady)if(lr.langChanged){var i=sr.pref("lang");t.langReady({lang:i,uiStrings:fr})}else me.push(t);var o=function(){t.callback&&!n&&a&&(n=!0,t.callback.call(lr))},s=[];if(t.context_tools&&sr.each(t.context_tools,function(e,t){var n=t.container_id?' id="'+t.container_id+'"':"",r=sr("#"+t.panel);r.length||(r=sr("<div>",{id:t.panel}).appendTo("#tools_top"));var a=void 0;switch(t.type){case"tool_button":a='<div class="tool_button">'+t.id+"</div>";var i=sr(a).appendTo(r);t.events&&sr.each(t.events,function(e,t){sr(i).bind(e,t)});break;case"select":a="<label"+n+'><select id="'+t.id+'">',sr.each(t.options,function(e,n){var r=e===t.defval?" selected":"";a+='<option value="'+e+'"'+r+">"+n+"</option>"});var o=sr(a+="</select></label>").appendTo(r).find("select");sr.each(t.events,function(e,t){sr(o).bind(e,t)});break;case"button-select":a='<div id="'+t.id+'" class="dropdown toolset" title="'+t.title+'"><div id="cur_'+t.id+'" class="icon_label"></div><button></button></div>';var l=sr('<ul id="'+t.id+'_opts"></ul>').appendTo("#option_lists");t.colnum&&l.addClass("optcols"+t.colnum),sr(a).appendTo(r).children(),s.push({elem:"#"+t.id,list:"#"+t.id+"_opts",title:t.title,callback:t.events.change,cur:"#cur_"+t.id});break;case"input":a="<label"+n+'><span id="'+t.id+'_label">'+t.label+':</span><input id="'+t.id+'" title="'+t.title+'" size="'+(t.size||"4")+'" value="'+(t.defval||"")+'" type="text"/></label>';var c=sr(a).appendTo(r).find("input");t.spindata&&c.SpinButton(t.spindata),t.events&&sr.each(t.events,function(e,t){c.bind(e,t)})}}),t.buttons){var l={},c={},u=t.svgicons,d={};sr.each(t.buttons,function(e,t){for(var n=void 0,r=void 0,a=void 0,i=t.id,o=e;sr("#"+i).length;)i=t.id+"_"+ ++o;u?(l[i]=t.icon,r=t.svgicon||t.id,"app_menu"===t.type?c["#"+i+" > div"]=r:c["#"+i]=r):n=sr('<img src="'+t.icon+'">');var s=void 0,h=void 0;switch(t.type){case"mode_flyout":case"mode":s="tool_button",h="#tools_left";break;case"context":s="tool_button",h="#"+t.panel,sr(h).length||sr("<div>",{id:t.panel}).appendTo("#tools_top");break;case"app_menu":s="",h="#main_menu ul"}var f=void 0,p=void 0,g=void 0,v=void 0,m=void 0,_=sr(t.list||"app_menu"===t.type?"<li/>":"<div/>").attr("id",i).attr("title",t.title).addClass(s);if(t.includeWith||t.list){if(t.list)_.addClass("push_button"),sr("#"+t.list+"_opts").append(_),t.isDefault&&(sr("#cur_"+t.list).append(_.children().clone()),r=t.svgicon||t.id,c["#cur_"+t.list]=r);else if(t.includeWith){var y=t.includeWith;f=(m=sr(y.button)).parent(),m.parent().hasClass("tools_flyout")||(a=m[0].id.replace("tool_","tools_"),g=m.clone().attr("id",a+"_show").append(sr("<div>",{class:"flyout_arrow_horiz"})),m.before(g),f=ge(a,m)),v=dn.getButtonData(y.button),y.isDefault&&(c["#"+a+"_show"]=t.id),p=d["#"+f[0].id]=[{sel:"#"+i,fn:t.events.click,icon:t.id,key:t.key,isDefault:t.includeWith?t.includeWith.isDefault:0},v];var b="position"in y?y.position:"last",x=f.children().length;!isNaN(b)&&b>=0&&b<x?f.children().eq(b).before(_):(f.append(_),p.reverse())}}else"position"in t?sr(h).children().eq(t.position).length?sr(h).children().eq(t.position).before(_):sr(h).children().last().before(_):_.appendTo(h),"mode_flyout"===t.type?(f=(m=sr(_)).parent(),m.parent().hasClass("tools_flyout")||(a=m[0].id.replace("tool_","tools_"),g=m.clone().attr("id",a+"_show").append(sr("<div>",{class:"flyout_arrow_horiz"})),m.before(g),(f=ge(a,m)).data("isLibrary",!0),g.data("isLibrary",!0)),c["#"+a+"_show"]=t.id,p=d["#"+f[0].id]=[{sel:"#"+i,fn:t.events.click,icon:t.id,isDefault:!0},v]):"app_menu"===t.type&&_.append("<div>").append(t.title);u||_.append(n),t.list||sr.each(t.events,function(e,n){"click"===e&&"mode"===t.type?(t.includeWith?_.bind(e,n):_.bind(e,function(){Y(_)&&n()}),t.key&&(sr(document).bind("keydown",t.key,n),t.title&&_.attr("title",t.title+" ["+t.key+"]"))):_.bind(e,n)}),pe(d)}),sr.each(s,function(){ve(this.elem,this.list,this.callback,{seticon:!0})}),u&&(a=!1),sr.svgIcons(u,{w:24,h:24,id_match:!1,no_img:!L(),fallback:l,placement:c,callback:function(e){"m"!==sr.pref("iconsize")&&(x&&(clearTimeout(x),x=null),r||(x=setTimeout(function(){r=!0,p(sr.pref("iconsize"))},50))),a=!0,o()}})}o()}}),pr.textActions.setInputElem(sr("#text")[0]);var _e='<div class="palette_item" data-rgb="none"></div>';sr.each(["#000000","#3f3f3f","#7f7f7f","#bfbfbf","#ffffff","#ff0000","#ff7f00","#ffff00","#7fff00","#00ff00","#00ff7f","#00ffff","#007fff","#0000ff","#7f00ff","#ff00ff","#ff007f","#7f0000","#7f3f00","#7f7f00","#3f7f00","#007f00","#007f3f","#007f7f","#003f7f","#00007f","#3f007f","#7f007f","#7f003f","#ffaaaa","#ffd4aa","#ffffaa","#d4ffaa","#aaffaa","#aaffd4","#aaffff","#aad4ff","#aaaaff","#d4aaff","#ffaaff","#ffaad4"],function(e,t){_e+='<div class="palette_item" style="background-color: '+t+';" data-rgb="'+t+'"></div>'}),sr("#palette").append(_e);_e="",sr.each(["#FFF","#888","#000"],function(){_e+='<div class="color_block" style="background-color:'+this+';"></div>'}),sr("#bg_blocks").append(_e);var ye=sr("#bg_blocks div");ye.each(function(){sr(this).click(function(){ye.removeClass("cur_background"),sr(this).addClass("cur_background")})}),Q(sr.pref("bkgd_color"),sr.pref("bkgd_url")),sr("#image_save_opts input").val([sr.pref("img_save")]);var be=function(e,t){null==t&&(t=e.value),sr("#group_opacity").val(t),e&&e.handle||sr("#opac_slider").slider("option","value",t),pr.setOpacity(t/100)},xe=function(e,t,n){null==t&&(t=e.value),sr("#blur").val(t);var r=!1;e&&e.handle||(sr("#blur_slider").slider("option","value",t),r=!0),n?pr.setBlurNoUndo(t):pr.setBlur(t,r)};sr("#stroke_style").change(function(){pr.setStrokeAttr("stroke-dasharray",sr(this).val()),z()}),sr("#stroke_linejoin").change(function(){pr.setStrokeAttr("stroke-linejoin",sr(this).val()),z()}),sr("select").change(function(){sr(this).blur()});var we,Se,ke,Ce,Ae,Ee=!1;sr("#selLayerNames").change(function(){var e=this.options[this.selectedIndex].value,t=fr.notification.QmoveElemsToLayer.replace("%s",e),n=function(t){t&&(Ee=!0,pr.moveSelectedToLayer(e),pr.clearSelection(),V())};e&&(Ee?n(!0):sr.confirm(t,n))}),sr("#font_family").change(function(){pr.setFontFamily(this.value)}),sr("#seg_type").change(function(){pr.setSegType(sr(this).val())}),sr("#text").bind("keyup input",function(){pr.setTextContent(this.value)}),sr("#image_url").change(function(){X(this.value)}),sr("#link_url").change(function(){this.value.length?pr.setLinkURL(this.value):pr.removeHyperlink()}),sr("#g_title").change(function(){pr.setGroupTitle(this.value)}),sr(".attr_changer").change(function(){var e=this.getAttribute("data-attr"),t=this.value;if(!re(e,t,F))return sr.alert(fr.notification.invalidAttrValGiven),this.value=F.getAttribute(e),!1;if("id"!==e&&"class"!==e)if(isNaN(t))t=pr.convertToNum(e,t);else if("px"!==br.baseUnit){var n=J();(F[e]||"pathedit"===pr.getMode()||"x"===e||"y"===e)&&(t*=n[br.baseUnit])}if("id"===e){var r=F;pr.clearSelection(),r.id=t,pr.addToSelection([r],!0)}else pr.changeSelectedAttribute(e,t);this.blur()}),sr("#palette").mouseover(function(){var e=sr('<input type="hidden">');sr(this).append(e),e.focus().remove()}),sr(".palette_item").mousedown(function(e){var t=e.shiftKey||2===e.button?"stroke":"fill",n=sr(this).data("rgb"),r=void 0;"none"===n||"transparent"===n||"initial"===n?(n="none",r=new sr.jGraduate.Paint):r=new sr.jGraduate.Paint({alpha:100,solidColor:n.substr(1)}),b[t].setPaint(r),pr.setColor(t,n),"none"!==n&&1!==pr.getPaintOpacity(t)&&pr.setPaintOpacity(t,1),ee()}).bind("contextmenu",function(e){e.preventDefault()}),sr("#toggle_stroke_tools").on("click",function(){sr("#tools_bottom").toggleClass("expanded")}),we=_[0],Se=null,ke=null,Ce=!1,Ae=!1,sr("#svgcanvas").bind("mousemove mouseup",function(e){if(!1!==Ce)return we.scrollLeft-=e.clientX-Se,we.scrollTop-=e.clientY-ke,Se=e.clientX,ke=e.clientY,"mouseup"===e.type&&(Ce=!1),!1}).mousedown(function(e){if(1===e.button||!0===Ae)return Ce=!0,Se=e.clientX,ke=e.clientY,!1}),sr(window).mouseup(function(){Ce=!1}),sr(document).bind("keydown","space",function(e){pr.spaceKey=Ae=!0,e.preventDefault()}).bind("keyup","space",function(e){e.preventDefault(),pr.spaceKey=Ae=!1}).bind("keydown","shift",function(e){"zoom"===pr.getMode()&&_.css("cursor",A)}).bind("keyup","shift",function(e){"zoom"===pr.getMode()&&_.css("cursor",C)}),lr.setPanning=function(e){pr.spaceKey=Ae=e},function(){var e=sr("#main_icon"),t=sr("#main_icon span"),n=sr("#main_menu"),r=!1,a=0,i=!0,o=!1;sr(window).mouseup(function(t){r||(e.removeClass("buttondown"),"INPUT"!==t.target.tagName?n.fadeOut(200):o||(o=!0,sr(t.target).click(function(){n.css("margin-left","-9999px").show()}))),r=!1}).mousedown(function(e){sr(e.target).closest("div.tools_flyout, .contextMenu").length||sr(".tools_flyout:visible,.contextMenu").fadeOut(250)}),t.bind("mousedown",function(){e.hasClass("buttondown")?n.fadeOut(200):(n.css("margin-left",0).show(),a||(a=n.height()),n.css("height",0).animate({height:a},200),r=!0),e.toggleClass("buttondown buttonup")}).hover(function(){r=!0}).mouseout(function(){r=!1});var s=sr("#main_menu li");s.mouseover(function(){i="rgba(0, 0, 0, 0)"===sr(this).css("background-color"),s.unbind("mouseover"),i&&s.mouseover(function(){this.style.backgroundColor="#FFC"}).mouseout(function(){return this.style.backgroundColor="transparent",!0})})}(),lr.addDropDown=function(e,t,n){if(sr(e).length){var r=sr(e).find("button"),a=sr(e).find("ul").attr("id",sr(e)[0].id+"-list");n?sr(e).addClass("dropup"):sr("#option_lists").append(a),a.find("li").bind("mouseup",t);var i=!1;sr(window).mouseup(function(e){i||(r.removeClass("down"),a.hide()),i=!1}),r.bind("mousedown",function(){if(r.hasClass("down"))a.hide();else{if(!n){var t=sr(e).position();a.css({top:t.top+24,left:t.left-10})}a.show(),i=!0}r.toggleClass("down")}).hover(function(){i=!0}).mouseout(function(){i=!1})}},lr.addDropDown("#font_family_dropdown",function(){sr("#font_family").val(sr(this).text()).change()}),lr.addDropDown("#opacity_dropdown",function(){if(!sr(this).find("div").length){var e=parseInt(sr(this).text().split("%")[0],10);be(!1,e)}},!0),sr("#opac_slider").slider({start:function(){sr("#opacity_dropdown li:not(.special)").hide()},stop:function(){sr("#opacity_dropdown li").show(),sr(window).mouseup()},slide:function(e,t){be(t)}}),lr.addDropDown("#blur_dropdown",sr.noop);var Pe,Ge,Ie=!1;sr("#blur_slider").slider({max:10,step:.1,stop:function(e,t){Ie=!1,xe(t),sr("#blur_dropdown li").show(),sr(window).mouseup()},start:function(){Ie=!0},slide:function(e,t){xe(t,null,Ie)}}),lr.addDropDown("#zoom_dropdown",function(){var e=sr(this),t=e.data("val");t?ce(window,t):ue({value:parseFloat(e.text())})},!0),ve("#stroke_linecap","#linecap_opts",function(){q(this,!0)},{dropUp:!0}),ve("#stroke_linejoin","#linejoin_opts",function(){q(this,!0)},{dropUp:!0}),ve("#tool_position","#position_opts",function(){var e=this.id.replace("tool_pos","").charAt(0);pr.alignSelectedElements(e,"page")},{multiclick:!0}),Pe=void 0,Ge=function(){sr(Pe).blur()},sr("#svg_editor").find("button, select, input:not(#text)").focus(function(){Pe=this,E="toolbars",_.mousedown(Ge)}).blur(function(){E="canvas",_.unbind("mousedown",Ge),"textedit"===pr.getMode()&&sr("#text").focus()});var Te=function(){Y("#tool_fhpath")&&pr.setMode("fhpath")},Ne=function(){Y("#tool_line")&&pr.setMode("line")},Le=function(){Y("#tool_square")&&pr.setMode("square")},Me=function(){Y("#tool_rect")&&pr.setMode("rect")},Oe=function(){Y("#tool_fhrect")&&pr.setMode("fhrect")},Ve=function(){Y("#tool_circle")&&pr.setMode("circle")},je=function(){Y("#tool_ellipse")&&pr.setMode("ellipse")},Re=function(){Y("#tool_fhellipse")&&pr.setMode("fhellipse")},Be=function(){Y("#tool_image")&&pr.setMode("image")},De=function(){Y("#tool_zoom")&&(pr.setMode("zoom"),_.css("cursor",C))},Ue=function(e){var t=pr.getResolution();e=e?t.zoom*e:1,sr("#zoom").val(100*e),pr.setZoom(e),le(),$(!0)},Fe=function(){Y("#tool_zoom")&&(Ue(),P())},He=function(){Y("#tool_text")&&pr.setMode("text")},ze=function(){Y("#tool_path")&&pr.setMode("path")},qe=function(){(null!=F||H)&&pr.deleteSelectedElements()},Ye=function(){(null!=F||H)&&pr.cutSelectedElements()},We=function(){(null!=F||H)&&pr.copySelectedElements()},Xe=function(){var e=pr.getZoom(),t=(_[0].scrollLeft+_.width()/2)/e-pr.contentW,n=(_[0].scrollTop+_.height()/2)/e-pr.contentH;pr.pasteElements("point",t,n)},Qe=function(){null!=F&&pr.moveToTopSelectedElement()},Ke=function(){null!=F&&pr.moveToBottomSelectedElement()},Ze=function(e){null!=F&&pr.moveUpDownSelected(e)},$e=function(){null!=F&&pr.convertToPath()},Je=function(){null!=F&&v.reorient()},et=function(){(null!=F||H)&&sr.prompt(fr.notification.enterNewLinkURL,"http://",function(e){e&&pr.makeHyperlink(e)})},tt=function(e,t){if(null!=F||H){if(br.gridSnapping){var n=pr.getZoom()*br.snappingStep;e*=n,t*=n}pr.moveSelectedElements(e,t)}},nt=function(){sr("#tool_node_link").toggleClass("push_button_pressed tool_button");var e=sr("#tool_node_link").hasClass("push_button_pressed");v.linkControlPoints(e)},rt=function(){v.getNodePoint()&&v.clonePathNode()},at=function(){v.getNodePoint()&&v.deletePathNode()},it=function(){var e=sr("#tool_add_subpath"),t=!e.hasClass("push_button_pressed");e.toggleClass("push_button_pressed tool_button"),v.addSubPath(t)},ot=function(){v.opencloseSubPath()},st=function(){pr.cycleElement(1)},lt=function(){pr.cycleElement(0)},ct=function(e,t){if(null!=F&&!H){e||(t*=-1);var n=parseFloat(sr("#angle").val())+t;pr.setRotationAngle(n),ne()}},ut=function(){var e=br.dimensions;sr.confirm(fr.notification.QwantToClear,function(t){t&&(P(),pr.clear(),pr.setResolution(e[0],e[1]),$(!0),Ue(),V(),ne(),de(),pr.runExtensions("onNewDocument"))})},dt=function(){return pr.setBold(!pr.getBold()),ne(),!1},ht=function(){return pr.setItalic(!pr.getItalic()),ne(),!1},ft=void 0,pt=function(){sr.select("Select an image type for export: ",["PNG","JPEG","BMP","WEBP","PDF"],function(e){if(e){var n=void 0;if("PDF"===e)_r||a(),pr.exportPDF(n);else{mr||a();var r=parseInt(sr("#image-slider").val(),10)/100;pr.rasterExport(e,r,n)}}function a(){var e=fr.notification.loadingImage;"new"===br.exportWindowType&&lr.exportWindowCt++,n=br.canvasName+lr.exportWindowCt;var r=void 0,a=void 0;if(ft)a=ft;else{if(r='<!DOCTYPE html><html><head><meta charset="utf-8"><title>'+e+"</title></head><body><h1>"+e+"</h1></body><html>",("undefined"==typeof URL||t(URL))&&URL.createObjectURL){var i=new Blob([r],{type:"text/html"});a=URL.createObjectURL(i)}else a="data:text/html;base64;charset=utf-8,"+mt(r);ft=a}S=window.open(a,n)}},function(){var e=sr(this);"JPEG"===e.val()||"WEBP"===e.val()?sr("#image-slider").length||sr("<div><label>"+fr.ui.quality+'\n              <input id="image-slider"\n                type="range" min="1" max="100" value="92" />\n            </label></div>').appendTo(e.parent()):sr("#image-slider").parent().remove()})},gt=function(){pr.open()},vt=function(){},_t=function(){m.getUndoStackSize()>0&&(m.undo(),V())},yt=function(){m.getRedoStackSize()>0&&(m.redo(),V())},bt=function(){H?pr.groupSelectedElements():F&&pr.ungroupSelectedElement()},xt=function(){pr.cloneSelectedElements(20,20)},wt=function(){var e=this.id.replace("tool_align","").charAt(0);pr.alignSelectedElements(e,sr("#align_relative_to").val())},kt=function(){if(sr("#tool_wireframe").toggleClass("push_button_pressed tool_button"),_.toggleClass("wireframe"),!Wt){var e=sr("#wireframe_rules");e.length?e.empty():e=sr('<style id="wireframe_rules"></style>').appendTo("head"),ae()}};sr("#svg_docprops_container, #svg_prefs_container").draggable({cancel:"button,fieldset",containment:"window"}).css("position","absolute");var Ct,At,Et=!1,Pt=!1,Gt=function(){if(!Et){Et=!0,sr("#image_save_opts input").val([sr.pref("img_save")]);var e=pr.getResolution();"px"!==br.baseUnit&&(e.w=te(e.w)+br.baseUnit,e.h=te(e.h)+br.baseUnit),sr("#canvas_width").val(e.w),sr("#canvas_height").val(e.h),sr("#canvas_title").val(pr.getDocumentTitle()),sr("#svg_docprops").show()}},It=function(){sr("#svg_source_editor").hide(),B=!1,sr("#svg_source_textarea").blur()},Tt=function(){if(B){var e=function(){pr.clearSelection(),It(),Ue(),V(),oe(),de()};pr.setSvgString(sr("#svg_source_textarea").val())?e():sr.confirm(fr.notification.QerrorsRevertToSource,function(t){if(!t)return!1;e()}),P()}},Nt=function(){sr("#svg_docprops").hide(),sr("#canvas_width,#canvas_height").removeAttr("disabled"),sr("#resolution")[0].selectedIndex=0,sr("#image_save_opts input").val([sr.pref("img_save")]),Et=!1},Lt=function(){sr("#svg_prefs").hide(),Pt=!1},Mt=function(){var e=sr("#canvas_title").val();oe(e),pr.setDocumentTitle(e);var t=sr("#canvas_width"),n=t.val(),r=sr("#canvas_height"),a=r.val();return"fit"===n||re("width",n)?(t.parent().removeClass("error"),"fit"===a||re("height",a)?(r.parent().removeClass("error"),pr.setResolution(n,a)?(sr.pref("img_save",sr("#image_save_opts :checked").val()),$(),void Nt()):(sr.alert(fr.notification.noContentToFitTo),!1)):(sr.alert(fr.notification.invalidAttrValGiven),r.parent().addClass("error"),!1)):(sr.alert(fr.notification.invalidAttrValGiven),t.parent().addClass("error"),!1)},Ot=lr.savePreferences=function(){Q(sr("#bg_blocks div.cur_background").css("background-color")||"#FFF",sr("#canvas_bg_url").val());var t=sr("#lang_select").val();t!==sr.pref("lang")&&lr.putLocale(t,e,br),p(sr("#iconsize").val()),br.gridSnapping=sr("#grid_snapping_on")[0].checked,br.snappingStep=sr("#grid_snapping_step").val(),br.gridColor=sr("#grid_color").val(),br.showRulers=sr("#show_rulers")[0].checked,sr("#rulers").toggle(br.showRulers),br.showRulers&&Z(),br.baseUnit=sr("#base_unit").val(),pr.setConfig(br),$(),Lt()},Vt=sr.noop,jt=function(){sr("#dialog_box").hide(),B||Et||Pt?(B?D!==sr("#svg_source_textarea").val()?sr.confirm(fr.notification.QignoreSourceChanges,function(e){e&&It()}):It():Et?Nt():Pt&&Lt(),Vt()):ie&&pr.leaveContext()},Rt={width:sr(window).width(),height:sr(window).height()};if(O()&&(Vt=function(){0===_[0].scrollLeft&&0===_[0].scrollTop&&(_[0].scrollLeft=w.left,_[0].scrollTop=w.top)},w={left:_[0].scrollLeft,top:_[0].scrollTop},sr(window).resize(Vt),lr.ready(function(){setTimeout(function(){Vt()},500)}),_.scroll(function(){w={left:_[0].scrollLeft,top:_[0].scrollTop}})),sr(window).resize(function(e){sr.each(Rt,function(e,t){var n=sr(window)[e]();_[0]["scroll"+("width"===e?"Left":"Top")]-=(n-t)/2,Rt[e]=n}),h()}),_.scroll(function(){sr("#ruler_x").length&&(sr("#ruler_x")[0].scrollLeft=_[0].scrollLeft),sr("#ruler_y").length&&(sr("#ruler_y")[0].scrollTop=_[0].scrollTop)}),sr("#url_notice").click(function(){sr.alert(this.title)}),sr("#change_image_url").click(K),Ct="tool_button_current",At="",sr.each(["clear","open","save","source","delete","delete_multi","paste","clone","clone_multi","move_top","move_bottom"],function(e,t){At+=(e?",":"")+"#tool_"+t}),sr(At).mousedown(function(){sr(this).addClass(Ct)}).bind("mousedown mouseout",function(){sr(this).removeClass(Ct)}),sr("#tool_undo, #tool_redo").mousedown(function(){sr(this).hasClass("disabled")||sr(this).addClass(Ct)}).bind("mousedown mouseout",function(){sr(this).removeClass(Ct)}),j()&&!window.opera)for(var Bt=["tool_clear","tool_save","tool_source","tool_undo","tool_redo","tool_clone"],Dt=Bt.length;Dt--;){var Ut=document.getElementById(Bt[Dt]);if(Ut){var Ft=Ut.title,Ht=Ft.indexOf("Ctrl+");Ut.title=[Ft.substr(0,Ht),"Cmd+",Ft.substr(Ht+5)].join("")}}var zt=function(e){var t="stroke_color"===e.attr("id")?"stroke":"fill",n="stroke"===t?"Pick a Stroke Paint and Opacity":"Pick a Fill Paint and Opacity",r=e.offset(),a=b[t].paint;sr("#color_picker").draggable({cancel:".jGraduate_tabs, .jGraduate_colPick, .jGraduate_gradPick, .jPicker",containment:"window"}).css(br.colorPickerCSS||{left:r.left-140,bottom:40}).jGraduate({paint:a,window:{pickerTitle:n},images:{clientPath:br.jGraduatePath},newstop:"inverse"},function(e){a=new sr.jGraduate.Paint(e),b[t].setPaint(a),pr.setPaint(t,a),sr("#color_picker").hide()},function(){sr("#color_picker").hide()})},qt=function(e,t){var n=void 0,r=void 0,a=br["fill"===t?"initFill":"initStroke"],i=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg"><rect width="16.5" height="16.5"          fill="#'+a.color+'" opacity="'+a.opacity+'"/>          <defs><linearGradient id="gradbox_"/></defs></svg>',"text/xml").documentElement;(i=sr(e)[0].appendChild(document.importNode(i,!0))).setAttribute("width",16.5),this.rect=i.firstChild,this.defs=i.getElementsByTagName("defs")[0],this.grad=this.defs.firstChild,this.paint=new sr.jGraduate.Paint({solidColor:a.color}),this.type=t,this.setPaint=function(e,t){this.paint=e;var a=e.type,i=e.alpha/100,o="none";switch(a){case"solidColor":o="none"!==e[a]?"#"+e[a]:e[a];break;case"linearGradient":case"radialGradient":this.grad.remove(),this.grad=this.defs.appendChild(e[a]),o="url(#"+(this.grad.id="gradbox_"+this.type)+")"}this.rect.setAttribute("fill",o),this.rect.setAttribute("opacity",i),t&&(pr.setColor(this.type,n,!0),pr.setPaintOpacity(this.type,r,!0))},this.update=function(e){if(F){var t=this.type;switch(F.tagName){case"use":case"image":case"foreignObject":return;case"g":case"a":for(var a=F.getElementsByTagName("*"),i=null,o=0,s=a.length;o<s;o++){var l=a[o].getAttribute(t);if(0===o)i=l;else if(i!==l){i=null;break}}if(null===i)return void(n=null);n=i,r=1;break;default:r=parseFloat(F.getAttribute(t+"-opacity")),isNaN(r)&&(r=1);var c="fill"===t?"black":"none";n=F.getAttribute(t)||c}e&&(pr.setColor(t,n,!0),pr.setPaintOpacity(t,r,!0));var u=function(e,t,n){var r={alpha:t};if(e.startsWith("url(#")){var a=pr.getRefElem(e);r[(a=a?a.cloneNode(!0):sr("#"+n+"_color defs *")[0]).tagName]=a}else e.startsWith("#")?r.solidColor=e.substr(1):r.solidColor="none";return new sr.jGraduate.Paint(r)}(n,r*=100,t);this.setPaint(u)}},this.prep=function(){switch(this.paint.type){case"linearGradient":case"radialGradient":var e=new sr.jGraduate.Paint({copy:this.paint});pr.setPaint(t,e)}}};b.fill=new qt("#fill_color","fill"),b.stroke=new qt("#stroke_color","stroke"),sr("#stroke_width").val(br.initStroke.width),sr("#group_opacity").val(100*br.initOpacity);var Yt=b.fill.rect.cloneNode(!1);Yt.setAttribute("style","vector-effect:non-scaling-stroke");var Wt="non-scaling-stroke"===Yt.style.vectorEffect;Yt.removeAttribute("style");var Xt,Qt,Kt=b.fill.rect.ownerDocument.createElementNS(u.SVG,"feGaussianBlur");function $t(){pr.deleteCurrentLayer()&&(ne(),V(),sr("#layerlist tr.layer").removeClass("layersel"),sr("#layerlist tr.layer:first").addClass("layersel"))}function Jt(e){var t=pr.getCurrentDrawing().getNumLayers(),n=sr("#layerlist tr.layersel").index();(n>0||n<t-1)&&(n+=e,pr.setCurrentLayerPosition(t-n-1),V())}void 0===Kt.stdDeviationX&&sr("#tool_blur").hide(),sr(Kt).remove(),Xt="-"+f.toLowerCase()+"-zoom-",Qt=Xt+"in",_.css("cursor",Qt),_.css("cursor")===Qt&&(C=Qt,A=Xt+"out"),_.css("cursor","auto"),setTimeout(function(){pr.embedImage("images/logo.png",function(e){e||(sr("#image_save_opts [value=embed]").attr("disabled","disabled"),sr("#image_save_opts input").val(["ref"]),sr.pref("img_save","ref"),sr("#image_opt_embed").css("color","#666").attr("title",fr.notification.featNotSupported))})},1e3),sr("#fill_color, #tool_fill .icon_label").click(function(){zt(sr("#fill_color")),ee()}),sr("#stroke_color, #tool_stroke .icon_label").click(function(){zt(sr("#stroke_color")),ee()}),sr("#group_opacityLabel").click(function(){sr("#opacity_dropdown button").mousedown(),sr(window).mouseup()}),sr("#zoomLabel").click(function(){sr("#zoom_dropdown button").mousedown(),sr(window).mouseup()}),sr("#tool_move_top").mousedown(function(e){sr("#tools_stacking").show(),e.preventDefault()}),sr(".layer_button").mousedown(function(){sr(this).addClass("layer_buttonpressed")}).mouseout(function(){sr(this).removeClass("layer_buttonpressed")}).mouseup(function(){sr(this).removeClass("layer_buttonpressed")}),sr(".push_button").mousedown(function(){sr(this).hasClass("disabled")||sr(this).addClass("push_button_pressed").removeClass("push_button")}).mouseout(function(){sr(this).removeClass("push_button_pressed").addClass("push_button")}).mouseup(function(){sr(this).removeClass("push_button_pressed").addClass("push_button")}),sr("#layer_new").click(function(){var e=void 0,t=pr.getCurrentDrawing().getNumLayers();do{e=fr.layers.layer+" "+ ++t}while(pr.getCurrentDrawing().hasLayer(e));sr.prompt(fr.notification.enterUniqueLayerName,e,function(e){e&&(pr.getCurrentDrawing().hasLayer(e)?sr.alert(fr.notification.dupeLayerName):(pr.createLayer(e),ne(),V()))})}),sr("#layer_delete").click($t),sr("#layer_up").click(function(){Jt(-1)}),sr("#layer_down").click(function(){Jt(1)}),sr("#layer_rename").click(function(){var e=sr("#layerlist tr.layersel td.layername").text();sr.prompt(fr.notification.enterNewLayerName,"",function(t){t&&(e===t||pr.getCurrentDrawing().hasLayer(t)?sr.alert(fr.notification.layerHasThatName):(pr.renameCurrentLayer(t),V()))})});var en=-1,tn=!1,rn=!1,an=function(e){var t=sr("#ruler_x");sr("#sidepanels").width("+="+e),sr("#layerpanel").width("+="+e),t.css("right",parseInt(t.css("right"),10)+e),_.css("right",parseInt(_.css("right"),10)+e),pr.runExtensions("workareaResized")},on=function(e){if(rn&&-1!==en){tn=!0;var t=en-e.pageX,n=sr("#sidepanels").width();n+t>300?(t=300-n,n=300):n+t<2&&(t=2-n,n=2),0!==t&&(en-=t,an(t))}},sn=function(e){var t=sr("#sidepanels").width();an((t>2||e?2:150)-t)};sr("#sidepanel_handle").mousedown(function(e){en=e.pageX,sr(window).mousemove(on),rn=!1,setTimeout(function(){rn=!0},20)}).mouseup(function(e){tn||sn(),en=-1,tn=!1}),sr(window).mouseup(function(){en=-1,tn=!1,sr("#svg_editor").unbind("mousemove",on)}),V();sr(window).bind("load resize",function(){_.css("line-height",_.height()+"px")}),sr("#resolution").change(function(){var e=sr("#canvas_width,#canvas_height");if(this.selectedIndex)if("content"===this.value)e.val("fit").attr("disabled","disabled");else{var t=this.value.split("x");sr("#canvas_width").val(t[0]),sr("#canvas_height").val(t[1]),e.removeAttr("disabled")}else"fit"===sr("#canvas_width").val()&&e.removeAttr("disabled").val(100)}),sr("input,select").attr("autocomplete","off");var cn,un,dn=(cn=[{sel:"#tool_select",fn:W,evt:"click",key:["V",!0]},{sel:"#tool_fhpath",fn:Te,evt:"click",key:["Q",!0]},{sel:"#tool_line",fn:Ne,evt:"click",key:["L",!0]},{sel:"#tool_rect",fn:Me,evt:"mouseup",key:["R",!0],parent:"#tools_rect",icon:"rect"},{sel:"#tool_square",fn:Le,evt:"mouseup",parent:"#tools_rect",icon:"square"},{sel:"#tool_fhrect",fn:Oe,evt:"mouseup",parent:"#tools_rect",icon:"fh_rect"},{sel:"#tool_ellipse",fn:je,evt:"mouseup",key:["E",!0],parent:"#tools_ellipse",icon:"ellipse"},{sel:"#tool_circle",fn:Ve,evt:"mouseup",parent:"#tools_ellipse",icon:"circle"},{sel:"#tool_fhellipse",fn:Re,evt:"mouseup",parent:"#tools_ellipse",icon:"fh_ellipse"},{sel:"#tool_path",fn:ze,evt:"click",key:["P",!0]},{sel:"#tool_text",fn:He,evt:"click",key:["T",!0]},{sel:"#tool_image",fn:Be,evt:"mouseup"},{sel:"#tool_zoom",fn:De,evt:"mouseup",key:["Z",!0]},{sel:"#tool_clear",fn:ut,evt:"mouseup",key:["N",!0]},{sel:"#tool_save",fn:function(){var e;B?Tt():(e={images:sr.pref("img_save"),round_digits:6},pr.save(e))},evt:"mouseup",key:["S",!0]},{sel:"#tool_export",fn:pt,evt:"mouseup"},{sel:"#tool_open",fn:gt,evt:"mouseup",key:["O",!0]},{sel:"#tool_import",fn:vt,evt:"mouseup"},{sel:"#tool_source",fn:U,evt:"click",key:["U",!0]},{sel:"#tool_wireframe",fn:kt,evt:"click",key:["F",!0]},{sel:"#tool_source_cancel,.overlay,#tool_docprops_cancel,#tool_prefs_cancel",fn:jt,evt:"click",key:["esc",!1,!1],hidekey:!0},{sel:"#tool_source_save",fn:Tt,evt:"click"},{sel:"#tool_docprops_save",fn:Mt,evt:"click"},{sel:"#tool_docprops",fn:Gt,evt:"mouseup"},{sel:"#tool_prefs_save",fn:Ot,evt:"click"},{sel:"#tool_prefs_option",fn:function(){return function(){if(!Pt){Pt=!0,sr("#main_menu").hide();var e=sr("#bg_blocks div"),t="cur_background",n=yr.bkgd_color,r=sr.pref("bkgd_url");e.each(function(){var e=sr(this),r=e.css("background-color")===n;e.toggleClass(t,r),r&&sr("#canvas_bg_url").removeClass(t)}),n||e.eq(0).addClass(t),r&&sr("#canvas_bg_url").val(r),sr("#grid_snapping_on").prop("checked",br.gridSnapping),sr("#grid_snapping_step").attr("value",br.snappingStep),sr("#grid_color").attr("value",br.gridColor),sr("#svg_prefs").show()}}(),!1},evt:"mouseup"},{sel:"#tool_delete,#tool_delete_multi",fn:qe,evt:"click",key:["del/backspace",!0]},{sel:"#tool_reorient",fn:Je,evt:"click"},{sel:"#tool_node_link",fn:nt,evt:"click"},{sel:"#tool_node_clone",fn:rt,evt:"click"},{sel:"#tool_node_delete",fn:at,evt:"click"},{sel:"#tool_openclose_path",fn:ot,evt:"click"},{sel:"#tool_add_subpath",fn:it,evt:"click"},{sel:"#tool_move_top",fn:Qe,evt:"click",key:"ctrl+shift+]"},{sel:"#tool_move_bottom",fn:Ke,evt:"click",key:"ctrl+shift+["},{sel:"#tool_topath",fn:$e,evt:"click"},{sel:"#tool_make_link,#tool_make_link_multi",fn:et,evt:"click"},{sel:"#tool_undo",fn:_t,evt:"click"},{sel:"#tool_redo",fn:yt,evt:"click"},{sel:"#tool_clone,#tool_clone_multi",fn:xt,evt:"click",key:["D",!0]},{sel:"#tool_group_elements",fn:bt,evt:"click",key:["G",!0]},{sel:"#tool_ungroup",fn:bt,evt:"click"},{sel:"#tool_unlink_use",fn:bt,evt:"click"},{sel:"[id^=tool_align]",fn:wt,evt:"click"},{sel:"#tool_bold",fn:dt,evt:"mousedown"},{sel:"#tool_italic",fn:ht,evt:"mousedown"},{sel:"#sidepanel_handle",fn:sn,key:["X"]},{sel:"#copy_save_done",fn:jt,evt:"click"},{key:"ctrl+left",fn:function(){ct(0,1)}},{key:"ctrl+right",fn:function(){ct(1,1)}},{key:"ctrl+shift+left",fn:function(){ct(0,5)}},{key:"ctrl+shift+right",fn:function(){ct(1,5)}},{key:"shift+O",fn:lt},{key:"shift+P",fn:st},{key:[g+"up",!0],fn:function(){Ue(2)}},{key:[g+"down",!0],fn:function(){Ue(.5)}},{key:[g+"]",!0],fn:function(){Ze("Up")}},{key:[g+"[",!0],fn:function(){Ze("Down")}},{key:["up",!0],fn:function(){tt(0,-1)}},{key:["down",!0],fn:function(){tt(0,1)}},{key:["left",!0],fn:function(){tt(-1,0)}},{key:["right",!0],fn:function(){tt(1,0)}},{key:"shift+up",fn:function(){tt(0,-10)}},{key:"shift+down",fn:function(){tt(0,10)}},{key:"shift+left",fn:function(){tt(-10,0)}},{key:"shift+right",fn:function(){tt(10,0)}},{key:["alt+up",!0],fn:function(){pr.cloneSelectedElements(0,-1)}},{key:["alt+down",!0],fn:function(){pr.cloneSelectedElements(0,1)}},{key:["alt+left",!0],fn:function(){pr.cloneSelectedElements(-1,0)}},{key:["alt+right",!0],fn:function(){pr.cloneSelectedElements(1,0)}},{key:["alt+shift+up",!0],fn:function(){pr.cloneSelectedElements(0,-10)}},{key:["alt+shift+down",!0],fn:function(){pr.cloneSelectedElements(0,10)}},{key:["alt+shift+left",!0],fn:function(){pr.cloneSelectedElements(-10,0)}},{key:["alt+shift+right",!0],fn:function(){pr.cloneSelectedElements(10,0)}},{key:"A",fn:function(){pr.selectAllInCurrentLayer()}},{key:g+"z",fn:_t},{key:g+"shift+z",fn:yt},{key:g+"y",fn:yt},{key:g+"x",fn:Ye},{key:g+"c",fn:We},{key:g+"v",fn:Xe}],un={"4/Shift+4":"#tools_rect_show","5/Shift+5":"#tools_ellipse_show"},{setAll:function(){var e={};sr.each(cn,function(t,n){var r=void 0;if(n.sel){if(!(r=sr(n.sel)).length)return!0;if(n.evt&&(R()&&"click"===n.evt&&(n.evt="mousedown"),r[n.evt](n.fn)),n.parent&&sr(n.parent+"_show").length){var a=sr(n.parent);a.length||(a=ge(n.parent.substr(1))),a.append(r),Array.isArray(e[n.parent])||(e[n.parent]=[]),e[n.parent].push(n)}}if(n.key){var i=void 0,o=!1;Array.isArray(n.key)?(i=n.key[0],n.key.length>1&&(o=n.key[1])):i=n.key,i+="";var s=n.fn;if(sr.each(i.split("/"),function(e,t){sr(document).bind("keydown",t,function(e){return s(),o&&e.preventDefault(),!1})}),n.sel&&!n.hidekey&&r.attr("title")){var l=r.attr("title").split("[")[0]+" ("+i+")";un[i]=n.sel,r.parents("#main_menu").length||r.attr("title",l)}}}),pe(e),sr(".attr_changer, #image_url").bind("keydown","return",function(e){sr(this).change(),e.preventDefault()}),sr(window).bind("keydown","tab",function(e){"canvas"===E&&(e.preventDefault(),st())}).bind("keydown","shift+tab",function(e){"canvas"===E&&(e.preventDefault(),lt())}),sr("#tool_zoom").dblclick(Fe)},setTitles:function(){sr.each(un,function(e,t){var n=sr(t).parents("#main_menu").length;sr(t).each(function(){var t=void 0;t=n?sr(this).text().split(" [")[0]:this.title.split(" [")[0];var r="";sr.each(e.split("/"),function(e,t){var n=t.split("+"),a="";n.length>1&&(a=n[0]+"+",t=n[1]),r+=(e?"/":"")+a+(fr["key_"+t]||t)}),n?this.lastChild.textContent=t+" ["+r+"]":this.title=t+" ["+r+"]"})})},getButtonData:function(e){var t=void 0;return sr.each(cn,function(n,r){r.sel===e&&(t=r)}),t}});dn.setAll(),lr.ready(function(){var e=br.initTool,t=sr("#tools_left, #svg_editor .tools_flyout"),n=t.find("#tool_"+e),r=t.find("#"+e);(n.length?n:r.length?r:sr("#tool_select")).click().mouseup(),br.wireframe&&sr("#tool_wireframe").click(),br.showlayers&&sn(),sr("#rulers").toggle(!!br.showRulers),br.showRulers&&(sr("#show_rulers")[0].checked=!0),br.baseUnit&&sr("#base_unit").val(br.baseUnit),br.gridSnapping&&(sr("#grid_snapping_on")[0].checked=!0),br.snappingStep&&sr("#grid_snapping_step").val(br.snappingStep),br.gridColor&&sr("#grid_color").val(br.gridColor)}),sr("#rect_rx").SpinButton({min:0,max:1e3,stateObj:d,callback:function(e){pr.setRectRadius(e.value)}}),sr("#stroke_width").SpinButton({min:0,max:99,smallStep:.1,stateObj:d,callback:function(e){var t=e.value;0===t&&F&&["line","polyline"].includes(F.nodeName)&&(t=e.value=1),pr.setStrokeWidth(t)}}),sr("#angle").SpinButton({min:-180,max:180,step:5,stateObj:d,callback:function(e){pr.setRotationAngle(e.value),sr("#tool_reorient").toggleClass("disabled",0===parseInt(e.value,10))}}),sr("#font_size").SpinButton({min:.001,stepfunc:function(e,t){var n=Number(e.value),r=n+t,a=r>=n;return 0===t?n:n>=24?a?Math.round(1.1*n):Math.round(n/1.1):n<=1?a?2*n:n/2:r},stateObj:d,callback:function(e){pr.setFontSize(e.value)}}),sr("#group_opacity").SpinButton({min:0,max:100,step:5,stateObj:d,callback:be}),sr("#blur").SpinButton({min:0,max:10,step:.1,stateObj:d,callback:xe}),sr("#zoom").SpinButton({min:.001,max:1e4,step:50,stepfunc:function(e,t){var n=Number(e.value);if(0===n)return 100;var r=n+t;return 0===t?n:n>=100?r:r>=n?2*n:n/2},stateObj:d,callback:ue}).val(100*pr.getZoom()),sr("#workarea").contextMenu({menu:"cmenu_canvas",inSpeed:0},function(e,t,n){switch(e){case"delete":qe();break;case"cut":Ye();break;case"copy":We();break;case"paste":pr.pasteElements();break;case"paste_in_place":pr.pasteElements("in_place");break;case"group":case"group_elements":pr.groupSelectedElements();break;case"ungroup":pr.ungroupSelectedElement();break;case"move_front":Qe();break;case"move_up":Ze("Up");break;case"move_down":Ze("Down");break;case"move_back":Ke();break;default:Boolean(Zt[e])&&function(e){return Zt[e].action}(e).call()}});var hn=function(e,t,n){switch(e){case"dupe":r=pr.getCurrentDrawing().getCurrentLayerName()+" copy",sr.prompt(fr.notification.enterUniqueLayerName,r,function(e){e&&(pr.getCurrentDrawing().hasLayer(e)?sr.alert(fr.notification.dupeLayerName):(pr.cloneLayer(e),ne(),V()))});break;case"delete":$t();break;case"merge_down":sr("#layerlist tr.layersel").index()!==pr.getCurrentDrawing().getNumLayers()-1&&(pr.mergeLayer(),ne(),V());break;case"merge_all":pr.mergeAllLayers(),ne(),V()}var r};function fn(){var e=void 0;try{e=localStorage.getItem("svgedit_clipboard")}catch(e){}y[(e?"en":"dis")+"ableContextMenuItems"]("#paste,#paste_in_place")}if(sr("#layerlist").contextMenu({menu:"cmenu_layers",inSpeed:0},hn),sr("#layer_moreopts").contextMenu({menu:"cmenu_layers",inSpeed:0,allowLeft:!0},hn),sr(".contextMenu li").mousedown(function(e){e.preventDefault()}),sr("#cmenu_canvas li").disableContextMenu(),y.enableContextMenuItems("#delete,#cut,#copy"),fn(),window.addEventListener("storage",function(e){"svgedit_clipboard"===e.key&&fn()}),window.addEventListener("beforeunload",function(e){if(0===m.getUndoStackSize()&&(lr.showSaveWarning=!1),!br.no_save_warning&&lr.showSaveWarning)return e.returnValue=fr.notification.unsavedChanges,fr.notification.unsavedChanges},!1),lr.canvas.getUIStrings=function(){return fr},lr.openPrep=function(e){sr("#main_menu").hide(),0===m.getUndoStackSize()?e(!0):sr.confirm(fr.notification.QwantToOpen,e)},window.FileReader){var pn=function(e){sr.process_cancel(fr.notification.loadingImage),e.stopPropagation(),e.preventDefault(),sr("#workarea").removeAttr("style"),sr("#main_menu").hide();var t="drop"===e.type?e.dataTransfer.files[0]:this.files[0];if(t){if(t.type.includes("image")){var n=void 0;t.type.includes("svg")?((n=new FileReader).onloadend=function(e){var t=pr.importSvgString(e.target.result,!0);pr.ungroupSelectedElement(),pr.ungroupSelectedElement(),pr.groupSelectedElements(),pr.alignSelectedElements("m","page"),pr.alignSelectedElements("c","page"),pr.selectOnly([t]),sr("#dialog_box").hide()},n.readAsText(t)):((n=new FileReader).onloadend=function(e){var t=100,n=100,r=new Image;r.src=e.target.result,r.style.opacity=0,r.onload=function(){var a,i,o;t=r.offsetWidth,n=r.offsetHeight,a=t,i=n,o=pr.addSvgElementFromJson({element:"image",attr:{x:0,y:0,width:a,height:i,id:pr.getNextId(),style:"pointer-events:inherit"}}),pr.setHref(o,e.target.result),pr.selectOnly([o]),pr.alignSelectedElements("m","page"),pr.alignSelectedElements("c","page"),ne(),sr("#dialog_box").hide()}},n.readAsDataURL(t))}}else sr("#dialog_box").hide()};_[0].addEventListener("dragenter",function(e){e.stopPropagation(),e.preventDefault()},!1),_[0].addEventListener("dragover",function(e){e.stopPropagation(),e.preventDefault()},!1),_[0].addEventListener("dragleave",function(e){e.stopPropagation(),e.preventDefault()},!1),_[0].addEventListener("drop",pn,!1);var gn=sr('<input type="file">').change(function(){var e=this;lr.openPrep(function(t){if(t&&(pr.clear(),1===e.files.length)){sr.process_cancel(fr.notification.loadingImage);var n=new FileReader;n.onloadend=function(e){xr(e.target.result),$()},n.readAsText(e.files[0])}})});sr("#tool_open").show().prepend(gn);var vn=sr('<input type="file">').change(pn);sr("#tool_import").show().prepend(vn)}$(!0);var mn=lr.setLang=function(e,t){if(lr.langChanged=!0,sr.pref("lang",e),sr("#lang_select").val(e),t){sr.extend(fr,t);var n=sr("#layerlist tr.layersel td.layername").text()===fr.common.layer+" 1";if(pr.setUiStrings(t),dn.setTitles(),n&&(pr.renameCurrentLayer(fr.common.layer+" 1"),V()),me.length)for(;me.length;){me.shift().langReady({lang:e,uiStrings:fr})}else pr.runExtensions("langReady",{lang:e,uiStrings:fr});pr.runExtensions("langChanged",e),fe();sr.each({"#stroke_color":"#tool_stroke .icon_label, #tool_stroke .color_block","#fill_color":"#tool_fill label, #tool_fill .color_block","#linejoin_miter":"#cur_linejoin","#linecap_butt":"#cur_linecap"},function(e,t){sr(t).attr("title",sr(e)[0].title)}),sr("#multiselected_panel div[id^=tool_align]").each(function(){sr("#tool_pos"+this.id.substr(10))[0].title=this.title})}};!function(e){ar=e}({addLangData:function(e){return lr.canvas.runExtensions("addlangData",e,!0)},curConfig:br,setLang:mn}),"file:"===document.location.protocol?setTimeout(s,100):s()},lr.ready=function(e){vr?e():cr.push(e)},lr.runCallbacks=function(){return Promise.all(cr.map(function(e){return e()})).then(function(){vr=!0})},lr.loadFromString=function(e){lr.ready(function(){xr(e)})},lr.disableUI=function(e){},lr.loadFromURL=function(e,t){t||(t={});var n=t,r=n.cache,a=n.callback;lr.ready(function(){sr.ajax({url:e,dataType:"text",cache:!!r,beforeSend:function(){sr.process_cancel(fr.notification.loadingImage)},success:function(e){xr(e,a)},error:function(e,t,n){404!==e.status&&e.responseText?xr(e.responseText,a):sr.alert(fr.notification.URLloadFail+": \n"+n,a)},complete:function(){sr("#dialog_box").hide()}})})},lr.loadFromDataURI=function(e){lr.ready(function(){var t=!1,n=e.match(/^data:image\/svg\+xml;base64,/);n?t=!0:n=e.match(/^data:image\/svg\+xml(?:;(?:utf8)?)?,/),n&&(n=n[0]);var r=e.slice(n.length);xr(t?_t(r):decodeURIComponent(r))})},lr.addExtension=function(){if(pr){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];pr.addExtension.apply(this,t)}},lr.ready(function(){!function(){for(var e in Zt)$t(Zt[e])}()}),Promise.resolve().then(function(){lr.init()}),lr});
//# sourceMappingURL=index-umd.min.js.map
