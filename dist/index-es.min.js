function touchHandler(e){var t=e.changedTouches,n=t[0],a="";switch(e.type){case"touchstart":a="mousedown";break;case"touchmove":a="mousemove";break;case"touchend":a="mouseup";break;default:return}var r=document.createEvent("MouseEvent");r.initMouseEvent(a,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),t.length<2&&(n.target.dispatchEvent(r),e.preventDefault())}document.addEventListener("touchstart",touchHandler,!0),document.addEventListener("touchmove",touchHandler,!0),document.addEventListener("touchend",touchHandler,!0),document.addEventListener("touchcancel",touchHandler,!0);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},possibleConstructorReturn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},slicedToArray=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(r)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),toConsumableArray=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},NS={HTML:"http://www.w3.org/1999/xhtml",MATH:"http://www.w3.org/1998/Math/MathML",SE:"http://svg-edit.googlecode.com",SVG:"http://www.w3.org/2000/svg",XLINK:"http://www.w3.org/1999/xlink",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"},getReverseNS=function(){var e={};return Object.entries(NS).forEach(function(t){var n=slicedToArray(t,2),a=n[0],r=n[1];e[r]=a.toLowerCase()}),e};!function(){if(!("SVGPathSeg"in window)){var e=function(){function e(t,n,a){classCallCheck(this,e),this.pathSegType=t,this.pathSegTypeAsLetter=n,this._owningPathSegList=a}return createClass(e,[{key:"_segmentChanged",value:function(){this._owningPathSegList&&this._owningPathSegList.segmentChanged(this)}}]),e}();e.prototype.classname="SVGPathSeg",e.PATHSEG_UNKNOWN=0,e.PATHSEG_CLOSEPATH=1,e.PATHSEG_MOVETO_ABS=2,e.PATHSEG_MOVETO_REL=3,e.PATHSEG_LINETO_ABS=4,e.PATHSEG_LINETO_REL=5,e.PATHSEG_CURVETO_CUBIC_ABS=6,e.PATHSEG_CURVETO_CUBIC_REL=7,e.PATHSEG_CURVETO_QUADRATIC_ABS=8,e.PATHSEG_CURVETO_QUADRATIC_REL=9,e.PATHSEG_ARC_ABS=10,e.PATHSEG_ARC_REL=11,e.PATHSEG_LINETO_HORIZONTAL_ABS=12,e.PATHSEG_LINETO_HORIZONTAL_REL=13,e.PATHSEG_LINETO_VERTICAL_ABS=14,e.PATHSEG_LINETO_VERTICAL_REL=15,e.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS=16,e.PATHSEG_CURVETO_CUBIC_SMOOTH_REL=17,e.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS=18,e.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL=19;var t=function(t){function n(t){return classCallCheck(this,n),possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_CLOSEPATH,"z",t))}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegClosePath]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter}},{key:"clone",value:function(){return new n(void 0)}}]),n}(),n=function(t){function n(t,a,r){classCallCheck(this,n);var i=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_MOVETO_ABS,"M",t));return i._x=a,i._y=r,i}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegMovetoAbs]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y)}}]),n}();Object.defineProperties(n.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0}});var a=function(t){function n(t,a,r){classCallCheck(this,n);var i=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_MOVETO_REL,"m",t));return i._x=a,i._y=r,i}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegMovetoRel]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y)}}]),n}();Object.defineProperties(a.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0}});var r=function(t){function n(t,a,r){classCallCheck(this,n);var i=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_LINETO_ABS,"L",t));return i._x=a,i._y=r,i}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegLinetoAbs]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y)}}]),n}();Object.defineProperties(r.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0}});var i=function(t){function n(t,a,r){classCallCheck(this,n);var i=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_LINETO_REL,"l",t));return i._x=a,i._y=r,i}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegLinetoRel]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y)}}]),n}();Object.defineProperties(i.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0}});var s=function(t){function n(t,a,r,i,s,o,l){classCallCheck(this,n);var u=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_CURVETO_CUBIC_ABS,"C",t));return u._x=a,u._y=r,u._x1=i,u._y1=s,u._x2=o,u._y2=l,u}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegCurvetoCubicAbs]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)}}]),n}();Object.defineProperties(s.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0},x1:{get:function(){return this._x1},set:function(e){this._x1=e,this._segmentChanged()},enumerable:!0},y1:{get:function(){return this._y1},set:function(e){this._y1=e,this._segmentChanged()},enumerable:!0},x2:{get:function(){return this._x2},set:function(e){this._x2=e,this._segmentChanged()},enumerable:!0},y2:{get:function(){return this._y2},set:function(e){this._y2=e,this._segmentChanged()},enumerable:!0}});var o=function(t){function n(t,a,r,i,s,o,l){classCallCheck(this,n);var u=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_CURVETO_CUBIC_REL,"c",t));return u._x=a,u._y=r,u._x1=i,u._y1=s,u._x2=o,u._y2=l,u}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegCurvetoCubicRel]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)}}]),n}();Object.defineProperties(o.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0},x1:{get:function(){return this._x1},set:function(e){this._x1=e,this._segmentChanged()},enumerable:!0},y1:{get:function(){return this._y1},set:function(e){this._y1=e,this._segmentChanged()},enumerable:!0},x2:{get:function(){return this._x2},set:function(e){this._x2=e,this._segmentChanged()},enumerable:!0},y2:{get:function(){return this._y2},set:function(e){this._y2=e,this._segmentChanged()},enumerable:!0}});var l=function(t){function n(t,a,r,i,s){classCallCheck(this,n);var o=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_CURVETO_QUADRATIC_ABS,"Q",t));return o._x=a,o._y=r,o._x1=i,o._y1=s,o}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegCurvetoQuadraticAbs]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y,this._x1,this._y1)}}]),n}();Object.defineProperties(l.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0},x1:{get:function(){return this._x1},set:function(e){this._x1=e,this._segmentChanged()},enumerable:!0},y1:{get:function(){return this._y1},set:function(e){this._y1=e,this._segmentChanged()},enumerable:!0}});var u=function(t){function n(t,a,r,i,s){classCallCheck(this,n);var o=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_CURVETO_QUADRATIC_REL,"q",t));return o._x=a,o._y=r,o._x1=i,o._y1=s,o}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegCurvetoQuadraticRel]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y,this._x1,this._y1)}}]),n}();Object.defineProperties(u.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0},x1:{get:function(){return this._x1},set:function(e){this._x1=e,this._segmentChanged()},enumerable:!0},y1:{get:function(){return this._y1},set:function(e){this._y1=e,this._segmentChanged()},enumerable:!0}});var c=function(t){function n(t,a,r,i,s,o,l,u){classCallCheck(this,n);var c=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_ARC_ABS,"A",t));return c._x=a,c._y=r,c._r1=i,c._r2=s,c._angle=o,c._largeArcFlag=l,c._sweepFlag=u,c}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegArcAbs]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)}}]),n}();Object.defineProperties(c.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0},r1:{get:function(){return this._r1},set:function(e){this._r1=e,this._segmentChanged()},enumerable:!0},r2:{get:function(){return this._r2},set:function(e){this._r2=e,this._segmentChanged()},enumerable:!0},angle:{get:function(){return this._angle},set:function(e){this._angle=e,this._segmentChanged()},enumerable:!0},largeArcFlag:{get:function(){return this._largeArcFlag},set:function(e){this._largeArcFlag=e,this._segmentChanged()},enumerable:!0},sweepFlag:{get:function(){return this._sweepFlag},set:function(e){this._sweepFlag=e,this._segmentChanged()},enumerable:!0}});var h=function(t){function n(t,a,r,i,s,o,l,u){classCallCheck(this,n);var c=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_ARC_REL,"a",t));return c._x=a,c._y=r,c._r1=i,c._r2=s,c._angle=o,c._largeArcFlag=l,c._sweepFlag=u,c}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegArcRel]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)}}]),n}();Object.defineProperties(h.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0},r1:{get:function(){return this._r1},set:function(e){this._r1=e,this._segmentChanged()},enumerable:!0},r2:{get:function(){return this._r2},set:function(e){this._r2=e,this._segmentChanged()},enumerable:!0},angle:{get:function(){return this._angle},set:function(e){this._angle=e,this._segmentChanged()},enumerable:!0},largeArcFlag:{get:function(){return this._largeArcFlag},set:function(e){this._largeArcFlag=e,this._segmentChanged()},enumerable:!0},sweepFlag:{get:function(){return this._sweepFlag},set:function(e){this._sweepFlag=e,this._segmentChanged()},enumerable:!0}});var d=function(t){function n(t,a){classCallCheck(this,n);var r=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_LINETO_HORIZONTAL_ABS,"H",t));return r._x=a,r}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegLinetoHorizontalAbs]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x}},{key:"clone",value:function(){return new n(void 0,this._x)}}]),n}();Object.defineProperty(d.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0});var f=function(t){function n(t,a){classCallCheck(this,n);var r=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_LINETO_HORIZONTAL_REL,"h",t));return r._x=a,r}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegLinetoHorizontalRel]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x}},{key:"clone",value:function(){return new n(void 0,this._x)}}]),n}();Object.defineProperty(f.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0});var p=function(t){function n(t,a){classCallCheck(this,n);var r=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_LINETO_VERTICAL_ABS,"V",t));return r._y=a,r}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegLinetoVerticalAbs]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._y)}}]),n}();Object.defineProperty(p.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0});var g=function(t){function n(t,a){classCallCheck(this,n);var r=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_LINETO_VERTICAL_REL,"v",t));return r._y=a,r}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegLinetoVerticalRel]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._y)}}]),n}();Object.defineProperty(g.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0});var v=function(t){function n(t,a,r,i,s){classCallCheck(this,n);var o=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS,"S",t));return o._x=a,o._y=r,o._x2=i,o._y2=s,o}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegCurvetoCubicSmoothAbs]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y,this._x2,this._y2)}}]),n}();Object.defineProperties(v.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0},x2:{get:function(){return this._x2},set:function(e){this._x2=e,this._segmentChanged()},enumerable:!0},y2:{get:function(){return this._y2},set:function(e){this._y2=e,this._segmentChanged()},enumerable:!0}});var m=function(t){function n(t,a,r,i,s){classCallCheck(this,n);var o=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_CURVETO_CUBIC_SMOOTH_REL,"s",t));return o._x=a,o._y=r,o._x2=i,o._y2=s,o}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegCurvetoCubicSmoothRel]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y,this._x2,this._y2)}}]),n}();Object.defineProperties(m.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0},x2:{get:function(){return this._x2},set:function(e){this._x2=e,this._segmentChanged()},enumerable:!0},y2:{get:function(){return this._y2},set:function(e){this._y2=e,this._segmentChanged()},enumerable:!0}});var y=function(t){function n(t,a,r){classCallCheck(this,n);var i=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS,"T",t));return i._x=a,i._y=r,i}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegCurvetoQuadraticSmoothAbs]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y)}}]),n}();Object.defineProperties(y.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0}});var b=function(t){function n(t,a,r){classCallCheck(this,n);var i=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL,"t",t));return i._x=a,i._y=r,i}return inherits(n,e),createClass(n,[{key:"toString",value:function(){return"[object SVGPathSegCurvetoQuadraticSmoothRel]"}},{key:"_asPathString",value:function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y}},{key:"clone",value:function(){return new n(void 0,this._x,this._y)}}]),n}();Object.defineProperties(b.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._segmentChanged()},enumerable:!0},y:{get:function(){return this._y},set:function(e){this._y=e,this._segmentChanged()},enumerable:!0}}),SVGPathElement.prototype.createSVGPathSegClosePath=function(){return new t(void 0)},SVGPathElement.prototype.createSVGPathSegMovetoAbs=function(e,t){return new n(void 0,e,t)},SVGPathElement.prototype.createSVGPathSegMovetoRel=function(e,t){return new a(void 0,e,t)},SVGPathElement.prototype.createSVGPathSegLinetoAbs=function(e,t){return new r(void 0,e,t)},SVGPathElement.prototype.createSVGPathSegLinetoRel=function(e,t){return new i(void 0,e,t)},SVGPathElement.prototype.createSVGPathSegCurvetoCubicAbs=function(e,t,n,a,r,i){return new s(void 0,e,t,n,a,r,i)},SVGPathElement.prototype.createSVGPathSegCurvetoCubicRel=function(e,t,n,a,r,i){return new o(void 0,e,t,n,a,r,i)},SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticAbs=function(e,t,n,a){return new l(void 0,e,t,n,a)},SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticRel=function(e,t,n,a){return new u(void 0,e,t,n,a)},SVGPathElement.prototype.createSVGPathSegArcAbs=function(e,t,n,a,r,i,s){return new c(void 0,e,t,n,a,r,i,s)},SVGPathElement.prototype.createSVGPathSegArcRel=function(e,t,n,a,r,i,s){return new h(void 0,e,t,n,a,r,i,s)},SVGPathElement.prototype.createSVGPathSegLinetoHorizontalAbs=function(e){return new d(void 0,e)},SVGPathElement.prototype.createSVGPathSegLinetoHorizontalRel=function(e){return new f(void 0,e)},SVGPathElement.prototype.createSVGPathSegLinetoVerticalAbs=function(e){return new p(void 0,e)},SVGPathElement.prototype.createSVGPathSegLinetoVerticalRel=function(e){return new g(void 0,e)},SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothAbs=function(e,t,n,a){return new v(void 0,e,t,n,a)},SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothRel=function(e,t,n,a){return new m(void 0,e,t,n,a)},SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothAbs=function(e,t){return new y(void 0,e,t)},SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothRel=function(e,t){return new b(void 0,e,t)},"getPathSegAtLength"in SVGPathElement.prototype||(SVGPathElement.prototype.getPathSegAtLength=function(e){if(void 0===e||!isFinite(e))throw new Error("Invalid arguments.");var t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("d",this.getAttribute("d"));var n=t.pathSegList.numberOfItems-1;if(n<=0)return 0;do{if(t.pathSegList.removeItem(n),e>t.getTotalLength())break;n--}while(n>0);return n}),window.SVGPathSeg=e,window.SVGPathSegClosePath=t,window.SVGPathSegMovetoAbs=n,window.SVGPathSegMovetoRel=a,window.SVGPathSegLinetoAbs=r,window.SVGPathSegLinetoRel=i,window.SVGPathSegCurvetoCubicAbs=s,window.SVGPathSegCurvetoCubicRel=o,window.SVGPathSegCurvetoQuadraticAbs=l,window.SVGPathSegCurvetoQuadraticRel=u,window.SVGPathSegArcAbs=c,window.SVGPathSegArcRel=h,window.SVGPathSegLinetoHorizontalAbs=d,window.SVGPathSegLinetoHorizontalRel=f,window.SVGPathSegLinetoVerticalAbs=p,window.SVGPathSegLinetoVerticalRel=g,window.SVGPathSegCurvetoCubicSmoothAbs=v,window.SVGPathSegCurvetoCubicSmoothRel=m,window.SVGPathSegCurvetoQuadraticSmoothAbs=y,window.SVGPathSegCurvetoQuadraticSmoothRel=b}if(!("SVGPathSegList"in window&&"appendItem"in SVGPathSegList.prototype)){var _=function(){function e(t){classCallCheck(this,e),this._pathElement=t,this._list=this._parsePath(this._pathElement.getAttribute("d")),this._mutationObserverConfig={attributes:!0,attributeFilter:["d"]},this._pathElementMutationObserver=new MutationObserver(this._updateListFromPathMutations.bind(this)),this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)}return createClass(e,[{key:"_checkPathSynchronizedToList",value:function(){this._updateListFromPathMutations(this._pathElementMutationObserver.takeRecords())}},{key:"_updateListFromPathMutations",value:function(e){if(this._pathElement){var t=!1;e.forEach(function(e){"d"===e.attributeName&&(t=!0)}),t&&(this._list=this._parsePath(this._pathElement.getAttribute("d")))}}},{key:"_writeListToPath",value:function(){this._pathElementMutationObserver.disconnect(),this._pathElement.setAttribute("d",e._pathSegArrayAsString(this._list)),this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)}},{key:"segmentChanged",value:function(e){this._writeListToPath()}},{key:"clear",value:function(){this._checkPathSynchronizedToList(),this._list.forEach(function(e){e._owningPathSegList=null}),this._list=[],this._writeListToPath()}},{key:"initialize",value:function(e){return this._checkPathSynchronizedToList(),this._list=[e],e._owningPathSegList=this,this._writeListToPath(),e}},{key:"_checkValidIndex",value:function(e){if(isNaN(e)||e<0||e>=this.numberOfItems)throw new Error("INDEX_SIZE_ERR")}},{key:"getItem",value:function(e){return this._checkPathSynchronizedToList(),this._checkValidIndex(e),this._list[e]}},{key:"insertItemBefore",value:function(e,t){return this._checkPathSynchronizedToList(),t>this.numberOfItems&&(t=this.numberOfItems),e._owningPathSegList&&(e=e.clone()),this._list.splice(t,0,e),e._owningPathSegList=this,this._writeListToPath(),e}},{key:"replaceItem",value:function(e,t){return this._checkPathSynchronizedToList(),e._owningPathSegList&&(e=e.clone()),this._checkValidIndex(t),this._list[t]=e,e._owningPathSegList=this,this._writeListToPath(),e}},{key:"removeItem",value:function(e){this._checkPathSynchronizedToList(),this._checkValidIndex(e);var t=this._list[e];return this._list.splice(e,1),this._writeListToPath(),t}},{key:"appendItem",value:function(e){return this._checkPathSynchronizedToList(),e._owningPathSegList&&(e=e.clone()),this._list.push(e),e._owningPathSegList=this,this._writeListToPath(),e}},{key:"_parsePath",value:function(e){if(!e||!e.length)return[];var t=this,n=function(){function e(){classCallCheck(this,e),this.pathSegList=[]}return createClass(e,[{key:"appendSegment",value:function(e){this.pathSegList.push(e)}}]),e}(),a=function(){function e(t){classCallCheck(this,e),this._string=t,this._currentIndex=0,this._endIndex=this._string.length,this._previousCommand=SVGPathSeg.PATHSEG_UNKNOWN,this._skipOptionalSpaces()}return createClass(e,[{key:"_isCurrentSpace",value:function(){var e=this._string[this._currentIndex];return e<=" "&&(" "===e||"\n"===e||"\t"===e||"\r"===e||"\f"===e)}},{key:"_skipOptionalSpaces",value:function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex++;return this._currentIndex<this._endIndex}},{key:"_skipOptionalSpacesOrDelimiter",value:function(){return!(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!==this._string.charAt(this._currentIndex))&&(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","===this._string.charAt(this._currentIndex)&&(this._currentIndex++,this._skipOptionalSpaces()),this._currentIndex<this._endIndex)}},{key:"hasMoreData",value:function(){return this._currentIndex<this._endIndex}},{key:"peekSegmentType",value:function(){var e=this._string[this._currentIndex];return this._pathSegTypeFromChar(e)}},{key:"_pathSegTypeFromChar",value:function(e){switch(e){case"Z":case"z":return SVGPathSeg.PATHSEG_CLOSEPATH;case"M":return SVGPathSeg.PATHSEG_MOVETO_ABS;case"m":return SVGPathSeg.PATHSEG_MOVETO_REL;case"L":return SVGPathSeg.PATHSEG_LINETO_ABS;case"l":return SVGPathSeg.PATHSEG_LINETO_REL;case"C":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS;case"c":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL;case"Q":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS;case"q":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL;case"A":return SVGPathSeg.PATHSEG_ARC_ABS;case"a":return SVGPathSeg.PATHSEG_ARC_REL;case"H":return SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS;case"h":return SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL;case"V":return SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS;case"v":return SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL;case"S":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS;case"s":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL;case"T":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS;case"t":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL;default:return SVGPathSeg.PATHSEG_UNKNOWN}}},{key:"_nextCommandHelper",value:function(e,t){return("+"===e||"-"===e||"."===e||e>="0"&&e<="9")&&t!==SVGPathSeg.PATHSEG_CLOSEPATH?t===SVGPathSeg.PATHSEG_MOVETO_ABS?SVGPathSeg.PATHSEG_LINETO_ABS:t===SVGPathSeg.PATHSEG_MOVETO_REL?SVGPathSeg.PATHSEG_LINETO_REL:t:SVGPathSeg.PATHSEG_UNKNOWN}},{key:"initialCommandIsMoveTo",value:function(){if(!this.hasMoreData())return!0;var e=this.peekSegmentType();return e===SVGPathSeg.PATHSEG_MOVETO_ABS||e===SVGPathSeg.PATHSEG_MOVETO_REL}},{key:"_parseNumber",value:function(){var e=0,t=0,n=1,a=0,r=1,i=1,s=this._currentIndex;if(this._skipOptionalSpaces(),this._currentIndex<this._endIndex&&"+"===this._string.charAt(this._currentIndex)?this._currentIndex++:this._currentIndex<this._endIndex&&"-"===this._string.charAt(this._currentIndex)&&(this._currentIndex++,r=-1),!(this._currentIndex===this._endIndex||(this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")&&"."!==this._string.charAt(this._currentIndex))){for(var o=this._currentIndex;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)this._currentIndex++;if(this._currentIndex!==o)for(var l=this._currentIndex-1,u=1;l>=o;)t+=u*(this._string.charAt(l--)-"0"),u*=10;if(this._currentIndex<this._endIndex&&"."===this._string.charAt(this._currentIndex)){if(this._currentIndex++,this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")return;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)n*=10,a+=(this._string.charAt(this._currentIndex)-"0")/n,this._currentIndex+=1}if(this._currentIndex!==s&&this._currentIndex+1<this._endIndex&&("e"===this._string.charAt(this._currentIndex)||"E"===this._string.charAt(this._currentIndex))&&"x"!==this._string.charAt(this._currentIndex+1)&&"m"!==this._string.charAt(this._currentIndex+1)){if(this._currentIndex++,"+"===this._string.charAt(this._currentIndex)?this._currentIndex++:"-"===this._string.charAt(this._currentIndex)&&(this._currentIndex++,i=-1),this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")return;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)e*=10,e+=this._string.charAt(this._currentIndex)-"0",this._currentIndex++}var c=t+a;if(c*=r,e&&(c*=Math.pow(10,i*e)),s!==this._currentIndex)return this._skipOptionalSpacesOrDelimiter(),c}}},{key:"_parseArcFlag",value:function(){if(!(this._currentIndex>=this._endIndex)){var e=!1,t=this._string.charAt(this._currentIndex++);if("0"===t)e=!1;else{if("1"!==t)return;e=!0}return this._skipOptionalSpacesOrDelimiter(),e}}},{key:"parseSegment",value:function(){var e=this._string[this._currentIndex],n=this._pathSegTypeFromChar(e);if(n===SVGPathSeg.PATHSEG_UNKNOWN){if(this._previousCommand===SVGPathSeg.PATHSEG_UNKNOWN)return null;if((n=this._nextCommandHelper(e,this._previousCommand))===SVGPathSeg.PATHSEG_UNKNOWN)return null}else this._currentIndex++;switch(this._previousCommand=n,n){case SVGPathSeg.PATHSEG_MOVETO_REL:return new SVGPathSegMovetoRel(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_MOVETO_ABS:return new SVGPathSegMovetoAbs(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_REL:return new SVGPathSegLinetoRel(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_ABS:return new SVGPathSegLinetoAbs(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL:return new SVGPathSegLinetoHorizontalRel(t,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS:return new SVGPathSegLinetoHorizontalAbs(t,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL:return new SVGPathSegLinetoVerticalRel(t,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS:return new SVGPathSegLinetoVerticalAbs(t,this._parseNumber());case SVGPathSeg.PATHSEG_CLOSEPATH:return this._skipOptionalSpaces(),new SVGPathSegClosePath(t);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL:var a={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicRel(t,a.x,a.y,a.x1,a.y1,a.x2,a.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:var r={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicAbs(t,r.x,r.y,r.x1,r.y1,r.x2,r.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:var i={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicSmoothRel(t,i.x,i.y,i.x2,i.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:var s={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicSmoothAbs(t,s.x,s.y,s.x2,s.y2);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL:var o={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoQuadraticRel(t,o.x,o.y,o.x1,o.y1);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS:var l={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoQuadraticAbs(t,l.x,l.y,l.x1,l.y1);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:return new SVGPathSegCurvetoQuadraticSmoothRel(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:return new SVGPathSegCurvetoQuadraticSmoothAbs(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_ARC_REL:var u={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegArcRel(t,u.x,u.y,u.x1,u.y1,u.arcAngle,u.arcLarge,u.arcSweep);case SVGPathSeg.PATHSEG_ARC_ABS:var c={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegArcAbs(t,c.x,c.y,c.x1,c.y1,c.arcAngle,c.arcLarge,c.arcSweep);default:throw new Error("Unknown path seg type.")}}}]),e}(),r=new n,i=new a(e);if(!i.initialCommandIsMoveTo())return[];for(;i.hasMoreData();){var s=i.parseSegment();if(!s)return[];r.appendSegment(s)}return r.pathSegList}}]),e}();_.prototype.classname="SVGPathSegList",Object.defineProperty(_.prototype,"numberOfItems",{get:function(){return this._checkPathSynchronizedToList(),this._list.length},enumerable:!0}),_._pathSegArrayAsString=function(e){var t="",n=!0;return e.forEach(function(e){n?(n=!1,t+=e._asPathString()):t+=" "+e._asPathString()}),t},Object.defineProperties(SVGPathElement.prototype,{pathSegList:{get:function(){return this._pathSegList||(this._pathSegList=new _(this)),this._pathSegList},enumerable:!0},normalizedPathSegList:{get:function(){return this.pathSegList},enumerable:!0},animatedPathSegList:{get:function(){return this.pathSegList},enumerable:!0},animatedNormalizedPathSegList:{get:function(){return this.pathSegList},enumerable:!0}}),window.SVGPathSegList=_}}();var $=jQuery,supportsSvg_=!!document.createElementNS&&!!document.createElementNS(NS.SVG,"svg").createSVGRect,_navigator=navigator,userAgent=_navigator.userAgent,svg=document.createElementNS(NS.SVG,"svg"),isOpera_=!!window.opera,isWebkit_=userAgent.includes("AppleWebKit"),isGecko_=userAgent.includes("Gecko/"),isIE_=userAgent.includes("MSIE"),isChrome_=userAgent.includes("Chrome/"),isWindows_=userAgent.includes("Windows"),isMac_=userAgent.includes("Macintosh"),isTouch_="ontouchstart"in window,supportsSelectors_=!!svg.querySelector,supportsXpath_=!!document.evaluate,supportsPathReplaceItem_=function(){var e=document.createElementNS(NS.SVG,"path");e.setAttribute("d","M0,0 10,10");var t=e.pathSegList,n=e.createSVGPathSegLinetoAbs(5,5);try{return t.replaceItem(n,1),!0}catch(e){}return!1}(),supportsPathInsertItemBefore_=function(){var e=document.createElementNS(NS.SVG,"path");e.setAttribute("d","M0,0 10,10");var t=e.pathSegList,n=e.createSVGPathSegLinetoAbs(5,5);try{return t.insertItemBefore(n,1),!0}catch(e){}return!1}(),supportsGoodTextCharPos_=function(){var e=document.createElementNS(NS.SVG,"svg"),t=document.createElementNS(NS.SVG,"svg");document.documentElement.appendChild(e),t.setAttribute("x",5),e.appendChild(t);var n=document.createElementNS(NS.SVG,"text");n.textContent="a",t.appendChild(n);var a=n.getStartPositionOfChar(0).x;return document.documentElement.removeChild(e),0===a}(),supportsPathBBox_=function(){var e=document.createElementNS(NS.SVG,"svg");document.documentElement.appendChild(e);var t=document.createElementNS(NS.SVG,"path");t.setAttribute("d","M0,0 C0,0 10,10 10,0"),e.appendChild(t);var n=t.getBBox();return document.documentElement.removeChild(e),n.height>4&&n.height<5}(),supportsHVLineContainerBBox_=function(){var e=document.createElementNS(NS.SVG,"svg");document.documentElement.appendChild(e);var t=document.createElementNS(NS.SVG,"path");t.setAttribute("d","M0,0 10,0");var n=document.createElementNS(NS.SVG,"path");n.setAttribute("d","M5,0 15,0");var a=document.createElementNS(NS.SVG,"g");a.appendChild(t),a.appendChild(n),e.appendChild(a);var r=a.getBBox();return document.documentElement.removeChild(e),15===r.width}(),supportsGoodDecimals_=function(){var e=document.createElementNS(NS.SVG,"rect");e.setAttribute("x",.1);var t=!e.cloneNode(!1).getAttribute("x").includes(",");return t||$.alert('NOTE: This version of Opera is known to contain bugs in SVG-edit.\nPlease upgrade to the <a href="http://opera.com">latest version</a> in which the problems have been fixed.'),t}(),supportsNonScalingStroke_=function(){var e=document.createElementNS(NS.SVG,"rect");return e.setAttribute("style","vector-effect:non-scaling-stroke"),"non-scaling-stroke"===e.style.vectorEffect}(),supportsNativeSVGTransformLists_=function(){var e=document.createElementNS(NS.SVG,"rect").transform.baseVal,t=svg.createSVGTransform();e.appendItem(t);var n=e.getItem(0);return n instanceof SVGTransform&&t instanceof SVGTransform&&n.type===t.type&&n.angle===t.angle&&n.matrix.a===t.matrix.a&&n.matrix.b===t.matrix.b&&n.matrix.c===t.matrix.c&&n.matrix.d===t.matrix.d&&n.matrix.e===t.matrix.e&&n.matrix.f===t.matrix.f}(),isOpera=function(){return isOpera_},isWebkit=function(){return isWebkit_},isGecko=function(){return isGecko_},isIE=function(){return isIE_},isChrome=function(){return isChrome_},isMac=function(){return isMac_},isTouch=function(){return isTouch_},supportsSelectors=function(){return supportsSelectors_},supportsXpath=function(){return supportsXpath_},supportsPathReplaceItem=function(){return supportsPathReplaceItem_},supportsPathInsertItemBefore=function(){return supportsPathInsertItemBefore_},supportsPathBBox=function(){return supportsPathBBox_},supportsHVLineContainerBBox=function(){return supportsHVLineContainerBBox_},supportsGoodTextCharPos=function(){return supportsGoodTextCharPos_},supportsNonScalingStroke=function(){return supportsNonScalingStroke_},supportsNativeTransformLists=function(){return supportsNativeSVGTransformLists_};function RGBColor(e){this.ok=!1,"#"===e.charAt(0)&&(e=e.substr(1,6)),e=(e=e.replace(/ /g,"")).toLowerCase();var t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var n in t)t.hasOwnProperty(n)&&e===n&&(e=t[n]);for(var a=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],r=0;r<a.length;r++){var i=a[r].re,s=a[r].process,o=i.exec(e);if(o){var l=s(o);this.r=l[0],this.g=l[1],this.b=l[2],this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),n=this.b.toString(16);return 1===e.length&&(e="0"+e),1===t.length&&(t="0"+t),1===n.length&&(n="0"+n),"#"+e+t+n},this.getHelpXML=function(){for(var e=[],n=0;n<a.length;n++)for(var r=a[n].example,i=0;i<r.length;i++)e[e.length]=r[i];for(var s in t)t.hasOwnProperty(s)&&(e[e.length]=s);var o=document.createElement("ul");o.setAttribute("id","rgbcolor-examples");for(var l=0;l<e.length;l++)try{var u=document.createElement("li"),c=new RGBColor(e[l]),h=document.createElement("div");h.style.cssText="margin: 3px; border: 1px solid black; background:"+c.toHex()+"; color:"+c.toHex(),h.appendChild(document.createTextNode("test"));var d=document.createTextNode(" "+e[l]+" -> "+c.toRGB()+" -> "+c.toHex());u.appendChild(h),u.appendChild(d),o.appendChild(u)}catch(e){}return o}}function jqPluginSVG(e){var t=e.fn.attr;return e.fn.attr=function(e,n){var a=this.length;if(!a)return t.apply(this,arguments);for(var r=0;r<a;++r){var i=this[r];if("http://www.w3.org/2000/svg"!==i.namespaceURI)return t.apply(this,arguments);if(void 0!==n)i.setAttribute(e,n);else if(Array.isArray(e)){for(var s={},o=e.length;o--;){var l=e[o],u=i.getAttribute(l);(u||"0"===u)&&(u=isNaN(u)?u:u-0),s[l]=u}return s}if("object"!==(void 0===e?"undefined":_typeof(e))){var c=i.getAttribute(e);return(c||"0"===c)&&(c=isNaN(c)?c:c-0),c}for(var h in e)i.setAttribute(h,e[h])}return this},e}function toAbsoluteURL(e){var t=document.createElement("a");return t.setAttribute("href",e),t.cloneNode(!1).href}function importScript(e){return new Promise(function(t,n){var a=document.createElement("script"),r=function(){a.onerror=null,a.onload=null,a.remove(),a.src=""};a.defer="defer",a.onerror=function(){n(new Error("Failed to import: "+e)),r()},a.onload=function(){t(),r()},a.src=e,document.head.appendChild(a)})}function importModule(e){return new Promise(function(t,n){var a="$importModule$"+Math.random().toString(32).slice(2),r=document.createElement("script"),i=function(){delete window[a],r.onerror=null,r.onload=null,r.remove(),URL.revokeObjectURL(r.src),r.src=""};r.defer="defer",r.type="module",r.onerror=function(){n(new Error("Failed to import: "+e)),i()},r.onload=function(){t(window[a]),i()};var s=toAbsoluteURL(e),o=new Blob(['import * as m from "'+s+'"; window.'+a+" = m;"],{type:"text/javascript"});r.src=URL.createObjectURL(o),document.head.appendChild(r)})}var svgroot=document.createElementNS(NS.SVG,"svg");function transformToString(e){var t=e.matrix,n="";switch(e.type){case 1:n="matrix("+[t.a,t.b,t.c,t.d,t.e,t.f].join(",")+")";break;case 2:n="translate("+t.e+","+t.f+")";break;case 3:n=t.a===t.d?"scale("+t.a+")":"scale("+t.a+","+t.d+")";break;case 4:var a=0,r=0;if(0!==e.angle){var i=1-t.a;r=(i*t.f+t.b*t.e)/(i*i+t.b*t.b),a=(t.e-t.b*r)/i}n="rotate("+e.angle+" "+a+","+r+")"}return n}var listMap_={},SVGTransformList=function e(t){classCallCheck(this,e),this._elem=t||null,this._xforms=[],this._update=function(){var e="";svgroot.createSVGMatrix();for(var t=0;t<this.numberOfItems;++t){e+=transformToString(this._list.getItem(t))+" "}this._elem.setAttribute("transform",e)},this._list=this,this._init=function(){var e=this,t=this._elem.getAttribute("transform");if(t)for(var n=/\s*((scale|matrix|rotate|translate)\s*\(.*?\))\s*,?\s*/,a=!0;a;)a=t.match(n),t=t.replace(n,""),a&&a[1]&&function(){var t=a[1].split(/\s*\(/),n=t[0],r=t[1].match(/\s*(.*?)\s*\)/);r[1]=r[1].replace(/(\d)-/g,"$1 -");var i=r[1].split(/[, ]+/),s="abcdef".split(""),o=svgroot.createSVGMatrix();Object.values(i).forEach(function(e,t){i[t]=parseFloat(e),"matrix"===n&&(o[s[t]]=i[t])});var l=svgroot.createSVGTransform(),u="set"+n.charAt(0).toUpperCase()+n.slice(1),c="matrix"===n?[o]:i;"scale"===n&&1===c.length?c.push(c[0]):"translate"===n&&1===c.length?c.push(0):"rotate"===n&&1===c.length&&c.push(0,0),l[u].apply(l,c),e._list.appendItem(l)}()},this._removeFromOtherLists=function(e){if(e){var t=!1;for(var n in listMap_){for(var a=listMap_[n],r=0,i=a._xforms.length;r<i;++r)if(a._xforms[r]===e){t=!0,a.removeItem(r);break}if(t)break}}},this.numberOfItems=0,this.clear=function(){this.numberOfItems=0,this._xforms=[]},this.initialize=function(e){this.numberOfItems=1,this._removeFromOtherLists(e),this._xforms=[e]},this.getItem=function(e){if(e<this.numberOfItems&&e>=0)return this._xforms[e];var t=new Error("DOMException with code=INDEX_SIZE_ERR");throw t.code=1,t},this.insertItemBefore=function(e,t){var n=null;if(t>=0)if(t<this.numberOfItems){this._removeFromOtherLists(e);var a=new Array(this.numberOfItems+1),r=void 0;for(r=0;r<t;++r)a[r]=this._xforms[r];a[r]=e;for(var i=r+1;r<this.numberOfItems;++i,++r)a[i]=this._xforms[r];this.numberOfItems++,this._xforms=a,n=e,this._list._update()}else n=this._list.appendItem(e);return n},this.replaceItem=function(e,t){var n=null;return t<this.numberOfItems&&t>=0&&(this._removeFromOtherLists(e),this._xforms[t]=e,n=e,this._list._update()),n},this.removeItem=function(e){if(e<this.numberOfItems&&e>=0){var t=this._xforms[e],n=new Array(this.numberOfItems-1),a=void 0;for(a=0;a<e;++a)n[a]=this._xforms[a];for(var r=a;r<this.numberOfItems-1;++r,++a)n[r]=this._xforms[a+1];return this.numberOfItems--,this._xforms=n,this._list._update(),t}var i=new Error("DOMException with code=INDEX_SIZE_ERR");throw i.code=1,i},this.appendItem=function(e){return this._removeFromOtherLists(e),this._xforms.push(e),this.numberOfItems++,this._list._update(),e}},resetListMap=function(){listMap_={}},removeElementFromListMap=function(e){e.id&&listMap_[e.id]&&delete listMap_[e.id]},getTransformList=function(e){if(!supportsNativeTransformLists()){var t=e.id||"temp",n=listMap_[t];return n&&"temp"!==t||(listMap_[t]=new SVGTransformList(e),listMap_[t]._init(),n=listMap_[t]),n}return e.transform?e.transform.baseVal:e.gradientTransform?e.gradientTransform.baseVal:e.patternTransform?e.patternTransform.baseVal:null},wAttrs=["x","x1","cx","rx","width"],hAttrs=["y","y1","cy","ry","height"],unitAttrs=["r","radius"].concat(wAttrs,hAttrs),elementContainer_=void 0,typeMap_={},init=function(e){elementContainer_=e;var t=document.createElementNS(NS.SVG,"svg");document.body.appendChild(t);var n=document.createElementNS(NS.SVG,"rect");n.setAttribute("width","1em"),n.setAttribute("height","1ex"),n.setAttribute("x","1in"),t.appendChild(n);var a=n.getBBox();document.body.removeChild(t);var r=a.x;typeMap_={em:a.width,ex:a.height,in:r,cm:r/2.54,mm:r/25.4,pt:r/72,pc:r/6,px:1,"%":0}},getTypeMap=function(){return typeMap_},shortFloat=function e(t){var n=elementContainer_.getRoundDigits();return isNaN(t)?Array.isArray(t)?e(t[0])+","+e(t[1]):parseFloat(t).toFixed(n)-0:+(+t).toFixed(n)},convertUnit=function(e,t){return t=t||elementContainer_.getBaseUnit(),shortFloat(e/typeMap_[t])},setUnitAttr=function(e,t,n){e.setAttribute(t,n)},convertToNum=function(e,t){if(!isNaN(t))return t-0;if("%"===t.substr(-1)){var n=t.substr(0,t.length-1)/100,a=elementContainer_.getWidth(),r=elementContainer_.getHeight();return wAttrs.includes(e)?n*a:hAttrs.includes(e)?n*r:n*Math.sqrt(a*a+r*r)/Math.sqrt(2)}var i=t.substr(-2);return t.substr(0,t.length-2)*typeMap_[i]},isValidUnit=function(e,t,n){var a=!1;if(unitAttrs.includes(e))isNaN(t)?(t=t.toLowerCase(),Object.keys(typeMap_).forEach(function(e){a||new RegExp("^-?[\\d\\.]+"+e+"$").test(t)&&(a=!0)})):a=!0;else if("id"===e){var r=!1;try{var i=elementContainer_.getElement(t);r=null==i||i===n}catch(e){}return r}return a=!0},HistoryEventTypes={BEFORE_APPLY:"before_apply",AFTER_APPLY:"after_apply",BEFORE_UNAPPLY:"before_unapply",AFTER_UNAPPLY:"after_unapply"},MoveElementCommand=function(){function e(t,n,a,r){classCallCheck(this,e),this.elem=t,this.text=r?"Move "+t.tagName+" to "+r:"Move "+t.tagName,this.oldNextSibling=n,this.oldParent=a,this.newNextSibling=t.nextSibling,this.newParent=t.parentNode}return createClass(e,[{key:"getText",value:function(){return this.text}},{key:"type",value:function(){return"svgedit.history.MoveElementCommand"}},{key:"apply",value:function(e){e&&e.handleHistoryEvent(HistoryEventTypes.BEFORE_APPLY,this),this.elem=this.newParent.insertBefore(this.elem,this.newNextSibling),e&&e.handleHistoryEvent(HistoryEventTypes.AFTER_APPLY,this)}},{key:"unapply",value:function(e){e&&e.handleHistoryEvent(HistoryEventTypes.BEFORE_UNAPPLY,this),this.elem=this.oldParent.insertBefore(this.elem,this.oldNextSibling),e&&e.handleHistoryEvent(HistoryEventTypes.AFTER_UNAPPLY,this)}},{key:"elements",value:function(){return[this.elem]}}]),e}();MoveElementCommand.type=MoveElementCommand.prototype.type;var InsertElementCommand=function(){function e(t,n){classCallCheck(this,e),this.elem=t,this.text=n||"Create "+t.tagName,this.parent=t.parentNode,this.nextSibling=this.elem.nextSibling}return createClass(e,[{key:"type",value:function(){return"svgedit.history.InsertElementCommand"}},{key:"getText",value:function(){return this.text}},{key:"apply",value:function(e){e&&e.handleHistoryEvent(HistoryEventTypes.BEFORE_APPLY,this),this.elem=this.parent.insertBefore(this.elem,this.nextSibling),e&&e.handleHistoryEvent(HistoryEventTypes.AFTER_APPLY,this)}},{key:"unapply",value:function(e){e&&e.handleHistoryEvent(HistoryEventTypes.BEFORE_UNAPPLY,this),this.parent=this.elem.parentNode,this.elem=this.elem.parentNode.removeChild(this.elem),e&&e.handleHistoryEvent(HistoryEventTypes.AFTER_UNAPPLY,this)}},{key:"elements",value:function(){return[this.elem]}}]),e}();InsertElementCommand.type=InsertElementCommand.prototype.type;var RemoveElementCommand=function(){function e(t,n,a,r){classCallCheck(this,e),this.elem=t,this.text=r||"Delete "+t.tagName,this.nextSibling=n,this.parent=a,removeElementFromListMap(t)}return createClass(e,[{key:"type",value:function(){return"svgedit.history.RemoveElementCommand"}},{key:"getText",value:function(){return this.text}},{key:"apply",value:function(e){e&&e.handleHistoryEvent(HistoryEventTypes.BEFORE_APPLY,this),removeElementFromListMap(this.elem),this.parent=this.elem.parentNode,this.elem=this.parent.removeChild(this.elem),e&&e.handleHistoryEvent(HistoryEventTypes.AFTER_APPLY,this)}},{key:"unapply",value:function(e){e&&e.handleHistoryEvent(HistoryEventTypes.BEFORE_UNAPPLY,this),removeElementFromListMap(this.elem),null==this.nextSibling&&window.console&&console.log("Error: reference element was lost"),this.parent.insertBefore(this.elem,this.nextSibling),e&&e.handleHistoryEvent(HistoryEventTypes.AFTER_UNAPPLY,this)}},{key:"elements",value:function(){return[this.elem]}}]),e}();RemoveElementCommand.type=RemoveElementCommand.prototype.type;var ChangeElementCommand=function(){function e(t,n,a){for(var r in classCallCheck(this,e),this.elem=t,this.text=a?"Change "+t.tagName+" "+a:"Change "+t.tagName,this.newValues={},this.oldValues=n,n)this.newValues[r]="#text"===r?t.textContent:"#href"===r?getHref(t):t.getAttribute(r)}return createClass(e,[{key:"type",value:function(){return"svgedit.history.ChangeElementCommand"}},{key:"getText",value:function(){return this.text}},{key:"apply",value:function(e){e&&e.handleHistoryEvent(HistoryEventTypes.BEFORE_APPLY,this);var t=!1;for(var n in this.newValues)this.newValues[n]?"#text"===n?this.elem.textContent=this.newValues[n]:"#href"===n?setHref(this.elem,this.newValues[n]):this.elem.setAttribute(n,this.newValues[n]):"#text"===n?this.elem.textContent="":(this.elem.setAttribute(n,""),this.elem.removeAttribute(n)),"transform"===n&&(t=!0);if(!t){var a=getRotationAngle(this.elem);if(a){var r=this.elem.getBBox(),i=["rotate(",a," ",r.x+r.width/2,",",r.y+r.height/2,")"].join("");i!==this.elem.getAttribute("transform")&&this.elem.setAttribute("transform",i)}}return e&&e.handleHistoryEvent(HistoryEventTypes.AFTER_APPLY,this),!0}},{key:"unapply",value:function(e){e&&e.handleHistoryEvent(HistoryEventTypes.BEFORE_UNAPPLY,this);var t=!1;for(var n in this.oldValues)this.oldValues[n]?"#text"===n?this.elem.textContent=this.oldValues[n]:"#href"===n?setHref(this.elem,this.oldValues[n]):this.elem.setAttribute(n,this.oldValues[n]):"#text"===n?this.elem.textContent="":this.elem.removeAttribute(n),"transform"===n&&(t=!0);if(!t){var a=getRotationAngle(this.elem);if(a){var r=this.elem.getBBox(),i=["rotate(",a," ",r.x+r.width/2,",",r.y+r.height/2,")"].join("");i!==this.elem.getAttribute("transform")&&this.elem.setAttribute("transform",i)}}return removeElementFromListMap(this.elem),e&&e.handleHistoryEvent(HistoryEventTypes.AFTER_UNAPPLY,this),!0}},{key:"elements",value:function(){return[this.elem]}}]),e}();ChangeElementCommand.type=ChangeElementCommand.prototype.type;var BatchCommand=function(){function e(t){classCallCheck(this,e),this.text=t||"Batch Command",this.stack=[]}return createClass(e,[{key:"type",value:function(){return"svgedit.history.BatchCommand"}},{key:"getText",value:function(){return this.text}},{key:"apply",value:function(e){e&&e.handleHistoryEvent(HistoryEventTypes.BEFORE_APPLY,this);for(var t=this.stack.length,n=0;n<t;++n)this.stack[n].apply(e);e&&e.handleHistoryEvent(HistoryEventTypes.AFTER_APPLY,this)}},{key:"unapply",value:function(e){e&&e.handleHistoryEvent(HistoryEventTypes.BEFORE_UNAPPLY,this);for(var t=this.stack.length-1;t>=0;t--)this.stack[t].unapply(e);e&&e.handleHistoryEvent(HistoryEventTypes.AFTER_UNAPPLY,this)}},{key:"elements",value:function(){for(var e=[],t=this.stack.length;t--;)for(var n=this.stack[t].elements(),a=n.length;a--;)e.includes(n[a])||e.push(n[a]);return e}},{key:"addSubCommand",value:function(e){this.stack.push(e)}},{key:"isEmpty",value:function(){return!this.stack.length}}]),e}();BatchCommand.type=BatchCommand.prototype.type;var UndoManager=function(){function e(t){classCallCheck(this,e),this.handler_=t||null,this.undoStackPointer=0,this.undoStack=[],this.undoChangeStackPointer=-1,this.undoableChangeStack=[]}return createClass(e,[{key:"resetUndoStack",value:function(){this.undoStack=[],this.undoStackPointer=0}},{key:"getUndoStackSize",value:function(){return this.undoStackPointer}},{key:"getRedoStackSize",value:function(){return this.undoStack.length-this.undoStackPointer}},{key:"getNextUndoCommandText",value:function(){return this.undoStackPointer>0?this.undoStack[this.undoStackPointer-1].getText():""}},{key:"getNextRedoCommandText",value:function(){return this.undoStackPointer<this.undoStack.length?this.undoStack[this.undoStackPointer].getText():""}},{key:"undo",value:function(){this.undoStackPointer>0&&this.undoStack[--this.undoStackPointer].unapply(this.handler_)}},{key:"redo",value:function(){this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0&&this.undoStack[this.undoStackPointer++].apply(this.handler_)}},{key:"addCommandToHistory",value:function(e){this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0&&(this.undoStack=this.undoStack.splice(0,this.undoStackPointer)),this.undoStack.push(e),this.undoStackPointer=this.undoStack.length}},{key:"beginUndoableChange",value:function(e,t){for(var n=++this.undoChangeStackPointer,a=t.length,r=new Array(a),i=new Array(a);a--;){var s=t[a];null!=s&&(i[a]=s,r[a]=s.getAttribute(e))}this.undoableChangeStack[n]={attrName:e,oldValues:r,elements:i}}},{key:"finishUndoableChange",value:function(){for(var e=this.undoChangeStackPointer--,t=this.undoableChangeStack[e],n=t.attrName,a=new BatchCommand("Change "+n),r=t.elements.length;r--;){var i=t.elements[r];if(null!=i){var s={};s[n]=t.oldValues[r],s[n]!==i.getAttribute(n)&&a.addSubCommand(new ChangeElementCommand(i,s,n))}}return this.undoableChangeStack[e]=null,a}}]),e}(),history=Object.freeze({HistoryEventTypes:HistoryEventTypes,MoveElementCommand:MoveElementCommand,InsertElementCommand:InsertElementCommand,RemoveElementCommand:RemoveElementCommand,ChangeElementCommand:ChangeElementCommand,BatchCommand:BatchCommand,UndoManager:UndoManager}),NEAR_ZERO=1e-14,svg$1=document.createElementNS(NS.SVG,"svg"),transformPoint=function(e,t,n){return{x:n.a*e+n.c*t+n.e,y:n.b*e+n.d*t+n.f}},isIdentity=function(e){return 1===e.a&&0===e.b&&0===e.c&&1===e.d&&0===e.e&&0===e.f},matrixMultiply=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=t.reduceRight(function(e,t){return t.multiply(e)});return Math.abs(a.a)<NEAR_ZERO&&(a.a=0),Math.abs(a.b)<NEAR_ZERO&&(a.b=0),Math.abs(a.c)<NEAR_ZERO&&(a.c=0),Math.abs(a.d)<NEAR_ZERO&&(a.d=0),Math.abs(a.e)<NEAR_ZERO&&(a.e=0),Math.abs(a.f)<NEAR_ZERO&&(a.f=0),a},hasMatrixTransform=function(e){if(!e)return!1;for(var t=e.numberOfItems;t--;){var n=e.getItem(t);if(1===n.type&&!isIdentity(n.matrix))return!0}return!1},transformBox=function(e,t,n,a,r){var i=transformPoint(e,t,r),s=transformPoint(e+n,t,r),o=transformPoint(e,t+a,r),l=transformPoint(e+n,t+a,r),u=Math.min(i.x,s.x,o.x,l.x),c=Math.max(i.x,s.x,o.x,l.x),h=Math.min(i.y,s.y,o.y,l.y);return{tl:i,tr:s,bl:o,br:l,aabox:{x:u,y:h,width:c-u,height:Math.max(i.y,s.y,o.y,l.y)-h}}},transformListToTransform=function(e,t,n){if(null==e)return svg$1.createSVGTransformFromMatrix(svg$1.createSVGMatrix());if(t=t||0,n=n||e.numberOfItems-1,(t=parseInt(t,10))>(n=parseInt(n,10))){var a=n;n=t,t=a}for(var r=svg$1.createSVGMatrix(),i=t;i<=n;++i){var s=i>=0&&i<e.numberOfItems?e.getItem(i).matrix:svg$1.createSVGMatrix();r=matrixMultiply(r,s)}return svg$1.createSVGTransformFromMatrix(r)},getMatrix=function(e){var t=getTransformList(e);return transformListToTransform(t).matrix},snapToAngle=function(e,t,n,a){var r=Math.PI/4,i=n-e,s=a-t,o=Math.atan2(s,i),l=Math.sqrt(i*i+s*s),u=Math.round(o/r)*r;return{x:e+l*Math.cos(u),y:t+l*Math.sin(u),a:u}},rectsIntersect=function(e,t){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y},$$1=jQuery,segData={2:["x","y"],4:["x","y"],6:["x","y","x1","y1","x2","y2"],8:["x","y","x1","y1"],10:["x","y","r1","r2","angle","largeArcFlag","sweepFlag"],12:["x"],14:["y"],16:["x","y","x2","y2"],18:["x","y"]},uiStrings={},setUiStrings=function(e){Object.assign(uiStrings,e.ui)},pathFuncs=[],linkControlPts=!0,pathData={},setLinkControlPoints=function(e){linkControlPts=e},path=null,editorContext_=null,init$1=function(e){editorContext_=e,pathFuncs=[0,"ClosePath"];$$1.each(["Moveto","Lineto","CurvetoCubic","CurvetoQuadratic","Arc","LinetoHorizontal","LinetoVertical","CurvetoCubicSmooth","CurvetoQuadraticSmooth"],function(e,t){pathFuncs.push(t+"Abs"),pathFuncs.push(t+"Rel")})},insertItemBefore=function(e,t,n){var a=e.pathSegList;if(supportsPathInsertItemBefore())a.insertItemBefore(t,n);else{for(var r=a.numberOfItems,i=[],s=0;s<r;s++){var o=a.getItem(s);i.push(o)}a.clear();for(var l=0;l<r;l++)l===n&&a.appendItem(t),a.appendItem(i[l])}},ptObjToArr=function(e,t){for(var n=segData[e],a=n.length,r=[],i=0;i<a;i++)r[i]=t[n[i]];return r},getGripPt=function(e,t){var n=e.path,a={x:t?t.x:e.item.x,y:t?t.y:e.item.y};n.matrix&&(a=transformPoint(a.x,a.y,n.matrix));var r=editorContext_.getCurrentZoom();return a.x*=r,a.y*=r,a},getPointFromGrip=function(e,t){var n={x:e.x,y:e.y};t.matrix&&(e=transformPoint(n.x,n.y,t.imatrix),n.x=e.x,n.y=e.y);var a=editorContext_.getCurrentZoom();return n.x/=a,n.y/=a,n},addPointGrip=function(e,t,n){var a=getGripContainer(),r=getElem("pathpointgrip_"+e);if(!r){r=document.createElementNS(NS.SVG,"circle");var i={id:"pathpointgrip_"+e,display:"none",r:4,fill:"#0FF",stroke:"#00F","stroke-width":2,cursor:"move",style:"pointer-events:all"};"pathNodeTooltip"in uiStrings&&(i["xlink:title"]=uiStrings.pathNodeTooltip),assignAttributes(r,i),r=a.appendChild(r),$$1("#pathpointgrip_"+e).dblclick(function(){path&&path.setSegType()})}return t&&n&&assignAttributes(r,{cx:t,cy:n,display:"inline"}),r},getGripContainer=function(){var e=getElem("pathpointgrip_container");e||((e=getElem("selectorParentGroup").appendChild(document.createElementNS(NS.SVG,"g"))).id="pathpointgrip_container");return e},addCtrlGrip=function(e){var t=getElem("ctrlpointgrip_"+e);if(t)return t;t=document.createElementNS(NS.SVG,"circle");var n={id:"ctrlpointgrip_"+e,display:"none",r:4,fill:"#0FF",stroke:"#55F","stroke-width":1,cursor:"move",style:"pointer-events:all"};return"pathCtrlPtTooltip"in uiStrings&&(n["xlink:title"]=uiStrings.pathCtrlPtTooltip),assignAttributes(t,n),getGripContainer().appendChild(t),t},getCtrlLine=function(e){var t=getElem("ctrlLine_"+e);return t||(t=document.createElementNS(NS.SVG,"line"),assignAttributes(t,{id:"ctrlLine_"+e,stroke:"#555","stroke-width":1,style:"pointer-events:none"}),getGripContainer().appendChild(t),t)},getPointGrip=function(e,t){var n=e.index,a=addPointGrip(n);if(t){var r=getGripPt(e);assignAttributes(a,{cx:r.x,cy:r.y,display:"inline"})}return a},getControlPoints=function(e){var t=e.item,n=e.index;if(!("x1"in t&&"x2"in t))return null;var a={};getGripContainer();for(var r=[path.segs[n-1].item,t],i=1;i<3;i++){var s=n+"c"+i,o=a["c"+i+"_line"]=getCtrlLine(s),l=getGripPt(e,{x:t["x"+i],y:t["y"+i]}),u=getGripPt(e,{x:r[i-1].x,y:r[i-1].y});assignAttributes(o,{x1:l.x,y1:l.y,x2:u.x,y2:u.y,display:"inline"}),a["c"+i+"_line"]=o;var c=a["c"+i]=addCtrlGrip(s);assignAttributes(c,{cx:l.x,cy:l.y,display:"inline"}),a["c"+i]=c}return a},replacePathSeg=function(e,t,n,a){var r=a||path.elem,i=r["createSVGPathSeg"+pathFuncs[e]].apply(r,n);if(supportsPathReplaceItem())r.pathSegList.replaceItem(i,t);else{for(var s=r.pathSegList,o=s.numberOfItems,l=[],u=0;u<o;u++){var c=s.getItem(u);l.push(c)}s.clear();for(var h=0;h<o;h++)h===t?s.appendItem(i):s.appendItem(l[h])}},getSegSelector=function(e,t){var n=e.index,a=getElem("segline_"+n);if(!a){var r=getGripContainer();a=document.createElementNS(NS.SVG,"path"),assignAttributes(a,{id:"segline_"+n,display:"none",fill:"none",stroke:"#0FF","stroke-width":2,style:"pointer-events:none",d:"M0,0 0,0"}),r.appendChild(a)}if(t){var i=e.prev;if(!i)return a.setAttribute("display","none"),a;var s=getGripPt(i);replacePathSeg(2,0,[s.x,s.y],a);for(var o=ptObjToArr(e.type,e.item,!0),l=0;l<o.length;l+=2){var u=getGripPt(e,{x:o[l],y:o[l+1]});o[l]=u.x,o[l+1]=u.y}replacePathSeg(e.type,1,o,a)}return a},smoothControlPoints=function(e,t,n){var a=e.x-n.x,r=e.y-n.y,i=t.x-n.x,s=t.y-n.y;if(!(0===a&&0===r||0===i&&0===s)){var o=Math.sqrt(a*a+r*r),l=Math.sqrt(i*i+s*s),u=editorContext_.getSVGRoot().createSVGPoint(),c=editorContext_.getSVGRoot().createSVGPoint(),h=Math.atan2(r,a),d=Math.atan2(s,i);h<0&&(h+=2*Math.PI),d<0&&(d+=2*Math.PI);var f=Math.abs(h-d),p=Math.abs(Math.PI-f)/2,g=void 0,v=void 0;return h-d>0?(g=f<Math.PI?h+p:h-p,v=f<Math.PI?d-p:d+p):(g=f<Math.PI?h-p:h+p,v=f<Math.PI?d+p:d-p),u.x=o*Math.cos(g)+n.x,u.y=o*Math.sin(g)+n.y,c.x=l*Math.cos(v)+n.x,c.y=l*Math.sin(v)+n.y,[u,c]}},Segment=function(){function e(t,n){classCallCheck(this,e),this.selected=!1,this.index=t,this.item=n,this.type=n.pathSegType,this.ctrlpts=[],this.ptgrip=null,this.segsel=null}return createClass(e,[{key:"showCtrlPts",value:function(e){for(var t in this.ctrlpts)this.ctrlpts.hasOwnProperty(t)&&this.ctrlpts[t].setAttribute("display",e?"inline":"none")}},{key:"selectCtrls",value:function(e){$$1("#ctrlpointgrip_"+this.index+"c1, #ctrlpointgrip_"+this.index+"c2").attr("fill",e?"#0FF":"#EEE")}},{key:"show",value:function(e){this.ptgrip&&(this.ptgrip.setAttribute("display",e?"inline":"none"),this.segsel.setAttribute("display",e?"inline":"none"),this.showCtrlPts(e))}},{key:"select",value:function(e){this.ptgrip&&(this.ptgrip.setAttribute("stroke",e?"#0FF":"#00F"),this.segsel.setAttribute("display",e?"inline":"none"),this.ctrlpts&&this.selectCtrls(e),this.selected=e)}},{key:"addGrip",value:function(){this.ptgrip=getPointGrip(this,!0),this.ctrlpts=getControlPoints(this,!0),this.segsel=getSegSelector(this,!0)}},{key:"update",value:function(e){if(this.ptgrip){var t=getGripPt(this);assignAttributes(this.ptgrip,{cx:t.x,cy:t.y}),getSegSelector(this,!0),this.ctrlpts&&(e&&(this.item=path.elem.pathSegList.getItem(this.index),this.type=this.item.pathSegType),getControlPoints(this))}}},{key:"move",value:function(e,t){var n=this.item,a=this.ctrlpts?[n.x+=e,n.y+=t,n.x1,n.y1,n.x2+=e,n.y2+=t]:[n.x+=e,n.y+=t];if(replacePathSeg(this.type,this.index,a),this.next&&this.next.ctrlpts){var r=this.next.item,i=[r.x,r.y,r.x1+=e,r.y1+=t,r.x2,r.y2];replacePathSeg(this.next.type,this.next.index,i)}if(this.mate){var s=this.mate.item,o=[s.x+=e,s.y+=t];replacePathSeg(this.mate.type,this.mate.index,o)}this.update(!0),this.next&&this.next.update(!0)}},{key:"setLinked",value:function(e){var t=void 0,n=void 0,a=void 0;if(2===e){if(n=1,!(t=this.next))return;a=this.item}else{if(n=2,!(t=this.prev))return;a=t.item}var r=t.item;r["x"+n]=a.x+(a.x-this.item["x"+e]),r["y"+n]=a.y+(a.y-this.item["y"+e]);var i=[r.x,r.y,r.x1,r.y1,r.x2,r.y2];replacePathSeg(t.type,t.index,i),t.update(!0)}},{key:"moveCtrl",value:function(e,t,n){var a=this.item;a["x"+e]+=t,a["y"+e]+=n;var r=[a.x,a.y,a.x1,a.y1,a.x2,a.y2];replacePathSeg(this.type,this.index,r),this.update(!0)}},{key:"setType",value:function(e,t){replacePathSeg(e,this.index,t),this.type=e,this.item=path.elem.pathSegList.getItem(this.index),this.showCtrlPts(6===e),this.ctrlpts=getControlPoints(this),this.update(!0)}}]),e}(),Path=function(){function e(t){if(classCallCheck(this,e),!t||"path"!==t.tagName)throw new Error("svgedit.path.Path constructed without a <path> element");this.elem=t,this.segs=[],this.selected_pts=[],path=this,this.init()}return createClass(e,[{key:"init",value:function(){$$1(getGripContainer()).find("*").each(function(){$$1(this).attr("display","none")});var e=this.elem.pathSegList,t=e.numberOfItems;this.segs=[],this.selected_pts=[],this.first_seg=null;for(var n=0;n<t;n++){var a=e.getItem(n),r=new Segment(n,a);r.path=this,this.segs.push(r)}for(var i=this.segs,s=null,o=0;o<t;o++){var l=i[o],u=o+1>=t?null:i[o+1],c=o-1<0?null:i[o-1];if(2===l.type){if(c&&1!==c.type){var h=i[s];h.next=i[s+1],h.next.prev=h,h.addGrip()}s=o}else if(u&&1===u.type)l.next=i[s+1],l.next.prev=l,l.mate=i[s],l.addGrip(),null==this.first_seg&&(this.first_seg=l);else if(u)1!==l.type&&(l.addGrip(),u&&2!==u.type&&(l.next=u,l.next.prev=l));else if(1!==l.type){var d=i[s];d.next=i[s+1],d.next.prev=d,d.addGrip(),l.addGrip(),this.first_seg||(this.first_seg=i[s])}}return this}},{key:"eachSeg",value:function(e){for(var t=this.segs.length,n=0;n<t;n++){if(!1===e.call(this.segs[n],n))break}}},{key:"addSeg",value:function(e){var t=this.segs[e];if(t.prev){var n=t.prev,a=void 0,r=void 0,i=void 0;switch(t.item.pathSegType){case 4:r=(t.item.x+n.item.x)/2,i=(t.item.y+n.item.y)/2,a=this.elem.createSVGPathSegLinetoAbs(r,i);break;case 6:var s=(n.item.x+t.item.x1)/2,o=(t.item.x1+t.item.x2)/2,l=(t.item.x2+t.item.x)/2,u=(s+o)/2,c=(o+l)/2;r=(u+c)/2;var h=(n.item.y+t.item.y1)/2,d=(t.item.y1+t.item.y2)/2,f=(t.item.y2+t.item.y)/2,p=(h+d)/2,g=(d+f)/2;i=(p+g)/2,a=this.elem.createSVGPathSegCurvetoCubicAbs(r,i,s,h,u,p);var v=[t.item.x,t.item.y,c,g,l,f];replacePathSeg(t.type,e,v)}insertItemBefore(this.elem,a,e)}}},{key:"deleteSeg",value:function(e){var t=this.segs[e],n=this.elem.pathSegList;t.show(!1);var a=t.next;if(t.mate){var r=[a.item.x,a.item.y];replacePathSeg(2,a.index,r),replacePathSeg(4,t.index,r),n.removeItem(t.mate.index)}else if(t.prev)n.removeItem(e);else{var i=[a.item.x,a.item.y];replacePathSeg(2,t.next.index,i),n.removeItem(e)}}},{key:"subpathIsClosed",value:function(e){var t=!1;return path.eachSeg(function(n){return n<=e||2!==this.type&&(1===this.type?(t=!0,!1):void 0)}),t}},{key:"removePtFromSelection",value:function(e){var t=this.selected_pts.indexOf(e);-1!==t&&(this.segs[e].select(!1),this.selected_pts.splice(t,1))}},{key:"clearSelection",value:function(){this.eachSeg(function(){this.select(!1)}),this.selected_pts=[]}},{key:"storeD",value:function(){this.last_d=this.elem.getAttribute("d")}},{key:"show",value:function(e){return this.eachSeg(function(){this.show(e)}),e&&this.selectPt(this.first_seg.index),this}},{key:"movePts",value:function(e,t){for(var n=this.selected_pts.length;n--;){this.segs[this.selected_pts[n]].move(e,t)}}},{key:"moveCtrl",value:function(e,t){var n=this.segs[this.selected_pts[0]];n.moveCtrl(this.dragctrl,e,t),linkControlPts&&n.setLinked(this.dragctrl)}},{key:"setSegType",value:function(e){this.storeD();for(var t=this.selected_pts.length,n=void 0;t--;){var a=this.selected_pts[t],r=this.segs[a],i=r.prev;if(i){if(!e)n="Toggle Path Segment Type",e=6===r.type?4:6;e=Number(e);var s=r.item.x,o=r.item.y,l=i.item.x,u=i.item.y,c=void 0;switch(e){case 6:if(r.olditem){var h=r.olditem;c=[s,o,h.x1,h.y1,h.x2,h.y2]}else{var d=s-l,f=o-u;c=[s,o,l+d/3,u+f/3,s-d/3,o-f/3]}break;case 4:c=[s,o],r.olditem=r.item}r.setType(e,c)}}path.endChanges(n)}},{key:"selectPt",value:function(e,t){this.clearSelection(),null==e&&this.eachSeg(function(t){this.prev&&(e=t)}),this.addPtsToSelection(e),t&&(this.dragctrl=t,linkControlPts&&this.segs[e].setLinked(t))}},{key:"update",value:function(){var e=this.elem;return getRotationAngle(e)?(this.matrix=getMatrix(e),this.imatrix=this.matrix.inverse()):(this.matrix=null,this.imatrix=null),this.eachSeg(function(t){this.item=e.pathSegList.getItem(t),this.update()}),this}},{key:"endChanges",value:function(e){isWebkit()&&editorContext_.resetD(this.elem);var t=new ChangeElementCommand(this.elem,{d:this.last_d},e);editorContext_.endChanges({cmd:t,elem:this.elem})}},{key:"addPtsToSelection",value:function(e){Array.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++){var n=e[t];this.segs[n].ptgrip&&!this.selected_pts.includes(n)&&n>=0&&this.selected_pts.push(n)}this.selected_pts.sort();var a=this.selected_pts.length,r=[];for(r.length=a;a--;){var i=this.selected_pts[a],s=this.segs[i];s.select(!0),r[a]=s.ptgrip}var o=this.subpathIsClosed(this.selected_pts[0]);editorContext_.addPtsToSelection({grips:r,closedSubpath:o})}}]),e}(),getPath_=function(e){var t=pathData[e.id];return t||(t=pathData[e.id]=new Path(e)),t},removePath_=function(e){e in pathData&&delete pathData[e]},newcx=void 0,newcy=void 0,oldcx=void 0,oldcy=void 0,angle=void 0,getRotVals=function(e,t){var n=e-oldcx,a=t-oldcy,r=Math.sqrt(n*n+a*a),i=Math.atan2(a,n)+angle;return n=r*Math.cos(i)+oldcx,a=r*Math.sin(i)+oldcy,n-=newcx,a-=newcy,r=Math.sqrt(n*n+a*a),i=Math.atan2(a,n)-angle,{x:r*Math.cos(i)+newcx,y:r*Math.sin(i)+newcy}},recalcRotatedPath=function(){var e=path.elem;if(angle=getRotationAngle(e,!0)){var t=path.oldbbox;oldcx=t.x+t.width/2,oldcy=t.y+t.height/2;var n=getBBox(e);newcx=n.x+n.width/2,newcy=n.y+n.height/2;var a=newcx-oldcx,r=newcy-oldcy,i=Math.sqrt(a*a+r*r),s=Math.atan2(r,a)+angle;newcx=i*Math.cos(s)+oldcx,newcy=i*Math.sin(s)+oldcy;for(var o=e.pathSegList,l=o.numberOfItems;l;){l-=1;var u=o.getItem(l),c=u.pathSegType;if(1!==c){var h=getRotVals(u.x,u.y),d=[h.x,h.y];if(null!=u.x1&&null!=u.x2){var f=getRotVals(u.x1,u.y1),p=getRotVals(u.x2,u.y2);d.splice(d.length,0,f.x,f.y,p.x,p.y)}replacePathSeg(c,l,d)}}n=getBBox(e);var g=editorContext_.getSVGRoot().createSVGTransform(),v=getTransformList(e);g.setRotate(180*angle/Math.PI,newcx,newcy),v.replaceItem(g,0)}},clearData=function(){pathData={}},reorientGrads=function(e,t){for(var n=getBBox(e),a=0;a<2;a++){var r=0===a?"fill":"stroke",i=e.getAttribute(r);if(i&&i.startsWith("url(")){var s=getRefElem(i);if("linearGradient"===s.tagName){var o=s.getAttribute("x1")||0,l=s.getAttribute("y1")||0,u=s.getAttribute("x2")||1,c=s.getAttribute("y2")||0;o=n.width*o+n.x,l=n.height*l+n.y,u=n.width*u+n.x,c=n.height*c+n.y;var h=transformPoint(o,l,t),d=transformPoint(u,c,t),f={};f.x1=(h.x-n.x)/n.width,f.y1=(h.y-n.y)/n.height,f.x2=(d.x-n.x)/n.width,f.y2=(d.y-n.y)/n.height;var p=s.cloneNode(!0);$$1(p).attr(f),p.id=editorContext_.getNextId(),findDefs().appendChild(p),e.setAttribute(r,"url(#"+p.id+")")}}}},pathMap=[0,"z","M","m","L","l","C","c","Q","q","A","a","H","h","V","v","S","s","T","t"],convertPath=function(e,t){for(var n=e.pathSegList,a=n.numberOfItems,r=0,i=0,s="",o=null,l=0;l<a;++l){var u=n.getItem(l),c=u.x||0,h=u.y||0,d=u.x1||0,f=u.y1||0,p=u.x2||0,g=u.y2||0,v=u.pathSegType,m=pathMap[v]["to"+(t?"Lower":"Upper")+"Case"]();switch(v){case 1:s+="z",o&&!t&&(r=o[0],i=o[1]);break;case 12:c-=r;case 13:t?(r+=c,m="l"):(r=c+=r,m="L"),s+=pathDSegment(m,[[c,i]]);break;case 14:h-=i;case 15:t?(i+=h,m="l"):(i=h+=i,m="L"),s+=pathDSegment(m,[[r,h]]);break;case 2:case 4:case 18:c-=r,h-=i;case 5:case 3:case 19:t?(r+=c,i+=h):(r=c+=r,i=h+=i),2!==v&&3!==v||(o=[r,i]),s+=pathDSegment(m,[[c,h]]);break;case 6:c-=r,d-=r,p-=r,h-=i,f-=i,g-=i;case 7:t?(r+=c,i+=h):(d+=r,p+=r,f+=i,g+=i,r=c+=r,i=h+=i),s+=pathDSegment(m,[[d,f],[p,g],[c,h]]);break;case 8:c-=r,d-=r,h-=i,f-=i;case 9:t?(r+=c,i+=h):(d+=r,f+=i,r=c+=r,i=h+=i),s+=pathDSegment(m,[[d,f],[c,h]]);break;case 10:c-=r,h-=i;case 11:t?(r+=c,i+=h):(r=c+=r,i=h+=i),s+=pathDSegment(m,[[u.r1,u.r2]],[u.angle,u.largeArcFlag?1:0,u.sweepFlag?1:0],[c,h]);break;case 16:c-=r,p-=r,h-=i,g-=i;case 17:t?(r+=c,i+=h):(p+=r,g+=i,r=c+=r,i=h+=i),s+=pathDSegment(m,[[p,g],[c,h]])}}return s};function pathDSegment(e,t,n,a){$$1.each(t,function(e,n){t[e]=shortFloat(n)});var r=e+t.join(" ");return n&&(r+=" "+n.join(" ")),a&&(r+=" "+shortFloat(a)),r}var pathActions=function(){var e=!1,t=void 0,n=void 0,a=null,r=!1;return{mouseDown:function(n,a,r,i){var s=void 0;if("path"!==editorContext_.getCurrentMode()){if(path){path.storeD();var o=void 0;if("pathpointgrip_"===(s=n.target.id).substr(0,14)){o=path.cur_pt=parseInt(s.substr(14),10),path.dragging=[r,i];var l=path.segs[o];n.shiftKey?l.selected?path.removePtFromSelection(o):path.addPtsToSelection(o):((path.selected_pts.length<=1||!l.selected)&&path.clearSelection(),path.addPtsToSelection(o))}else if(s.startsWith("ctrlpointgrip_")){path.dragging=[r,i];var u=s.split("_")[1].split("c");o=Number(u[0]);var c=Number(u[1]);path.selectPt(o,c)}if(!path.dragging){var h=editorContext_.getRubberBox();null==h&&(h=editorContext_.setRubberBox(editorContext_.selectorManager.getRubberBandBox()));var d=editorContext_.getCurrentZoom();assignAttributes(h,{x:r*d,y:i*d,width:0,height:0,display:"inline"},100)}}}else{var f=r,p=i,g=editorContext_.getCurrentZoom(),v=f/g,m=p/g,y=getElem("path_stretch_line");t=[v,m],editorContext_.getGridSnapping()&&(v=snapToGrid(v),m=snapToGrid(m),f=snapToGrid(f),p=snapToGrid(p)),y||(y=document.createElementNS(NS.SVG,"path"),assignAttributes(y,{id:"path_stretch_line",stroke:"#22C","stroke-width":"0.5",fill:"none"}),y=getElem("selectorParentGroup").appendChild(y)),y.setAttribute("display","inline");var b=void 0,_=editorContext_.getDrawnPath();if(_){for(var x=_.pathSegList,C=x.numberOfItems,S=6/g,w=!1;C;){C--;var k=x.getItem(C),$=k.x,P=k.y;if(v>=$-S&&v<=$+S&&m>=P-S&&m<=P+S){w=!0;break}}s=editorContext_.getId(),removePath_(s);var E=getElem(s),A=void 0,T=void 0,N=x.numberOfItems;if(w){if(C<=1&&N>=2){var G=x.getItem(0).x,L=x.getItem(0).y;A=4===(T=y.pathSegList.getItem(1)).pathSegType?_.createSVGPathSegLinetoAbs(G,L):_.createSVGPathSegCurvetoCubicAbs(G,L,T.x1/g,T.y1/g,G,L);var I=_.createSVGPathSegClosePath();x.appendItem(A),x.appendItem(I)}else if(N<3)return!1;if($$1(y).remove(),_=editorContext_.setDrawnPath(null),editorContext_.setStarted(!1),e){path.matrix&&editorContext_.remapElement(E,{},path.matrix.inverse());var M=E.getAttribute("d"),B=$$1(path.elem).attr("d");return $$1(path.elem).attr("d",B+M),$$1(E).remove(),path.matrix&&recalcRotatedPath(),init$1(),pathActions.toEditMode(path.elem),path.selectPt(),!1}}else{if(!$$1.contains(editorContext_.getContainer(),editorContext_.getMouseTarget(n)))return console.log("Clicked outside canvas"),!1;var O=_.pathSegList.numberOfItems,V=_.pathSegList.getItem(O-1),R=V.x,j=V.y;if(n.shiftKey){var D=snapToAngle(R,j,v,m);v=D.x,m=D.y}A=4===(T=y.pathSegList.getItem(1)).pathSegType?_.createSVGPathSegLinetoAbs(editorContext_.round(v),editorContext_.round(m)):_.createSVGPathSegCurvetoCubicAbs(editorContext_.round(v),editorContext_.round(m),T.x1/g,T.y1/g,T.x2/g,T.y2/g),_.pathSegList.appendItem(A),v*=g,m*=g,y.setAttribute("d",["M",v,m,v,m].join(" ")),b=O,e&&(b+=path.segs.length),addPointGrip(b,v,m)}}else{var F="M"+v+","+m+" ";_=editorContext_.setDrawnPath(editorContext_.addSvgElementFromJson({element:"path",curStyles:!0,attr:{d:F,id:editorContext_.getNextId(),opacity:editorContext_.getOpacity()/2}})),y.setAttribute("d",["M",f,p,f,p].join(" ")),b=e?path.segs.length:0,addPointGrip(b,f,p)}}},mouseMove:function(e,a){var i=editorContext_.getCurrentZoom();r=!0;var s=editorContext_.getDrawnPath();if("path"!==editorContext_.getCurrentMode())if(path.dragging){var o=getPointFromGrip({x:path.dragging[0],y:path.dragging[1]},path),l=getPointFromGrip({x:e,y:a},path),u=l.x-o.x,c=l.y-o.y;path.dragging=[e,a],path.dragctrl?path.moveCtrl(u,c):path.movePts(u,c)}else path.selected_pts=[],path.eachSeg(function(e){if(this.next||this.prev){var t=editorContext_.getRubberBox().getBBox(),n=getGripPt(this),a={x:n.x,y:n.y,width:0,height:0},r=rectsIntersect(t,a);this.select(r),r&&path.selected_pts.push(this.index)}});else{if(!s)return;var h=s.pathSegList,d=h.numberOfItems-1;if(t){var f=addCtrlGrip("1c1"),p=addCtrlGrip("0c2");f.setAttribute("cx",e),f.setAttribute("cy",a),f.setAttribute("display","inline");var g=t[0],v=t[1],m=g+(g-e/i),y=v+(v-a/i);p.setAttribute("cx",m*i),p.setAttribute("cy",y*i),p.setAttribute("display","inline");var b=getCtrlLine(1);if(assignAttributes(b,{x1:e,y1:a,x2:m*i,y2:y*i,display:"inline"}),0===d)n=[e,a];else{var _=h.getItem(d-1),x=_.x,C=_.y;6===_.pathSegType?(x+=x-_.x2,C+=C-_.y2):n&&(x=n[0]/i,C=n[1]/i),replacePathSeg(6,d,[g,v,x,C,m,y],s)}}else{var S=getElem("path_stretch_line");if(S){var w=h.getItem(d);if(6===w.pathSegType){var k=w.x+(w.x-w.x2),$=w.y+(w.y-w.y2);replacePathSeg(6,1,[e,a,k*i,$*i,e,a],S)}else n?replacePathSeg(6,1,[e,a,n[0],n[1],e,a],S):replacePathSeg(4,1,[e,a],S)}}}},mouseUp:function(e,a,i,s){var o=editorContext_.getDrawnPath();if("path"===editorContext_.getCurrentMode())return t=null,o||(a=getElem(editorContext_.getId()),editorContext_.setStarted(!1),n=null),{keep:!0,element:a};var l=editorContext_.getRubberBox();if(path.dragging){var u=path.cur_pt;path.dragging=!1,path.dragctrl=!1,path.update(),r&&path.endChanges("Move path point(s)"),e.shiftKey||r||path.selectPt(u)}else l&&"none"!==l.getAttribute("display")?(l.setAttribute("display","none"),l.getAttribute("width")<=2&&l.getAttribute("height")<=2&&pathActions.toSelectMode(e.target)):pathActions.toSelectMode(e.target);r=!1},toEditMode:function(t){path=getPath_(t),editorContext_.setCurrentMode("pathedit"),editorContext_.clearSelection(),path.show(!0).update(),path.oldbbox=getBBox(path.elem),e=!1},toSelectMode:function(e){var t=e===path.elem;editorContext_.setCurrentMode("select"),path.show(!1),a=!1,editorContext_.clearSelection(),path.matrix&&recalcRotatedPath(),t&&(editorContext_.call("selected",[e]),editorContext_.addToSelection([e],!0))},addSubPath:function(t){t?(editorContext_.setCurrentMode("path"),e=!0):(pathActions.clear(!0),pathActions.toEditMode(path.elem))},select:function(e){a===e?(pathActions.toEditMode(e),editorContext_.setCurrentMode("pathedit")):a=e},reorient:function(){var e=editorContext_.getSelectedElements()[0];if(e&&0!==getRotationAngle(e)){var t=new BatchCommand("Reorient path"),n={d:e.getAttribute("d"),transform:e.getAttribute("transform")};t.addSubCommand(new ChangeElementCommand(e,n)),editorContext_.clearSelection(),this.resetOrientation(e),editorContext_.addCommandToHistory(t),getPath_(e).show(!1).matrix=null,this.clear(),editorContext_.addToSelection([e],!0),editorContext_.call("changed",editorContext_.getSelectedElements())}},clear:function(e){var t=editorContext_.getDrawnPath();if(a=null,t){var r=getElem(editorContext_.getId());$$1(getElem("path_stretch_line")).remove(),$$1(r).remove(),$$1(getElem("pathpointgrip_container")).find("*").attr("display","none"),n=null,editorContext_.setDrawnPath(null),editorContext_.setStarted(!1)}else"pathedit"===editorContext_.getCurrentMode()&&this.toSelectMode();path&&path.init().show(!1)},resetOrientation:function(e){if(null==e||"path"!==e.nodeName)return!1;var t=getTransformList(e),n=transformListToTransform(t).matrix;t.clear(),e.removeAttribute("transform");for(var a=e.pathSegList,r=a.numberOfItems,i=function(t){var r=a.getItem(t),i=r.pathSegType;if(1===i)return"continue";var s=[];$$1.each(["",1,2],function(e,t){var a=r["x"+t],i=r["y"+t];if(void 0!==a&&void 0!==i){var o=transformPoint(a,i,n);s.splice(s.length,0,o.x,o.y)}}),replacePathSeg(i,t,s,e)},s=0;s<r;++s)i(s);reorientGrads(e,n)},zoomChange:function(){"pathedit"===editorContext_.getCurrentMode()&&path.update()},getNodePoint:function(){var e=path.selected_pts.length?path.selected_pts[0]:1,t=path.segs[e];return{x:t.item.x,y:t.item.y,type:t.type}},linkControlPoints:function(e){setLinkControlPoints(e)},clonePathNode:function(){path.storeD();for(var e=path.selected_pts,t=e.length,n=[];t--;){var a=e[t];path.addSeg(a),n.push(a+t),n.push(a+t+1)}path.init().addPtsToSelection(n),path.endChanges("Clone path node(s)")},opencloseSubPath:function(){var e=path.selected_pts;if(1===e.length){var t=path.elem,n=t.pathSegList,a=e[0],r=null,i=null;if(path.eachSeg(function(e){return 2===this.type&&e<=a&&(i=this.item),e<=a||(2===this.type?(r=e,!1):1===this.type?(r=!1,!1):void 0)}),null==r&&(r=path.segs.length-1),!1!==r){var s=t.createSVGPathSegLinetoAbs(i.x,i.y),o=t.createSVGPathSegClosePath();return r===path.segs.length-1?(n.appendItem(s),n.appendItem(o)):(insertItemBefore(t,o,r),insertItemBefore(t,s,r)),void path.init().selectPt(r+1)}if(path.segs[a].mate)return n.removeItem(a),n.removeItem(a),void path.init().selectPt(a-1);for(var l=void 0,u=void 0,c=0;c<n.numberOfItems;c++){var h=n.getItem(c);if(2===h.pathSegType)l=c;else if(c===a)n.removeItem(l);else if(1===h.pathSegType&&a<c){u=c-1,n.removeItem(c);break}}for(var d=a-l-1;d--;)insertItemBefore(t,n.getItem(l),u);var f=n.getItem(l);replacePathSeg(2,l,[f.x,f.y]),path.init().selectPt(0)}},deletePathNode:function(){if(pathActions.canDeleteNodes){path.storeD();for(var e=path.selected_pts,t=e.length;t--;){var n=e[t];path.deleteSeg(n)}if(function e(){var t=path.elem.pathSegList,n=t.numberOfItems,a=function(e,n){for(;n--;)t.removeItem(e)};if(n<=1)return!0;for(;n--;){var r=t.getItem(n);if(1===r.pathSegType){var i=t.getItem(n-1),s=t.getItem(n-2);if(2===i.pathSegType){a(n-1,2),e();break}if(2===s.pathSegType){a(n-2,3),e();break}}else if(2===r.pathSegType&&n>0){var o=t.getItem(n-1).pathSegType;if(2===o){a(n-1,1),e();break}if(1===o&&t.numberOfItems-1===n){a(n,1),e();break}}}return!1}(),path.elem.pathSegList.numberOfItems<=1)return pathActions.toSelectMode(path.elem),void editorContext_.canvas.deleteSelectedElements();if(path.init(),path.clearSelection(),window.opera){var a=$$1(path.elem);a.attr("d",a.attr("d"))}path.endChanges("Delete path node(s)")}},smoothPolylineIntoPath:function(e){var t=void 0,n=e.points,a=n.numberOfItems;if(a>=4){var r=n.getItem(0),i=null,s=[];for(s.push(["M",r.x,",",r.y," C"].join("")),t=1;t<=a-4;t+=3){var o=n.getItem(t),l=n.getItem(t+1),u=n.getItem(t+2);if(i){var c=smoothControlPoints(i,o,r);if(c&&2===c.length){var h=s[s.length-1].split(",");h[2]=c[0].x,h[3]=c[0].y,s[s.length-1]=h.join(","),o=c[1]}}s.push([o.x,o.y,l.x,l.y,u.x,u.y].join(",")),r=u,i=l}for(s.push("L");t<a;){var d=n.getItem(t);s.push([d.x,d.y].join(",")),t++}s=s.join(" "),e=editorContext_.addSvgElementFromJson({element:"path",curStyles:!0,attr:{id:editorContext_.getId(),d:s,fill:"none"}})}return e},setSegType:function(e){path.setSegType(e)},moveNode:function(e,t){var n=path.selected_pts;if(n.length){path.storeD();var a=path.segs[n[0]],r={x:0,y:0};r[e]=t-a.item[e],a.move(r.x,r.y),path.endChanges("Move path point")}},fixEnd:function(e){for(var t=e.pathSegList,n=t.numberOfItems,a=void 0,r=0;r<n;++r){var i=t.getItem(r);if(2===i.pathSegType&&(a=i),1===i.pathSegType){var s=t.getItem(r-1);if(s.x!==a.x||s.y!==a.y){var o=e.createSVGPathSegLinetoAbs(a.x,a.y);insertItemBefore(e,o,r),pathActions.fixEnd(e);break}}}isWebkit()&&editorContext_.resetD(e)},convertPath:convertPath}}(),$$2=jqPluginSVG(jQuery),KEYSTR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",visElems="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use",visElemsArr=visElems.split(","),editorContext_$1=null,domdoc_=null,domcontainer_=null,svgroot_=null,init$2=function(e){editorContext_$1=e,domdoc_=e.getDOMDocument(),domcontainer_=e.getDOMContainer(),svgroot_=e.getSVGRoot()},toXml=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/,"&#x27;")},encode64=function(e){if(e=encodeUTF8(e),window.btoa)return window.btoa(e);var t=[];t.length=4*Math.floor((e.length+2)/3);var n=0,a=0;do{var r=e.charCodeAt(n++),i=e.charCodeAt(n++),s=e.charCodeAt(n++),o=r>>2,l=(3&r)<<4|i>>4,u=(15&i)<<2|s>>6,c=63&s;isNaN(i)?u=c=64:isNaN(s)&&(c=64),t[a++]=KEYSTR.charAt(o),t[a++]=KEYSTR.charAt(l),t[a++]=KEYSTR.charAt(u),t[a++]=KEYSTR.charAt(c)}while(n<e.length);return t.join("")},decode64=function(e){if(window.atob)return decodeUTF8(window.atob(e));e=e.replace(/[^A-Za-z0-9+/=]/g,"");var t="",n=0;do{var a=KEYSTR.indexOf(e.charAt(n++)),r=KEYSTR.indexOf(e.charAt(n++)),i=KEYSTR.indexOf(e.charAt(n++)),s=KEYSTR.indexOf(e.charAt(n++)),o=a<<2|r>>4,l=(15&r)<<4|i>>2,u=(3&i)<<6|s;t+=String.fromCharCode(o),64!==i&&(t+=String.fromCharCode(l)),64!==s&&(t+=String.fromCharCode(u))}while(n<e.length);return decodeUTF8(t)},decodeUTF8=function(e){return decodeURIComponent(escape(e))},encodeUTF8=function(e){return unescape(encodeURIComponent(e))},dataURLToObjectURL=function(e){if("undefined"==typeof Uint8Array||"undefined"==typeof Blob||"undefined"==typeof URL||!URL.createObjectURL)return"";for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],a=atob(t[1]),r=a.length,i=new Uint8Array(r);r--;)i[r]=a.charCodeAt(r);var s=new Blob([i],{type:n});return URL.createObjectURL(s)},createObjectURL=function(e){return e&&"undefined"!=typeof URL&&URL.createObjectURL?URL.createObjectURL(e):""},blankPageObjectURL=function(){if("undefined"==typeof Blob)return"";var e=new Blob(["<html><head><title>SVG-edit</title></head><body>&nbsp;</body></html>"],{type:"text/html"});return createObjectURL(e)}(),text2xml=function(e){e.includes("<svg:svg")&&(e=e.replace(/<(\/?)svg:/g,"<$1").replace("xmlns:svg","xmlns"));var t=void 0,n=void 0;try{(n=window.DOMParser?new DOMParser:new ActiveXObject("Microsoft.XMLDOM")).async=!1}catch(e){throw new Error("XML Parser could not be instantiated")}try{t=n.loadXML?!!n.loadXML(e)&&n:n.parseFromString(e,"text/xml")}catch(e){throw new Error("Error parsing XML string")}return t},bboxToObj=function(e){return{x:e.x,y:e.y,width:e.width,height:e.height}},walkTree=function e(t,n){if(t&&1===t.nodeType){n(t);for(var a=t.childNodes.length;a--;)e(t.childNodes.item(a),n)}},walkTreePost=function(e,t){if(e&&1===e.nodeType){for(var n=e.childNodes.length;n--;)walkTree(e.childNodes.item(n),t);t(e)}},getUrlFromAttr=function(e){if(e){if(e.startsWith('url("'))return e.substring(5,e.indexOf('"',6));if(e.startsWith("url('"))return e.substring(5,e.indexOf("'",6));if(e.startsWith("url("))return e.substring(4,e.indexOf(")"))}return null},getHref=function(e){return e.getAttributeNS(NS.XLINK,"href")},setHref=function(e,t){e.setAttributeNS(NS.XLINK,"xlink:href",t)},findDefs=function(){var e=editorContext_$1.getSVGContent(),t=e.getElementsByTagNameNS(NS.SVG,"defs");return t.length>0?t=t[0]:(t=e.ownerDocument.createElementNS(NS.SVG,"defs"),e.firstChild?e.insertBefore(t,e.firstChild.nextSibling):e.appendChild(t)),t},getPathBBox=function(e){for(var t=e.pathSegList,n=t.numberOfItems,a=[[],[]],r=t.getItem(0),i=[r.x,r.y],s=0;s<n;s++){var o=t.getItem(s);void 0!==o.x&&(a[0].push(i[0]),a[1].push(i[1]),o.x1?function(){for(var e=[o.x1,o.y1],t=[o.x2,o.y2],n=[o.x,o.y],r=function(r){var s=function(a){return Math.pow(1-a,3)*i[r]+3*Math.pow(1-a,2)*a*e[r]+3*(1-a)*Math.pow(a,2)*t[r]+Math.pow(a,3)*n[r]},o=6*i[r]-12*e[r]+6*t[r],l=-3*i[r]+9*e[r]-9*t[r]+3*n[r],u=3*e[r]-3*i[r];if(0===l){if(0===o)return"continue";var c=-u/o;return c>0&&c<1&&a[r].push(s(c)),"continue"}var h=Math.pow(o,2)-4*u*l;if(h<0)return"continue";var d=(-o+Math.sqrt(h))/(2*l);d>0&&d<1&&a[r].push(s(d));var f=(-o-Math.sqrt(h))/(2*l);f>0&&f<1&&a[r].push(s(f))},s=0;s<2;s++)r(s);i=n}():(a[0].push(o.x),a[1].push(o.y)))}var l=Math.min.apply(null,a[0]),u=Math.max.apply(null,a[0])-l,c=Math.min.apply(null,a[1]);return{x:l,y:c,width:u,height:Math.max.apply(null,a[1])-c}};function groupBBFix(e){if(supportsHVLineContainerBBox())try{return e.getBBox()}catch(e){}var t=$$2.data(e,"ref"),n=null,a=void 0,r=void 0;t?(r=$$2(t).children().clone().attr("visibility","hidden"),$$2(svgroot_).append(r),n=r.filter("line, path")):n=$$2(e).find("line, path");var i=!1;if(n.length)if(n.each(function(){var e=this.getBBox();e.width&&e.height||(i=!0)}),i){var s=t?r:$$2(e).children();a=getStrokedBBox(s)}else a=e.getBBox();else a=e.getBBox();return t&&r.remove(),a}var getBBox=function(e){var t=e||editorContext_$1.geSelectedElements()[0];if(1!==e.nodeType)return null;var n=t.nodeName,a=null;switch(n){case"text":""===t.textContent?(t.textContent="a",a=t.getBBox(),t.textContent=""):t.getBBox&&(a=t.getBBox());break;case"path":supportsPathBBox()?t.getBBox&&(a=t.getBBox()):a=getPathBBox(t);break;case"g":case"a":a=groupBBFix(t);break;default:if("use"===n&&(a=groupBBFix(t,!0)),"use"===n||"foreignObject"===n&&isWebkit()){if(a||(a=t.getBBox()),!isWebkit()){var r={};r.width=a.width,r.height=a.height,r.x=a.x+parseFloat(t.getAttribute("x")||0),r.y=a.y+parseFloat(t.getAttribute("y")||0),a=r}}else if(visElemsArr.includes(n))if(t)try{a=t.getBBox()}catch(e){var i=t.getExtentOfChar(0),s=t.getComputedTextLength();a={x:i.x,y:i.y,width:s,height:i.height}}else{var o=$$2(t).closest("foreignObject");o.length&&o[0].getBBox&&(a=o[0].getBBox())}}return a&&(a=bboxToObj(a)),a},getPathDFromSegments=function(e){var t="";return $$2.each(e,function(e,n){var a=n[1];t+=n[0];for(var r=0;r<a.length;r+=2)t+=a[r]+","+a[r+1]+" "}),t},getPathDFromElement=function(e){var t=1.81,n=void 0,a=void 0,r=void 0,i=void 0;switch(e.tagName){case"ellipse":case"circle":var s=a=$$2(e).attr(["rx","ry","cx","cy"]),o=s.cx,l=s.cy,u=a;r=u.rx,i=u.ry,"circle"===e.tagName&&(r=i=$$2(e).attr("r")),n=getPathDFromSegments([["M",[o-r,l]],["C",[o-r,l-i/t,o-r/t,l-i,o,l-i]],["C",[o+r/t,l-i,o+r,l-i/t,o+r,l]],["C",[o+r,l+i/t,o+r/t,l+i,o,l+i]],["C",[o-r/t,l+i,o-r,l+i/t,o-r,l]],["Z",[]]]);break;case"path":n=e.getAttribute("d");break;case"line":n="M"+(a=$$2(e).attr(["x1","y1","x2","y2"])).x1+","+a.y1+"L"+a.x2+","+a.y2;break;case"polyline":n="M"+e.getAttribute("points");break;case"polygon":n="M"+e.getAttribute("points")+" Z";break;case"rect":var c=$$2(e).attr(["rx","ry"]);r=c.rx,i=c.ry;var h=e.getBBox(),d=h.x,f=h.y,p=h.width,g=h.height;t=4-t,n=getPathDFromSegments(r||i?[["M",[d,f+i]],["C",[d,f+i/t,d+r/t,f,d+r,f]],["L",[d+p-r,f]],["C",[d+p-r/t,f,d+p,f+i/t,d+p,f+i]],["L",[d+p,f+g-i]],["C",[d+p,f+g-i/t,d+p-r/t,f+g,d+p-r,f+g]],["L",[d+r,f+g]],["C",[d+r/t,f+g,d,f+g-i/t,d,f+g-i]],["L",[d,f+i]],["Z",[]]]:[["M",[d,f]],["L",[d+p,f]],["L",[d+p,f+g]],["L",[d,f+g]],["L",[d,f]],["Z",[]]])}return n},getExtraAttributesForConvertToPath=function(e){var t={};return $$2.each(["marker-start","marker-end","marker-mid","filter","clip-path"],function(){var n=e.getAttribute(this);n&&(t[this]=n)}),t},getBBoxOfElementAsPath=function(e,t,n){var a=t({element:"path",attr:getExtraAttributesForConvertToPath(e)}),r=e.getAttribute("transform");r&&a.setAttribute("transform",r);var i=e.parentNode;e.nextSibling?i.insertBefore(a,e):i.appendChild(a);var s=getPathDFromElement(e);s?a.setAttribute("d",s):a.parentNode.removeChild(a),n.resetOrientation(a);var o=!1;try{o=a.getBBox()}catch(e){}return a.parentNode.removeChild(a),o},convertToPath=function(e,t,n,a,r,i,s,o){var l=new s.BatchCommand("Convert element to Path"),u=n({element:"path",attr:t=$$2.extend({},t,getExtraAttributesForConvertToPath(e))}),c=e.getAttribute("transform");c&&u.setAttribute("transform",c);var h=e.id,d=e.parentNode;e.nextSibling?d.insertBefore(u,e):d.appendChild(u);var f=getPathDFromElement(e);if(f){if(u.setAttribute("d",f),c){var p=getTransformList(u);hasMatrixTransform(p)&&a.resetOrientation(u)}var g=e.nextSibling;return l.addSubCommand(new s.RemoveElementCommand(e,g,d)),l.addSubCommand(new s.InsertElementCommand(u)),r(),e.parentNode.removeChild(e),u.setAttribute("id",h),u.removeAttribute("visibility"),i([u],!0),o(l),u}return u.parentNode.removeChild(u),null};function bBoxCanBeOptimizedOverNativeGetBBox(e,t){var n=e%90;return t||!(n>-.001&&n<.001||(n<-89.99||n>89.99))}var getBBoxWithTransform=function(e,t,n){var a=getBBox(e);if(!a)return null;var r=getTransformList(e),i=getRotationAngleFromTransformList(r),s=hasMatrixTransform(r);if(i||s){var o=!1;if(bBoxCanBeOptimizedOverNativeGetBBox(i,s)){if(["ellipse","path","line","polyline","polygon"].includes(e.tagName))a=o=getBBoxOfElementAsPath(e,t,n);else if("rect"===e.tagName){var l=e.getAttribute("rx"),u=e.getAttribute("ry");(l||u)&&(a=o=getBBoxOfElementAsPath(e,t,n))}}if(!o){var c=transformListToTransform(r).matrix;a=transformBox(a.x,a.y,a.width,a.height,c).aabox}}return a};function getStrokeOffsetForBBox(e){var t=e.getAttribute("stroke-width");return isNaN(t)||"none"===e.getAttribute("stroke")?0:t/2}var getStrokedBBox=function(e,t,n){if(!e||!e.length)return!1;var a=void 0;if($$2.each(e,function(){a||this.parentNode&&(a=getBBoxWithTransform(this,t,n))}),void 0===a)return null;var r=a.x+a.width,i=a.y+a.height,s=a.x,o=a.y;if(1===e.length){var l=getStrokeOffsetForBBox(e[0]);s-=l,o-=l,r+=l,i+=l}else $$2.each(e,function(e,a){var l=getBBoxWithTransform(a,t,n);if(l){var u=getStrokeOffsetForBBox(a);s=Math.min(s,l.x-u),o=Math.min(o,l.y-u),1===a.nodeType&&(r=Math.max(r,l.x+l.width+u),i=Math.max(i,l.y+l.height+u))}});return a.x=s,a.y=o,a.width=r-s,a.height=i-o,a},getVisibleElements=function(e){e||(e=$$2(editorContext_$1.getSVGContent()).children());var t=[];return $$2(e).children().each(function(e,n){n.getBBox&&t.push(n)}),t.reverse()},getStrokedBBoxDefaultVisible=function(e){return e||(e=getVisibleElements()),getStrokedBBox(e,editorContext_$1.addSvgElementFromJson,editorContext_$1.pathActions)},getRotationAngleFromTransformList=function(e,t){if(!e)return 0;for(var n=e.numberOfItems,a=0;a<n;++a){var r=e.getItem(a);if(4===r.type)return t?r.angle*Math.PI/180:r.angle}return 0},getRotationAngle=function(e,t){var n=e||editorContext_$1.getSelectedElements()[0],a=getTransformList(n);return getRotationAngleFromTransformList(a,t)},getRefElem=function(e){return getElem(getUrlFromAttr(e).substr(1))},getElem=supportsSelectors()?function(e){return svgroot_.querySelector("#"+e)}:supportsXpath()?function(e){return domdoc_.evaluate('svg:svg[@id="svgroot"]//svg:*[@id="'+e+'"]',domcontainer_,function(){return NS.SVG},9,null).singleNodeValue}:function(e){return $$2(svgroot_).find("[id="+e+"]")[0]},assignAttributes=function(e,t,n,a){for(var r in t){var i="xml:"===r.substr(0,4)?NS.XML:"xlink:"===r.substr(0,6)?NS.XLINK:null;i?e.setAttributeNS(i,r,t[r]):a?setUnitAttr(e,r,t[r]):e.setAttribute(r,t[r])}},cleanupElement=function(e){var t={"fill-opacity":1,"stop-opacity":1,opacity:1,stroke:"none","stroke-dasharray":"none","stroke-linejoin":"miter","stroke-linecap":"butt","stroke-opacity":1,"stroke-width":1,rx:0,ry:0};for(var n in"ellipse"===e.nodeName&&(delete t.rx,delete t.ry),t){var a=t[n];e.getAttribute(n)===String(a)&&e.removeAttribute(n)}},snapToGrid=function(e){var t=editorContext_$1.getBaseUnit(),n=editorContext_$1.getSnappingStep();return"px"!==t&&(n*=getTypeMap()[t]),e=Math.round(e/n)*n},regexEscape=function(e,t){return String(e).replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\"+(t||"")+"-]","g"),"\\$&")},loadedScripts={},executeAfterLoads=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{globals:!1};return function(){var r=arguments;function i(){n.apply(null,r)}var s=!("svgEditor"in window&&window.svgEditor&&!1===window.svgEditor.modules);if(!0===loadedScripts[e])i();else if(Array.isArray(loadedScripts[e]))loadedScripts[e].push(i);else{loadedScripts[e]=[];var o=s&&!a.globals?importModule:importScript;t.reduce(function(e,t){return e.then(function(){return o(t)})},Promise.resolve()).then(function(){i(),loadedScripts[e].forEach(function(e){e()}),loadedScripts[e]=!0})()}}},buildCanvgCallback=function(e){return executeAfterLoads("canvg",["canvg/rgbcolor.js","canvg/canvg.js"],e)},buildJSPDFCallback=function(e){return executeAfterLoads("RGBColor",["canvg/rgbcolor.js"],function(){var t=[];RGBColor&&void 0!==RGBColor.ok||t.push("canvg/rgbcolor.js"),executeAfterLoads("jsPDF",[].concat(t,["jspdf/underscore-min.js","jspdf/jspdf.min.js","jspdf/jspdf.plugin.svgToPdf.js"]),e,{globals:!0})()})},preventClickDefault=function(e){$$2(e).click(function(e){e.preventDefault()})},copyElem=function e(t,n){var a=document.createElementNS(t.namespaceURI,t.nodeName);if($$2.each(t.attributes,function(e,t){"-moz-math-font-style"!==t.localName&&a.setAttributeNS(t.namespaceURI,t.nodeName,t.value)}),a.removeAttribute("id"),a.id=n(),isWebkit()&&"path"===t.nodeName){var r=convertPath(t);a.setAttribute("d",r)}if($$2.each(t.childNodes,function(t,r){switch(r.nodeType){case 1:a.appendChild(e(r,n));break;case 3:a.textContent=r.nodeValue}}),$$2(t).data("gsvg"))$$2(a).data("gsvg",a.firstChild);else if($$2(t).data("symbol")){var i=$$2(t).data("symbol");$$2(a).data("ref",i).data("symbol",i)}else"image"===a.tagName&&preventClickDefault(a);return a},$$3=jQuery,contextMenuExtensions={},hasCustomHandler=function(e){return Boolean(contextMenuExtensions[e])},getCustomHandler=function(e){return contextMenuExtensions[e].action},injectExtendedContextMenuItemIntoDom=function(e){Object.keys(contextMenuExtensions).length||$$3("#cmenu_canvas").append("<li class='separator'>");var t=e.shortcut||"";$$3("#cmenu_canvas").append("<li class='disabled'><a href='#"+e.id+"'>"+e.label+"<span class='shortcut'>"+t+"</span></a></li>")},injectExtendedContextMenuItemsIntoDom=function(){for(var e in contextMenuExtensions)injectExtendedContextMenuItemIntoDom(contextMenuExtensions[e])};function canvg(e,t,n){if(null!=e||null!=t||null!=n){"string"==typeof e&&(e=document.getElementById(e)),null!=e.svg&&e.svg.stop();var a=build(n||{});1===e.childNodes.length&&"OBJECT"===e.childNodes[0].nodeName||(e.svg=a);var r=e.getContext("2d");void 0!==t.documentElement?a.loadXmlDoc(r,t):"<"===t.substr(0,1)?a.loadXml(r,t):a.load(r,t)}else for(var i=document.querySelectorAll("svg"),s=0;s<i.length;s++){var o=i[s],l=document.createElement("canvas");l.width=o.clientWidth,l.height=o.clientHeight,o.parentNode.insertBefore(l,o),o.parentNode.removeChild(o);var u=document.createElement("div");u.appendChild(o),canvg(l,u.innerHTML)}}function build(e){var t={opts:e,FRAMERATE:30,MAX_VIRTUAL_PIXELS:3e4,log:function(e){}};!0===t.opts.log&&"undefined"!=typeof console&&(t.log=function(e){console.log(e)}),t.init=function(e){var n=0;t.UniqueId=function(){return"canvg"+ ++n},t.Definitions={},t.Styles={},t.Animations=[],t.Images=[],t.ctx=e,t.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(e,t){this.viewPorts.push({width:e,height:t})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(e){return null!=e&&"number"==typeof e?e:"x"===e?this.width():"y"===e?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},t.init(),t.ImagesLoaded=function(){for(var e=0;e<t.Images.length;e++)if(!t.Images[e].loaded)return!1;return!0},t.trim=function(e){return e.replace(/^\s+|\s+$/g,"")},t.compressSpaces=function(e){return e.replace(/[\s\r\t\n]+/gm," ")},t.ajax=function(e){var t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return t?(t.open("GET",e,!1),t.send(null),t.responseText):null},t.parseXml=function(e){if(window.DOMParser)return(new DOMParser).parseFromString(e,"text/xml");e=e.replace(/<!DOCTYPE svg[^>]*>/,"");var t=new ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t};var n={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return t.Property=function(){function e(t,n){classCallCheck(this,e),this.name=t,this.value=n}return createClass(e,[{key:"getValue",value:function(){return this.value}},{key:"hasValue",value:function(){return null!=this.value&&""!==this.value}},{key:"numValue",value:function(){if(!this.hasValue())return 0;var e=parseFloat(this.value);return(this.value+"").match(/%$/)&&(e/=100),e}},{key:"valueOrDefault",value:function(e){return this.hasValue()?this.value:e}},{key:"numValueOrDefault",value:function(e){return this.hasValue()?this.numValue():e}},{key:"addOpacity",value:function(e){var n=this.value;if(null!=e.value&&""!==e.value&&"string"==typeof this.value){var a=new RGBColor(this.value);a.ok&&(n="rgba("+a.r+", "+a.g+", "+a.b+", "+e.numValue()+")")}return new t.Property(this.name,n)}},{key:"getDefinition",value:function(){var e=this.value.match(/#([^)'"]+)/);return e&&(e=e[1]),e||(e=this.value),t.Definitions[e]}},{key:"isUrlDefinition",value:function(){return this.value.startsWith("url(")}},{key:"getFillStyleDefinition",value:function(e,n){var a=this.getDefinition();if(null!=a&&a.createGradient)return a.createGradient(t.ctx,e,n);if(null!=a&&a.createPattern){if(a.getHrefAttribute().hasValue()){var r=a.attribute("patternTransform");a=a.getHrefAttribute().getDefinition(),r.hasValue()&&(a.attribute("patternTransform",!0).value=r.value)}return a.createPattern(t.ctx,e)}return null}},{key:"getDPI",value:function(e){return 96}},{key:"getEM",value:function(e){var n=12,a=new t.Property("fontSize",t.Font.Parse(t.ctx.font).fontSize);return a.hasValue()&&(n=a.toPixels(e)),n}},{key:"getUnits",value:function(){return(this.value+"").replace(/[0-9.-]/g,"")}},{key:"toPixels",value:function(e,n){if(!this.hasValue())return 0;var a=this.value+"";if(a.match(/em$/))return this.numValue()*this.getEM(e);if(a.match(/ex$/))return this.numValue()*this.getEM(e)/2;if(a.match(/px$/))return this.numValue();if(a.match(/pt$/))return this.numValue()*this.getDPI(e)*(1/72);if(a.match(/pc$/))return 15*this.numValue();if(a.match(/cm$/))return this.numValue()*this.getDPI(e)/2.54;if(a.match(/mm$/))return this.numValue()*this.getDPI(e)/25.4;if(a.match(/in$/))return this.numValue()*this.getDPI(e);if(a.match(/%$/))return this.numValue()*t.ViewPort.ComputeSize(e);var r=this.numValue();return n&&r<1?r*t.ViewPort.ComputeSize(e):r}},{key:"toMilliseconds",value:function(){if(!this.hasValue())return 0;var e=this.value+"";return e.match(/s$/)?1e3*this.numValue():(e.match(/ms$/),this.numValue())}},{key:"toRadians",value:function(){if(!this.hasValue())return 0;var e=this.value+"";return e.match(/deg$/)?this.numValue()*(Math.PI/180):e.match(/grad$/)?this.numValue()*(Math.PI/200):e.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)}},{key:"toTextBaseline",value:function(){return this.hasValue()?n[this.value]:null}}]),e}(),t.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(e,n,a,r,i,s){var o=null!=s?this.Parse(s):this.CreateFont("","","","","",t.ctx.font);return{fontFamily:i||o.fontFamily,fontSize:r||o.fontSize,fontStyle:e||o.fontStyle,fontWeight:a||o.fontWeight,fontVariant:n||o.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var e=this;this.Parse=function(n){for(var a={},r=t.trim(t.compressSpaces(n||"")).split(" "),i={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},s="",o=0;o<r.length;o++)!i.fontStyle&&e.Styles.includes(r[o])?("inherit"!==r[o]&&(a.fontStyle=r[o]),i.fontStyle=!0):!i.fontVariant&&e.Variants.includes(r[o])?("inherit"!==r[o]&&(a.fontVariant=r[o]),i.fontStyle=i.fontVariant=!0):!i.fontWeight&&e.Weights.includes(r[o])?("inherit"!==r[o]&&(a.fontWeight=r[o]),i.fontStyle=i.fontVariant=i.fontWeight=!0):i.fontSize?"inherit"!==r[o]&&(s+=r[o]):("inherit"!==r[o]&&(a.fontSize=r[o].split("/")[0]),i.fontStyle=i.fontVariant=i.fontWeight=i.fontSize=!0);return""!==s&&(a.fontFamily=s),a}},t.ToNumberArray=function(e){for(var n=t.trim(t.compressSpaces((e||"").replace(/,/g," "))).split(" "),a=0;a<n.length;a++)n[a]=parseFloat(n[a]);return n},t.Point=function(){function e(t,n){classCallCheck(this,e),this.x=t,this.y=n}return createClass(e,[{key:"angleTo",value:function(e){return Math.atan2(e.y-this.y,e.x-this.x)}},{key:"applyTransform",value:function(e){var t=this.x*e[0]+this.y*e[2]+e[4],n=this.x*e[1]+this.y*e[3]+e[5];this.x=t,this.y=n}}]),e}(),t.CreatePoint=function(e){var n=t.ToNumberArray(e);return new t.Point(n[0],n[1])},t.CreatePath=function(e){for(var n=t.ToNumberArray(e),a=[],r=0;r<n.length;r+=2)a.push(new t.Point(n[r],n[r+1]));return a},t.BoundingBox=function(e,t,n,a){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(e,t){null!=e&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),null!=t&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))},this.addX=function(e){this.addPoint(e,null)},this.addY=function(e){this.addPoint(null,e)},this.addBoundingBox=function(e){this.addPoint(e.x1,e.y1),this.addPoint(e.x2,e.y2)},this.addQuadraticCurve=function(e,t,n,a,r,i){var s=e+2/3*(n-e),o=t+2/3*(a-t),l=s+1/3*(r-e),u=o+1/3*(i-t);this.addBezierCurve(e,t,s,l,o,u,r,i)},this.addBezierCurve=function(e,t,n,a,r,i,s,o){var l=this,u=[e,t],c=[n,a],h=[r,i],d=[s,o];this.addPoint(u[0],u[1]),this.addPoint(d[0],d[1]);for(var f=function(e){var t=function(t){return Math.pow(1-t,3)*u[e]+3*Math.pow(1-t,2)*t*c[e]+3*(1-t)*Math.pow(t,2)*h[e]+Math.pow(t,3)*d[e]},n=6*u[e]-12*c[e]+6*h[e],a=-3*u[e]+9*c[e]-9*h[e]+3*d[e],r=3*c[e]-3*u[e];if(0===a){if(0===n)return"continue";var i=-r/n;return i>0&&i<1&&(0===e&&l.addX(t(i)),1===e&&l.addY(t(i))),"continue"}var s=Math.pow(n,2)-4*r*a;if(s<0)return"continue";var o=(-n+Math.sqrt(s))/(2*a);o>0&&o<1&&(0===e&&l.addX(t(o)),1===e&&l.addY(t(o)));var f=(-n-Math.sqrt(s))/(2*a);f>0&&f<1&&(0===e&&l.addX(t(f)),1===e&&l.addY(t(f)))},p=0;p<=1;p++)f(p)},this.isPointInBox=function(e,t){return this.x1<=e&&e<=this.x2&&this.y1<=t&&t<=this.y2},this.addPoint(e,t),this.addPoint(n,a)},t.Transform=function(e){this.Type={},this.Type.translate=function(e){this.p=t.CreatePoint(e),this.apply=function(e){e.translate(this.p.x||0,this.p.y||0)},this.unapply=function(e){e.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(e){e.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(e){var n=t.ToNumberArray(e);this.angle=new t.Property("angle",n[0]),this.cx=n[1]||0,this.cy=n[2]||0,this.apply=function(e){e.translate(this.cx,this.cy),e.rotate(this.angle.toRadians()),e.translate(-this.cx,-this.cy)},this.unapply=function(e){e.translate(this.cx,this.cy),e.rotate(-1*this.angle.toRadians()),e.translate(-this.cx,-this.cy)},this.applyToPoint=function(e){var t=this.angle.toRadians();e.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),e.applyTransform([Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0]),e.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(e){this.p=t.CreatePoint(e),this.apply=function(e){e.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(e){e.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(e){e.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(e){this.m=t.ToNumberArray(e),this.apply=function(e){e.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.applyToPoint=function(e){e.applyTransform(this.m)}},this.Type.SkewBase=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return a.angle=new t.Property("angle",e),a}return inherits(n,e),n}(this.Type.matrix),this.Type.skewX=function(e){function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.m=[1,0,Math.tan(n.angle.toRadians()),1,0,0],n}return inherits(t,e),t}(this.Type.SkewBase),this.Type.skewY=function(e){function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.m=[1,Math.tan(n.angle.toRadians()),0,1,0,0],n}return inherits(t,e),t}(this.Type.SkewBase),this.transforms=[],this.apply=function(e){for(var t=0;t<this.transforms.length;t++)this.transforms[t].apply(e)},this.unapply=function(e){for(var t=this.transforms.length-1;t>=0;t--)this.transforms[t].unapply(e)},this.applyToPoint=function(e){for(var t=0;t<this.transforms.length;t++)this.transforms[t].applyToPoint(e)};for(var n=t.trim(t.compressSpaces(e)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),a=0;a<n.length;a++){var r=t.trim(n[a].split("(")[0]),i=n[a].split("(")[1].replace(")",""),s=new this.Type[r](i);s.type=r,this.transforms.push(s)}},t.AspectRatio=function(e,n,a,r,i,s,o,l,u,c){var h=(n=(n=t.compressSpaces(n)).replace(/^defer\s/,"")).split(" ")[0]||"xMidYMid",d=n.split(" ")[1]||"meet",f=a/r,p=i/s,g=Math.min(f,p),v=Math.max(f,p);"meet"===d&&(r*=g,s*=g),"slice"===d&&(r*=v,s*=v),u=new t.Property("refX",u),c=new t.Property("refY",c),u.hasValue()&&c.hasValue()?e.translate(-g*u.toPixels("x"),-g*c.toPixels("y")):(h.match(/^xMid/)&&("meet"===d&&g===p||"slice"===d&&v===p)&&e.translate(a/2-r/2,0),h.match(/YMid$/)&&("meet"===d&&g===f||"slice"===d&&v===f)&&e.translate(0,i/2-s/2),h.match(/^xMax/)&&("meet"===d&&g===p||"slice"===d&&v===p)&&e.translate(a-r,0),h.match(/YMax$/)&&("meet"===d&&g===f||"slice"===d&&v===f)&&e.translate(0,i-s)),"none"===h?e.scale(f,p):"meet"===d?e.scale(g,g):"slice"===d&&e.scale(v,v),e.translate(null==o?0:-o,null==l?0:-l)},t.Element={},t.EmptyProperty=new t.Property("EMPTY",""),t.Element.ElementBase=function(e){if(this.attributes={},this.styles={},this.children=[],this.attribute=function(e,n){var a=this.attributes[e];return null!=a?a:(!0===n&&(a=new t.Property(e,""),this.attributes[e]=a),a||t.EmptyProperty)},this.getHrefAttribute=function(){for(var e in this.attributes)if(e.match(/:href$/))return this.attributes[e];return t.EmptyProperty},this.style=function(e,n,a){var r=this.styles[e];if(null!=r)return r;var i=this.attribute(e);if(null!=i&&i.hasValue())return this.styles[e]=i,i;if(!0!==a){var s=this.parent;if(null!=s){var o=s.style(e);if(null!=o&&o.hasValue())return o}}return!0===n&&(r=new t.Property(e,""),this.styles[e]=r),r||t.EmptyProperty},this.render=function(e){if("none"!==this.style("display").value&&"hidden"!==this.style("visibility").value){if(e.save(),this.attribute("mask").hasValue()){var t=this.attribute("mask").getDefinition();null!=t&&t.apply(e,this)}else if(this.style("filter").hasValue()){var n=this.style("filter").getDefinition();null!=n&&n.apply(e,this)}else this.setContext(e),this.renderChildren(e),this.clearContext(e);e.restore()}},this.setContext=function(e){},this.clearContext=function(e){},this.renderChildren=function(e){for(var t=0;t<this.children.length;t++)this.children[t].render(e)},this.addChild=function(e,n){var a=n?t.CreateElement(e):e;a.parent=this,"title"!==a.type&&this.children.push(a)},null!=e&&1===e.nodeType){for(var n,a=0;n=e.childNodes[a];a++)if(1===n.nodeType&&this.addChild(n,!0),this.captureTextNodes&&(3===n.nodeType||4===n.nodeType)){var r=n.nodeValue||n.text||"";""!==t.trim(t.compressSpaces(r))&&this.addChild(new t.Element.tspan(n),!1)}for(var i=0;i<e.attributes.length;i++){var s=e.attributes[i];this.attributes[s.nodeName]=new t.Property(s.nodeName,s.nodeValue)}var o=t.Styles[e.nodeName];if(null!=o)for(var l in o)this.styles[l]=o[l];if(this.attribute("class").hasValue())for(var u=t.compressSpaces(this.attribute("class").value).split(" "),c=0;c<u.length;c++){if(null!=(o=t.Styles["."+u[c]]))for(var h in o)this.styles[h]=o[h];if(null!=(o=t.Styles[e.nodeName+"."+u[c]]))for(var d in o)this.styles[d]=o[d]}if(this.attribute("id").hasValue()){var f=t.Styles["#"+this.attribute("id").value];if(null!=f)for(var p in f)this.styles[p]=f[p]}if(this.attribute("style").hasValue())for(var g=this.attribute("style").value.split(";"),v=0;v<g.length;v++)if(""!==t.trim(g[v])){var m=g[v].split(":"),y=t.trim(m[0]),b=t.trim(m[1]);this.styles[y]=new t.Property(y,b)}this.attribute("id").hasValue()&&null==t.Definitions[this.attribute("id").value]&&(t.Definitions[this.attribute("id").value]=this)}},t.Element.RenderedElementBase=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return a.setContext=function(e){if(this.style("fill").isUrlDefinition()){var n=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=n&&(e.fillStyle=n)}else if(this.style("fill").hasValue()){var a=this.style("fill");"currentColor"===a.value&&(a.value=this.style("color").value),e.fillStyle="none"===a.value?"rgba(0,0,0,0)":a.value}if(this.style("fill-opacity").hasValue()){var r=new t.Property("fill",e.fillStyle);r=r.addOpacity(this.style("fill-opacity")),e.fillStyle=r.value}if(this.style("stroke").isUrlDefinition()){var i=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=i&&(e.strokeStyle=i)}else if(this.style("stroke").hasValue()){var s=this.style("stroke");"currentColor"===s.value&&(s.value=this.style("color").value),e.strokeStyle="none"===s.value?"rgba(0,0,0,0)":s.value}if(this.style("stroke-opacity").hasValue()){var o=new t.Property("stroke",e.strokeStyle);o=o.addOpacity(this.style("stroke-opacity")),e.strokeStyle=o.value}if(this.style("stroke-width").hasValue()){var l=this.style("stroke-width").toPixels();e.lineWidth=0===l?.001:l}if(this.style("stroke-linecap").hasValue()&&(e.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(e.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(e.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()&&"none"!==this.style("stroke-dasharray").value){var u=t.ToNumberArray(this.style("stroke-dasharray").value);void 0!==e.setLineDash?e.setLineDash(u):void 0!==e.webkitLineDash?e.webkitLineDash=u:void 0===e.mozDash||1===u.length&&0===u[0]||(e.mozDash=u);var c=this.style("stroke-dashoffset").numValueOrDefault(1);void 0!==e.lineDashOffset?e.lineDashOffset=c:void 0!==e.webkitLineDashOffset?e.webkitLineDashOffset=c:void 0!==e.mozDashOffset&&(e.mozDashOffset=c)}(void 0!==e.font&&(e.font=t.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.attribute("transform").hasValue())&&new t.Transform(this.attribute("transform").value).apply(e);if(this.style("clip-path",!1,!0).hasValue()){var h=this.style("clip-path",!1,!0).getDefinition();null!=h&&h.apply(e)}this.style("opacity").hasValue()&&(e.globalAlpha=this.style("opacity").numValue())},a}return inherits(n,e),n}(t.Element.ElementBase),t.Element.PathElementBase=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return a.path=function(e){return null!=e&&e.beginPath(),new t.BoundingBox},a.renderChildren=function(e){this.path(e),t.Mouse.checkPath(this,e),""!==e.fillStyle&&("inherit"!==this.style("fill-rule").valueOrDefault("inherit")?e.fill(this.style("fill-rule").value):e.fill()),""!==e.strokeStyle&&e.stroke();var n=this.getMarkers();if(null!=n){if(this.style("marker-start").isUrlDefinition())this.style("marker-start").getDefinition().render(e,n[0][0],n[0][1]);if(this.style("marker-mid").isUrlDefinition())for(var a=this.style("marker-mid").getDefinition(),r=1;r<n.length-1;r++)a.render(e,n[r][0],n[r][1]);if(this.style("marker-end").isUrlDefinition())this.style("marker-end").getDefinition().render(e,n[n.length-1][0],n[n.length-1][1])}},a.getBoundingBox=function(){return this.path()},a.getMarkers=function(){return null},a}return inherits(n,e),n}(t.Element.RenderedElementBase),t.Element.svg=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return a.baseClearContext=a.clearContext,a.clearContext=function(e){this.baseClearContext(e),t.ViewPort.RemoveCurrent()},a.baseSetContext=a.setContext,a.setContext=function(e){e.strokeStyle="rgba(0,0,0,0)",e.lineCap="butt",e.lineJoin="miter",e.miterLimit=4,void 0!==e.font&&void 0!==window.getComputedStyle&&(e.font=window.getComputedStyle(e.canvas).getPropertyValue("font")),this.baseSetContext(e),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),e.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var n=t.ViewPort.width(),a=t.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),void 0===this.root){n=this.attribute("width").toPixels("x"),a=this.attribute("height").toPixels("y");var r=0,i=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(r=-this.attribute("refX").toPixels("x"),i=-this.attribute("refY").toPixels("y")),"visible"!==this.attribute("overflow").valueOrDefault("hidden")&&(e.beginPath(),e.moveTo(r,i),e.lineTo(n,i),e.lineTo(n,a),e.lineTo(r,a),e.closePath(),e.clip())}if(t.ViewPort.SetCurrent(n,a),this.attribute("viewBox").hasValue()){var s=t.ToNumberArray(this.attribute("viewBox").value),o=s[0],l=s[1];n=s[2],a=s[3],t.AspectRatio(e,this.attribute("preserveAspectRatio").value,t.ViewPort.width(),n,t.ViewPort.height(),a,o,l,this.attribute("refX").value,this.attribute("refY").value),t.ViewPort.RemoveCurrent(),t.ViewPort.SetCurrent(s[2],s[3])}},a}return inherits(n,e),n}(t.Element.RenderedElementBase),t.Element.rect=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return a.path=function(e){var n=this.attribute("x").toPixels("x"),a=this.attribute("y").toPixels("y"),r=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y"),s=this.attribute("rx").toPixels("x"),o=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(o=s),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(s=o),s=Math.min(s,r/2),o=Math.min(o,i/2),null!=e&&(e.beginPath(),e.moveTo(n+s,a),e.lineTo(n+r-s,a),e.quadraticCurveTo(n+r,a,n+r,a+o),e.lineTo(n+r,a+i-o),e.quadraticCurveTo(n+r,a+i,n+r-s,a+i),e.lineTo(n+s,a+i),e.quadraticCurveTo(n,a+i,n,a+i-o),e.lineTo(n,a+o),e.quadraticCurveTo(n,a,n+s,a),e.closePath()),new t.BoundingBox(n,a,n+r,a+i)},a}return inherits(n,e),n}(t.Element.PathElementBase),t.Element.circle=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return a.path=function(e){var n=this.attribute("cx").toPixels("x"),a=this.attribute("cy").toPixels("y"),r=this.attribute("r").toPixels();return null!=e&&(e.beginPath(),e.arc(n,a,r,0,2*Math.PI,!0),e.closePath()),new t.BoundingBox(n-r,a-r,n+r,a+r)},a}return inherits(n,e),n}(t.Element.PathElementBase),t.Element.ellipse=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return a.path=function(e){var n=(Math.sqrt(2)-1)/3*4,a=this.attribute("rx").toPixels("x"),r=this.attribute("ry").toPixels("y"),i=this.attribute("cx").toPixels("x"),s=this.attribute("cy").toPixels("y");return null!=e&&(e.beginPath(),e.moveTo(i,s-r),e.bezierCurveTo(i+n*a,s-r,i+a,s-n*r,i+a,s),e.bezierCurveTo(i+a,s+n*r,i+n*a,s+r,i,s+r),e.bezierCurveTo(i-n*a,s+r,i-a,s+n*r,i-a,s),e.bezierCurveTo(i-a,s-n*r,i-n*a,s-r,i,s-r),e.closePath()),new t.BoundingBox(i-a,s-r,i+a,s+r)},a}return inherits(n,e),n}(t.Element.PathElementBase),t.Element.line=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return a.getPoints=function(){return[new t.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new t.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},a.path=function(e){var n=this.getPoints();return null!=e&&(e.beginPath(),e.moveTo(n[0].x,n[0].y),e.lineTo(n[1].x,n[1].y)),new t.BoundingBox(n[0].x,n[0].y,n[1].x,n[1].y)},a.getMarkers=function(){var e=this.getPoints(),t=e[0].angleTo(e[1]);return[[e[0],t],[e[1],t]]},a}return inherits(n,e),n}(t.Element.PathElementBase),t.Element.polyline=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return a.points=t.CreatePath(a.attribute("points").value),a.path=function(e){var n=new t.BoundingBox(this.points[0].x,this.points[0].y);null!=e&&(e.beginPath(),e.moveTo(this.points[0].x,this.points[0].y));for(var a=1;a<this.points.length;a++)n.addPoint(this.points[a].x,this.points[a].y),null!=e&&e.lineTo(this.points[a].x,this.points[a].y);return n},a.getMarkers=function(){for(var e=[],t=0;t<this.points.length-1;t++)e.push([this.points[t],this.points[t].angleTo(this.points[t+1])]);return e.push([this.points[this.points.length-1],e[e.length-1][1]]),e},a}return inherits(n,e),n}(t.Element.PathElementBase),t.Element.polygon=function(e){function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.basePath=n.path,n.path=function(e){var t=this.basePath(e);return null!=e&&(e.lineTo(this.points[0].x,this.points[0].y),e.closePath()),t},n}return inherits(t,e),t}(t.Element.polyline),t.Element.path=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e)),r=a.attribute("d").value;return r=(r=(r=(r=(r=(r=(r=(r=r.replace(/,/gm," ")).replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2")).replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2")).replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2")).replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2")).replace(/([0-9])([+-])/gm,"$1 $2")).replace(/(\.[0-9]*)(\.)/gm,"$1 $2")).replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),r=t.compressSpaces(r),r=t.trim(r),a.PathParser=new function(e){this.tokens=e.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new t.Point(0,0),this.control=new t.Point(0,0),this.current=new t.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return!!this.isEnd()||null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var e=new t.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(e)},this.getAsControlPoint=function(){var e=this.getPoint();return this.control=e,e},this.getAsCurrentPoint=function(){var e=this.getPoint();return this.current=e,e},this.getReflectedControlPoint=function(){return"c"!==this.previousCommand.toLowerCase()&&"s"!==this.previousCommand.toLowerCase()&&"q"!==this.previousCommand.toLowerCase()&&"t"!==this.previousCommand.toLowerCase()?this.current:new t.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)},this.makeAbsolute=function(e){return this.isRelativeCommand()&&(e.x+=this.current.x,e.y+=this.current.y),e},this.addMarker=function(e,t,n){null!=n&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(n)),this.addMarkerAngle(e,null==t?null:t.angleTo(e))},this.addMarkerAngle=function(e,t){this.points.push(e),this.angles.push(t)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var e=0;e<this.angles.length;e++)if(null==this.angles[e])for(var t=e+1;t<this.angles.length;t++)if(null!=this.angles[t]){this.angles[e]=this.angles[t];break}return this.angles}}(r),a.path=function(e){var n=this.PathParser;n.reset();var a=new t.BoundingBox;for(null!=e&&e.beginPath();!n.isEnd();)switch(n.nextCommand(),n.command){case"M":case"m":var r=n.getAsCurrentPoint();for(n.addMarker(r),a.addPoint(r.x,r.y),null!=e&&e.moveTo(r.x,r.y),n.start=n.current;!n.isCommandOrEnd();){var i=n.getAsCurrentPoint();n.addMarker(i,n.start),a.addPoint(i.x,i.y),null!=e&&e.lineTo(i.x,i.y)}break;case"L":case"l":for(;!n.isCommandOrEnd();){var s=n.current,o=n.getAsCurrentPoint();n.addMarker(o,s),a.addPoint(o.x,o.y),null!=e&&e.lineTo(o.x,o.y)}break;case"H":case"h":for(;!n.isCommandOrEnd();){var l=new t.Point((n.isRelativeCommand()?n.current.x:0)+n.getScalar(),n.current.y);n.addMarker(l,n.current),n.current=l,a.addPoint(n.current.x,n.current.y),null!=e&&e.lineTo(n.current.x,n.current.y)}break;case"V":case"v":for(;!n.isCommandOrEnd();){var u=new t.Point(n.current.x,(n.isRelativeCommand()?n.current.y:0)+n.getScalar());n.addMarker(u,n.current),n.current=u,a.addPoint(n.current.x,n.current.y),null!=e&&e.lineTo(n.current.x,n.current.y)}break;case"C":case"c":for(;!n.isCommandOrEnd();){var c=n.current,h=n.getPoint(),d=n.getAsControlPoint(),f=n.getAsCurrentPoint();n.addMarker(f,d,h),a.addBezierCurve(c.x,c.y,h.x,h.y,d.x,d.y,f.x,f.y),null!=e&&e.bezierCurveTo(h.x,h.y,d.x,d.y,f.x,f.y)}break;case"S":case"s":for(;!n.isCommandOrEnd();){var p=n.current,g=n.getReflectedControlPoint(),v=n.getAsControlPoint(),m=n.getAsCurrentPoint();n.addMarker(m,v,g),a.addBezierCurve(p.x,p.y,g.x,g.y,v.x,v.y,m.x,m.y),null!=e&&e.bezierCurveTo(g.x,g.y,v.x,v.y,m.x,m.y)}break;case"Q":case"q":for(;!n.isCommandOrEnd();){var y=n.current,b=n.getAsControlPoint(),_=n.getAsCurrentPoint();n.addMarker(_,b,b),a.addQuadraticCurve(y.x,y.y,b.x,b.y,_.x,_.y),null!=e&&e.quadraticCurveTo(b.x,b.y,_.x,_.y)}break;case"T":case"t":for(;!n.isCommandOrEnd();){var x=n.current,C=n.getReflectedControlPoint();n.control=C;var S=n.getAsCurrentPoint();n.addMarker(S,C,C),a.addQuadraticCurve(x.x,x.y,C.x,C.y,S.x,S.y),null!=e&&e.quadraticCurveTo(C.x,C.y,S.x,S.y)}break;case"A":case"a":for(var w=function(){var r=n.current,i=n.getScalar(),s=n.getScalar(),o=n.getScalar()*(Math.PI/180),l=n.getScalar(),u=n.getScalar(),c=n.getAsCurrentPoint(),h=new t.Point(Math.cos(o)*(r.x-c.x)/2+Math.sin(o)*(r.y-c.y)/2,-Math.sin(o)*(r.x-c.x)/2+Math.cos(o)*(r.y-c.y)/2),d=Math.pow(h.x,2)/Math.pow(i,2)+Math.pow(h.y,2)/Math.pow(s,2);d>1&&(i*=Math.sqrt(d),s*=Math.sqrt(d));var f=(l===u?-1:1)*Math.sqrt((Math.pow(i,2)*Math.pow(s,2)-Math.pow(i,2)*Math.pow(h.y,2)-Math.pow(s,2)*Math.pow(h.x,2))/(Math.pow(i,2)*Math.pow(h.y,2)+Math.pow(s,2)*Math.pow(h.x,2)));isNaN(f)&&(f=0);var p=new t.Point(f*i*h.y/s,f*-s*h.x/i),g=new t.Point((r.x+c.x)/2+Math.cos(o)*p.x-Math.sin(o)*p.y,(r.y+c.y)/2+Math.sin(o)*p.x+Math.cos(o)*p.y),v=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))},m=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(v(e)*v(t))},y=function(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(m(e,t))},b=y([1,0],[(h.x-p.x)/i,(h.y-p.y)/s]),_=[(h.x-p.x)/i,(h.y-p.y)/s],x=[(-h.x-p.x)/i,(-h.y-p.y)/s],C=y(_,x);m(_,x)<=-1&&(C=Math.PI),m(_,x)>=1&&(C=0);var S=1-u?1:-1,w=b+S*(C/2),k=new t.Point(g.x+i*Math.cos(w),g.y+s*Math.sin(w));if(n.addMarkerAngle(k,w-S*Math.PI/2),n.addMarkerAngle(c,w-S*Math.PI),a.addPoint(c.x,c.y),null!=e){var $=i>s?i:s,P=i>s?1:i/s,E=i>s?s/i:1;e.translate(g.x,g.y),e.rotate(o),e.scale(P,E),e.arc(0,0,$,b,b+C,1-u),e.scale(1/P,1/E),e.rotate(-o),e.translate(-g.x,-g.y)}};!n.isCommandOrEnd();)w();break;case"Z":case"z":null!=e&&e.closePath(),n.current=n.start}return a},a.getMarkers=function(){for(var e=this.PathParser.getMarkerPoints(),t=this.PathParser.getMarkerAngles(),n=[],a=0;a<e.length;a++)n.push([e[a],t[a]]);return n},a}return inherits(n,e),n}(t.Element.PathElementBase),t.Element.pattern=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return a.createPattern=function(e,n){var a=this.attribute("width").toPixels("x",!0),r=this.attribute("height").toPixels("y",!0),i=new t.Element.svg;i.attributes.viewBox=new t.Property("viewBox",this.attribute("viewBox").value),i.attributes.width=new t.Property("width",a+"px"),i.attributes.height=new t.Property("height",r+"px"),i.attributes.transform=new t.Property("transform",this.attribute("patternTransform").value),i.children=this.children;var s=document.createElement("canvas");s.width=a,s.height=r;var o=s.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&o.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var l=-1;l<=1;l++)for(var u=-1;u<=1;u++)o.save(),o.translate(l*s.width,u*s.height),i.render(o),o.restore();return e.createPattern(s,"repeat")},a}return inherits(n,e),n}(t.Element.ElementBase),t.Element.marker=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return a.baseRender=a.render,a.render=function(e,n,a){e.translate(n.x,n.y),"auto"===this.attribute("orient").valueOrDefault("auto")&&e.rotate(a),"strokeWidth"===this.attribute("markerUnits").valueOrDefault("strokeWidth")&&e.scale(e.lineWidth,e.lineWidth),e.save();var r=new t.Element.svg;r.attributes.viewBox=new t.Property("viewBox",this.attribute("viewBox").value),r.attributes.refX=new t.Property("refX",this.attribute("refX").value),r.attributes.refY=new t.Property("refY",this.attribute("refY").value),r.attributes.width=new t.Property("width",this.attribute("markerWidth").value),r.attributes.height=new t.Property("height",this.attribute("markerHeight").value),r.attributes.fill=new t.Property("fill",this.attribute("fill").valueOrDefault("black")),r.attributes.stroke=new t.Property("stroke",this.attribute("stroke").valueOrDefault("none")),r.children=this.children,r.render(e),e.restore(),"strokeWidth"===this.attribute("markerUnits").valueOrDefault("strokeWidth")&&e.scale(1/e.lineWidth,1/e.lineWidth),"auto"===this.attribute("orient").valueOrDefault("auto")&&e.rotate(-a),e.translate(-n.x,-n.y)},a}return inherits(n,e),n}(t.Element.ElementBase),t.Element.defs=function(e){function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.render=function(e){},n}return inherits(t,e),t}(t.Element.ElementBase),t.Element.GradientBase=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));a.gradientUnits=a.attribute("gradientUnits").valueOrDefault("objectBoundingBox"),a.stops=[];for(var r=0;r<a.children.length;r++){var i=a.children[r];"stop"===i.type&&a.stops.push(i)}return a.getGradient=function(){},a.createGradient=function(e,n,a){var r=this.getHrefAttribute().hasValue()?this.getHrefAttribute().getDefinition():this,i=function(e){return a.hasValue()?new t.Property("color",e).addOpacity(a).value:e},s=this.getGradient(e,n);if(null==s)return i(r.stops[r.stops.length-1].color);for(var o=0;o<r.stops.length;o++)s.addColorStop(r.stops[o].offset,i(r.stops[o].color));if(this.attribute("gradientTransform").hasValue()){var l=t.ViewPort.viewPorts[0],u=new t.Element.rect;u.attributes.x=new t.Property("x",-t.MAX_VIRTUAL_PIXELS/3),u.attributes.y=new t.Property("y",-t.MAX_VIRTUAL_PIXELS/3),u.attributes.width=new t.Property("width",t.MAX_VIRTUAL_PIXELS),u.attributes.height=new t.Property("height",t.MAX_VIRTUAL_PIXELS);var c=new t.Element.g;c.attributes.transform=new t.Property("transform",this.attribute("gradientTransform").value),c.children=[u];var h=new t.Element.svg;h.attributes.x=new t.Property("x",0),h.attributes.y=new t.Property("y",0),h.attributes.width=new t.Property("width",l.width),h.attributes.height=new t.Property("height",l.height),h.children=[c];var d=document.createElement("canvas");d.width=l.width,d.height=l.height;var f=d.getContext("2d");return f.fillStyle=s,h.render(f),f.createPattern(d,"no-repeat")}return s},a}return inherits(n,e),n}(t.Element.ElementBase),t.Element.linearGradient=function(e){function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getGradient=function(e,t){var n="objectBoundingBox"===this.gradientUnits?t.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var a="objectBoundingBox"===this.gradientUnits?n.x()+n.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),r="objectBoundingBox"===this.gradientUnits?n.y()+n.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),i="objectBoundingBox"===this.gradientUnits?n.x()+n.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),s="objectBoundingBox"===this.gradientUnits?n.y()+n.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return a===i&&r===s?null:e.createLinearGradient(a,r,i,s)},n}return inherits(t,e),t}(t.Element.GradientBase),t.Element.radialGradient=function(e){function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getGradient=function(e,t){var n=t.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var a="objectBoundingBox"===this.gradientUnits?n.x()+n.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),r="objectBoundingBox"===this.gradientUnits?n.y()+n.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),i=a,s=r;this.attribute("fx").hasValue()&&(i="objectBoundingBox"===this.gradientUnits?n.x()+n.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(s="objectBoundingBox"===this.gradientUnits?n.y()+n.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var o="objectBoundingBox"===this.gradientUnits?(n.width()+n.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return e.createRadialGradient(i,s,0,a,r,o)},n}return inherits(t,e),t}(t.Element.GradientBase),t.Element.stop=function(e){function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.offset=n.attribute("offset").numValue(),n.offset<0&&(n.offset=0),n.offset>1&&(n.offset=1);var a=n.style("stop-color");return n.style("stop-opacity").hasValue()&&(a=a.addOpacity(n.style("stop-opacity"))),n.color=a.value,n}return inherits(t,e),t}(t.Element.ElementBase),t.Element.AnimateBase=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.Animations.push(a),a.duration=0,a.begin=a.attribute("begin").toMilliseconds(),a.maxDuration=a.begin+a.attribute("dur").toMilliseconds(),a.getProperty=function(){var e=this.attribute("attributeType").value,t=this.attribute("attributeName").value;return"CSS"===e?this.parent.style(t,!0):this.parent.attribute(t,!0)},a.initialValue=null,a.initialUnits="",a.removed=!1,a.calcValue=function(){return""},a.update=function(e){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"===this.attribute("repeatCount").value||"indefinite"===this.attribute("repeatDur").value)this.duration=0;else if("freeze"!==this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"===this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+e;var t=!1;if(this.begin<this.duration){var n=this.calcValue();if(this.attribute("type").hasValue())n=this.attribute("type").value+"("+n+")";this.getProperty().value=n,t=!0}return t},a.from=a.attribute("from"),a.to=a.attribute("to"),a.values=a.attribute("values"),a.values.hasValue()&&(a.values.value=a.values.value.split(";")),a.progress=function(){var e={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var n=e.progress*(this.values.value.length-1),a=Math.floor(n),r=Math.ceil(n);e.from=new t.Property("from",parseFloat(this.values.value[a])),e.to=new t.Property("to",parseFloat(this.values.value[r])),e.progress=(n-a)/(r-a)}else e.from=this.from,e.to=this.to;return e},a}return inherits(n,e),n}(t.Element.ElementBase),t.Element.animate=function(e){function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.calcValue=function(){var e=this.progress();return e.from.numValue()+(e.to.numValue()-e.from.numValue())*e.progress+this.initialUnits},n}return inherits(t,e),t}(t.Element.AnimateBase),t.Element.animateColor=function(e){function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.calcValue=function(){var e=this.progress(),t=new RGBColor(e.from.value),n=new RGBColor(e.to.value);if(t.ok&&n.ok){var a=t.r+(n.r-t.r)*e.progress,r=t.g+(n.g-t.g)*e.progress,i=t.b+(n.b-t.b)*e.progress;return"rgb("+parseInt(a,10)+","+parseInt(r,10)+","+parseInt(i,10)+")"}return this.attribute("from").value},n}return inherits(t,e),t}(t.Element.AnimateBase),t.Element.animateTransform=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return a.calcValue=function(){for(var e=this.progress(),n=t.ToNumberArray(e.from.value),a=t.ToNumberArray(e.to.value),r="",i=0;i<n.length;i++)r+=n[i]+(a[i]-n[i])*e.progress+" ";return r},a}return inherits(n,e),n}(t.Element.animate),t.Element.font=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));a.horizAdvX=a.attribute("horiz-adv-x").numValue(),a.isRTL=!1,a.isArabic=!1,a.fontFace=null,a.missingGlyph=null,a.glyphs=[];for(var r=0;r<a.children.length;r++){var i=a.children[r];"font-face"===i.type?(a.fontFace=i,i.style("font-family").hasValue()&&(t.Definitions[i.style("font-family").value]=a)):"missing-glyph"===i.type?a.missingGlyph=i:"glyph"===i.type&&(""!==i.arabicForm?(a.isRTL=!0,a.isArabic=!0,void 0===a.glyphs[i.unicode]&&(a.glyphs[i.unicode]=[]),a.glyphs[i.unicode][i.arabicForm]=i):a.glyphs[i.unicode]=i)}return a}return inherits(n,e),n}(t.Element.ElementBase),t.Element.fontface=function(e){function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.ascent=n.attribute("ascent").value,n.descent=n.attribute("descent").value,n.unitsPerEm=n.attribute("units-per-em").numValue(),n}return inherits(t,e),t}(t.Element.ElementBase),t.Element.missingglyph=function(e){function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.horizAdvX=0,n}return inherits(t,e),t}(t.Element.path),t.Element.glyph=function(e){function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.horizAdvX=n.attribute("horiz-adv-x").numValue(),n.unicode=n.attribute("unicode").value,n.arabicForm=n.attribute("arabic-form").value,n}return inherits(t,e),t}(t.Element.path),t.Element.text=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return a.captureTextNodes=!0,a.baseSetContext=a.setContext,a.setContext=function(e){this.baseSetContext(e);var t=this.style("dominant-baseline").toTextBaseline();null==t&&(t=this.style("alignment-baseline").toTextBaseline()),null!=t&&(e.textBaseline=t)},a.getBoundingBox=function(){var e=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),a=this.parent.style("font-size").numValueOrDefault(t.Font.Parse(t.ctx.font).fontSize);return new t.BoundingBox(e,n-a,e+Math.floor(2*a/3)*this.children[0].getText().length,n)},a.renderChildren=function(e){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.x+=this.getAnchorDelta(e,this,0);for(var t=0;t<this.children.length;t++)this.renderChild(e,this,t)},a.getAnchorDelta=function(e,t,n){var a=this.style("text-anchor").valueOrDefault("start");if("start"!==a){for(var r=0,i=n;i<t.children.length;i++){var s=t.children[i];if(i>n&&s.attribute("x").hasValue())break;r+=s.measureTextRecursive(e)}return-1*("end"===a?r:r/2)}return 0},a.renderChild=function(e,t,n){var a=t.children[n];a.attribute("x").hasValue()?(a.x=a.attribute("x").toPixels("x")+this.getAnchorDelta(e,t,n),a.attribute("dx").hasValue()&&(a.x+=a.attribute("dx").toPixels("x"))):(this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),a.attribute("dx").hasValue()&&(this.x+=a.attribute("dx").toPixels("x")),a.x=this.x),this.x=a.x+a.measureText(e),a.attribute("y").hasValue()?(a.y=a.attribute("y").toPixels("y"),a.attribute("dy").hasValue()&&(a.y+=a.attribute("dy").toPixels("y"))):(this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),a.attribute("dy").hasValue()&&(this.y+=a.attribute("dy").toPixels("y")),a.y=this.y),this.y=a.y,a.render(e);for(var r=0;r<a.children.length;r++)this.renderChild(e,a,r)},a}return inherits(n,e),n}(t.Element.RenderedElementBase),t.Element.TextElementBase=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return a.getGlyph=function(e,t,n){var a=t[n],r=null;if(e.isArabic){var i="isolated";(0===n||" "===t[n-1])&&n<t.length-2&&" "!==t[n+1]&&(i="terminal"),n>0&&" "!==t[n-1]&&n<t.length-2&&" "!==t[n+1]&&(i="medial"),n>0&&" "!==t[n-1]&&(n===t.length-1||" "===t[n+1])&&(i="initial"),void 0!==e.glyphs[a]&&null==(r=e.glyphs[a][i])&&"glyph"===e.glyphs[a].type&&(r=e.glyphs[a])}else r=e.glyphs[a];return null==r&&(r=e.missingGlyph),r},a.renderChildren=function(e){var n=this.parent.style("font-family").getDefinition();if(null==n)""!==e.fillStyle&&e.fillText(t.compressSpaces(this.getText()),this.x,this.y),""!==e.strokeStyle&&e.strokeText(t.compressSpaces(this.getText()),this.x,this.y);else{var a=this.parent.style("font-size").numValueOrDefault(t.Font.Parse(t.ctx.font).fontSize),r=this.parent.style("font-style").valueOrDefault(t.Font.Parse(t.ctx.font).fontStyle),i=this.getText();n.isRTL&&(i=i.split("").reverse().join(""));for(var s=t.ToNumberArray(this.parent.attribute("dx").value),o=0;o<i.length;o++){var l=this.getGlyph(n,i,o),u=a/n.fontFace.unitsPerEm;e.translate(this.x,this.y),e.scale(u,-u);var c=e.lineWidth;e.lineWidth=e.lineWidth*n.fontFace.unitsPerEm/a,"italic"===r&&e.transform(1,0,.4,1,0,0),l.render(e),"italic"===r&&e.transform(1,0,-.4,1,0,0),e.lineWidth=c,e.scale(1/u,-1/u),e.translate(-this.x,-this.y),this.x+=a*(l.horizAdvX||n.horizAdvX)/n.fontFace.unitsPerEm,void 0===s[o]||isNaN(s[o])||(this.x+=s[o])}}},a.getText=function(){},a.measureTextRecursive=function(e){for(var t=this.measureText(e),n=0;n<this.children.length;n++)t+=this.children[n].measureTextRecursive(e);return t},a.measureText=function(e){var n=this.parent.style("font-family").getDefinition();if(null!=n){var a=this.parent.style("font-size").numValueOrDefault(t.Font.Parse(t.ctx.font).fontSize),r=0,i=this.getText();n.isRTL&&(i=i.split("").reverse().join(""));for(var s=t.ToNumberArray(this.parent.attribute("dx").value),o=0;o<i.length;o++){r+=(this.getGlyph(n,i,o).horizAdvX||n.horizAdvX)*a/n.fontFace.unitsPerEm,void 0===s[o]||isNaN(s[o])||(r+=s[o])}return r}var l=t.compressSpaces(this.getText());if(!e.measureText)return 10*l.length;e.save(),this.setContext(e);var u=e.measureText(l).width;return e.restore(),u},a}return inherits(n,e),n}(t.Element.RenderedElementBase),t.Element.tspan=function(e){function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.captureTextNodes=!0,n.text=e.nodeValue||e.text||"",n.getText=function(){return this.text},n}return inherits(t,e),t}(t.Element.TextElementBase),t.Element.tref=function(e){function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getText=function(){var e=this.getHrefAttribute().getDefinition();if(null!=e)return e.children[0].getText()},n}return inherits(t,e),t}(t.Element.TextElementBase),t.Element.a=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));a.hasText=!0;for(var r,i=0;r=e.childNodes[i];i++)3!==r.nodeType&&(a.hasText=!1);return a.text=a.hasText?e.childNodes[0].nodeValue:"",a.getText=function(){return this.text},a.baseRenderChildren=a.renderChildren,a.renderChildren=function(e){if(this.hasText){this.baseRenderChildren(e);var n=new t.Property("fontSize",t.Font.Parse(t.ctx.font).fontSize);t.Mouse.checkBoundingBox(this,new t.BoundingBox(this.x,this.y-n.toPixels("y"),this.x+this.measureText(e),this.y))}else{var a=new t.Element.g;a.children=this.children,a.parent=this,a.render(e)}},a.onclick=function(){window.open(this.getHrefAttribute().value)},a.onmousemove=function(){t.ctx.canvas.style.cursor="pointer"},a}return inherits(n,e),n}(t.Element.TextElementBase),t.Element.image=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e)),r=a.getHrefAttribute().value;if(""===r)return possibleConstructorReturn(a);var i=r.match(/\.svg$/);if(t.Images.push(a),a.loaded=!1,i)a.img=t.ajax(r),a.loaded=!0;else{a.img=document.createElement("img"),!0===t.opts.useCORS&&(a.img.crossOrigin="Anonymous");var s=a;a.img.onload=function(){s.loaded=!0},a.img.onerror=function(){t.log('ERROR: image "'+r+'" not found'),s.loaded=!0},a.img.src=r}return a.renderChildren=function(e){var n=this.attribute("x").toPixels("x"),a=this.attribute("y").toPixels("y"),r=this.attribute("width").toPixels("x"),s=this.attribute("height").toPixels("y");0!==r&&0!==s&&(e.save(),i?e.drawSvg(this.img,n,a,r,s):(e.translate(n,a),t.AspectRatio(e,this.attribute("preserveAspectRatio").value,r,this.img.width,s,this.img.height,0,0),e.drawImage(this.img,0,0)),e.restore())},a.getBoundingBox=function(){var e=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),a=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");return new t.BoundingBox(e,n,e+a,n+r)},a}return inherits(n,e),n}(t.Element.RenderedElementBase),t.Element.g=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return a.getBoundingBox=function(){for(var e=new t.BoundingBox,n=0;n<this.children.length;n++)e.addBoundingBox(this.children[n].getBoundingBox());return e},a}return inherits(n,e),n}(t.Element.RenderedElementBase),t.Element.symbol=function(e){function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.render=function(e){},n}return inherits(t,e),t}(t.Element.RenderedElementBase),t.Element.style=function(e){function n(e){classCallCheck(this,n);for(var a,r=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e)),i="",s=0;a=e.childNodes[s];s++)i+=a.nodeValue;i=i.replace(/(\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"");for(var o=(i=t.compressSpaces(i)).split("}"),l=0;l<o.length;l++)if(""!==t.trim(o[l]))for(var u=o[l].split("{"),c=u[0].split(","),h=u[1].split(";"),d=0;d<c.length;d++){var f=t.trim(c[d]);if(""!==f){for(var p={},g=0;g<h.length;g++){var v=h[g].indexOf(":"),m=h[g].substr(0,v),y=h[g].substr(v+1,h[g].length-v);null!=m&&null!=y&&(p[t.trim(m)]=new t.Property(t.trim(m),t.trim(y)))}if(t.Styles[f]=p,"@font-face"===f)for(var b=p["font-family"].value.replace(/"/g,""),_=p.src.value.split(","),x=0;x<_.length;x++)if(_[x].includes('format("svg")'))for(var C=_[x].indexOf("url"),S=_[x].indexOf(")",C),w=_[x].substr(C+5,S-C-6),k=t.parseXml(t.ajax(w)).getElementsByTagName("font"),$=0;$<k.length;$++){var P=t.CreateElement(k[$]);t.Definitions[b]=P}}}return r}return inherits(n,e),n}(t.Element.ElementBase),t.Element.use=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));a.baseSetContext=a.setContext,a.setContext=function(e){this.baseSetContext(e),this.attribute("x").hasValue()&&e.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&e.translate(0,this.attribute("y").toPixels("y"))};var r=a.getHrefAttribute().getDefinition();return a.path=function(e){null!=r&&r.path(e)},a.getBoundingBox=function(){if(null!=r)return r.getBoundingBox()},a.renderChildren=function(e){if(null!=r){var n=r;"symbol"===r.type&&((n=new t.Element.svg).type="svg",n.attributes.viewBox=new t.Property("viewBox",r.attribute("viewBox").value),n.attributes.preserveAspectRatio=new t.Property("preserveAspectRatio",r.attribute("preserveAspectRatio").value),n.attributes.overflow=new t.Property("overflow",r.attribute("overflow").value),n.children=r.children),"svg"===n.type&&(this.attribute("width").hasValue()&&(n.attributes.width=new t.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(n.attributes.height=new t.Property("height",this.attribute("height").value)));var a=n.parent;n.parent=null,n.render(e),n.parent=a}},a}return inherits(n,e),n}(t.Element.RenderedElementBase),t.Element.mask=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return a.apply=function(e,n){var a=this.attribute("x").toPixels("x"),r=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),s=this.attribute("height").toPixels("y");if(0===i&&0===s){for(var o=new t.BoundingBox,l=0;l<this.children.length;l++)o.addBoundingBox(this.children[l].getBoundingBox());a=Math.floor(o.x1),r=Math.floor(o.y1),i=Math.floor(o.width()),s=Math.floor(o.height())}var u=n.attribute("mask").value;n.attribute("mask").value="";var c=document.createElement("canvas");c.width=a+i,c.height=r+s;var h=c.getContext("2d");this.renderChildren(h);var d=document.createElement("canvas");d.width=a+i,d.height=r+s;var f=d.getContext("2d");n.render(f),f.globalCompositeOperation="destination-in",f.fillStyle=h.createPattern(c,"no-repeat"),f.fillRect(0,0,a+i,r+s),e.fillStyle=f.createPattern(d,"no-repeat"),e.fillRect(0,0,a+i,r+s),n.attribute("mask").value=u},a.render=function(e){},a}return inherits(n,e),n}(t.Element.ElementBase),t.Element.clipPath=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return a.apply=function(e){for(var n=0;n<this.children.length;n++){var a=this.children[n];if(void 0!==a.path){var r=null;a.attribute("transform").hasValue()&&(r=new t.Transform(a.attribute("transform").value)).apply(e),a.path(e),e.clip(),r&&r.unapply(e)}}},a.render=function(e){},a}return inherits(n,e),n}(t.Element.ElementBase),t.Element.filter=function(e){function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.apply=function(e,t){var n=t.getBoundingBox(),a=Math.floor(n.x1),r=Math.floor(n.y1),i=Math.floor(n.width()),s=Math.floor(n.height()),o=t.style("filter").value;t.style("filter").value="";for(var l=0,u=0,c=0;c<this.children.length;c++){var h=this.children[c].extraFilterDistance||0;l=Math.max(l,h),u=Math.max(u,h)}var d=document.createElement("canvas");d.width=i+2*l,d.height=s+2*u;var f=d.getContext("2d");f.translate(-a+l,-r+u),t.render(f);for(var p=0;p<this.children.length;p++)this.children[p].apply(f,0,0,i+2*l,s+2*u);e.drawImage(d,0,0,i+2*l,s+2*u,a-l,r-u,i+2*l,s+2*u),t.style("filter",!0).value=o},n.render=function(e){},n}return inherits(t,e),t}(t.Element.ElementBase),t.Element.feMorphology=function(e){function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.apply=function(e,t,n,a,r){},n}return inherits(t,e),t}(t.Element.ElementBase),t.Element.feComposite=function(e){function t(e){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.apply=function(e,t,n,a,r){},n}return inherits(t,e),t}(t.Element.ElementBase),t.Element.feColorMatrix=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e)),r=t.ToNumberArray(a.attribute("values").value);switch(a.attribute("type").valueOrDefault("matrix")){case"saturate":var i=r[0];r=[.213+.787*i,.715-.715*i,.072-.072*i,0,0,.213-.213*i,.715+.285*i,.072-.072*i,0,0,.213-.213*i,.715-.715*i,.072+.928*i,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var s=r[0]*Math.PI/180,o=function(e,t,n){return e+Math.cos(s)*t+Math.sin(s)*n};r=[o(.213,.787,-.213),o(.715,-.715,-.715),o(.072,-.072,.928),0,0,o(.213,-.213,.143),o(.715,.285,.14),o(.072,-.072,-.283),0,0,o(.213,-.213,-.787),o(.715,-.715,.715),o(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}function l(e,t,n,a,r,i){return e[n*a*4+4*t+i]}function u(e,t,n,a,r,i,s){e[n*a*4+4*t+i]=s}function c(e,t){var n=r[e];return n*(n<0?t-255:t)}return a.apply=function(e,t,n,a,r){for(var i=e.getImageData(0,0,a,r),s=0;s<r;s++)for(var o=0;o<a;o++){var h=l(i.data,o,s,a,0,0),d=l(i.data,o,s,a,0,1),f=l(i.data,o,s,a,0,2),p=l(i.data,o,s,a,0,3);u(i.data,o,s,a,0,0,c(0,h)+c(1,d)+c(2,f)+c(3,p)+c(4,1)),u(i.data,o,s,a,0,1,c(5,h)+c(6,d)+c(7,f)+c(8,p)+c(9,1)),u(i.data,o,s,a,0,2,c(10,h)+c(11,d)+c(12,f)+c(13,p)+c(14,1)),u(i.data,o,s,a,0,3,c(15,h)+c(16,d)+c(17,f)+c(18,p)+c(19,1))}e.clearRect(0,0,a,r),e.putImageData(i,0,0)},a}return inherits(n,e),n}(t.Element.ElementBase),t.Element.feGaussianBlur=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return a.blurRadius=Math.floor(a.attribute("stdDeviation").numValue()),a.extraFilterDistance=a.blurRadius,a.apply=function(e,n,a,r,i){"undefined"!=typeof stackBlurCanvasRGBA?(e.canvas.id=t.UniqueId(),e.canvas.style.display="none",document.body.appendChild(e.canvas),stackBlurCanvasRGBA(e.canvas.id,n,a,r,i,this.blurRadius),document.body.removeChild(e.canvas)):t.log("ERROR: StackBlur.js must be included for blur to work")},a}return inherits(n,e),n}(t.Element.ElementBase),t.Element.title=function(e){function t(e){return classCallCheck(this,t),possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return inherits(t,e),t}(t.Element.ElementBase),t.Element.desc=function(e){function t(e){return classCallCheck(this,t),possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return inherits(t,e),t}(t.Element.ElementBase),t.Element.MISSING=function(e){function n(e){classCallCheck(this,n);var a=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.log("ERROR: Element '"+e.nodeName+"' not yet implemented."),a}return inherits(n,e),n}(t.Element.ElementBase),t.CreateElement=function(e){var n=e.nodeName.replace(/^[^:]+:/,"").replace(/-/g,""),a=void 0;return(a=void 0!==t.Element[n]?new t.Element[n](e):new t.Element.MISSING(e)).type=e.nodeName,a},t.load=function(e,n){t.loadXml(e,t.ajax(n))},t.loadXml=function(e,n){t.loadXmlDoc(e,t.parseXml(n))},t.loadXmlDoc=function(e,n){t.init(e);var a=function(t){for(var n=e.canvas;n;)t.x-=n.offsetLeft,t.y-=n.offsetTop,n=n.offsetParent;return window.scrollX&&(t.x+=window.scrollX),window.scrollY&&(t.y+=window.scrollY),t};!0!==t.opts.ignoreMouse&&(e.canvas.onclick=function(e){var n=a(new t.Point(null!=e?e.clientX:event.clientX,null!=e?e.clientY:event.clientY));t.Mouse.onclick(n.x,n.y)},e.canvas.onmousemove=function(e){var n=a(new t.Point(null!=e?e.clientX:event.clientX,null!=e?e.clientY:event.clientY));t.Mouse.onmousemove(n.x,n.y)});var r=t.CreateElement(n.documentElement);r.root=!0;var i=!0,s=function(){t.ViewPort.Clear(),e.canvas.parentNode&&t.ViewPort.SetCurrent(e.canvas.parentNode.clientWidth,e.canvas.parentNode.clientHeight),!0!==t.opts.ignoreDimensions&&(r.style("width").hasValue()&&(e.canvas.width=r.style("width").toPixels("x"),e.canvas.style.width=e.canvas.width+"px"),r.style("height").hasValue()&&(e.canvas.height=r.style("height").toPixels("y"),e.canvas.style.height=e.canvas.height+"px"));var a=e.canvas.clientWidth||e.canvas.width,s=e.canvas.clientHeight||e.canvas.height;if(!0===t.opts.ignoreDimensions&&r.style("width").hasValue()&&r.style("height").hasValue()&&(a=r.style("width").toPixels("x"),s=r.style("height").toPixels("y")),t.ViewPort.SetCurrent(a,s),null!=t.opts.offsetX&&(r.attribute("x",!0).value=t.opts.offsetX),null!=t.opts.offsetY&&(r.attribute("y",!0).value=t.opts.offsetY),null!=t.opts.scaleWidth||null!=t.opts.scaleHeight){var o=t.ToNumberArray(r.attribute("viewBox").value),l=null,u=null;null!=t.opts.scaleWidth&&(r.attribute("width").hasValue()?l=r.attribute("width").toPixels("x")/t.opts.scaleWidth:isNaN(o[2])||(l=o[2]/t.opts.scaleWidth)),null!=t.opts.scaleHeight&&(r.attribute("height").hasValue()?u=r.attribute("height").toPixels("y")/t.opts.scaleHeight:isNaN(o[3])||(u=o[3]/t.opts.scaleHeight)),null==l&&(l=u),null==u&&(u=l),r.attribute("width",!0).value=t.opts.scaleWidth,r.attribute("height",!0).value=t.opts.scaleHeight,r.attribute("viewBox",!0).value="0 0 "+a*l+" "+s*u,r.attribute("preserveAspectRatio",!0).value="none"}!0!==t.opts.ignoreClear&&e.clearRect(0,0,a,s),r.render(e),i&&(i=!1,"function"==typeof t.opts.renderCallback&&t.opts.renderCallback(n))},o=!0;t.ImagesLoaded()&&(o=!1,s()),t.intervalID=setInterval(function(){var e=!1;if(o&&t.ImagesLoaded()&&(o=!1,e=!0),!0!==t.opts.ignoreMouse&&(e|=t.Mouse.hasEvents()),!0!==t.opts.ignoreAnimation)for(var n=0;n<t.Animations.length;n++)e|=t.Animations[n].update(1e3/t.FRAMERATE);"function"==typeof t.opts.forceRedraw&&!0===t.opts.forceRedraw()&&(e=!0),e&&(s(),t.Mouse.runEvents())},1e3/t.FRAMERATE)},t.stop=function(){t.intervalID&&clearInterval(t.intervalID)},t.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!==this.events.length},this.onclick=function(e,t){this.events.push({type:"onclick",x:e,y:t,run:function(e){e.onclick&&e.onclick()}})},this.onmousemove=function(e,t){this.events.push({type:"onmousemove",x:e,y:t,run:function(e){e.onmousemove&&e.onmousemove()}})},this.eventElements=[],this.checkPath=function(e,t){for(var n=0;n<this.events.length;n++){var a=this.events[n];t.isPointInPath&&t.isPointInPath(a.x,a.y)&&(this.eventElements[n]=e)}},this.checkBoundingBox=function(e,t){for(var n=0;n<this.events.length;n++){var a=this.events[n];t.isPointInBox(a.x,a.y)&&(this.eventElements[n]=e)}},this.runEvents=function(){t.ctx.canvas.style.cursor="";for(var e=0;e<this.events.length;e++)for(var n=this.events[e],a=this.eventElements[e];a;)n.run(a),a=a.parent;this.events=[],this.eventElements=[]}},t}"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(e,t,n,a,r){canvg(this.canvas,e,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:t,offsetY:n,scaleWidth:a,scaleHeight:r})});var $$4=jQuery,Layer=function(){function e(t,n,a){if(classCallCheck(this,e),this.name_=t,this.group_=a?null:n,a){var r=a.ownerDocument;this.group_=r.createElementNS(NS.SVG,"g");var i=r.createElementNS(NS.SVG,"title");i.textContent=t,this.group_.appendChild(i),n?$$4(n).after(this.group_):a.appendChild(this.group_)}addLayerClass(this.group_),walkTree(this.group_,function(e){e.setAttribute("style","pointer-events:inherit")}),this.group_.setAttribute("style",a?"pointer-events:all":"pointer-events:none")}return createClass(e,[{key:"getName",value:function(){return this.name_}},{key:"getGroup",value:function(){return this.group_}},{key:"activate",value:function(){this.group_.setAttribute("style","pointer-events:all")}},{key:"deactivate",value:function(){this.group_.setAttribute("style","pointer-events:none")}},{key:"setVisible",value:function(e){var t=void 0===e||e?"inline":"none";this.group_.getAttribute("display")!==t&&this.group_.setAttribute("display",t)}},{key:"isVisible",value:function(){return"none"!==this.group_.getAttribute("display")}},{key:"getOpacity",value:function(){var e=this.group_.getAttribute("opacity");return null===e||void 0===e?1:parseFloat(e)}},{key:"setOpacity",value:function(e){"number"==typeof e&&e>=0&&e<=1&&this.group_.setAttribute("opacity",e)}},{key:"appendChildren",value:function(e){for(var t=0;t<e.length;++t)this.group_.appendChild(e[t])}},{key:"getTitleElement",value:function(){for(var e=this.group_.childNodes.length,t=0;t<e;++t){var n=this.group_.childNodes.item(t);if(n&&"title"===n.tagName)return n}return null}},{key:"setName",value:function(e,t){var n=this.name_;e=toXml(e);var a=this.getTitleElement();return a?($$4(a).empty(),a.textContent=e,this.name_=e,t&&t.changeElement(a,{"#text":n}),this.name_):null}},{key:"removeGroup",value:function(){var e=this.group_.parentNode.removeChild(this.group_);return this.group_=void 0,e}}]),e}();function addLayerClass(e){var t=e.getAttribute("class");null!==t&&void 0!==t&&t.length?Layer.CLASS_REGEX.test(t)||e.setAttribute("class",t+" "+Layer.CLASS_NAME):e.setAttribute("class",Layer.CLASS_NAME)}Layer.CLASS_NAME="layer",Layer.CLASS_REGEX=new RegExp("(\\s|^)"+Layer.CLASS_NAME+"(\\s|$)");var HistoryRecordingService=function(){function e(t){classCallCheck(this,e),this.undoManager_=t,this.currentBatchCommand_=null,this.batchCommandStack_=[]}return createClass(e,[{key:"startBatchCommand",value:function(e){return this.undoManager_?(this.currentBatchCommand_=new BatchCommand(e),this.batchCommandStack_.push(this.currentBatchCommand_),this):this}},{key:"endBatchCommand",value:function(){if(!this.undoManager_)return this;if(this.currentBatchCommand_){var e=this.currentBatchCommand_;this.batchCommandStack_.pop();var t=this.batchCommandStack_.length;this.currentBatchCommand_=t?this.batchCommandStack_[t-1]:null,this.addCommand_(e)}return this}},{key:"moveElement",value:function(e,t,n,a){return this.undoManager_?(this.addCommand_(new MoveElementCommand(e,t,n,a)),this):this}},{key:"insertElement",value:function(e,t){return this.undoManager_?(this.addCommand_(new InsertElementCommand(e,t)),this):this}},{key:"removeElement",value:function(e,t,n,a){return this.undoManager_?(this.addCommand_(new RemoveElementCommand(e,t,n,a)),this):this}},{key:"changeElement",value:function(e,t,n){return this.undoManager_?(this.addCommand_(new ChangeElementCommand(e,t,n)),this):this}},{key:"addCommand_",value:function(e){if(!this.undoManager_)return this;this.currentBatchCommand_?this.currentBatchCommand_.addSubCommand(e):this.undoManager_.addCommandToHistory(e)}}]),e}();HistoryRecordingService.NO_HISTORY=new HistoryRecordingService;var $$5=jQuery,visElems$1="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use".split(","),RandomizeModes={LET_DOCUMENT_DECIDE:0,ALWAYS_RANDOMIZE:1,NEVER_RANDOMIZE:2},randIds=RandomizeModes.LET_DOCUMENT_DECIDE,disabledElems=[];function historyRecordingService(e){return e||new HistoryRecordingService(canvas_.undoMgr)}function findLayerNameInGroup(e){return $$5("title",e).text()||(isOpera()&&e.querySelectorAll?$$5(e.querySelectorAll("title")).text():"")}function getNewLayerName(e){for(var t=1;e.includes("Layer "+t);)t++;return"Layer "+t}var Drawing=function(){function e(t,n){if(classCallCheck(this,e),!t||!t.tagName||!t.namespaceURI||"svg"!==t.tagName||t.namespaceURI!==NS.SVG)throw new Error("Error: svgedit.draw.Drawing instance initialized without a <svg> element");this.svgElem_=t,this.obj_num=0,this.idPrefix=n||"svg_",this.releasedNums=[],this.all_layers=[],this.layer_map={},this.current_layer=null,this.nonce_="";var a=this.svgElem_.getAttributeNS(NS.SE,"nonce");a&&randIds!==RandomizeModes.NEVER_RANDOMIZE?this.nonce_=a:randIds===RandomizeModes.ALWAYS_RANDOMIZE&&this.setNonce(Math.floor(100001*Math.random()))}return createClass(e,[{key:"getElem_",value:function(e){return this.svgElem_.querySelector?this.svgElem_.querySelector("#"+e):$$5(this.svgElem_).find("[id="+e+"]")[0]}},{key:"getSvgElem",value:function(){return this.svgElem_}},{key:"getNonce",value:function(){return this.nonce_}},{key:"setNonce",value:function(e){this.svgElem_.setAttributeNS(NS.XMLNS,"xmlns:se",NS.SE),this.svgElem_.setAttributeNS(NS.SE,"se:nonce",e),this.nonce_=e}},{key:"clearNonce",value:function(){this.nonce_=""}},{key:"getId",value:function(){return this.nonce_?this.idPrefix+this.nonce_+"_"+this.obj_num:this.idPrefix+this.obj_num}},{key:"getNextId",value:function(){var e=this.obj_num,t=!1;this.releasedNums.length>0?(this.obj_num=this.releasedNums.pop(),t=!0):this.obj_num++;for(var n=this.getId();this.getElem_(n);)t&&(this.obj_num=e,t=!1),this.obj_num++,n=this.getId();return t&&(this.obj_num=e),n}},{key:"releaseId",value:function(e){var t=this.idPrefix+(this.nonce_?this.nonce_+"_":"");if("string"!=typeof e||!e.startsWith(t))return!1;var n=parseInt(e.substr(t.length),10);return!("number"!=typeof n||n<=0||this.releasedNums.includes(n))&&(this.releasedNums.push(n),!0)}},{key:"getNumLayers",value:function(){return this.all_layers.length}},{key:"hasLayer",value:function(e){return void 0!==this.layer_map[e]}},{key:"getLayerName",value:function(e){return e>=0&&e<this.getNumLayers()?this.all_layers[e].getName():""}},{key:"getCurrentLayer",value:function(){return this.current_layer?this.current_layer.getGroup():null}},{key:"getLayerByName",value:function(e){var t=this.layer_map[e];return t?t.getGroup():null}},{key:"getCurrentLayerName",value:function(){return this.current_layer?this.current_layer.getName():""}},{key:"setCurrentLayerName",value:function(e,t){var n=null;if(this.current_layer){var a=this.current_layer.getName();(n=this.current_layer.setName(e,t))&&(delete this.layer_map[a],this.layer_map[n]=this.current_layer)}return n}},{key:"setCurrentLayerPosition",value:function(e){var t=this.getNumLayers();if(!this.current_layer||e<0||e>=t)return null;var n=void 0;for(n=0;n<t&&this.all_layers[n]!==this.current_layer;++n);if(n===t)return null;if(n!==e){var a=this.current_layer.getGroup(),r=a.nextSibling,i=null;return e>n?e<t-1&&(i=this.all_layers[e+1].getGroup()):i=this.all_layers[e].getGroup(),this.svgElem_.insertBefore(a,i),this.identifyLayers(),this.setCurrentLayer(this.getLayerName(e)),{currentGroup:a,oldNextSibling:r}}return null}},{key:"mergeLayer",value:function(e){var t=this.current_layer.getGroup(),n=$$5(t).prev()[0];if(n){e.startBatchCommand("Merge Layer");var a=t.nextSibling;for(e.removeElement(t,a,this.svgElem_);t.firstChild;){var r=t.firstChild;if("title"!==r.localName){var i=r.nextSibling;n.appendChild(r),e.moveElement(r,i,t)}else e.removeElement(r,r.nextSibling,t),t.removeChild(r)}this.current_layer.removeGroup();var s=this.all_layers.indexOf(this.current_layer);if(s>0){var o=this.current_layer.getName();this.current_layer=this.all_layers[s-1],this.all_layers.splice(s,1),delete this.layer_map[o]}e.endBatchCommand()}}},{key:"mergeAllLayers",value:function(e){for(this.current_layer=this.all_layers[this.all_layers.length-1],e.startBatchCommand("Merge all Layers");this.all_layers.length>1;)this.mergeLayer(e);e.endBatchCommand()}},{key:"setCurrentLayer",value:function(e){var t=this.layer_map[e];return!!t&&(this.current_layer&&this.current_layer.deactivate(),this.current_layer=t,this.current_layer.activate(),!0)}},{key:"deleteCurrentLayer",value:function(){if(this.current_layer&&this.getNumLayers()>1){var e=this.current_layer.removeGroup();return this.identifyLayers(),e}return null}},{key:"identifyLayers",value:function(){this.all_layers=[],this.layer_map={};for(var e=this.svgElem_.childNodes.length,t=[],n=[],a=null,r=!1,i=0;i<e;++i){var s=this.svgElem_.childNodes.item(i);if(s&&1===s.nodeType)if("g"===s.tagName){r=!0;var o=findLayerNameInGroup(s);o?(n.push(o),a=new Layer(o,s),this.all_layers.push(a),this.layer_map[o]=a):t.push(s)}else visElems$1.includes(s.nodeName)&&t.push(s)}t.length>0||!r?((a=new Layer(getNewLayerName(n),null,this.svgElem_)).appendChildren(t),this.all_layers.push(a),this.layer_map[name]=a):a.activate(),this.current_layer=a}},{key:"createLayer",value:function(e,t){this.current_layer&&this.current_layer.deactivate(),(void 0===e||null===e||""===e||this.layer_map[e])&&(e=getNewLayerName(Object.keys(this.layer_map)));var n=new Layer(e,null,this.svgElem_);return t&&(t.startBatchCommand("Create Layer"),t.insertElement(n.getGroup()),t.endBatchCommand()),this.all_layers.push(n),this.layer_map[e]=n,this.current_layer=n,n.getGroup()}},{key:"cloneLayer",value:function(e,t){if(!this.current_layer)return null;this.current_layer.deactivate(),(void 0===e||null===e||""===e||this.layer_map[e])&&(e=getNewLayerName(Object.keys(this.layer_map)));for(var n=this.current_layer.getGroup(),a=new Layer(e,n,this.svgElem_),r=a.getGroup(),i=n.childNodes,s=0;s<i.length;s++){var o=i[s];"title"!==o.localName&&r.appendChild(this.copyElem(o))}t&&(t.startBatchCommand("Duplicate Layer"),t.insertElement(r),t.endBatchCommand());var l=this.all_layers.indexOf(this.current_layer);return l>=0?this.all_layers.splice(l+1,0,a):this.all_layers.push(a),this.layer_map[e]=a,this.current_layer=a,r}},{key:"getLayerVisibility",value:function(e){var t=this.layer_map[e];return!!t&&t.isVisible()}},{key:"setLayerVisibility",value:function(e,t){if("boolean"!=typeof t)return null;var n=this.layer_map[e];return n?(n.setVisible(t),n.getGroup()):null}},{key:"getLayerOpacity",value:function(e){var t=this.layer_map[e];return t?t.getOpacity():null}},{key:"setLayerOpacity",value:function(e,t){if(!("number"!=typeof t||t<0||t>1)){var n=this.layer_map[e];n&&n.setOpacity(t)}}},{key:"copyElem",value:function(e){var t=this;return copyElem(e,function(){return t.getNextId()})}}]),e}(),randomizeIds=function(e,t){(randIds=!1===e?RandomizeModes.NEVER_RANDOMIZE:RandomizeModes.ALWAYS_RANDOMIZE)!==RandomizeModes.ALWAYS_RANDOMIZE||t.getNonce()?randIds===RandomizeModes.NEVER_RANDOMIZE&&t.getNonce()&&t.clearNonce():t.setNonce(Math.floor(100001*Math.random()))},canvas_=void 0,init$3=function(e){canvas_=e},identifyLayers=function(){leaveContext(),canvas_.getCurrentDrawing().identifyLayers()},createLayer=function(e,t){var n=canvas_.getCurrentDrawing().createLayer(e,historyRecordingService(t));canvas_.clearSelection(),canvas_.call("changed",[n])},cloneLayer=function(e,t){var n=canvas_.getCurrentDrawing().cloneLayer(e,historyRecordingService(t));canvas_.clearSelection(),leaveContext(),canvas_.call("changed",[n])},deleteCurrentLayer=function(){var e=canvas_.getCurrentDrawing().getCurrentLayer(),t=e.nextSibling,n=e.parentNode;if(e=canvas_.getCurrentDrawing().deleteCurrentLayer()){var a=new BatchCommand("Delete Layer");return a.addSubCommand(new RemoveElementCommand(e,t,n)),canvas_.addCommandToHistory(a),canvas_.clearSelection(),canvas_.call("changed",[n]),!0}return!1},setCurrentLayer=function(e){var t=canvas_.getCurrentDrawing().setCurrentLayer(toXml(e));return t&&canvas_.clearSelection(),t},renameCurrentLayer=function(e){var t=canvas_.getCurrentDrawing(),n=t.getCurrentLayer();if(n&&t.setCurrentLayerName(e,historyRecordingService()))return canvas_.call("changed",[n]),!0;return!1},setCurrentLayerPosition=function(e){var t=canvas_.getCurrentDrawing().setCurrentLayerPosition(e);return!!t&&(canvas_.addCommandToHistory(new MoveElementCommand(t.currentGroup,t.oldNextSibling,canvas_.getSVGContent())),!0)},setLayerVisibility=function(e,t){var n=canvas_.getCurrentDrawing(),a=n.getLayerVisibility(e),r=n.setLayerVisibility(e,t);if(!r)return!1;var i=a?"inline":"none";return canvas_.addCommandToHistory(new ChangeElementCommand(r,{display:i},"Layer Visibility")),r===n.getCurrentLayer()&&(canvas_.clearSelection(),canvas_.pathActions.clear()),!0},moveSelectedToLayer=function(e){var t=canvas_.getCurrentDrawing().getLayerByName(e);if(!t)return!1;for(var n=new BatchCommand("Move Elements to Layer"),a=canvas_.getSelectedElements(),r=a.length;r--;){var i=a[r];if(i){var s=i.nextSibling,o=i.parentNode;t.appendChild(i),n.addSubCommand(new MoveElementCommand(i,s,o))}}return canvas_.addCommandToHistory(n),!0},mergeLayer=function(e){canvas_.getCurrentDrawing().mergeLayer(historyRecordingService(e)),canvas_.clearSelection(),leaveContext(),canvas_.changeSvgcontent()},mergeAllLayers=function(e){canvas_.getCurrentDrawing().mergeAllLayers(historyRecordingService(e)),canvas_.clearSelection(),leaveContext(),canvas_.changeSvgcontent()},leaveContext=function(){var e=disabledElems.length;if(e){for(var t=0;t<e;t++){var n=disabledElems[t],a=canvas_.elData(n,"orig_opac");1!==a?n.setAttribute("opacity",a):n.removeAttribute("opacity"),n.setAttribute("style","pointer-events: inherit")}disabledElems=[],canvas_.clearSelection(!0),canvas_.call("contextset",null)}canvas_.setCurrentGroup(null)},setContext=function(e){leaveContext(),"string"==typeof e&&(e=getElem(e)),canvas_.setCurrentGroup(e),$$5(e).parentsUntil("#svgcontent").andSelf().siblings().each(function(){var e=this.getAttribute("opacity")||1;canvas_.elData(this,"orig_opac",e),this.setAttribute("opacity",.33*e),this.setAttribute("style","pointer-events: none"),disabledElems.push(this)}),canvas_.clearSelection(),canvas_.call("contextset",canvas_.getCurrentGroup())},draw=Object.freeze({Drawing:Drawing,randomizeIds:randomizeIds,init:init$3,identifyLayers:identifyLayers,createLayer:createLayer,cloneLayer:cloneLayer,deleteCurrentLayer:deleteCurrentLayer,setCurrentLayer:setCurrentLayer,renameCurrentLayer:renameCurrentLayer,setCurrentLayerPosition:setCurrentLayerPosition,setLayerVisibility:setLayerVisibility,moveSelectedToLayer:moveSelectedToLayer,mergeLayer:mergeLayer,mergeAllLayers:mergeAllLayers,leaveContext:leaveContext,setContext:setContext,Layer:Layer}),REVERSE_NS=getReverseNS(),svgWhiteList_={a:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","mask","opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","xlink:href","xlink:title"],circle:["class","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","r","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],clipPath:["class","clipPathUnits","id"],defs:[],style:["type"],desc:[],ellipse:["class","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],feGaussianBlur:["class","color-interpolation-filters","id","requiredFeatures","stdDeviation"],filter:["class","color-interpolation-filters","filterRes","filterUnits","height","id","primitiveUnits","requiredFeatures","width","x","xlink:href","y"],foreignObject:["class","font-size","height","id","opacity","requiredFeatures","style","transform","width","x","y"],g:["class","clip-path","clip-rule","id","display","fill","fill-opacity","fill-rule","filter","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","font-family","font-size","font-style","font-weight","text-anchor"],image:["class","clip-path","clip-rule","filter","height","id","mask","opacity","requiredFeatures","style","systemLanguage","transform","width","x","xlink:href","xlink:title","y"],line:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","x1","x2","y1","y2"],linearGradient:["class","id","gradientTransform","gradientUnits","requiredFeatures","spreadMethod","systemLanguage","x1","x2","xlink:href","y1","y2"],marker:["id","class","markerHeight","markerUnits","markerWidth","orient","preserveAspectRatio","refX","refY","systemLanguage","viewBox"],mask:["class","height","id","maskContentUnits","maskUnits","width","x","y"],metadata:["class","id"],path:["class","clip-path","clip-rule","d","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],pattern:["class","height","id","patternContentUnits","patternTransform","patternUnits","requiredFeatures","style","systemLanguage","viewBox","width","x","xlink:href","y"],polygon:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","id","class","marker-end","marker-mid","marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],polyline:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","marker-end","marker-mid","marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],radialGradient:["class","cx","cy","fx","fy","gradientTransform","gradientUnits","id","r","requiredFeatures","spreadMethod","systemLanguage","xlink:href"],rect:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask","opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","width","x","y"],stop:["class","id","offset","requiredFeatures","stop-color","stop-opacity","style","systemLanguage"],svg:["class","clip-path","clip-rule","filter","id","height","mask","preserveAspectRatio","requiredFeatures","style","systemLanguage","viewBox","width","x","xmlns","xmlns:se","xmlns:xlink","y"],switch:["class","id","requiredFeatures","systemLanguage"],symbol:["class","fill","fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","opacity","preserveAspectRatio","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","viewBox"],text:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","transform","x","xml:space","y"],textPath:["class","id","method","requiredFeatures","spacing","startOffset","style","systemLanguage","transform","xlink:href"],title:[],tspan:["class","clip-path","clip-rule","dx","dy","fill","fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","rotate","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","textLength","transform","x","xml:space","y"],use:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","transform","width","x","xlink:href","y"],annotation:["encoding"],"annotation-xml":["encoding"],maction:["actiontype","other","selection"],math:["class","id","display","xmlns"],menclose:["notation"],merror:[],mfrac:["linethickness"],mi:["mathvariant"],mmultiscripts:[],mn:[],mo:["fence","lspace","maxsize","minsize","rspace","stretchy"],mover:[],mpadded:["lspace","width","height","depth","voffset"],mphantom:[],mprescripts:[],mroot:[],mrow:["xlink:href","xlink:type","xmlns:xlink"],mspace:["depth","height","width"],msqrt:[],mstyle:["displaystyle","mathbackground","mathcolor","mathvariant","scriptlevel"],msub:[],msubsup:[],msup:[],mtable:["align","columnalign","columnlines","columnspacing","displaystyle","equalcolumns","equalrows","frame","rowalign","rowlines","rowspacing","width"],mtd:["columnalign","columnspan","rowalign","rowspan"],mtext:[],mtr:["columnalign","rowalign"],munder:[],munderover:[],none:[],semantics:[]},svgWhiteListNS_={};Object.entries(svgWhiteList_).forEach(function(e){var t=slicedToArray(e,2),n=t[0],a=t[1],r={};Object.entries(a).forEach(function(e){var t=slicedToArray(e,2),n=(t[0],t[1]);if(n.includes(":")){var a=n.split(":");r[a[1]]=NS[a[0].toUpperCase()]}else r[n]="xmlns"===n?NS.XMLNS:null}),svgWhiteListNS_[n]=r});var sanitizeSvg=function e(t){if(3===t.nodeType&&(t.nodeValue=t.nodeValue.replace(/^\s+|\s+$/g,""),t.nodeValue.length||t.parentNode.removeChild(t)),1===t.nodeType){var n=t.ownerDocument,a=t.parentNode;if(n&&a){var r=svgWhiteList_[t.nodeName],i=svgWhiteListNS_[t.nodeName];if(void 0!==r){for(var s=[],o=t.attributes.length;o--;){var l=t.attributes.item(o),u=l.nodeName,c=l.localName,h=l.namespaceURI;if(i.hasOwnProperty(c)&&h===i[c]&&h!==NS.XMLNS||h===NS.XMLNS&&REVERSE_NS[l.value]||((u.startsWith("se:")||u.startsWith("data-"))&&s.push([u,l.value]),t.removeAttributeNS(h,c)),isGecko())switch(u){case"transform":case"gradientTransform":case"patternTransform":var d=l.value.replace(/(\d)-/g,"$1 -");t.setAttribute(u,d)}if("style"===u){for(var f=l.value.split(";"),p=f.length;p--;){var g=f[p].split(":"),v=slicedToArray(g,2),m=v[0],y=v[1],b=(m||"").trim(),_=(y||"").trim();r.includes(b)&&t.setAttribute(b,_)}t.removeAttribute("style")}}Object.values(s).forEach(function(e){t.setAttributeNS(NS.SE,e[0],e[1])});var x=getHref(t);if(x&&["filter","linearGradient","pattern","radialGradient","textPath","use"].includes(t.nodeName)&&"#"!==x[0]&&(setHref(t,""),t.removeAttributeNS(NS.XLINK,"href")),"use"===t.nodeName&&!getHref(t))return void a.removeChild(t);for(Object.values(["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],function(e){var n=t.getAttribute(e);n&&(n=getUrlFromAttr(n))&&"#"!==n[0]&&(t.setAttribute(e,""),t.removeAttribute(e))}),o=t.childNodes.length;o--;)e(t.childNodes.item(o))}else{for(var C=[];t.hasChildNodes();)C.push(a.insertBefore(t.firstChild,t));a.removeChild(t);for(var S=C.length;S--;)e(C[S])}}}},$$6=jQuery,pathMap$1=[0,"z","M","m","L","l","C","c","Q","q","A","a","H","h","V","v","S","s","T","t"],editorContext_$2=null,init$4=function(e){editorContext_$2=e},remapElement=function(e,t,n){for(var a=function(e,t){return transformPoint(e,t,n)},r=function(e){return n.a*e},i=function(e){return n.d*e},s=editorContext_$2.getGridSnapping()&&"svg"===e.parentNode.parentNode.localName,o=function(){if(s)for(var n in t)t[n]=snapToGrid(t[n]);assignAttributes(e,t,1e3,!0)},l=getBBox(e),u=0;u<2;u++){var c=0===u?"fill":"stroke",h=e.getAttribute(c);if(h&&h.startsWith("url(")&&(n.a<0||n.d<0)){var d=getRefElem(h).cloneNode(!0);if(n.a<0){var f=d.getAttribute("x1"),p=d.getAttribute("x2");d.setAttribute("x1",-(f-1)),d.setAttribute("x2",-(p-1))}if(n.d<0){var g=d.getAttribute("y1"),v=d.getAttribute("y2");d.setAttribute("y1",-(g-1)),d.setAttribute("y2",-(v-1))}d.id=editorContext_$2.getDrawing().getNextId(),findDefs().appendChild(d),e.setAttribute(c,"url(#"+d.id+")")}}var m=e.tagName;if("g"===m||"text"===m||"tspan"===m||"use"===m)if(1!==n.a||0!==n.b||0!==n.c||1!==n.d||0===n.e&&0===n.f){var y=getTransformList(e),b=editorContext_$2.getSVGRoot().createSVGTransform();b.setMatrix(matrixMultiply(transformListToTransform(y).matrix,n)),y.clear(),y.appendItem(b)}else{var _=transformListToTransform(e).matrix,x=matrixMultiply(_.inverse(),n,_);t.x=parseFloat(t.x)+x.e,t.y=parseFloat(t.y)+x.f}switch(m){case"foreignObject":case"rect":case"image":if("image"===m&&(n.a<0||n.d<0)){var C=getTransformList(e),S=editorContext_$2.getSVGRoot().createSVGTransform();S.setMatrix(matrixMultiply(transformListToTransform(C).matrix,n)),C.clear(),C.appendItem(S)}else{var w=a(t.x,t.y);t.width=r(t.width),t.height=i(t.height),t.x=w.x+Math.min(0,t.width),t.y=w.y+Math.min(0,t.height),t.width=Math.abs(t.width),t.height=Math.abs(t.height)}o();break;case"ellipse":var k=a(t.cx,t.cy);t.cx=k.x,t.cy=k.y,t.rx=r(t.rx),t.ry=i(t.ry),t.rx=Math.abs(t.rx),t.ry=Math.abs(t.ry),o();break;case"circle":var $=a(t.cx,t.cy);t.cx=$.x,t.cy=$.y;var P=transformBox(l.x,l.y,l.width,l.height,n),E=P.tr.x-P.tl.x,A=P.bl.y-P.tl.y;t.r=Math.min(E/2,A/2),t.r&&(t.r=Math.abs(t.r)),o();break;case"line":var T=a(t.x1,t.y1),N=a(t.x2,t.y2);t.x1=T.x,t.y1=T.y,t.x2=N.x,t.y2=N.y;case"text":case"tspan":case"use":o();break;case"g":var G=$$6(e).data("gsvg");G&&assignAttributes(G,t,1e3,!0);break;case"polyline":case"polygon":for(var L=t.points.length,I=0;I<L;++I){var M=t.points[I],B=a(M.x,M.y),O=B.x,V=B.y;t.points[I].x=O,t.points[I].y=V}for(var R="",j=0;j<L;++j){var D=t.points[j];R+=D.x+","+D.y+" "}e.setAttribute("points",R);break;case"path":var F=e.pathSegList,U=F.numberOfItems;t.d=[];for(var H=0;H<U;++H){var z=F.getItem(H);t.d[H]={type:z.pathSegType,x:z.x,y:z.y,x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,r1:z.r1,r2:z.r2,angle:z.angle,largeArcFlag:z.largeArcFlag,sweepFlag:z.sweepFlag}}U=t.d.length;var q=t.d[0],X=a(q.x,q.y);t.d[0].x=X.x,t.d[0].y=X.y;for(var W=1;W<U;++W){var Y=t.d[W];if(Y.type%2==0){var Q=a(void 0!==Y.x?Y.x:X.x,void 0!==Y.y?Y.y:X.y),Z=a(Y.x1,Y.y1),K=a(Y.x2,Y.y2);Y.x=Q.x,Y.y=Q.y,Y.x1=Z.x,Y.y1=Z.y,Y.x2=K.x,Y.y2=K.y,Y.r1=r(Y.r1),Y.r2=i(Y.r2)}else Y.x=r(Y.x),Y.y=i(Y.y),Y.x1=r(Y.x1),Y.y1=i(Y.y1),Y.x2=r(Y.x2),Y.y2=i(Y.y2),Y.r1=r(Y.r1),Y.r2=i(Y.r2)}var J="";U=t.d.length;for(var ee=0;ee<U;++ee){var te=t.d[ee],ne=te.type;switch(J+=pathMap$1[ne],ne){case 13:case 12:J+=te.x+" ";break;case 15:case 14:J+=te.y+" ";break;case 3:case 5:case 19:case 2:case 4:case 18:J+=te.x+","+te.y+" ";break;case 7:case 6:J+=te.x1+","+te.y1+" "+te.x2+","+te.y2+" "+te.x+","+te.y+" ";break;case 9:case 8:J+=te.x1+","+te.y1+" "+te.x+","+te.y+" ";break;case 11:case 10:J+=te.r1+","+te.r2+" "+te.angle+" "+ +te.largeArcFlag+" "+ +te.sweepFlag+" "+te.x+","+te.y+" ";break;case 17:case 16:J+=te.x2+","+te.y2+" "+te.x+","+te.y+" "}}e.setAttribute("d",J)}},$$7=jqPluginSVG(jQuery),context_=void 0,init$5=function(e){context_=e},updateClipPath=function(e,t,n){var a=getRefElem(e).firstChild,r=getTransformList(a),i=context_.getSVGRoot().createSVGTransform();i.setTranslate(t,n),r.appendItem(i),recalculateDimensions(a)},recalculateDimensions=function e(t){if(null==t)return null;if("svg"===t.nodeName&&navigator.userAgent.includes("Firefox/20"))return null;var n=context_.getSVGRoot(),a=getTransformList(t);if(a&&a.numberOfItems>0){for(var r=a.numberOfItems,i=r;r--;){var s=a.getItem(r);if(0===s.type)a.removeItem(r);else if(1===s.type){if(isIdentity(s.matrix)){if(1===i)return t.removeAttribute("transform"),null;a.removeItem(r)}}else 4===s.type&&0===s.angle&&a.removeItem(r)}if(1===a.numberOfItems&&getRotationAngle(t))return null}if(!a||0===a.numberOfItems)return t.setAttribute("transform",""),t.removeAttribute("transform"),null;if(a){for(var o=[],l=a.numberOfItems;l--;){var u=a.getItem(l);1===u.type?o.push([u.matrix,l]):o.length&&(o=[])}if(2===o.length){var c=n.createSVGTransformFromMatrix(matrixMultiply(o[1][0],o[0][0]));a.removeItem(o[0][1]),a.removeItem(o[1][1]),a.insertItemBefore(c,o[1][1])}if((l=a.numberOfItems)>=2&&1===a.getItem(l-2).type&&2===a.getItem(l-1).type){var h=n.createSVGTransform(),d=matrixMultiply(a.getItem(l-2).matrix,a.getItem(l-1).matrix);h.setMatrix(d),a.removeItem(l-2),a.removeItem(l-2),a.appendItem(h)}}switch(t.tagName){case"line":case"polyline":case"polygon":case"path":break;default:if(1===a.numberOfItems&&1===a.getItem(0).type||2===a.numberOfItems&&1===a.getItem(0).type&&4===a.getItem(0).type)return null}var f=$$7(t).data("gsvg"),p=new BatchCommand("Transform"),g={},v=null,m=[];switch(t.tagName){case"line":m=["x1","y1","x2","y2"];break;case"circle":m=["cx","cy","r"];break;case"ellipse":m=["cx","cy","rx","ry"];break;case"foreignObject":case"rect":case"image":m=["width","height","x","y"];break;case"use":case"text":case"tspan":m=["x","y"];break;case"polygon":case"polyline":(v={}).points=t.getAttribute("points");var y=t.points,b=y.numberOfItems;g.points=new Array(b);for(var _=0;_<b;++_){var x=y.getItem(_);g.points[_]={x:x.x,y:x.y}}break;case"path":(v={}).d=t.getAttribute("d"),g.d=t.getAttribute("d")}m.length?(g=$$7(t).attr(m),$$7.each(g,function(e,t){g[e]=convertToNum(e,t)})):f&&(g={x:$$7(f).attr("x")||0,y:$$7(f).attr("y")||0}),null==v&&(v=$$7.extend(!0,{},g),$$7.each(v,function(e,t){v[e]=convertToNum(e,t)})),v.transform=context_.getStartTransform()||"";var C=void 0,S=void 0;if("g"===t.tagName&&!f||"a"===t.tagName){var w=getBBox(t);C={x:w.x+w.width/2,y:w.y+w.height/2},S=transformPoint(w.x+w.width/2,w.y+w.height/2,transformListToTransform(a).matrix);var k=n.createSVGMatrix(),$=getRotationAngle(t);if($){var P=$*Math.PI/180,E=void 0;E=Math.abs(P)>1e-10?Math.sin(P)/(1-Math.cos(P)):2/P;for(var A=0;A<a.numberOfItems;++A){var T=a.getItem(A);if(4===T.type){var N=T.matrix;C.y=(E*N.e+N.f)/2,C.x=(N.e-E*N.f)/2,a.removeItem(A);break}}}var G=a.numberOfItems,L=0,I=0,M=0,B=void 0;G&&(B=a.getItem(0).matrix);var O=void 0;if(G>=3&&3===a.getItem(G-2).type&&2===a.getItem(G-3).type&&2===a.getItem(G-1).type){M=3;for(var V=a.getItem(G-3).matrix,R=a.getItem(G-2).matrix,j=a.getItem(G-1).matrix,D=t.childNodes,F=D.length;F--;){var U=D.item(F);if(L=0,I=0,1===U.nodeType){var H=getTransformList(U);if(!H)continue;var z=transformListToTransform(H).matrix,q=getRotationAngle(U);if(O=context_.getStartTransform(),context_.setStartTransform(U.getAttribute("transform")),q||hasMatrixTransform(H)){var X=n.createSVGTransform();X.setMatrix(matrixMultiply(V,R,j,z)),H.clear(),H.appendItem(X)}else{var W=matrixMultiply(z.inverse(),j,z),Y=n.createSVGMatrix();Y.e=-W.e,Y.f=-W.f;var Q=matrixMultiply(Y.inverse(),z.inverse(),V,R,j,z,W.inverse()),Z=n.createSVGTransform(),K=n.createSVGTransform(),J=n.createSVGTransform();Z.setTranslate(W.e,W.f),K.setScale(Q.a,Q.d),J.setTranslate(Y.e,Y.f),H.appendItem(J),H.appendItem(K),H.appendItem(Z)}p.addSubCommand(e(U)),context_.setStartTransform(O)}}a.removeItem(G-1),a.removeItem(G-2),a.removeItem(G-3)}else if(G>=3&&1===a.getItem(G-1).type){M=3,k=transformListToTransform(a).matrix;var ee=n.createSVGTransform();ee.setMatrix(k),a.clear(),a.appendItem(ee)}else if((1===G||G>1&&3!==a.getItem(1).type)&&2===a.getItem(0).type){M=2;var te=transformListToTransform(a).matrix;a.removeItem(0);var ne=transformListToTransform(a).matrix.inverse(),ae=matrixMultiply(ne,te);if(L=ae.e,I=ae.f,0!==L||0!==I){for(var re=t.childNodes,ie=re.length,se=[];ie--;){var oe=re.item(ie);if(1===oe.nodeType){if(oe.getAttribute("clip-path")){var le=oe.getAttribute("clip-path");se.includes(le)||(updateClipPath(le,L,I),se.push(le))}O=context_.getStartTransform(),context_.setStartTransform(oe.getAttribute("transform"));var ue=getTransformList(oe);if(ue){var ce=n.createSVGTransform();ce.setTranslate(L,I),ue.numberOfItems?ue.insertItemBefore(ce,0):ue.appendItem(ce),p.addSubCommand(e(oe));for(var he=t.getElementsByTagNameNS(NS.SVG,"use"),de="#"+oe.id,fe=he.length;fe--;){var pe=he.item(fe);if(de===getHref(pe)){var ge=n.createSVGTransform();ge.setTranslate(-L,-I),getTransformList(pe).insertItemBefore(ge,0),p.addSubCommand(e(pe))}}context_.setStartTransform(O)}}}se=[],context_.setStartTransform(O)}}else{if(1!==G||1!==a.getItem(0).type||$){if($){var ve=n.createSVGTransform();ve.setRotate($,S.x,S.y),a.numberOfItems?a.insertItemBefore(ve,0):a.appendItem(ve)}return 0===a.numberOfItems&&t.removeAttribute("transform"),null}M=1;for(var me=a.getItem(0).matrix,ye=t.childNodes,be=ye.length;be--;){var _e=ye.item(be);if(1===_e.nodeType){O=context_.getStartTransform(),context_.setStartTransform(_e.getAttribute("transform"));var xe=getTransformList(_e);if(!xe)continue;var Ce=matrixMultiply(me,transformListToTransform(xe).matrix),Se=n.createSVGTransform();Se.setMatrix(Ce),xe.clear(),xe.appendItem(Se,0),p.addSubCommand(e(_e)),context_.setStartTransform(O);var we=_e.getAttribute("stroke-width");if("none"!==_e.getAttribute("stroke")&&!isNaN(we)){var ke=(Math.abs(Ce.a)+Math.abs(Ce.d))/2;_e.setAttribute("stroke-width",we*ke)}}}a.clear()}if(2===M){if($){S={x:C.x+B.e,y:C.y+B.f};var $e=n.createSVGTransform();$e.setRotate($,S.x,S.y),a.numberOfItems?a.insertItemBefore($e,0):a.appendItem($e)}}else if(3===M){var Pe=transformListToTransform(a).matrix,Ee=n.createSVGTransform();Ee.setRotate($,C.x,C.y);var Ae=Ee.matrix,Te=n.createSVGTransform();Te.setRotate($,S.x,S.y);var Ne=Te.matrix.inverse(),Ge=Pe.inverse(),Le=matrixMultiply(Ge,Ne,Ae,Pe);if(L=Le.e,I=Le.f,0!==L||0!==I)for(var Ie=t.childNodes,Me=Ie.length;Me--;){var Be=Ie.item(Me);if(1===Be.nodeType){O=context_.getStartTransform(),context_.setStartTransform(Be.getAttribute("transform"));var Oe=getTransformList(Be),Ve=n.createSVGTransform();Ve.setTranslate(L,I),Oe.numberOfItems?Oe.insertItemBefore(Ve,0):Oe.appendItem(Ve),p.addSubCommand(e(Be)),context_.setStartTransform(O)}}$&&(a.numberOfItems?a.insertItemBefore(Te,0):a.appendItem(Te))}}else{var Re=getBBox(t);if(!Re&&"path"!==t.tagName)return null;var je=n.createSVGMatrix(),De=getRotationAngle(t);if(De){C={x:Re.x+Re.width/2,y:Re.y+Re.height/2},S=transformPoint(Re.x+Re.width/2,Re.y+Re.height/2,transformListToTransform(a).matrix);for(var Fe=De*Math.PI/180,Ue=Math.abs(Fe)>1e-10?Math.sin(Fe)/(1-Math.cos(Fe)):2/Fe,He=0;He<a.numberOfItems;++He){var ze=a.getItem(He);if(4===ze.type){var qe=ze.matrix;C.y=(Ue*qe.e+qe.f)/2,C.x=(qe.e-Ue*qe.f)/2,a.removeItem(He);break}}}var Xe=0,We=a.numberOfItems;if(!isWebkit()){var Ye=t.getAttribute("fill");if(Ye&&Ye.startsWith("url(")){var Qe=getRefElem(Ye),Ze="pattern";if(Qe.tagName!==Ze&&(Ze="gradient"),"userSpaceOnUse"===Qe.getAttribute(Ze+"Units")){je=transformListToTransform(a).matrix;var Ke=getTransformList(Qe),Je=transformListToTransform(Ke).matrix,et="matrix("+[(je=matrixMultiply(je,Je)).a,je.b,je.c,je.d,je.e,je.f].join(",")+")";Qe.setAttribute(Ze+"Transform",et)}}}if(We>=3&&3===a.getItem(We-2).type&&2===a.getItem(We-3).type&&2===a.getItem(We-1).type)Xe=3,je=transformListToTransform(a,We-3,We-1).matrix,a.removeItem(We-1),a.removeItem(We-2),a.removeItem(We-3);else if(4===We&&1===a.getItem(We-1).type){Xe=3,je=transformListToTransform(a).matrix;var tt=n.createSVGTransform();tt.setMatrix(je),a.clear(),a.appendItem(tt),je=n.createSVGMatrix()}else if((1===We||We>1&&3!==a.getItem(1).type)&&2===a.getItem(0).type){Xe=2;var nt=a.getItem(0).matrix,at=transformListToTransform(a,1).matrix,rt=at.inverse();je=matrixMultiply(rt,nt,at),a.removeItem(0)}else{if(1!==We||1!==a.getItem(0).type||De){if(Xe=4,De){var it=n.createSVGTransform();it.setRotate(De,S.x,S.y),a.numberOfItems?a.insertItemBefore(it,0):a.appendItem(it)}return 0===a.numberOfItems&&t.removeAttribute("transform"),null}switch(je=transformListToTransform(a).matrix,t.tagName){case"line":g=$$7(t).attr(["x1","y1","x2","y2"]);case"polyline":case"polygon":if(g.points=t.getAttribute("points"),g.points){var st=t.points,ot=st.numberOfItems;g.points=new Array(ot);for(var lt=0;lt<ot;++lt){var ut=st.getItem(lt);g.points[lt]={x:ut.x,y:ut.y}}}case"path":g.d=t.getAttribute("d"),Xe=1,a.clear()}}if(1!==Xe&&2!==Xe&&3!==Xe||remapElement(t,g,je),2===Xe){if(De){hasMatrixTransform(a)||(S={x:C.x+je.e,y:C.y+je.f});var ct=n.createSVGTransform();ct.setRotate(De,S.x,S.y),a.numberOfItems?a.insertItemBefore(ct,0):a.appendItem(ct)}if("text"===t.tagName)for(var ht=t.childNodes,dt=ht.length;dt--;){var ft=ht.item(dt);if("tspan"===ft.tagName){var pt={x:$$7(ft).attr("x")||0,y:$$7(ft).attr("y")||0};remapElement(ft,pt,je)}}}else if(3===Xe&&De){var gt=transformListToTransform(a).matrix,vt=n.createSVGTransform();vt.setRotate(De,C.x,C.y);var mt=vt.matrix,yt=n.createSVGTransform();yt.setRotate(De,S.x,S.y);var bt=yt.matrix.inverse(),_t=gt.inverse(),xt=matrixMultiply(_t,bt,mt,gt);remapElement(t,g,xt),De&&(a.numberOfItems?a.insertItemBefore(yt,0):a.appendItem(yt))}}return 0===a.numberOfItems&&t.removeAttribute("transform"),p.addSubCommand(new ChangeElementCommand(t,v)),p},$$8=jQuery,svgFactory_=void 0,config_=void 0,selectorManager_=void 0,gripRadius=isTouch()?10:4,Selector=function(){function e(t,n,a){classCallCheck(this,e),this.id=t,this.selectedElement=n,this.locked=!0,this.selectorGroup=svgFactory_.createSVGElement({element:"g",attr:{id:"selectorGroup"+this.id}}),this.selectorRect=this.selectorGroup.appendChild(svgFactory_.createSVGElement({element:"path",attr:{id:"selectedBox"+this.id,fill:"none",stroke:"#22C","stroke-width":"1","stroke-dasharray":"5,5",style:"pointer-events:none"}})),this.gripCoords={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null},this.reset(this.selectedElement,a)}return createClass(e,[{key:"reset",value:function(e,t){this.locked=!0,this.selectedElement=e,this.resize(t),this.selectorGroup.setAttribute("display","inline")}},{key:"updateGripCursors",value:function(e){var t=void 0,n=[],a=Math.round(e/45);for(t in a<0&&(a+=8),selectorManager_.selectorGrips)n.push(t);for(;a>0;)n.push(n.shift()),a--;var r=0;for(t in selectorManager_.selectorGrips)selectorManager_.selectorGrips[t].setAttribute("style","cursor:"+n[r]+"-resize"),r++}},{key:"showGrips",value:function(e){var t=e?"inline":"none";selectorManager_.selectorGripsGroup.setAttribute("display",t);var n=this.selectedElement;this.hasGrips=e,n&&e&&(this.selectorGroup.appendChild(selectorManager_.selectorGripsGroup),this.updateGripCursors(getRotationAngle(n)))}},{key:"resize",value:function(e){var t=this.selectorRect,n=selectorManager_,a=n.selectorGrips,r=this.selectedElement,i=r.getAttribute("stroke-width"),s=svgFactory_.getCurrentZoom(),o=1/s;"none"===r.getAttribute("stroke")||isNaN(i)||(o+=i/2);var l=r.tagName;"text"===l&&(o+=2/s);var u=getTransformList(r),c=transformListToTransform(u).matrix;if(c.e*=s,c.f*=s,e||(e=getBBox(r)),"g"===l&&!$$8.data(r,"gsvg")){var h=getStrokedBBox([r.childNodes]);h&&(e=h)}var d=e.x,f=e.y,p=e.width,g=e.height;e={x:d,y:f,width:p,height:g},o*=s;var v=transformBox(d*s,f*s,p*s,g*s,c),m=v.aabox,y=m.x-o,b=m.y-o,_=m.width+2*o,x=m.height+2*o,C=y+_/2,S=b+x/2,w=getRotationAngle(r);if(w){var k=svgFactory_.svgRoot().createSVGTransform();k.setRotate(-w,C,S);var $=k.matrix;v.tl=transformPoint(v.tl.x,v.tl.y,$),v.tr=transformPoint(v.tr.x,v.tr.y,$),v.bl=transformPoint(v.bl.x,v.bl.y,$),v.br=transformPoint(v.br.x,v.br.y,$);var P=v.tl,E=P.x,A=P.y,T=P.x,N=P.y,G=Math.min,L=Math.max;y=E=G(E,G(v.tr.x,G(v.bl.x,v.br.x)))-o,b=A=G(A,G(v.tr.y,G(v.bl.y,v.br.y)))-o,_=(T=L(T,L(v.tr.x,L(v.bl.x,v.br.x)))+o)-E,x=(N=L(N,L(v.tr.y,L(v.bl.y,v.br.y)))+o)-A}var I="M"+y+","+b+" L"+(y+_)+","+b+" "+(y+_)+","+(b+x)+" "+y+","+(b+x)+"z";t.setAttribute("d",I);var M=w?"rotate("+[w,C,S].join(",")+")":"";for(var B in this.selectorGroup.setAttribute("transform",M),this.gripCoords={nw:[y,b],ne:[y+_,b],sw:[y,b+x],se:[y+_,b+x],n:[y+_/2,b],w:[y,b+x/2],e:[y+_,b+x/2],s:[y+_/2,b+x]},this.gripCoords){var O=this.gripCoords[B];a[B].setAttribute("cx",O[0]),a[B].setAttribute("cy",O[1])}n.rotateGripConnector.setAttribute("x1",y+_/2),n.rotateGripConnector.setAttribute("y1",b),n.rotateGripConnector.setAttribute("x2",y+_/2),n.rotateGripConnector.setAttribute("y2",b-5*gripRadius),n.rotateGrip.setAttribute("cx",y+_/2),n.rotateGrip.setAttribute("cy",b-5*gripRadius)}}]),e}(),SelectorManager=function(){function e(){classCallCheck(this,e),this.selectorParentGroup=null,this.rubberBandBox=null,this.selectors=[],this.selectorMap={},this.selectorGrips={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null},this.selectorGripsGroup=null,this.rotateGripConnector=null,this.rotateGrip=null,this.initGroup()}return createClass(e,[{key:"initGroup",value:function(){for(var e in this.selectorParentGroup&&this.selectorParentGroup.parentNode&&this.selectorParentGroup.parentNode.removeChild(this.selectorParentGroup),this.selectorParentGroup=svgFactory_.createSVGElement({element:"g",attr:{id:"selectorParentGroup"}}),this.selectorGripsGroup=svgFactory_.createSVGElement({element:"g",attr:{display:"none"}}),this.selectorParentGroup.appendChild(this.selectorGripsGroup),svgFactory_.svgRoot().appendChild(this.selectorParentGroup),this.selectorMap={},this.selectors=[],this.rubberBandBox=null,this.selectorGrips){var t=svgFactory_.createSVGElement({element:"circle",attr:{id:"selectorGrip_resize_"+e,fill:"#22C",r:gripRadius,style:"cursor:"+e+"-resize","stroke-width":2,"pointer-events":"all"}});$$8.data(t,"dir",e),$$8.data(t,"type","resize"),this.selectorGrips[e]=this.selectorGripsGroup.appendChild(t)}if(this.rotateGripConnector=this.selectorGripsGroup.appendChild(svgFactory_.createSVGElement({element:"line",attr:{id:"selectorGrip_rotateconnector",stroke:"#22C","stroke-width":"1"}})),this.rotateGrip=this.selectorGripsGroup.appendChild(svgFactory_.createSVGElement({element:"circle",attr:{id:"selectorGrip_rotate",fill:"lime",r:gripRadius,stroke:"#22C","stroke-width":2,style:"cursor:url("+config_.imgPath+"rotate.png) 12 12, auto;"}})),$$8.data(this.rotateGrip,"type","rotate"),!$$8("#canvasBackground").length){var n=config_.dimensions,a=svgFactory_.createSVGElement({element:"svg",attr:{id:"canvasBackground",width:n[0],height:n[1],x:0,y:0,overflow:isWebkit()?"none":"visible",style:"pointer-events:none"}}),r=svgFactory_.createSVGElement({element:"rect",attr:{width:"100%",height:"100%",x:0,y:0,"stroke-width":1,stroke:"#000",fill:"#FFF",style:"pointer-events:none"}});a.appendChild(r),svgFactory_.svgRoot().insertBefore(a,svgFactory_.svgContent())}}},{key:"requestSelector",value:function(e,t){if(null==e)return null;var n=this.selectors.length;if("object"===_typeof(this.selectorMap[e.id]))return this.selectorMap[e.id].locked=!0,this.selectorMap[e.id];for(var a=0;a<n;++a)if(this.selectors[a]&&!this.selectors[a].locked)return this.selectors[a].locked=!0,this.selectors[a].reset(e,t),this.selectorMap[e.id]=this.selectors[a],this.selectors[a];return this.selectors[n]=new Selector(n,e,t),this.selectorParentGroup.appendChild(this.selectors[n].selectorGroup),this.selectorMap[e.id]=this.selectors[n],this.selectors[n]}},{key:"releaseSelector",value:function(e){if(null!=e){var t=this.selectors.length,n=this.selectorMap[e.id];n.locked||console.log("WARNING! selector was released but was already unlocked");for(var a=0;a<t;++a)if(this.selectors[a]&&this.selectors[a]===n){delete this.selectorMap[e.id],n.locked=!1,n.selectedElement=null,n.showGrips(!1);try{n.selectorGroup.setAttribute("display","none")}catch(e){}break}}}},{key:"getRubberBandBox",value:function(){return this.rubberBandBox||(this.rubberBandBox=this.selectorParentGroup.appendChild(svgFactory_.createSVGElement({element:"rect",attr:{id:"selectorRubberBand",fill:"#22C","fill-opacity":.15,stroke:"#22C","stroke-width":.5,display:"none",style:"pointer-events:none"}}))),this.rubberBandBox}}]),e}(),init$6=function(e,t){config_=e,svgFactory_=t,selectorManager_=new SelectorManager},getSelectorManager=function(){return selectorManager_},$$9=jqPluginSVG(jQuery),MoveElementCommand$1=MoveElementCommand,InsertElementCommand$1=InsertElementCommand,RemoveElementCommand$1=RemoveElementCommand,ChangeElementCommand$1=ChangeElementCommand,BatchCommand$1=BatchCommand,UndoManager$1=UndoManager,HistoryEventTypes$1=HistoryEventTypes;window.console||(window.console={},window.console.log=function(e){},window.console.dir=function(e){}),window.opera&&(window.console.log=function(e){opera.postError(e)},window.console.dir=function(e){});var SvgCanvas=function e(t,n){classCallCheck(this,e);var a={show_outside_canvas:!0,selectNew:!0,dimensions:[640,480]};n&&$$9.extend(a,n);var r=a.dimensions,i=this,s=t.ownerDocument,o=s.importNode(text2xml('<svg id="svgroot" xmlns="'+NS.SVG+'" xlinkns="'+NS.XLINK+'" width="'+r[0]+'" height="'+r[1]+'" x="'+r[0]+'" y="'+r[1]+'" overflow="visible"><defs><filter id="canvashadow" filterUnits="objectBoundingBox"><feGaussianBlur in="SourceAlpha" stdDeviation="4" result="blur"/><feOffset in="blur" dx="5" dy="5" result="offsetBlur"/><feMerge><feMergeNode in="offsetBlur"/><feMergeNode in="SourceGraphic"/></feMerge></filter></defs></svg>').documentElement,!0);t.appendChild(o);var l=s.createElementNS(NS.SVG,"svg");(i.clearSvgContentElement=function(){$$9(l).empty(),$$9(l).attr({id:"svgcontent",width:r[0],height:r[1],x:r[0],y:r[1],overflow:a.show_outside_canvas?"visible":"hidden",xmlns:NS.SVG,"xmlns:se":NS.SE,"xmlns:xlink":NS.XLINK}).appendTo(o);var e=s.createComment(" Created with SVG-edit - https://github.com/SVG-Edit/svgedit");l.appendChild(e)})();var u="svg_";i.setIdPrefix=function(e){u=e},i.current_drawing_=new Drawing(l,u);var c=i.getCurrentDrawing=function(){return i.current_drawing_},h=1,d=null,f={shape:{fill:("none"===a.initFill.color?"":"#")+a.initFill.color,fill_paint:null,fill_opacity:a.initFill.opacity,stroke:"#"+a.initStroke.color,stroke_paint:null,stroke_opacity:a.initStroke.opacity,stroke_width:a.initStroke.width,stroke_dasharray:"none",stroke_linejoin:"miter",stroke_linecap:"butt",opacity:a.initOpacity}};f.text=$$9.extend(!0,{},f.shape),$$9.extend(f.text,{fill:"#000000",stroke_width:a.text&&a.text.stroke_width,font_size:a.text&&a.text.font_size,font_family:a.text&&a.text.font_family});var p=f.shape,g=[],v=this.getJsonFromSvgElement=function(e){if(3===e.nodeType)return e.nodeValue;for(var t,n={element:e.tagName,attr:{},children:[]},a=0;t=e.attributes[a];a++)n.attr[t.name]=t.value;for(var r,i=0;r=e.childNodes[i];i++)n.children[i]=v(r);return n},m=this.addSvgElementFromJson=function(e){if("string"==typeof e)return s.createTextNode(e);var t=getElem(e.attr.id),n=c().getCurrentLayer();if(t&&e.element!==t.tagName&&(n.removeChild(t),t=null),!t){var a=e.namespace||NS.SVG;t=s.createElementNS(a,e.element),n&&(d||n).appendChild(t)}return e.curStyles&&assignAttributes(t,{fill:p.fill,stroke:p.stroke,"stroke-width":p.stroke_width,"stroke-dasharray":p.stroke_dasharray,"stroke-linejoin":p.stroke_linejoin,"stroke-linecap":p.stroke_linecap,"stroke-opacity":p.stroke_opacity,"fill-opacity":p.fill_opacity,opacity:p.opacity/2,style:"pointer-events:inherit"},100),assignAttributes(t,e.attr,100),cleanupElement(t),e.children&&e.children.forEach(function(e){t.appendChild(m(e))}),t};i.getTransformList=getTransformList,i.matrixMultiply=matrixMultiply,i.hasMatrixTransform=hasMatrixTransform,i.transformListToTransform=transformListToTransform,init({getBaseUnit:function(){return a.baseUnit},getElement:getElem,getHeight:function(){return l.getAttribute("height")/h},getWidth:function(){return l.getAttribute("width")/h},getRoundDigits:function(){return F.round_digits}}),i.convertToNum=convertToNum;var y=function(){return l},b=this.getSelectedElems=function(){return g},_=pathActions;init$2({pathActions:_,getSVGContent:y,addSvgElementFromJson:m,getSelectedElements:b,getDOMDocument:function(){return s},getDOMContainer:function(){return t},getSVGRoot:function(){return o},getBaseUnit:function(){return a.baseUnit},getSnappingStep:function(){return a.snappingStep}}),i.findDefs=findDefs,i.getUrlFromAttr=getUrlFromAttr,i.getHref=getHref,i.setHref=setHref,i.getBBox=getBBox,i.getRotationAngle=getRotationAngle,i.getElem=getElem,i.getRefElem=getRefElem,i.assignAttributes=assignAttributes,this.cleanupElement=cleanupElement;var x=function(){return a.gridSnapping};init$4({getDrawing:function(){return c()},getSVGRoot:function(){return o},getGridSnapping:x}),this.remapElement=remapElement,init$5({getSVGRoot:function(){return o},getStartTransform:function(){return Y},setStartTransform:function(e){Y=e}}),this.recalculateDimensions=recalculateDimensions;var C=getReverseNS();i.sanitizeSvg=sanitizeSvg;var S=i.undoMgr=new UndoManager$1({handleHistoryEvent:function(e,t){var n=HistoryEventTypes$1;if(e===n.BEFORE_UNAPPLY||e===n.BEFORE_APPLY)i.clearSelection();else if(e===n.AFTER_APPLY||e===n.AFTER_UNAPPLY){var a=t.elements();i.pathActions.clear(),T("changed",a);var r=t.type(),s=e===n.AFTER_APPLY;if(r===MoveElementCommand$1.type())(s?t.newParent:t.oldParent)===l&&identifyLayers();else if(r===InsertElementCommand$1.type()||r===RemoveElementCommand$1.type())t.parent===l&&identifyLayers(),r===InsertElementCommand$1.type()?s&&j(t.elem):s||j(t.elem),"use"===t.elem.tagName&&Ie(t.elem);else if(r===ChangeElementCommand$1.type()){"title"===t.elem.tagName&&t.elem.parentNode.parentNode===l&&identifyLayers();var o=s?t.newValues:t.oldValues;o.stdDeviation&&i.setBlurOffsets(t.elem.parentNode,o.stdDeviation)}}}}),w=function(e){i.undoMgr.addCommandToHistory(e)},k=this.getZoom=function(){return h},$=this.round=function(e){return parseInt(e*h,10)/h};init$6(a,{createSVGElement:function(e){return i.addSvgElementFromJson(e)},svgRoot:function(){return o},svgContent:function(){return l},getCurrentZoom:k});var P=this.selectorManager=getSelectorManager(),E=i.getNextId=function(){return c().getNextId()},A=i.getId=function(){return c().getId()},T=function(e,t){if(oe[e])return oe[e](window,t)},N=function(e){g.map(function(e){null!=e&&P.releaseSelector(e)}),g=[],e||T("selected",g)},G=function(e,t){if(e.length){for(var n=0;n<g.length&&null!=g[n];)++n;for(var a=e.length;a--;){var r=e[a];if(r){var i=getBBox(r);if(i&&("a"===r.tagName&&1===r.childNodes.length&&(r=r.firstChild),!g.includes(r))){g[n]=r,n++;var s=P.requestSelector(r,i);g.length>1&&s.showGrips(!1)}}}for(T("selected",g),t||1===g.length?P.requestSelector(g[0]).showGrips(!0):P.requestSelector(g[0]).showGrips(!1),g.sort(function(e,t){return e&&t&&e.compareDocumentPosition?3-(6&t.compareDocumentPosition(e)):null==e?1:void 0});null==g[0];)g.shift(0)}},L=function(){return p.opacity},I=this.getMouseTarget=function(e){if(null==e)return null;var n=e.target;if(n.correspondingUseElement&&(n=n.correspondingUseElement),[NS.MATH,NS.HTML].includes(n.namespaceURI)&&"svgcanvas"!==n.id)for(;"foreignObject"!==n.nodeName;)if(!(n=n.parentNode))return o;var a=c().getCurrentLayer();if([o,t,l,a].includes(n))return o;if($$9(n).closest("#selectorParentGroup").length)return P.selectorParentGroup;for(;n.parentNode!==(d||a);)n=n.parentNode;return n};i.pathActions=_,init$1({selectorManager:P,canvas:i,call:T,resetD:function(e){e.setAttribute("d",_.convertPath(e))},round:$,clearSelection:N,addToSelection:G,addCommandToHistory:w,remapElement:remapElement,addSvgElementFromJson:m,getGridSnapping:x,getOpacity:L,getSelectedElements:b,getContainer:function(){return t},setStarted:function(e){W=e},getRubberBox:function(){return ee},setRubberBox:function(e){return ee=e},addPtsToSelection:function(e){var t=e.closedSubpath,n=e.grips;_.canDeleteNodes=!0,_.closed_subpath=t,T("selected",n)},endChanges:function(e){var t=e.cmd,n=e.elem;w(t),T("changed",[n])},getCurrentZoom:k,getId:A,getNextId:E,getMouseTarget:I,getCurrentMode:function(){return Q},setCurrentMode:function(e){return Q=e},getDrawnPath:function(){return Ae},setDrawnPath:function(e){return Ae=e},getSVGRoot:function(){return o}});var M={},B="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use",O=["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],V=$$9.data,R=document.createElementNS(NS.SVG,"animate");$$9(R).attr({attributeName:"opacity",begin:"indefinite",dur:1,fill:"freeze"}).appendTo(o);var j=function e(t){var n=$$9(t).attr(O);for(var a in n){var r=n[a];if(r&&r.startsWith("url(")){var i=getUrlFromAttr(r).substr(1);getElem(i)||(findDefs().appendChild(q[i]),delete q[i])}}var s=t.getElementsByTagName("*");if(s.length)for(var o=0,l=s.length;o<l;o++)e(s[o])},D={},F={round_digits:5},U={},H=f.text,z={},q={},X=a.imgPath+"logo.png",W=!1,Y=null,Q="select",Z="none",K=p,J=null,ee=null,te=[],ne=null,ae=this.runExtensions=function(e,t,n){var a=!!n&&[];return $$9.each(z,function(r,i){i&&e in i&&(n?a.push(i[e](t)):a=i[e](t))}),a};this.addExtension=function(e,t){var n=void 0;if(e in z)console.log('Cannot add extension "'+e+'", an extension by that name already exists.');else{var a=$$9.extend(i.getPrivateMethods(),{svgroot:o,svgcontent:l,nonce:c().getNonce(),selectorManager:P});"function"==typeof t?n=t(a):(n=t).callback&&(n.callback=n.callback.bind(n,a)),z[e]=n,T("extension_added",n)}};var re=this.getIntersectionList=function(e){if(null==ee)return null;var t=d||c().getCurrentLayer(),n=void 0;if(e)(n=l.createSVGRect()).x=e.x,n.y=e.y,n.width=e.width,n.height=e.height;else{n=ee.getBBox();var a=l.createSVGRect();for(var r in n)a[r]=n[r]/h;n=a}var i=null;if(isIE||"function"==typeof o.getIntersectionList&&(n.x+=parseInt(l.getAttribute("x"),10),n.y+=parseInt(l.getAttribute("y"),10),i=o.getIntersectionList(n,t)),null==i||"function"!=typeof i.item){i=[],te.length||(te=ie(t));for(var s=te.length;s--;)n.width&&rectsIntersect(n,te[s].bbox)&&i.push(te[s].elem)}return i};this.getStrokedBBox=getStrokedBBoxDefaultVisible,this.getVisibleElements=getVisibleElements;var ie=this.getVisibleElementsAndBBoxes=function(e){e||(e=$$9(l).children());var t=[];return $$9(e).children().each(function(e,n){n.getBBox&&t.push({elem:n,bbox:getStrokedBBoxDefaultVisible([n])})}),t.reverse()},se=this.groupSvgElem=function(e){var t=document.createElementNS(NS.SVG,"g");e.parentNode.replaceChild(t,e),$$9(t).append(e).data("gsvg",e)[0].id=E()},oe={};i.call=T,i.bind=function(e,t){var n=oe[e];return oe[e]=t,n},this.prepareSvg=function(e){this.sanitizeSvg(e.documentElement);for(var t=e.getElementsByTagNameNS(NS.SVG,"path"),n=0,a=t.length;n<a;++n){var r=t[n];r.setAttribute("d",_.convertPath(r)),_.fixEnd(r)}};var le=function(e){if(!isGecko())return e;var t=e.cloneNode(!0);return e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e),P.releaseSelector(e),g[0]=t,P.requestSelector(t).showGrips(!0),t};this.setRotationAngle=function(e,t){e=parseFloat(e);var n=g[0],a=n.getAttribute("transform"),r=getBBox(n),i=r.x+r.width/2,s=r.y+r.height/2,l=getTransformList(n);l.numberOfItems>0&&(4===l.getItem(0).type&&l.removeItem(0));if(0!==e){var u=transformPoint(i,s,transformListToTransform(l).matrix),c=o.createSVGTransform();c.setRotate(e,u.x,u.y),l.numberOfItems?l.insertItemBefore(c,0):l.appendItem(c)}else 0===l.numberOfItems&&n.removeAttribute("transform");if(!t){var h=n.getAttribute("transform");n.setAttribute("transform",a),Fe("transform",h,g),T("changed",g)}var d=P.requestSelector(g[0]);d.resize(),d.updateGripCursors(e)};var ue=this.recalculateAllSelectedDimensions=function(){for(var e=new BatchCommand$1("none"===Z?"position":"size"),t=g.length;t--;){var n=g[t],a=recalculateDimensions(n);a&&e.addSubCommand(a)}e.isEmpty()||(w(e),T("changed",g))},ce=function(e){console.log([e.a,e.b,e.c,e.d,e.e,e.f])},he=null;this.clearSelection=N,this.addToSelection=G;var de=this.selectOnly=function(e,t){N(!0),G(e,t)};this.removeFromSelection=function(e){if(null!=g[0]&&e.length){var t=0,n=[],a=g.length;n.length=a;for(var r=0;r<a;++r){var i=g[r];i&&(e.includes(i)?P.releaseSelector(i):(n[t]=i,t++))}g=n}},this.selectAllInCurrentLayer=function(){var e=c().getCurrentLayer();e&&(Q="select",de($$9(d||e).children()))};var fe,pe,ge,ve,me,ye,be,_e,xe,Ce,Se,we,ke,$e,Pe,Ee,Ae=null;fe={minx:null,miny:null,maxx:null,maxy:null},pe=null,ge=null,ve=null,me=null,ye=null,be={},_e=0,xe={x:0,y:0},Ce={x:0,y:0},Se={x:0,y:0},we={x:0,y:0},ke={x:0,y:0},$e={x:0,y:0},Pe=void 0,Ee=function(e){var t={x:0,y:0},n=xe,a=Ce,r=Se,i=we,s=e*e,o=s*e,l=[[-1,3,-3,1],[3,-6,3,0],[-3,0,3,0],[1,4,1,0]];return t.x=1/6*((n.x*l[0][0]+a.x*l[0][1]+r.x*l[0][2]+i.x*l[0][3])*o+(n.x*l[1][0]+a.x*l[1][1]+r.x*l[1][2]+i.x*l[1][3])*s+(n.x*l[2][0]+a.x*l[2][1]+r.x*l[2][2]+i.x*l[2][3])*e+(n.x*l[3][0]+a.x*l[3][1]+r.x*l[3][2]+i.x*l[3][3])),t.y=1/6*((n.y*l[0][0]+a.y*l[0][1]+r.y*l[0][2]+i.y*l[0][3])*o+(n.y*l[1][0]+a.y*l[1][1]+r.y*l[1][2]+i.y*l[1][3])*s+(n.y*l[2][0]+a.y*l[2][1]+r.y*l[2][2]+i.y*l[2][3])*e+(n.y*l[3][0]+a.y*l[3][1]+r.y*l[3][2]+i.y*l[3][3])),{x:t.x,y:t.y}},$$9(t).mousedown(function(e){if(!i.spaceKey&&1!==e.button){var t=2===e.button;e.altKey&&i.cloneSelectedElements(0,0),he=$$9("#svgcontent g")[0].getScreenCTM().inverse();var n=transformPoint(e.pageX,e.pageY,he),r=n.x*h,s=n.y*h;e.preventDefault(),t&&(Q="select",ne=n);var l=r/h,u=s/h,c=I(e);"a"===c.tagName&&1===c.childNodes.length&&(c=c.firstChild);var d=l;me=ge=l;var f=u;if(ye=ve=u,a.gridSnapping&&(l=snapToGrid(l),u=snapToGrid(u),ge=snapToGrid(ge),ve=snapToGrid(ve)),c===P.selectorParentGroup&&null!=g[0]){var v=e.target,y=V(v,"type");"rotate"===y?Q="rotate":"resize"===y&&(Q="resize",Z=V(v,"dir")),c=g[0]}Y=c.getAttribute("transform");var b=void 0,x=void 0,C=getTransformList(c);switch(Q){case"select":if(W=!0,Z="none",t&&(W=!1),c!==o){if(g.includes(c)||(e.shiftKey||N(!0),G([c]),J=c,_.clear()),!t)for(b=0;b<g.length;++b)if(null!=g[b]){var S=getTransformList(g[b]);S.numberOfItems?S.insertItemBefore(o.createSVGTransform(),0):S.appendItem(o.createSVGTransform())}}else t||(N(),Q="multiselect",null==ee&&(ee=P.getRubberBandBox()),assignAttributes(ee,{x:me*=h,y:ye*=h,width:0,height:0,display:"inline"},100));break;case"zoom":W=!0,null==ee&&(ee=P.getRubberBandBox()),assignAttributes(ee,{x:d*h,y:d*h,width:0,height:0,display:"inline"},100);break;case"resize":W=!0,ge=l,ve=u,be=getBBox($$9("#selectedBox0")[0]);var w={};$$9.each(be,function(e,t){w[e]=t/h}),be=w;var k=getRotationAngle(c)?1:0;if(hasMatrixTransform(C))C.insertItemBefore(o.createSVGTransform(),k),C.insertItemBefore(o.createSVGTransform(),k),C.insertItemBefore(o.createSVGTransform(),k);else if(C.appendItem(o.createSVGTransform()),C.appendItem(o.createSVGTransform()),C.appendItem(o.createSVGTransform()),supportsNonScalingStroke()){var $=isWebkit(),A=void 0;$&&(A=function(e){var t=e.getAttributeNS(null,"stroke");e.removeAttributeNS(null,"stroke"),null!==t&&setTimeout(function(){e.setAttributeNS(null,"stroke",t)},0)}),c.style.vectorEffect="non-scaling-stroke",$&&A(c);var T=c.getElementsByTagName("*"),L=T.length;for(b=0;b<L;b++)T[b].style.vectorEffect="non-scaling-stroke",$&&A(T[b])}break;case"fhellipse":case"fhrect":case"fhpath":Se.x=d,Se.y=f,W=!0,pe=d+","+f+" ",x=0===parseFloat(p.stroke_width)?1:p.stroke_width,m({element:"polyline",curStyles:!0,attr:{points:pe,id:E(),fill:"none",opacity:p.opacity/2,"stroke-linecap":"round",style:"pointer-events:none"}}),fe.minx=d,fe.maxx=d,fe.miny=f,fe.maxy=f;break;case"image":W=!0;var M=m({element:"image",attr:{x:l,y:u,width:0,height:0,id:E(),opacity:p.opacity/2,style:"pointer-events:inherit"}});setHref(M,X),preventClickDefault(M);break;case"square":case"rect":W=!0,ge=l,ve=u,m({element:"rect",curStyles:!0,attr:{x:l,y:u,width:0,height:0,id:E(),opacity:p.opacity/2}});break;case"line":W=!0,x=0===Number(p.stroke_width)?1:p.stroke_width,m({element:"line",curStyles:!0,attr:{x1:l,y1:u,x2:l,y2:u,id:E(),stroke:p.stroke,"stroke-width":x,"stroke-dasharray":p.stroke_dasharray,"stroke-linejoin":p.stroke_linejoin,"stroke-linecap":p.stroke_linecap,"stroke-opacity":p.stroke_opacity,fill:"none",opacity:p.opacity/2,style:"pointer-events:none"}});break;case"circle":W=!0,m({element:"circle",curStyles:!0,attr:{cx:l,cy:u,r:0,id:E(),opacity:p.opacity/2}});break;case"ellipse":W=!0,m({element:"ellipse",curStyles:!0,attr:{cx:l,cy:u,rx:0,ry:0,id:E(),opacity:p.opacity/2}});break;case"text":W=!0,m({element:"text",curStyles:!0,attr:{x:l,y:u,id:E(),fill:H.fill,"stroke-width":H.stroke_width,"font-size":H.font_size,"font-family":H.font_family,"text-anchor":"middle","xml:space":"preserve",opacity:p.opacity}});break;case"path":case"pathedit":ge*=h,ve*=h,_.mouseDown(e,c,ge,ve),W=!0;break;case"textedit":ge*=h,ve*=h,Te.mouseDown(e,c,ge,ve),W=!0;break;case"rotate":W=!0,i.undoMgr.beginUndoableChange("transform",g)}var B=ae("mouseDown",{event:e,start_x:ge,start_y:ve,selectedElements:g},!0);$$9.each(B,function(e,t){t&&t.started&&(W=!0)})}}).mousemove(function(e){if(W&&1!==e.button&&!i.spaceKey){var t=void 0,n=void 0,r=void 0,s=void 0,l=void 0,u=void 0,c=void 0,d=void 0,f=void 0,p=g[0],v=transformPoint(e.pageX,e.pageY,he),m=v.x*h,y=v.y*h,b=getElem(A()),x=m/h,C=x,S=y/h,w=S;a.gridSnapping&&(C=snapToGrid(C),w=snapToGrid(w)),e.preventDefault();var k=void 0;switch(Q){case"select":if(null!==g[0]){if(l=C-ge,u=w-ve,a.gridSnapping&&(l=snapToGrid(l),u=snapToGrid(u)),e.shiftKey){var $=n=snapToAngle(ge,ve,C,w);C=$.x,w=$.y}if(0!==l||0!==u){for(c=g.length,t=0;t<c&&null!=(p=g[t]);++t){var E=o.createSVGTransform();k=getTransformList(p),E.setTranslate(l,u),k.numberOfItems?k.replaceItem(E,0):k.appendItem(E),P.requestSelector(p).resize()}T("transition",g)}}break;case"multiselect":x*=h,S*=h,assignAttributes(ee,{x:Math.min(me,x),y:Math.min(ye,S),width:Math.abs(x-me),height:Math.abs(S-ye)},100);var N=g.slice(),G=[],L=re();for(c=L.length,t=0;t<c;++t){var I=L[t];g.includes(I)||G.push(I);var M=N.indexOf(I);-1!==M&&N.splice(M,1)}N.length>0&&i.removeFromSelection(N),G.length>0&&i.addToSelection(G);break;case"resize":k=getTransformList(p);var B=hasMatrixTransform(k),O=(f=B?be:getBBox(p)).x,V=f.y,R=f,j=R.width,D=R.height;if(l=C-ge,u=w-ve,a.gridSnapping&&(l=snapToGrid(l),u=snapToGrid(u),D=snapToGrid(D),j=snapToGrid(j)),d=getRotationAngle(p)){var F=Math.sqrt(l*l+u*u),U=Math.atan2(u,l)-d*Math.PI/180;l=F*Math.cos(U),u=F*Math.sin(U)}Z.includes("n")||Z.includes("s")||(u=0),Z.includes("e")||Z.includes("w")||(l=0);var H=0,z=0,q=D?(D+u)/D:1,X=j?(j+l)/j:1;Z.includes("n")&&(q=D?(D-u)/D:1,z=D),Z.includes("w")&&(X=j?(j-l)/j:1,H=j);var Y=o.createSVGTransform(),K=o.createSVGTransform(),J=o.createSVGTransform();if(a.gridSnapping&&(O=snapToGrid(O),H=snapToGrid(H),V=snapToGrid(V),z=snapToGrid(z)),Y.setTranslate(-(O+H),-(V+z)),e.shiftKey&&(1===X?X=q:q=X),K.setScale(X,q),J.setTranslate(O+H,V+z),B){var te=d?1:0;k.replaceItem(Y,2+te),k.replaceItem(K,1+te),k.replaceItem(J,Number(te))}else{var ne=k.numberOfItems;k.replaceItem(J,ne-3),k.replaceItem(K,ne-2),k.replaceItem(Y,ne-1)}P.requestSelector(p).resize(),T("transition",g);break;case"zoom":x*=h,S*=h,assignAttributes(ee,{x:Math.min(me*h,x),y:Math.min(ye*h,S),width:Math.abs(x-me*h),height:Math.abs(S-ye*h)},100);break;case"text":assignAttributes(b,{x:C,y:w},1e3);break;case"line":a.gridSnapping&&(C=snapToGrid(C),w=snapToGrid(w));var ie=C,se=w;e.shiftKey&&(ie=(n=snapToAngle(ge,ve,ie,se)).x,se=n.y),b.setAttributeNS(null,"x2",ie),b.setAttributeNS(null,"y2",se);break;case"foreignObject":case"square":case"rect":case"image":var oe="square"===Q||e.shiftKey,le=Math.abs(C-ge),ue=Math.abs(w-ve),ce=void 0,de=void 0;oe?(le=ue=Math.max(le,ue),ce=ge<C?ge:ge-le,de=ve<w?ve:ve-ue):(ce=Math.min(ge,C),de=Math.min(ve,w)),a.gridSnapping&&(le=snapToGrid(le),ue=snapToGrid(ue),ce=snapToGrid(ce),de=snapToGrid(de)),assignAttributes(b,{width:le,height:ue,x:ce,y:de},1e3);break;case"circle":var Ae=$$9(b).attr(["cx","cy"]);r=Ae.cx,s=Ae.cy;var Ne=Math.sqrt((C-r)*(C-r)+(w-s)*(w-s));a.gridSnapping&&(Ne=snapToGrid(Ne)),b.setAttributeNS(null,"r",Ne);break;case"ellipse":var Ge=$$9(b).attr(["cx","cy"]);r=Ge.cx,s=Ge.cy,a.gridSnapping&&(C=snapToGrid(C),r=snapToGrid(r),w=snapToGrid(w),s=snapToGrid(s)),b.setAttributeNS(null,"rx",Math.abs(C-r));var Le=Math.abs(e.shiftKey?C-r:w-s);b.setAttributeNS(null,"ry",Le);break;case"fhellipse":case"fhrect":fe.minx=Math.min(x,fe.minx),fe.maxx=Math.max(x,fe.maxx),fe.miny=Math.min(S,fe.miny),fe.maxy=Math.max(S,fe.maxy);case"fhpath":if(we.x=x,we.y=S,xe.x&&xe.y)for(t=0;t<9;t++)Pe=t/10,ke=Ee((t+1)/10),$e=ke,ke=Ee(Pe),(_e+=Math.sqrt(($e.x-ke.x)*($e.x-ke.x)+($e.y-ke.y)*($e.y-ke.y)))>.8&&(pe+=+ke.x+","+ke.y+" ",b.setAttributeNS(null,"points",pe),_e-=.8);xe={x:Ce.x,y:Ce.y},Ce={x:Se.x,y:Se.y},Se={x:we.x,y:we.y};break;case"path":case"pathedit":if(C*=h,w*=h,a.gridSnapping&&(C=snapToGrid(C),w=snapToGrid(w),ge=snapToGrid(ge),ve=snapToGrid(ve)),e.shiftKey){var Ie=path,Me=void 0,Be=void 0;Ie?(Me=Ie.dragging?Ie.dragging[0]:ge,Be=Ie.dragging?Ie.dragging[1]:ve):(Me=ge,Be=ve);var Oe=n=snapToAngle(Me,Be,C,w);C=Oe.x,w=Oe.y}ee&&"none"!==ee.getAttribute("display")&&(x*=h,S*=h,assignAttributes(ee,{x:Math.min(me*h,x),y:Math.min(ye*h,S),width:Math.abs(x-me*h),height:Math.abs(S-ye*h)},100)),_.mouseMove(C,w);break;case"textedit":C*=h,w*=h,Te.mouseMove(m,y);break;case"rotate":r=(f=getBBox(p)).x+f.width/2,s=f.y+f.height/2;var Ve=getMatrix(p),Re=transformPoint(r,s,Ve);r=Re.x,s=Re.y,d=(Math.atan2(s-w,r-C)*(180/Math.PI)-90)%360,a.gridSnapping&&(d=snapToGrid(d)),e.shiftKey&&(d=45*Math.round(d/45)),i.setRotationAngle(d<-180?360+d:d,!0),T("transition",g)}ae("mouseMove",{event:e,mouse_x:m,mouse_y:y,selected:p})}}).click(function(e){return e.preventDefault(),!1}).dblclick(function(e){var t=e.target.parentNode;if(t!==d){var n=I(e),a=n.tagName;if("text"===a&&"textedit"!==Q){var r=transformPoint(e.pageX,e.pageY,he);Te.select(n,r.x,r.y)}"g"!==a&&"a"!==a||!getRotationAngle(n)||(Ue(n),n=g[0],N(!0)),d&&leaveContext(),"g"!==t.tagName&&"a"!==t.tagName||t===c().getCurrentLayer()||n===P.selectorParentGroup||setContext(n)}}).mouseup(function(e){if(2!==e.button){var t=J;if(J=null,W){var n=transformPoint(e.pageX,e.pageY,he),r=n.x*h,s=n.y*h,o=r/h,l=s/h,u=getElem(A()),d=!1,f=o,v=l;W=!1;var y=void 0,b=void 0;switch(Q){case"resize":case"multiselect":null!=ee&&(ee.setAttribute("display","none"),te=[]),Q="select";case"select":if(null!=g[0]){if(null==g[1]){var x=g[0];switch(x.tagName){case"g":case"use":case"image":case"foreignObject":break;default:K.fill=x.getAttribute("fill"),K.fill_opacity=x.getAttribute("fill-opacity"),K.stroke=x.getAttribute("stroke"),K.stroke_opacity=x.getAttribute("stroke-opacity"),K.stroke_width=x.getAttribute("stroke-width"),K.stroke_dasharray=x.getAttribute("stroke-dasharray"),K.stroke_linejoin=x.getAttribute("stroke-linejoin"),K.stroke_linecap=x.getAttribute("stroke-linecap")}"text"===x.tagName&&(H.font_size=x.getAttribute("font-size"),H.font_family=x.getAttribute("font-family")),P.requestSelector(x).showGrips(!0)}if(ue(),f!==me||v!==ye)for(var C=g.length,S=0;S<C&&null!=g[S];++S)g[S].firstChild||P.requestSelector(g[S]).resize();else b=e.target,"path"===g[0].nodeName&&null==g[1]?_.select(g[0]):e.shiftKey&&t!==b&&i.removeFromSelection([b]);if(supportsNonScalingStroke()){var k=g[0];k&&(k.removeAttribute("style"),walkTree(k,function(e){e.removeAttribute("style")}))}}return;case"zoom":null!=ee&&ee.setAttribute("display","none");var $=e.shiftKey?.5:2;return void T("zoomed",{x:Math.min(me,f),y:Math.min(ye,v),width:Math.abs(f-me),height:Math.abs(v-ye),factor:$});case"fhpath":_e=0,xe={x:0,y:0},Ce={x:0,y:0},Se={x:0,y:0},we={x:0,y:0};var E=u.getAttribute("points"),N=E.indexOf(",");(d=N>=0?E.indexOf(",",N+1)>=0:E.indexOf(" ",E.indexOf(" ")+1)>=0)&&(u=_.smoothPolylineIntoPath(u));break;case"line":y=$$9(u).attr(["x1","x2","y1","y2"]),d=y.x1!==y.x2||y.y1!==y.y2;break;case"foreignObject":case"square":case"rect":case"image":y=$$9(u).attr(["width","height"]),d="0"!==y.width||"0"!==y.height||"image"===Q;break;case"circle":d="0"!==u.getAttribute("r");break;case"ellipse":y=$$9(u).attr(["rx","ry"]),d=null!=y.rx||null!=y.ry;break;case"fhellipse":fe.maxx-fe.minx>0&&fe.maxy-fe.miny>0&&(u=m({element:"ellipse",curStyles:!0,attr:{cx:(fe.minx+fe.maxx)/2,cy:(fe.miny+fe.maxy)/2,rx:(fe.maxx-fe.minx)/2,ry:(fe.maxy-fe.miny)/2,id:A()}}),T("changed",[u]),d=!0);break;case"fhrect":fe.maxx-fe.minx>0&&fe.maxy-fe.miny>0&&(u=m({element:"rect",curStyles:!0,attr:{x:fe.minx,y:fe.miny,width:fe.maxx-fe.minx,height:fe.maxy-fe.miny,id:A()}}),T("changed",[u]),d=!0);break;case"text":d=!0,de([u]),Te.start(u);break;case"path":u=null,W=!0;var G=_.mouseUp(e,u,r,s);u=G.element,d=G.keep;break;case"pathedit":d=!0,u=null,_.mouseUp(e);break;case"textedit":d=!1,u=null,Te.mouseUp(e,r,s);break;case"rotate":d=!0,u=null,Q="select";var L=i.undoMgr.finishUndoableChange();L.isEmpty()||w(L),ue(),T("changed",g)}var I=ae("mouseUp",{event:e,mouse_x:r,mouse_y:s},!0);if($$9.each(I,function(e,t){t&&(d=t.keep||d,u=t.element,W=t.started||W)}),d||null==u){if(null!=u){i.addedNew=!0;var M=.2,B=void 0;if(R.beginElement&&parseFloat(u.getAttribute("opacity"))!==p.opacity){B=$$9(R).clone().attr({to:p.opacity,dur:M}).appendTo(u);try{B[0].beginElement()}catch(e){}}else M=0;setTimeout(function(){B&&B.remove(),u.setAttribute("opacity",p.opacity),u.setAttribute("style","pointer-events:inherit"),cleanupElement(u),"path"===Q?_.toEditMode(u):a.selectNew&&de([u],!0),w(new InsertElementCommand$1(u)),T("changed",[u])},1e3*M)}}else{for(c().releaseId(A()),u.parentNode.removeChild(u),u=null,b=e.target;b&&b.parentNode&&b.parentNode.parentNode&&"g"===b.parentNode.parentNode.tagName;)b=b.parentNode;"path"===Q&&Ae||!b||!b.parentNode||"selectorParentGroup"===b.parentNode.id||"svgcanvas"===b.id||"svgroot"===b.id||(i.setMode("select"),de([b],!0))}Y=null}}}),$$9(t).bind("mousewheel DOMMouseScroll",function(e){if(e.shiftKey){e.preventDefault();var t=e.originalEvent;he=$$9("#svgcontent g")[0].getScreenCTM().inverse();var n=$$9("#workarea"),r=a.showRulers?16:0,s=transformPoint(t.pageX,t.pageY,he),o=n.width(),l=n.height(),u=o-15-r,c=l-15-r,d=u*he.a,f=c*he.d,p=n.offset(),g=p.left+r,v=p.top+r,m=t.wheelDelta?t.wheelDelta:t.detail?-t.detail:0;if(m){var y=Math.max(.75,Math.min(4/3,m)),b=void 0,_=void 0;y>1?(b=Math.ceil(u/d*y*100)/100,_=Math.ceil(c/f*y*100)/100):(b=Math.floor(u/d*y*100)/100,_=Math.floor(c/f*y*100)/100);var x=Math.min(b,_);if((x=Math.min(10,Math.max(.01,x)))!==h){y=x/h;var C=transformPoint(g,v,he),S={x:(s.x-(s.x-C.x)/y)*x-r+o/2,y:(s.y-(s.y-C.y)/y)*x-r+l/2};i.setZoom(x),$$9("#zoom").val((100*x).toFixed(1)),T("updateCanvas",{center:!1,newCtr:S}),T("zoomDone")}}}});var Te=i.textActions=function(){var e=void 0,t=void 0,n=void 0,a=void 0,r=void 0,s=[],l=void 0,u=void 0,c=void 0,d=void 0,f=void 0;function p(e){var i=""===t.value;if($$9(t).focus(),!arguments.length)if(i)e=0;else{if(t.selectionEnd!==t.selectionStart)return;e=t.selectionEnd}var o=s[e];i||t.setSelectionRange(e,e),(n=getElem("text_cursor"))||(n=document.createElementNS(NS.SVG,"line"),assignAttributes(n,{id:"text_cursor",stroke:"#333","stroke-width":1}),n=getElem("selectorParentGroup").appendChild(n)),r||(r=setInterval(function(){var e="none"===n.getAttribute("display");n.setAttribute("display",e?"inline":"none")},600));var u=x(o.x,l.y),c=x(o.x,l.y+l.height);assignAttributes(n,{x1:u.x,y1:u.y,x2:c.x,y2:c.y,visibility:"visible",display:"inline"}),a&&a.setAttribute("d","")}function v(e,r,i){if(e!==r){i||t.setSelectionRange(e,r),(a=getElem("text_selectblock"))||(a=document.createElementNS(NS.SVG,"path"),assignAttributes(a,{id:"text_selectblock",fill:"green",opacity:.5,style:"pointer-events:none"}),getElem("selectorParentGroup").appendChild(a));var o=s[e],u=s[r];n.setAttribute("visibility","hidden");var c=x(o.x,l.y),h=x(o.x+(u.x-o.x),l.y),d=x(o.x,l.y+l.height),f=x(o.x+(u.x-o.x),l.y+l.height),g="M"+c.x+","+c.y+" L"+h.x+","+h.y+" "+f.x+","+f.y+" "+d.x+","+d.y+"z";assignAttributes(a,{d:g,display:"inline"})}else p(r)}function m(t,n){var a=o.createSVGPoint();if(a.x=t,a.y=n,1===s.length)return 0;var r=e.getCharNumAtPosition(a);r<0?(r=s.length-2,t<=s[0].x&&(r=0)):r>=s.length-2&&(r=s.length-2);var i=s[r];return t>i.x+i.width/2&&r++,r}function y(e,t){p(m(e,t))}function b(e,n,a){var r=t.selectionStart,i=m(e,n);v(Math.min(r,i),Math.max(r,i),!a)}function _(e,t){var n={x:e,y:t};if(n.x/=h,n.y/=h,u){var a=transformPoint(n.x,n.y,u.inverse());n.x=a.x,n.y=a.y}return n}function x(e,t){var n={x:e,y:t};if(u){var a=transformPoint(n.x,n.y,u);n.x=a.x,n.y=a.y}return n.x*=h,n.y*=h,n}function C(t){v(0,e.textContent.length),$$9(this).unbind(t)}function S(t){if(f&&e){var n=transformPoint(t.pageX,t.pageY,he),a=_(n.x*h,n.y*h),r=m(a.x,a.y),i=e.textContent,s=i.substr(0,r).replace(/[a-z0-9]+$/i,"").length,o=i.substr(r).match(/^[a-z0-9]+/i);v(s,(o?o[0].length:0)+r),$$9(t.target).click(C),setTimeout(function(){$$9(t.target).unbind("click",C)},300)}}return{select:function(t,n,a){e=t,Te.toEditMode(n,a)},start:function(t){e=t,Te.toEditMode()},mouseDown:function(e,n,a,r){var i=_(a,r);t.focus(),y(i.x,i.y),c=a,d=r},mouseMove:function(e,t){var n=_(e,t);b(n.x,n.y)},mouseUp:function(t,n,a){var r=_(n,a);b(r.x,r.y,!0),t.target!==e&&n<c+2&&n>c-2&&a<d+2&&a>d-2&&Te.toSelectMode(!0)},setCursor:p,toEditMode:function(t,n){if(f=!1,Q="textedit",P.requestSelector(e).showGrips(!1),P.requestSelector(e),Te.init(),$$9(e).css("cursor","text"),arguments.length){var a=_(t,n);y(a.x,a.y)}else p();setTimeout(function(){f=!0},300)},toSelectMode:function(s){Q="select",clearInterval(r),r=null,a&&$$9(a).attr("display","none"),n&&$$9(n).attr("visibility","hidden"),$$9(e).css("cursor","move"),s&&(N(),$$9(e).css("cursor","move"),T("selected",[e]),G([e],!0)),e&&!e.textContent.length&&i.deleteSelectedElements(),$$9(t).blur(),e=!1},setInputElem:function(e){t=e},clear:function(){"textedit"===Q&&Te.toSelectMode()},init:function(n){if(e){var a=void 0,r=void 0;e.parentNode||(e=g[0],P.requestSelector(e).showGrips(!1));var o=e.textContent.length,c=e.getAttribute("transform");for(l=getBBox(e),u=c?getMatrix(e):null,(s=[]).length=o,t.focus(),$$9(e).unbind("dblclick",S).dblclick(S),o||(r={x:l.x+l.width/2,width:0}),a=0;a<o;a++){var d=e.getStartPositionOfChar(a);if(r=e.getEndPositionOfChar(a),!supportsGoodTextCharPos()){var f=i.contentW*h;d.x-=f,r.x-=f,d.x/=h,r.x/=h}s[a]={x:d.x,y:l.y,width:r.x-d.x,height:l.height}}s.push({x:r.x,width:0}),v(t.selectionStart,t.selectionEnd,!0)}}}}(),Ne=this.removeUnusedDefElems=function(){var e=l.getElementsByTagNameNS(NS.SVG,"defs");if(!e||!e.length)return 0;var t=[],n=0,a=["fill","stroke","filter","marker-start","marker-mid","marker-end"],r=a.length,i=l.getElementsByTagNameNS(NS.SVG,"*"),s=i.length,o=void 0,u=void 0;for(o=0;o<s;o++){var c=i[o];for(u=0;u<r;u++){var h=getUrlFromAttr(c.getAttribute(a[u]));h&&t.push(h.substr(1))}var d=getHref(c);d&&d.startsWith("#")&&t.push(d.substr(1))}var f=$$9(e).find("linearGradient, radialGradient, filter, marker, svg, symbol");for(o=f.length;o--;){var p=f[o],g=p.id;t.includes(g)||(q[g]=p,p.parentNode.removeChild(p),n++)}return n};function Ge(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).codesOnly,t=void 0!==e&&e;N();var n=[],a={feGaussianBlur:M.exportNoBlur,foreignObject:M.exportNoforeignObject,"[stroke-dasharray]":M.exportNoDashArray},r=$$9(l);return"font"in $$9("<canvas>")[0].getContext("2d")||(a.text=M.exportNoText),$$9.each(a,function(e,a){r.find(e).length&&n.push(t?e:a)}),n}this.svgCanvasToString=function(){for(;Ne()>0;);_.clear(!0),$$9.each(l.childNodes,function(e,t){e&&8===t.nodeType&&t.data.includes("Created with")&&l.insertBefore(t,l.firstChild)}),d&&(leaveContext(),de([d]));var e=[];$$9(l).find("g:data(gsvg)").each(function(){for(var t=this.attributes,n=t.length,a=0;a<n;a++)"id"!==t[a].nodeName&&"style"!==t[a].nodeName||n--;if(n<=0){var r=this.firstChild;e.push(r),$$9(this).replaceWith(r)}});var t=this.svgToString(l,0);return e.length&&$$9(e).each(function(){se(this)}),t},this.svgToString=function(e,t){var n=[],r=a.baseUnit,i=new RegExp("^-?[\\d\\.]+"+r+"$");if(e){cleanupElement(e);var s=e.attributes,o=void 0,l=void 0,u=e.childNodes;for(l=0;l<t;l++)n.push(" ");if(n.push("<"),n.push(e.nodeName),"svgcontent"===e.id){var c=Oe();"px"!==r&&(c.w=convertUnit(c.w,r)+r,c.h=convertUnit(c.h,r)+r),n.push(' width="'+c.w+'" height="'+c.h+'" xmlns="'+NS.SVG+'"');var h={};$$9(e).find("*").andSelf().each(function(){var e=this.namespaceURI;e&&!h[e]&&C[e]&&"xmlns"!==C[e]&&"xml"!==C[e]&&(h[e]=!0,n.push(" xmlns:"+C[e]+'="'+e+'"')),$$9.each(this.attributes,function(e,t){var a=t.namespaceURI;a&&!h[a]&&"xmlns"!==C[a]&&"xml"!==C[a]&&(h[a]=!0,n.push(" xmlns:"+C[a]+'="'+a+'"'))})}),l=s.length;for(var d=["width","height","xmlns","x","y","viewBox","id","overflow"];l--;){o=s.item(l);var f=toXml(o.value);o.nodeName.startsWith("xmlns:")||(""===f||d.includes(o.localName)||o.namespaceURI&&!C[o.namespaceURI]||(n.push(" "),n.push(o.nodeName),n.push('="'),n.push(f),n.push('"')))}}else{if("defs"===e.nodeName&&!e.firstChild)return;var p=["-moz-math-font-style","_moz-math-font-style"];for(l=s.length-1;l>=0;l--){o=s.item(l);var g=toXml(o.value);if(!p.includes(o.localName)&&""!==g){if(g.startsWith("pointer-events"))continue;if("class"===o.localName&&g.startsWith("se_"))continue;if(n.push(" "),"d"===o.localName&&(g=_.convertPath(e,!0)),isNaN(g)?i.test(g)&&(g=shortFloat(g)+r):g=shortFloat(g),F.apply&&"image"===e.nodeName&&"href"===o.localName&&F.images&&"embed"===F.images){var v=D[g];v&&(g=v)}o.namespaceURI&&o.namespaceURI!==NS.SVG&&!C[o.namespaceURI]||(n.push(o.nodeName),n.push('="'),n.push(g),n.push('"'))}}}if(e.hasChildNodes()){n.push(">"),t++;var m=!1;for(l=0;l<u.length;l++){var y=u.item(l);switch(y.nodeType){case 1:n.push("\n"),n.push(this.svgToString(u.item(l),t));break;case 3:var b=y.nodeValue.replace(/^\s+|\s+$/g,"");""!==b&&(m=!0,n.push(String(toXml(b))));break;case 4:n.push("\n"),n.push(new Array(t+1).join(" ")),n.push("<![CDATA["),n.push(y.nodeValue),n.push("]]>");break;case 8:n.push("\n"),n.push(new Array(t+1).join(" ")),n.push("\x3c!--"),n.push(y.data),n.push("--\x3e")}}if(t--,!m)for(n.push("\n"),l=0;l<t;l++)n.push(" ");n.push("</"),n.push(e.nodeName),n.push(">")}else n.push("/>")}return n.join("")},this.embedImage=function(e,t){$$9(new Image).load(function(){var n=document.createElement("canvas");n.width=this.width,n.height=this.height,n.getContext("2d").drawImage(this,0,0);try{var a=";svgedit_url="+encodeURIComponent(e);a=n.toDataURL().replace(";base64",a+";base64"),D[e]=a}catch(t){D[e]=!1}X=e,t&&t(D[e])}).attr("src",e)},this.setGoodImage=function(e){X=e},this.open=function(){},this.save=function(e){N(),e&&$$9.extend(F,e),F.apply=!0;var t=this.svgCanvasToString();T("saved",t)},this.rasterExport=function(e,t,n){var a="image/"+e.toLowerCase(),r=Ge(),s=Ge({codesOnly:!0}),o=this.svgCanvasToString();buildCanvgCallback(function(){var l=e||"PNG";$$9("#export_canvas").length||$$9("<canvas>",{id:"export_canvas"}).hide().appendTo("body");var u=$$9("#export_canvas")[0];u.width=i.contentW,u.height=i.contentH,canvg(u,o,{renderCallback:function(){var i=("ICO"===l?"BMP":l).toLowerCase(),c=t?u.toDataURL("image/"+i,t):u.toDataURL("image/"+i);if(u.toBlob)u.toBlob(function(i){var l=createObjectURL(i);T("exported",{datauri:c,bloburl:l,svg:o,issues:r,issueCodes:s,type:e,mimeType:a,quality:t,exportWindowName:n})},a,t);else{var h=dataURLToObjectURL(c);T("exported",{datauri:c,bloburl:h,svg:o,issues:r,issueCodes:s,type:e,mimeType:a,quality:t,exportWindowName:n})}}})})()},this.exportPDF=function(e,t){var n=this;buildJSPDFCallback(function(){var a=Oe(),r=a.w>a.h?"landscape":"portrait",i=jsPDF({orientation:r,unit:"pt",format:[a.w,a.h]}),s=Ve();i.setProperties({title:s});var o=Ge(),l=Ge({codesOnly:!0}),u=n.svgCanvasToString();i.addSVG(u,0,0);var c={svg:u,issues:o,issueCodes:l,exportWindowName:e},h=t||"dataurlstring";c[h]=i.output(h),T("exportedPDF",c)})()},this.getSvgString=function(){return F.apply=!1,this.svgCanvasToString()},this.randomizeIds=function(e){arguments.length>0&&!1===e?randomizeIds(!1,c()):randomizeIds(!0,c())};var Le=this.uniquifyElems=function(e){var t={},n=["filter","linearGradient","pattern","radialGradient","symbol","textPath","use"];for(var a in walkTree(e,function(e){if(1===e.nodeType){e.id&&(e.id in t||(t[e.id]={elem:null,attrs:[],hrefs:[]}),t[e.id].elem=e),$$9.each(O,function(n,a){var r=e.getAttributeNode(a);if(r){var i=getUrlFromAttr(r.value),s=i?i.substr(1):null;s&&(s in t||(t[s]={elem:null,attrs:[],hrefs:[]}),t[s].attrs.push(r))}});var a=getHref(e);if(a&&n.includes(e.nodeName)){var r=a.substr(1);r&&(r in t||(t[r]={elem:null,attrs:[],hrefs:[]}),t[r].hrefs.push(e))}}}),t)if(a){var r=t[a].elem;if(r){var i=E();r.id=i;for(var s=t[a].attrs,o=s.length;o--;){var l=s[o];l.ownerElement.setAttribute(l.name,"url(#"+i+")")}for(var u=t[a].hrefs,c=u.length;c--;){var h=u[c];setHref(h,"#"+i)}}}},Ie=this.setUseData=function(e){var t=$$9(e);"use"!==e.tagName&&(t=t.find("use")),t.each(function(){var e=getHref(this).substr(1),t=getElem(e);t&&($$9(this).data("ref",t),"symbol"!==t.tagName&&"svg"!==t.tagName||$$9(this).data("symbol",t).data("ref",t))})},Me=this.convertGradients=function(e){var t=$$9(e).find("linearGradient, radialGradient");!t.length&&isWebkit()&&(t=$$9(e).find("*").filter(function(){return this.tagName.includes("Gradient")})),t.each(function(){if("userSpaceOnUse"===$$9(this).attr("gradientUnits")){var e=$$9(l).find('[fill="url(#'+this.id+')"],[stroke="url(#'+this.id+')"]');if(!e.length)return;var t=getBBox(e[0]);if(!t)return;if("linearGradient"===this.tagName){var n=$$9(this).attr(["x1","y1","x2","y2"]),a=this.gradientTransform.baseVal;if(a&&a.numberOfItems>0){var r=transformListToTransform(a).matrix,i=transformPoint(n.x1,n.y1,r),s=transformPoint(n.x2,n.y2,r);n.x1=i.x,n.y1=i.y,n.x2=s.x,n.y2=s.y,this.removeAttribute("gradientTransform")}$$9(this).attr({x1:(n.x1-t.x)/t.width,y1:(n.y1-t.y)/t.height,x2:(n.x2-t.x)/t.width,y2:(n.y2-t.y)/t.height}),this.removeAttribute("gradientUnits")}}})},Be=this.convertToGroup=function(e){e||(e=g[0]);var t=$$9(e),n=new BatchCommand$1,a=void 0;if(t.data("gsvg")){var r=e.firstChild,i=$$9(r).attr(["x","y"]);$$9(e.firstChild.firstChild).unwrap(),$$9(e).removeData("gsvg");var u=getTransformList(e),c=o.createSVGTransform();c.setTranslate(i.x,i.y),u.appendItem(c),recalculateDimensions(e),T("selected",[e])}else if(t.data("symbol")){e=t.data("symbol"),a=t.attr("transform");var h=t.attr(["x","y"]),d=e.getAttribute("viewBox");if(d){var f=d.split(" ");h.x-=+f[0],h.y-=+f[1]}a+=" translate("+(h.x||0)+","+(h.y||0)+")";var p=t.prev();n.addSubCommand(new RemoveElementCommand$1(t[0],t[0].nextSibling,t[0].parentNode)),t.remove();var v=$$9(l).find("use:data(symbol)").length,m=s.createElementNS(NS.SVG,"g"),y=e.childNodes,b=void 0;for(b=0;b<y.length;b++)m.appendChild(y[b].cloneNode(!0));if(isGecko()){var _=$$9(findDefs()).children("linearGradient,radialGradient,pattern").clone();$$9(m).append(_)}a&&m.setAttribute("transform",a);var x=e.parentNode;if(Le(m),isGecko()&&$$9(findDefs()).append($$9(m).find("linearGradient,radialGradient,pattern")),m.id=E(),p.after(m),x){if(!v){var C=e.nextSibling;x.removeChild(e),n.addSubCommand(new RemoveElementCommand$1(e,C,x))}n.addSubCommand(new InsertElementCommand$1(m))}Ie(m),isGecko()?Me(findDefs()):Me(m),walkTreePost(m,function(e){try{recalculateDimensions(e)}catch(e){console.log(e)}}),$$9(m).find(B).each(function(){this.id||(this.id=E())}),de([m]);var S=Ue(m,!0);S&&n.addSubCommand(S),w(n)}else console.log("Unexpected element to ungroup:",e)};this.setSvgString=function(e,t){try{var n=text2xml(e);if(n.firstElementChild&&n.firstElementChild.namespaceURI!==NS.SVG)return!1;this.prepareSvg(n);var r=new BatchCommand$1("Change Source"),d=l.nextSibling,f=o.removeChild(l);r.addSubCommand(new RemoveElementCommand$1(f,d,o)),l=s.adoptNode?s.adoptNode(n.documentElement):s.importNode(n.documentElement,!0),o.appendChild(l);var p=$$9(l);i.current_drawing_=new Drawing(l,u);var g=c().getNonce();g?T("setnonce",g):T("unsetnonce"),p.find("image").each(function(){var e=this;preventClickDefault(e);var t=getHref(this);if(t){if(t.startsWith("data:")){var n=t.match(/svgedit_url=(.*?);/);if(n){var a=decodeURIComponent(n[1]);$$9(new Image).load(function(){e.setAttributeNS(NS.XLINK,"xlink:href",a)}).attr("src",a)}}i.embedImage(t)}}),p.find("svg").each(function(){if(!$$9(this).closest("defs").length){Le(this);var e=this.parentNode;1===e.childNodes.length&&"g"===e.nodeName?($$9(e).data("gsvg",this),e.id=e.id||E()):se(this)}}),isGecko()&&p.find("linearGradient, radialGradient, pattern").appendTo(findDefs()),Ie(p),Me(p[0]);var v={id:"svgcontent",overflow:a.show_outside_canvas?"visible":"hidden"},m=!1;if(p.attr("viewBox")){var y=p.attr("viewBox").split(" ");v.width=y[2],v.height=y[3]}else $$9.each(["width","height"],function(e,t){var n=p.attr(t)||"100%";"%"===String(n).substr(-1)?m=!0:v[t]=convertToNum(t,n)});if(identifyLayers(),p.children().find(B).each(function(){this.id||(this.id=E())}),m){var b=getStrokedBBoxDefaultVisible();v.width=b.width+b.x,v.height=b.height+b.y}v.width<=0&&(v.width=100),v.height<=0&&(v.height=100),p.attr(v),this.contentW=v.width,this.contentH=v.height,r.addSubCommand(new InsertElementCommand$1(l));var _=p.attr(["width","height"]);r.addSubCommand(new ChangeElementCommand$1(o,_)),h=1,resetListMap(),N(),clearData(),o.appendChild(P.selectorParentGroup),t||w(r),T("changed",[l])}catch(e){return console.log(e),!1}return!0},this.importSvgString=function(e){var t=void 0,n=void 0,a=void 0;try{var r=encode64(e.length+e).substr(0,32),i=!1;U[r]&&$$9(U[r].symbol).parents("#svgroot").length&&(i=!0);var o=new BatchCommand$1("Import Image"),u=void 0;if(i)u=U[r].symbol,n=U[r].xform;else{var h=text2xml(e);this.prepareSvg(h);var f=void 0;f=s.adoptNode?s.adoptNode(h.documentElement):s.importNode(h.documentElement,!0),Le(f);var p=convertToNum("width",f.getAttribute("width")),g=convertToNum("height",f.getAttribute("height")),v=f.getAttribute("viewBox"),m=v?v.split(" "):[0,0,p,g];for(t=0;t<4;++t)m[t]=+m[t];var y=+l.getAttribute("height");n="translate(0) "+(n=g>p?"scale("+y/3/m[3]+")":"scale("+y/3/m[2]+")")+" translate(0)",u=s.createElementNS(NS.SVG,"symbol");var b=findDefs();for(isGecko()&&$$9(f).find("linearGradient, radialGradient, pattern").appendTo(b);f.firstChild;){var _=f.firstChild;u.appendChild(_)}for(var x=f.attributes,C=0;C<x.length;C++){var S=x[C];u.setAttribute(S.nodeName,S.value)}u.id=E(),U[r]={symbol:u,xform:n},findDefs().appendChild(u),o.addSubCommand(new InsertElementCommand$1(u))}(a=s.createElementNS(NS.SVG,"use")).id=E(),setHref(a,"#"+u.id),(d||c().getCurrentLayer()).appendChild(a),o.addSubCommand(new InsertElementCommand$1(a)),N(),a.setAttribute("transform",n),recalculateDimensions(a),$$9(a).data("symbol",u).data("ref",u),G([a]),w(o),T("changed",[l])}catch(e){return console.log(e),null}return a},["identifyLayers","createLayer","cloneLayer","deleteCurrentLayer","setCurrentLayer","renameCurrentLayer","setCurrentLayerPosition","setLayerVisibility","moveSelectedToLayer","mergeLayer","mergeAllLayers","leaveContext","setContext"].forEach(function(e){i[e]=draw[e]}),init$3({pathActions:_,getCurrentGroup:function(){return d},setCurrentGroup:function(e){d=e},getSelectedElements:b,getSVGContent:y,undoMgr:S,elData:V,getCurrentDrawing:c,clearSelection:N,call:T,addCommandToHistory:w,changeSvgcontent:function(){T("changed",[l])}}),this.clear=function(){_.clear(),N(),i.clearSvgContentElement(),i.current_drawing_=new Drawing(l),i.createLayer("Layer 1"),i.undoMgr.resetUndoStack(),P.initGroup(),ee=P.getRubberBandBox(),T("cleared")},this.linkControlPoints=_.linkControlPoints,this.getContentElem=function(){return l},this.getRootElem=function(){return o};var Oe=this.getResolution=function(){return{w:l.getAttribute("width")/h,h:l.getAttribute("height")/h,zoom:h}};this.getSnapToGrid=function(){return a.gridSnapping},this.getVersion=function(){return"svgcanvas.js ($Rev$)"},this.setUiStrings=function(e){Object.assign(M,e.notification),setUiStrings(e)},this.setConfig=function(e){Object.assign(a,e)},this.getTitle=function(e){if(e=e||g[0]){for(var t=(e=$$9(e).data("gsvg")||$$9(e).data("symbol")||e).childNodes,n=0;n<t.length;n++)if("title"===t[n].nodeName)return t[n].textContent;return""}},this.setGroupTitle=function(e){var t=g[0];t=$$9(t).data("gsvg")||t;var n=$$9(t).children("title"),a=new BatchCommand$1("Set Label"),r=void 0;if(e.length)n.length?(r=n[0],a.addSubCommand(new ChangeElementCommand$1(r,{"#text":r.textContent})),r.textContent=e):((r=s.createElementNS(NS.SVG,"title")).textContent=e,$$9(t).prepend(r),a.addSubCommand(new InsertElementCommand$1(r)));else{var i=n.nextSibling;a.addSubCommand(new RemoveElementCommand$1(n[0],i,t)),n.remove()}w(a)};var Ve=this.getDocumentTitle=function(){return i.getTitle(l)};this.setDocumentTitle=function(e){for(var t=l.childNodes,n=!1,a="",r=new BatchCommand$1("Change Image Title"),i=0;i<t.length;i++)if("title"===t[i].nodeName){a=(n=t[i]).textContent;break}n||(n=s.createElementNS(NS.SVG,"title"),l.insertBefore(n,l.firstChild)),e.length?n.textContent=e:n.parentNode.removeChild(n),r.addSubCommand(new ChangeElementCommand$1(n,{"#text":a})),w(r)},this.getEditorNS=function(e){return e&&l.setAttribute("xmlns:se",NS.SE),NS.SE},this.setResolution=function(e,t){var n=Oe(),a=n.w,r=n.h,s=void 0;if("fit"===e){var o=getStrokedBBoxDefaultVisible();if(!o)return!1;s=new BatchCommand$1("Fit Canvas to Content");var u=getVisibleElements();G(u);var c=[],d=[];$$9.each(u,function(e,t){c.push(-1*o.x),d.push(-1*o.y)});var f=i.moveSelectedElements(c,d,!0);s.addSubCommand(f),N(),e=Math.round(o.width),t=Math.round(o.height)}return e===a&&t===r||(s||(s=new BatchCommand$1("Change Image Dimensions")),e=convertToNum("width",e),t=convertToNum("height",t),l.setAttribute("width",e),l.setAttribute("height",t),this.contentW=e,this.contentH=t,s.addSubCommand(new ChangeElementCommand$1(l,{width:a,height:r})),l.setAttribute("viewBox",[0,0,e/h,t/h].join(" ")),s.addSubCommand(new ChangeElementCommand$1(l,{viewBox:["0 0",a,r].join(" ")})),w(s),T("changed",[l])),!0},this.getOffset=function(){return $$9(l).attr(["x","y"])},this.setBBoxZoom=function(e,t,n){var a=.85,r=void 0,s=function(e){if(!e)return!1;var r=Math.round(t/e.width*100*a)/100,s=Math.round(n/e.height*100*a)/100,o=Math.min(r,s);return i.setZoom(o),{zoom:o,bbox:e}};if("object"===(void 0===e?"undefined":_typeof(e))){if(0===(r=e).width||0===r.height){var o=r.zoom?r.zoom:h*r.factor;return i.setZoom(o),{zoom:h,bbox:r}}return s(r)}switch(e){case"selection":if(!g[0])return;var l=$$9.map(g,function(e){if(e)return e});r=getStrokedBBoxDefaultVisible(l);break;case"canvas":var u=Oe();a=.95,r={width:u.w,height:u.h,x:0,y:0};break;case"content":r=getStrokedBBoxDefaultVisible();break;case"layer":r=getStrokedBBoxDefaultVisible(getVisibleElements(c().getCurrentLayer()));break;default:return}return s(r)},this.setZoom=function(e){var t=Oe();l.setAttribute("viewBox","0 0 "+t.w/e+" "+t.h/e),h=e,$$9.each(g,function(e,t){t&&P.requestSelector(t).resize()}),_.zoomChange(),ae("zoomChanged",e)},this.getMode=function(){return Q},this.setMode=function(e){_.clear(!0),Te.clear(),K=g[0]&&"text"===g[0].nodeName?H:p,Q=e},this.getColor=function(e){return K[e]},this.setColor=function(e,t,n){p[e]=t,K[e+"_paint"]={type:"solidColor"};var a=[];function r(e){"g"!==e.nodeName&&a.push(e)}for(var i=g.length;i--;){var s=g[i];s&&("g"===s.tagName?walkTree(s,r):"fill"===e?"polyline"!==s.tagName&&"line"!==s.tagName&&a.push(s):a.push(s))}a.length>0&&(n?De(e,t,a):(Fe(e,t,a),T("changed",a)))};var Re=this.setGradient=function(e){if(K[e+"_paint"]&&"solidColor"!==K[e+"_paint"].type){var t=i[e+"Grad"],n=je(t),a=findDefs();n?t=n:(t=a.appendChild(s.importNode(t,!0))).id=E(),i.setColor(e,"url(#"+t.id+")")}},je=function(e){for(var t=findDefs(),n=$$9(t).find("linearGradient, radialGradient"),a=n.length,r=["r","cx","cy","fx","fy"];a--;){var i=n[a];if("linearGradient"===e.tagName){if(e.getAttribute("x1")!==i.getAttribute("x1")||e.getAttribute("y1")!==i.getAttribute("y1")||e.getAttribute("x2")!==i.getAttribute("x2")||e.getAttribute("y2")!==i.getAttribute("y2"))continue}else if("continue"===function(){var t=$$9(e).attr(r),n=$$9(i).attr(r),a=!1;if($$9.each(r,function(e,r){t[r]!==n[r]&&(a=!0)}),a)return"continue"}())continue;var s=e.getElementsByTagNameNS(NS.SVG,"stop"),o=i.getElementsByTagNameNS(NS.SVG,"stop");if(s.length===o.length){for(var l=s.length;l--;){var u=s[l],c=o[l];if(u.getAttribute("offset")!==c.getAttribute("offset")||u.getAttribute("stop-opacity")!==c.getAttribute("stop-opacity")||u.getAttribute("stop-color")!==c.getAttribute("stop-color"))break}if(-1===l)return i}}return null};this.setPaint=function(e,t){var n=new $$9.jGraduate.Paint(t);switch(this.setPaintOpacity(e,n.alpha/100,!0),K[e+"_paint"]=n,n.type){case"solidColor":this.setColor(e,"none"!==n.solidColor?"#"+n.solidColor:"none");break;case"linearGradient":case"radialGradient":i[e+"Grad"]=n[n.type],Re(e)}},this.setStrokePaint=function(e){this.setPaint("stroke",e)},this.setFillPaint=function(e){this.setPaint("fill",e)},this.getStrokeWidth=function(){return K.stroke_width},this.setStrokeWidth=function(e){if(0===e&&["line","path"].includes(Q))i.setStrokeWidth(1);else{K.stroke_width=e;for(var t=[],n=g.length;n--;){var a=g[n];a&&("g"===a.tagName?walkTree(a,r):t.push(a))}t.length>0&&(Fe("stroke-width",e,t),T("changed",g))}function r(e){"g"!==e.nodeName&&t.push(e)}},this.setStrokeAttr=function(e,t){p[e.replace("-","_")]=t;for(var n=[],a=g.length;a--;){var r=g[a];r&&("g"===r.tagName?walkTree(r,function(e){"g"!==e.nodeName&&n.push(e)}):n.push(r))}n.length>0&&(Fe(e,t,n),T("changed",g))},this.getStyle=function(){return p},this.getOpacity=L,this.setOpacity=function(e){p.opacity=e,Fe("opacity",e)},this.getFillOpacity=function(){return p.fill_opacity},this.getStrokeOpacity=function(){return p.stroke_opacity},this.setPaintOpacity=function(e,t,n){p[e+"_opacity"]=t,n?De(e+"-opacity",t):Fe(e+"-opacity",t)},this.getPaintOpacity=function(e){return"fill"===e?this.getFillOpacity():this.getStrokeOpacity()},this.getBlur=function(e){var t=0;if(e&&e.getAttribute("filter")){var n=getElem(e.id+"_blur");n&&(t=n.firstChild.getAttribute("stdDeviation"))}return t},function(){var e=null,t=null,n=!1;function a(){var n=i.undoMgr.finishUndoableChange();e.addSubCommand(n),w(e),e=null,t=null}i.setBlurNoUndo=function(e){if(t)if(0===e)De("filter",""),n=!0;else{var a=g[0];n&&De("filter","url(#"+a.id+"_blur)"),isWebkit()&&(console.log("e",a),a.removeAttribute("filter"),a.setAttribute("filter","url(#"+a.id+"_blur)")),De("stdDeviation",e,[t.firstChild]),i.setBlurOffsets(t,e)}else i.setBlur(e)},i.setBlurOffsets=function(e,t){t>3?assignAttributes(e,{x:"-50%",y:"-50%",width:"200%",height:"200%"},100):isWebkit()||(e.removeAttribute("x"),e.removeAttribute("y"),e.removeAttribute("width"),e.removeAttribute("height"))},i.setBlur=function(n,r){if(e)a();else{var s=g[0],o=s.id;t=getElem(o+"_blur"),n-=0;var l=new BatchCommand$1;if(t)0===n&&(t=null);else{var u=m({element:"feGaussianBlur",attr:{in:"SourceGraphic",stdDeviation:n}});(t=m({element:"filter",attr:{id:o+"_blur"}})).appendChild(u),findDefs().appendChild(t),l.addSubCommand(new InsertElementCommand$1(t))}var c={filter:s.getAttribute("filter")};if(0===n)return s.removeAttribute("filter"),void l.addSubCommand(new ChangeElementCommand$1(s,c));Fe("filter","url(#"+o+"_blur)"),l.addSubCommand(new ChangeElementCommand$1(s,c)),i.setBlurOffsets(t,n),e=l,i.undoMgr.beginUndoableChange("stdDeviation",[t?t.firstChild:null]),r&&(i.setBlurNoUndo(n),a())}}}(),this.getBold=function(){var e=g[0];return null!=e&&"text"===e.tagName&&null==g[1]&&"bold"===e.getAttribute("font-weight")},this.setBold=function(e){var t=g[0];null!=t&&"text"===t.tagName&&null==g[1]&&Fe("font-weight",e?"bold":"normal"),g[0].textContent||Te.setCursor()},this.getItalic=function(){var e=g[0];return null!=e&&"text"===e.tagName&&null==g[1]&&"italic"===e.getAttribute("font-style")},this.setItalic=function(e){var t=g[0];null!=t&&"text"===t.tagName&&null==g[1]&&Fe("font-style",e?"italic":"normal"),g[0].textContent||Te.setCursor()},this.getFontFamily=function(){return H.font_family},this.setFontFamily=function(e){H.font_family=e,Fe("font-family",e),g[0]&&!g[0].textContent&&Te.setCursor()},this.setFontColor=function(e){H.fill=e,Fe("fill",e)},this.getFontColor=function(){return H.fill},this.getFontSize=function(){return H.font_size},this.setFontSize=function(e){H.font_size=e,Fe("font-size",e),g[0].textContent||Te.setCursor()},this.getText=function(){var e=g[0];return null==e?"":e.textContent},this.setTextContent=function(e){Fe("#text",e),Te.init(e),Te.setCursor()},this.setImageURL=function(e){var t=g[0];if(t){var n=$$9(t).attr(["width","height"]),a=!n.width||!n.height,r=getHref(t);if(r!==e)a=!0;else if(!a)return;var i=new BatchCommand$1("Change Image URL");setHref(t,e),i.addSubCommand(new ChangeElementCommand$1(t,{"#href":r})),a?$$9(new Image).load(function(){var e=$$9(t).attr(["width","height"]);$$9(t).attr({width:this.width,height:this.height}),P.requestSelector(t).resize(),i.addSubCommand(new ChangeElementCommand$1(t,e)),w(i),T("changed",[t])}).attr("src",e):w(i)}},this.setLinkURL=function(e){var t=g[0];if(t){if("a"!==t.tagName){var n=$$9(t).parents("a");if(!n.length)return;t=n[0]}var a=getHref(t);if(a!==e){var r=new BatchCommand$1("Change Link URL");setHref(t,e),r.addSubCommand(new ChangeElementCommand$1(t,{"#href":a})),w(r)}}},this.setRectRadius=function(e){var t=g[0];if(null!=t&&"rect"===t.tagName){var n=t.getAttribute("rx");n!==String(e)&&(t.setAttribute("rx",e),t.setAttribute("ry",e),w(new ChangeElementCommand$1(t,{rx:n,ry:n},"Radius")),T("changed",[t]))}},this.makeHyperlink=function(e){i.groupSelectedElements("a",e)},this.removeHyperlink=function(){i.ungroupSelectedElement()},this.setSegType=function(e){_.setSegType(e)},this.convertToPath=function(e,t){if(null!=e){if(t)return getBBoxOfElementAsPath(e,m,_);var n={fill:p.fill,"fill-opacity":p.fill_opacity,stroke:p.stroke,"stroke-width":p.stroke_width,"stroke-dasharray":p.stroke_dasharray,"stroke-linejoin":p.stroke_linejoin,"stroke-linecap":p.stroke_linecap,"stroke-opacity":p.stroke_opacity,opacity:p.opacity,visibility:"hidden"};return convertToPath(e,n,m,_,N,G,history,w)}var a=g;$$9.each(a,function(e,t){t&&i.convertToPath(t)})};var De=function(e,t,n){"pathedit"===Q&&_.moveNode(e,t);for(var a=(n=n||g).length,r=["g","polyline","path"],s=["transform","opacity","filter"],l=function(){var l=n[a];if(null==l)return"continue";if(("x"===e||"y"===e)&&r.includes(l.tagName)){var u=getStrokedBBoxDefaultVisible([l]),c="x"===e?t-u.x:0,d="y"===e?t-u.y:0;return i.moveSelectedElements(c*h,d*h,!0),"continue"}"g"===l.tagName&&s.includes(e);var f="#text"===e?l.textContent:l.getAttribute(e);if(null==f&&(f=""),f!==String(t)){"#text"===e?(l.textContent=t,/rotate/.test(l.getAttribute("transform"))&&(l=le(l))):"#href"===e?setHref(l,t):l.setAttribute(e,t),"textedit"===Q&&"#text"!==e&&l.textContent.length&&Te.toSelectMode(l),isGecko()&&"text"===l.nodeName&&/rotate/.test(l.getAttribute("transform"))&&(String(t).startsWith("url")||["font-size","font-family","x","y"].includes(e)&&l.textContent)&&(l=le(l)),g.includes(l)&&setTimeout(function(){l.parentNode&&P.requestSelector(l).resize()},0);var p=getRotationAngle(l);if(0!==p&&"transform"!==e)for(var v=getTransformList(l),m=v.numberOfItems;m--;){if(4===v.getItem(m).type){v.removeItem(m);var y=getBBox(l),b=transformPoint(y.x+y.width/2,y.y+y.height/2,transformListToTransform(v).matrix),_=b.x,x=b.y,C=o.createSVGTransform();C.setRotate(p,_,x),v.insertItemBefore(C,m);break}}}};a--;)l()},Fe=this.changeSelectedAttribute=function(e,t,n){n=n||g,i.undoMgr.beginUndoableChange(e,n),De(e,t,n);var a=i.undoMgr.finishUndoableChange();a.isEmpty()||w(a)};this.deleteSelectedElements=function(){for(var e=new BatchCommand$1("Delete Elements"),t=g.length,n=[],a=0;a<t;++a){var r=g[a];if(null==r)break;var i=r.parentNode,s=r;P.releaseSelector(s),removePath_(s.id),"a"===i.tagName&&1===i.childNodes.length&&(s=i,i=i.parentNode);var o=s.nextSibling,l=i.removeChild(s);n.push(r),e.addSubCommand(new RemoveElementCommand$1(l,o,i))}g=[],e.isEmpty()||w(e),T("changed",n),N()},this.cutSelectedElements=function(){i.copySelectedElements(),i.deleteSelectedElements()},this.copySelectedElements=function(){localStorage.setItem("svgedit_clipboard",JSON.stringify(g.map(function(e){return v(e)}))),$$9("#cmenu_canvas").enableContextMenuItems("#paste,#paste_in_place")},this.pasteElements=function(e,t,n){var a=JSON.parse(localStorage.getItem("svgedit_clipboard")),r=a.length;if(r){var s=[],o=new BatchCommand$1("Paste elements"),l={};for(a.forEach(function e(t){t.attr&&t.attr.id&&(l[t.attr.id]=E(),t.attr.id=l[t.attr.id]),t.children&&t.children.forEach(e)}),ae("IDsUpdated",{elems:a,changes:l},!0).forEach(function(e){e&&"remove"in e&&e.remove.forEach(function(e){a=a.filter(function(t){return t.attr.id!==e})})});r--;){var u=a[r];if(u){var c=m(u);s.push(c),o.addSubCommand(new InsertElementCommand$1(c)),j(c)}}if(de(s),"in_place"!==e){var h=void 0,d=void 0;e?"point"===e&&(h=t,d=n):(h=ne.x,d=ne.y);var f=getStrokedBBoxDefaultVisible(s),p=h-(f.x+f.width/2),g=d-(f.y+f.height/2),v=[],y=[];$$9.each(s,function(e,t){v.push(p),y.push(g)});var b=i.moveSelectedElements(v,y,!1);b&&o.addSubCommand(b)}w(o),T("changed",s)}},this.groupSelectedElements=function(e,t){e||(e="g");var n="",a=void 0;switch(e){case"a":n="Make hyperlink",a="",arguments.length>1&&(a=t);break;default:e="g",n="Group Elements"}var r=new BatchCommand$1(n),i=m({element:e,attr:{id:E()}});"a"===e&&setHref(i,a),r.addSubCommand(new InsertElementCommand$1(i));for(var s=g.length;s--;){var o=g[s];if(null!=o){"a"===o.parentNode.tagName&&1===o.parentNode.childNodes.length&&(o=o.parentNode);var l=o.nextSibling,u=o.parentNode;i.appendChild(o),r.addSubCommand(new MoveElementCommand$1(o,l,u))}}r.isEmpty()||w(r),de([i],!0)};var Ue=this.pushGroupProperties=function(e,t){for(var n=e.childNodes,a=n.length,r=e.getAttribute("transform"),s=getTransformList(e),l=transformListToTransform(s).matrix,u=new BatchCommand$1("Push group properties"),h=getRotationAngle(e),d=$$9(e).attr(["filter","opacity"]),f=void 0,p=void 0,g=void 0,v=c(),m=0;m<a;m++){var y=n[m];if(1===y.nodeType){if(null!==d.opacity&&1!==d.opacity){var b=Math.round((y.getAttribute("opacity")||1)*d.opacity*100)/100;Fe("opacity",b,[y])}if(d.filter){var _=this.getBlur(y),x=_;p||(p=this.getBlur(e)),_?_=Number(p)+Number(_):0===_&&(_=p),x?f=getRefElem(y.getAttribute("filter")):f?(f=v.copyElem(f),findDefs().appendChild(f)):f=getRefElem(d.filter);var C="feGaussianBlur"===f.firstChild.tagName?"blur":"filter";f.id=y.id+"_"+C,Fe("filter","url(#"+f.id+")",[y]),_&&(Fe("stdDeviation",_,[f.firstChild]),i.setBlurOffsets(f,_))}var S=getTransformList(y);if(y.tagName.includes("Gradient")&&(S=null),S&&"defs"!==y.tagName&&s.numberOfItems){if(h&&1===s.numberOfItems){var w=s.getItem(0).matrix,k=o.createSVGMatrix(),$=getRotationAngle(y);$&&(k=S.getItem(0).matrix);var P=getBBox(y),E=transformListToTransform(S).matrix,A=transformPoint(P.x+P.width/2,P.y+P.height/2,E),T=h+$,N=o.createSVGTransform();N.setRotate(T,A.x,A.y);var G=matrixMultiply(w,k,N.matrix.inverse());if($&&S.removeItem(0),T&&(S.numberOfItems?S.insertItemBefore(N,0):S.appendItem(N)),G.e||G.f){var L=o.createSVGTransform();L.setTranslate(G.e,G.f),S.numberOfItems?S.insertItemBefore(L,0):S.appendItem(L)}}else{var I=y.getAttribute("transform");(g={}).transform=I||"";var M=o.createSVGTransform(),B=transformListToTransform(S).matrix,O=B.inverse(),V=matrixMultiply(O,l,B);M.setMatrix(V),S.appendItem(M)}var R=recalculateDimensions(y);R&&u.addSubCommand(R)}}}if(r&&((g={}).transform=r,e.setAttribute("transform",""),e.removeAttribute("transform"),u.addSubCommand(new ChangeElementCommand$1(e,g))),t&&!u.isEmpty())return u};this.ungroupSelectedElement=function(){var e=g[0];if(e)if($$9(e).data("gsvg")||$$9(e).data("symbol"))Be(e);else{if("use"===e.tagName){var t=getElem(getHref(e).substr(1));return $$9(e).data("symbol",t).data("ref",t),void Be(e)}var n=$$9(e).parents("a");if(n.length&&(e=n[0]),"g"===e.tagName||"a"===e.tagName){var a=new BatchCommand$1("Ungroup Elements"),r=Ue(e,!0);r&&a.addSubCommand(r);for(var i=e.parentNode,s=e.nextSibling,o=new Array(e.childNodes.length),l=0;e.firstChild;){var u=e.firstChild,c=u.nextSibling,h=u.parentNode;if("title"!==u.tagName)o[l++]=u=i.insertBefore(u,s),a.addSubCommand(new MoveElementCommand$1(u,c,h));else{var d=u.nextSibling;a.addSubCommand(new RemoveElementCommand$1(u,d,h)),h.removeChild(u)}}N();var f=e.nextSibling;e=i.removeChild(e),a.addSubCommand(new RemoveElementCommand$1(e,f,i)),a.isEmpty()||w(a),G(o)}}},this.moveToTopSelectedElement=function(){var e=g[0];if(null!=e){var t=e,n=t.parentNode,a=t.nextSibling;a!==(t=t.parentNode.appendChild(t)).nextSibling&&(w(new MoveElementCommand$1(t,a,n,"top")),T("changed",[t]))}},this.moveToBottomSelectedElement=function(){var e=g[0];if(null!=e){var t=e,n=t.parentNode,a=t.nextSibling,r=t.parentNode.firstChild;"title"===r.tagName&&(r=r.nextSibling),"defs"===r.tagName&&(r=r.nextSibling),a!==(t=t.parentNode.insertBefore(t,r)).nextSibling&&(w(new MoveElementCommand$1(t,a,n,"bottom")),T("changed",[t]))}},this.moveUpDownSelected=function(e){var t=g[0];if(t){te=[];var n=void 0,a=void 0,r=$$9(re(getStrokedBBoxDefaultVisible([t]))).toArray();if("Down"===e&&r.reverse(),$$9.each(r,function(){if(a)return n=this,!1;this===t&&(a=!0)}),n){var i=t,s=i.parentNode,o=i.nextSibling;$$9(n)["Down"===e?"before":"after"](i),o!==i.nextSibling&&(w(new MoveElementCommand$1(i,o,s,"Move "+e)),T("changed",[i]))}}},this.moveSelectedElements=function(e,t,n){e.constructor!==Array&&(e/=h,t/=h),n=n||!0;for(var a=new BatchCommand$1("position"),r=g.length;r--;){var i=g[r];if(null!=i){var s=o.createSVGTransform(),l=getTransformList(i);e.constructor===Array?s.setTranslate(e[r],t[r]):s.setTranslate(e,t),l.numberOfItems?l.insertItemBefore(s,0):l.appendItem(s);var u=recalculateDimensions(i);u&&a.addSubCommand(u),P.requestSelector(i).resize()}}if(!a.isEmpty())return n&&w(a),T("changed",g),a},this.cloneSelectedElements=function(e,t){var n=void 0,a=void 0,r=new BatchCommand$1("Clone Elements"),i=g.length;for(g.sort(function(e,t){return $$9(t).index()-$$9(e).index()}),n=0;n<i&&null!=(a=g[n]);++n);var s=g.slice(0,n);this.clearSelection(!0);var o=c();for(n=s.length;n--;)a=s[n]=o.copyElem(s[n]),(d||o.getCurrentLayer()).appendChild(a),r.addSubCommand(new InsertElementCommand$1(a));r.isEmpty()||(G(s.reverse()),this.moveSelectedElements(e,t,!1),w(r))},this.alignSelectedElements=function(e,t){var n=[],a=g.length;if(a){for(var r=Number.MAX_VALUE,s=Number.MIN_VALUE,o=Number.MAX_VALUE,l=Number.MIN_VALUE,u=Number.MIN_VALUE,c=Number.MIN_VALUE,h=0;h<a&&null!=g[h];++h){var d=g[h];switch(n[h]=getStrokedBBoxDefaultVisible([d]),t){case"smallest":(("l"===e||"c"===e||"r"===e)&&(u===Number.MIN_VALUE||u>n[h].width)||("t"===e||"m"===e||"b"===e)&&(c===Number.MIN_VALUE||c>n[h].height))&&(r=n[h].x,o=n[h].y,s=n[h].x+n[h].width,l=n[h].y+n[h].height,u=n[h].width,c=n[h].height);break;case"largest":(("l"===e||"c"===e||"r"===e)&&(u===Number.MIN_VALUE||u<n[h].width)||("t"===e||"m"===e||"b"===e)&&(c===Number.MIN_VALUE||c<n[h].height))&&(r=n[h].x,o=n[h].y,s=n[h].x+n[h].width,l=n[h].y+n[h].height,u=n[h].width,c=n[h].height);break;default:n[h].x<r&&(r=n[h].x),n[h].y<o&&(o=n[h].y),n[h].x+n[h].width>s&&(s=n[h].x+n[h].width),n[h].y+n[h].height>l&&(l=n[h].y+n[h].height)}}"page"===t&&(r=0,o=0,s=i.contentW,l=i.contentH);for(var f=new Array(a),p=new Array(a),v=0;v<a&&null!=g[v];++v){var m=n[v];switch(f[v]=0,p[v]=0,e){case"l":f[v]=r-m.x;break;case"c":f[v]=(r+s)/2-(m.x+m.width/2);break;case"r":f[v]=s-(m.x+m.width);break;case"t":p[v]=o-m.y;break;case"m":p[v]=(o+l)/2-(m.y+m.height/2);break;case"b":p[v]=l-(m.y+m.height)}}this.moveSelectedElements(f,p)}},this.contentW=Oe().w,this.contentH=Oe().h,this.updateCanvas=function(e,t){o.setAttribute("width",e),o.setAttribute("height",t);var n=$$9("#canvasBackground")[0],a=l.getAttribute("x"),r=l.getAttribute("y"),i=e/2-this.contentW*h/2,s=t/2-this.contentH*h/2;assignAttributes(l,{width:this.contentW*h,height:this.contentH*h,x:i,y:s,viewBox:"0 0 "+this.contentW+" "+this.contentH}),assignAttributes(n,{width:l.getAttribute("width"),height:l.getAttribute("height"),x:i,y:s});var u=getElem("background_image");return u&&assignAttributes(u,{width:"100%",height:"100%"}),P.selectorParentGroup.setAttribute("transform","translate("+i+","+s+")"),ae("canvasUpdated",{new_x:i,new_y:s,old_x:a,old_y:r,d_x:i-a,d_y:s-r}),{x:i,y:s,old_x:a,old_y:r,d_x:i-a,d_y:s-r}},this.setBackground=function(e,t){var n=getElem("canvasBackground"),a=$$9(n).find("rect")[0],r=getElem("background_image");a.setAttribute("fill",e),t?(r||(r=s.createElementNS(NS.SVG,"image"),assignAttributes(r,{id:"background_image",width:"100%",height:"100%",preserveAspectRatio:"xMinYMin",style:"pointer-events:none"})),setHref(r,t),n.appendChild(r)):r&&r.parentNode.removeChild(r)},this.cycleElement=function(e){var t=void 0,n=g[0],a=!1,r=getVisibleElements(d||c().getCurrentLayer());if(r.length){if(null==n)a=r[t=e?r.length-1:0];else for(var i=r.length;i--;)if(r[i]===n){(t=e?i-1:i+1)>=r.length?t=0:t<0&&(t=r.length-1),a=r[t];break}de([a],!0),T("selected",g)}},this.clear(),this.getPrivateMethods=function(){return{addCommandToHistory:w,setGradient:Re,addSvgElementFromJson:m,assignAttributes:assignAttributes,BatchCommand:BatchCommand$1,buildCanvgCallback:buildCanvgCallback,call:T,canvg:canvg,ChangeElementCommand:ChangeElementCommand$1,copyElem:function(e){return c().copyElem(e)},decode64:decode64,encode64:encode64,executeAfterLoads:executeAfterLoads,ffClone:le,findDefs:findDefs,findDuplicateGradient:je,getElem:getElem,getId:A,getIntersectionList:re,getMouseTarget:I,getNextId:E,getPathBBox:getPathBBox,getTypeMap:getTypeMap,getUrlFromAttr:getUrlFromAttr,hasMatrixTransform:hasMatrixTransform,identifyLayers:identifyLayers,InsertElementCommand:InsertElementCommand$1,isChrome:isChrome,isIdentity:isIdentity,isIE:isIE,logMatrix:ce,matrixMultiply:matrixMultiply,MoveElementCommand:MoveElementCommand$1,NS:NS,preventClickDefault:preventClickDefault,recalculateAllSelectedDimensions:ue,recalculateDimensions:recalculateDimensions,remapElement:remapElement,RemoveElementCommand:RemoveElementCommand$1,removeUnusedDefElems:Ne,round:$,runExtensions:ae,sanitizeSvg:sanitizeSvg,SVGEditTransformList:SVGTransformList,text2xml:text2xml,toString:toString,transformBox:transformBox,transformListToTransform:transformListToTransform,transformPoint:transformPoint,walkTree:walkTree}}};function jqPluginJSHotkeys(e){function t(t){if("string"==typeof t.data){var n=t.handler,a=t.data.toLowerCase().split(" ");t.handler=function(t){if(this===t.target||!/textarea|select/i.test(t.target.nodeName)&&"text"!==t.target.type){var r="keypress"!==t.type&&e.hotkeys.specialKeys[t.which],i=String.fromCharCode(t.which).toLowerCase(),s="",o={};t.altKey&&"alt"!==r&&(s+="alt+"),t.ctrlKey&&"ctrl"!==r&&(s+="ctrl+"),t.metaKey&&!t.ctrlKey&&"meta"!==r&&(s+="meta+"),t.shiftKey&&"shift"!==r&&(s+="shift+"),r?o[s+r]=!0:(o[s+i]=!0,o[s+e.hotkeys.shiftNums[i]]=!0,"shift+"===s&&(o[e.hotkeys.shiftNums[i]]=!0));for(var l=0,u=a.length;l<u;l++)if(o[a[l]])return n.apply(this,arguments)}}}}return e.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta",219:"[",221:"]"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},e.each(["keydown","keyup","keypress"],function(){e.event.special[this]={add:t}}),e}function jqPluginBBQ(e){return function(e,t){var n,a,r,i,s,o,l,u,c=Array.prototype.slice,h=decodeURIComponent,d=e.param,f=e.bbq=e.bbq||{},p=e.event.special,g="hashchange",v="querystring",m="fragment",y="elemUrlAttr",b="location",_="href",x="src",C=/^.*\?|#.*$/g,S=/^.*\#/,w={};function k(e){return"string"==typeof e}function $(e){var t=c.call(arguments,1);return function(){return e.apply(this,t.concat(c.call(arguments)))}}function P(a,i,s,o,l){var c,f,p,g,y;return o!==n?(y=(p=s.match(a?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/))[3]||"",2===l&&k(o)?f=o.replace(a?S:C,""):(g=r(p[2]),o=k(o)?r[a?m:v](o):o,f=2===l?o:1===l?e.extend({},o,g):e.extend({},g,o),f=d(f),a&&(f=f.replace(u,h))),c=p[1]+(a?"#":f||!p[1]?"?":"")+f+y):c=i(s!==n?s:t[b][_]),c}function E(e,t,a){return t===n||"boolean"==typeof t?(a=t,t=d[e?m:v]()):t=k(t)?t.replace(e?S:C,""):t,r(t,a)}function A(t,a,r,i){return k(r)||"object"===(void 0===r?"undefined":_typeof(r))||(i=r,r=a,a=n),this.each(function(){var n=e(this),s=a||l()[(this.nodeName||"").toLowerCase()]||"",o=s&&n.attr(s)||"";n.attr(s,d[t](o,r,i))})}d[v]=$(P,0,function(e){return e.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}),d[m]=a=$(P,1,function(e){return e.replace(/^[^#]*#?(.*)$/,"$1")}),a.noEscape=function(t){t=t||"";var n=e.map(t.split(""),encodeURIComponent);u=new RegExp(n.join("|"),"g")},a.noEscape(",/"),e.deparam=r=function(t,a){var r={},i={true:!0,false:!1,null:null};return e.each(t.replace(/\+/g," ").split("&"),function(t,s){var o,l=s.split("="),u=h(l[0]),c=r,d=0,f=u.split("]["),p=f.length-1;if(/\[/.test(f[0])&&/\]$/.test(f[p])?(f[p]=f[p].replace(/\]$/,""),p=(f=f.shift().split("[").concat(f)).length-1):p=0,2===l.length)if(o=h(l[1]),a&&(o=o&&!isNaN(o)?+o:"undefined"===o?n:i[o]!==n?i[o]:o),p)for(;d<=p;d++)c=c[u=""===f[d]?c.length:f[d]]=d<p?c[u]||(f[d+1]&&isNaN(f[d+1])?{}:[]):o;else e.isArray(r[u])?r[u].push(o):r[u]!==n?r[u]=[r[u],o]:r[u]=o;else u&&(r[u]=a?n:"")}),r},r[v]=$(E,0),r[m]=i=$(E,1),e[y]||(e[y]=function(t){return e.extend(w,t)})({a:_,base:_,iframe:x,img:x,input:x,form:"action",link:_,script:x}),l=e[y],e.fn[v]=$(A,v),e.fn[m]=$(A,m),f.pushState=s=function(e,r){k(e)&&/^#/.test(e)&&r===n&&(r=2);var i=e!==n,s=a(t[b][_],i?e:{},i?r:2);t[b][_]=s+(/#/.test(s)?"":"#")},f.getState=o=function(e,t){return e===n||"boolean"==typeof e?i(e):i(t)[e]},f.removeState=function(t){var a={};t!==n&&(a=o(),e.each(e.isArray(t)?t:arguments,function(e,t){delete a[t]})),s(a,2)},p[g]=e.extend(p[g],{add:function(t){var i;function s(e){var t=e[m]=a();e.getState=function(e,a){return e===n||"boolean"==typeof e?r(t,e):r(t,a)[e]},i.apply(this,arguments)}if(e.isFunction(t))return i=t,s;i=t.handler,t.handler=s}})}(e,window),function(e,t,n){var a,r=e.event.special,i="location",s="hashchange",o="href",l=e.browser,u=document.documentMode,c=l.msie&&(void 0===u||u<8),h="on"+s in t&&!c;function d(e){return(e=e||t[i][o]).replace(/^[^#]*#?(.*)$/,"$1")}e[s+"Delay"]=100,r[s]=e.extend(r[s],{setup:function(){if(h)return!1;e(a.start)},teardown:function(){if(h)return!1;e(a.stop)}}),a=function(){var n,a,r,l,u={};return u.start=function(){if(!n){var u=d();r||(r=l=function(e){return e},c&&(a=e('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow,l=function(){return d(a.document[i][o])},(r=function(e,t){if(e!==t){var n=a.document;n.open().close(),n[i].hash="#"+e}})(d()))),function a(){var c=d(),h=l(u);c!==u?(r(u=c,h),e(t).trigger(s)):h!==u&&(t[i][o]=t[i][o].replace(/#.*/,"")+"#"+h),n=setTimeout(a,e[s+"Delay"])}()}},u.stop=function(){a||(n&&clearTimeout(n),n=0)},u}()}(e,window),e}function jqPluginSVGIcons(e){var t={},n=void 0;return e.svgIcons=function(a,r){var i="http://www.w3.org/2000/svg",s="http://www.w3.org/1999/xlink",o=r.w||24,l=r.h||24,u=void 0,c=void 0,h=void 0,d=!1,f=!1,p=0,g=!!window.opera,v="data:image/svg+xml;charset=utf-8;base64,",m=void 0;if(r.svgz){m=e('<object data="'+a+'" type=image/svg+xml>').appendTo("body").hide();try{c=m[0].contentDocument,m.load(b),b(0,!0)}catch(e){w()}}else{var y=new DOMParser;e.ajax({url:a,dataType:"string",success:function(t){t?(c=y.parseFromString(t,"text/xml"),e(function(){b("ajax")})):e(w)},error:function(t){window.opera?e(function(){w()}):t.responseText?((c=y.parseFromString(t.responseText,"text/xml")).childNodes.length||e(w),e(function(){b("ajax")})):e(w)}})}function b(t,n){if("ajax"!==t){if(f)return;var a=(c=m[0].contentDocument)&&c.getElementById("svg_eof");if(!(a||n&&a))return void(++p<50?setTimeout(b,20):(w(),f=!0));f=!0}if(u=e(c.firstChild).children(),r.no_img)setTimeout(function(){d||S()},500);else{var i=v+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNzUiIGhlaWdodD0iMjc1Ij48L3N2Zz4%3D";h=e(new Image).attr({src:i,width:0,height:0}).appendTo("body").load(function(){S(!0)}).error(function(){S()})}}var _=function(e,t,n,a){if(g&&t.css("visibility","hidden"),r.replace){a&&t.attr("id",n);var i=e.attr("class");i&&t.attr("class","svg_icon "+i),e.replaceWith(t)}else e.append(t);g&&setTimeout(function(){t.removeAttr("style")},1)},x=void 0,C=function(e,n){void 0!==r.id_match&&!1===r.id_match||_(x,e,n,!0),t[n]=e};function S(a,c){if(!d){r.no_img&&(a=!1);var f=void 0;if(a&&(f=e(document.createElement("div"))).hide().appendTo("body"),c){var p=r.fallback_path||"";e.each(c,function(t,n){x=e("#"+t);var a=e(new Image).attr({class:"svg_icon",src:p+n,width:o,height:l,alt:"icon"});C(a,t)})}else for(var y=u.length,b=0;b<y;b++){var S=u[b],w=S.id;if("svg_eof"===w)break;x=e("#"+w);var $=document.createElementNS(i,"svg");$.setAttributeNS(null,"viewBox",[0,0,o,l].join(" "));var P=S.getElementsByTagNameNS(i,"svg")[0],E=P.getAttribute("width"),A=P.getAttribute("height");P.removeAttribute("width"),P.removeAttribute("height"),P.getAttribute("viewBox")||P.setAttribute("viewBox",[0,0,E,A].join(" ")),$.setAttribute("xmlns",i),$.setAttribute("width",o),$.setAttribute("height",l),$.setAttribute("xmlns:xlink",s),$.setAttribute("class","svg_icon"),g||(P=P.cloneNode(!0)),$.appendChild(P);var T=void 0;if(a){f.empty().append($);var N=v+k(unescape(encodeURIComponent((new XMLSerializer).serializeToString($))));T=e(new Image).attr({class:"svg_icon",src:N})}else T=n(e($),b);C(T,w)}r.placement&&e.each(r.placement,function(r,i){t[i]&&e(r).each(function(r){var s=t[i].clone();r>0&&!a&&(s=n(s,r,!0)),_(e(this),s,i)})}),c||(a&&f.remove(),m&&m.remove(),h&&h.remove()),r.resize&&e.resizeSvgIcons(r.resize),d=!0,r.callback&&r.callback(t)}}function w(){if(a.includes(".svgz")){var t=a.replace(".svgz",".svg");window.console&&console.log(".svgz failed, trying with .svg"),e.svgIcons(t,r)}else r.fallback&&S(!1,r.fallback)}function k(e){if(window.btoa)return window.btoa(e);var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=new Array(4*Math.floor((e.length+2)/3)),a=0,r=0;do{var i=e.charCodeAt(a++),s=e.charCodeAt(a++),o=e.charCodeAt(a++),l=i>>2,u=(3&i)<<4|s>>4,c=(15&s)<<2|o>>6,h=63&o;isNaN(s)?c=h=64:isNaN(o)&&(h=64),n[r++]=t.charAt(l),n[r++]=t.charAt(u),n[r++]=t.charAt(c),n[r++]=t.charAt(h)}while(a<e.length);return n.join("")}n=function(e,t,n){var a=e.find("defs");if(!a.length)return e;var r=void 0;r=g?a.find("*").filter(function(){return!!this.id}):a.find("[id]");var i=e[0].getElementsByTagName("*"),s=i.length;return r.each(function(e){var n=this.id,a="x"+n+t+e;this.id=a;var r="url(#"+n+")",o="url(#"+a+")";for(e=0;e<s;e++){var l=i[e];l.getAttribute("fill")===r&&l.setAttribute("fill",o),l.getAttribute("stroke")===r&&l.setAttribute("stroke",o),l.getAttribute("filter")===r&&l.setAttribute("filter",o)}}),e}},e.getSvgIcon=function(e,a){var r=t[e];return a&&r&&(r=n(r,0,!0).clone(!0)),r},e.resizeSvgIcons=function(t){var n=!e(".svg_icon:first").length;e.each(t,function(t,a){var r=Array.isArray(a),i=r?a[0]:a,s=r?a[1]:a;n&&(t=t.replace(/\.svg_icon/g,"svg")),e(t).each(function(){this.setAttribute("width",i),this.setAttribute("height",s),window.opera&&window.widget&&(this.parentNode.style.width=i+"px",this.parentNode.style.height=s+"px")})})},e}var ns={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"};function jqPluginJGraduate(e){e.loadingStylesheets||(e.loadingStylesheets=[]);e.loadingStylesheets.includes("jgraduate/css/jgraduate.css")||e.loadingStylesheets.push("jgraduate/css/jgraduate.css"),e.jGraduate={Paint:function(e){var t=e||{};if(this.alpha=isNaN(t.alpha)?100:t.alpha,t.copy)switch(this.type=t.copy.type,this.alpha=t.copy.alpha,this.solidColor=null,this.linearGradient=null,this.radialGradient=null,this.type){case"none":break;case"solidColor":this.solidColor=t.copy.solidColor;break;case"linearGradient":this.linearGradient=t.copy.linearGradient.cloneNode(!0);break;case"radialGradient":this.radialGradient=t.copy.radialGradient.cloneNode(!0)}else t.linearGradient?(this.type="linearGradient",this.solidColor=null,this.radialGradient=null,this.linearGradient=t.linearGradient.cloneNode(!0)):t.radialGradient?(this.type="radialGradient",this.solidColor=null,this.linearGradient=null,this.radialGradient=t.radialGradient.cloneNode(!0)):t.solidColor?(this.type="solidColor",this.solidColor=t.solidColor):(this.type="none",this.solidColor=null,this.linearGradient=null,this.radialGradient=null)}},e.fn.jGraduateDefaults={paint:new e.jGraduate.Paint,window:{pickerTitle:"Drag markers to pick a paint"},images:{clientPath:"images/"},newstop:"inverse"};var t=navigator.userAgent.includes("Gecko/");function n(e,n,a){var r=document.createElementNS(ns.svg,e);return function(e,n){if(t)for(var a in n)e.setAttribute(a,n[a]);else for(var r in n){var i=n[r],s=e[r];s&&"SVGLength"===s.constructor?s.baseVal.value=i:e.setAttribute(r,i)}}(r,n),a&&a.appendChild(r),r}return e.fn.jGraduate=function(t){var a=arguments;return this.each(function(){var r=e(this),i=e.extend(!0,{},e.fn.jGraduateDefaults,t),s=r.attr("id"),o="#"+r.attr("id")+" ";if(o){var l=function(){switch(r.paint.type){case"radialGradient":r.paint.linearGradient=null;break;case"linearGradient":r.paint.radialGradient=null;break;case"solidColor":r.paint.radialGradient=r.paint.linearGradient=null}"function"==typeof r.okCallback&&r.okCallback(r.paint),r.hide()},u=function(){"function"==typeof r.cancelCallback&&r.cancelCallback(),r.hide()};e.extend(!0,r,{paint:new e.jGraduate.Paint({copy:i.paint}),okCallback:"function"==typeof a[1]&&a[1]||null,cancelCallback:"function"==typeof a[2]&&a[2]||null});var c=null,h=e(window);"none"===r.paint.type&&(r.paint=e.jGraduate.Paint({solidColor:"ffffff"})),r.addClass("jGraduate_Picker"),r.html('<ul class="jGraduate_tabs"><li class="jGraduate_tab_color jGraduate_tab_current" data-type="col">Solid Color</li><li class="jGraduate_tab_lingrad" data-type="lg">Linear Gradient</li><li class="jGraduate_tab_radgrad" data-type="rg">Radial Gradient</li></ul><div class="jGraduate_colPick"></div><div class="jGraduate_gradPick"></div><div class="jGraduate_LightBox"></div><div id="'+s+'_jGraduate_stopPicker" class="jGraduate_stopPicker"></div>');var d=e(o+"> .jGraduate_colPick"),f=e(o+"> .jGraduate_gradPick");f.html('<div id="'+s+'_jGraduate_Swatch" class="jGraduate_Swatch"><h2 class="jGraduate_Title">'+i.window.pickerTitle+'</h2><div id="'+s+'_jGraduate_GradContainer" class="jGraduate_GradContainer"></div><div id="'+s+'_jGraduate_StopSlider" class="jGraduate_StopSlider"></div></div><div class="jGraduate_Form jGraduate_Points jGraduate_lg_field"><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Begin Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+s+'_jGraduate_x1" size="3" title="Enter starting x value between 0.0 and 1.0"/><label>y:</label><input type="text" id="'+s+'_jGraduate_y1" size="3" title="Enter starting y value between 0.0 and 1.0"/></div></div><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">End Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+s+'_jGraduate_x2" size="3" title="Enter ending x value between 0.0 and 1.0"/><label>y:</label><input type="text" id="'+s+'_jGraduate_y2" size="3" title="Enter ending y value between 0.0 and 1.0"/></div></div></div><div class="jGraduate_Form jGraduate_Points jGraduate_rg_field"><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Center Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+s+'_jGraduate_cx" size="3" title="Enter x value between 0.0 and 1.0"/><label>y:</label><input type="text" id="'+s+'_jGraduate_cy" size="3" title="Enter y value between 0.0 and 1.0"/></div></div><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Focal Point</label><div class="jGraduate_Form_Section"><label>Match center: <input type="checkbox" checked="checked" id="'+s+'_jGraduate_match_ctr"/></label><br/><label>x:</label><input type="text" id="'+s+'_jGraduate_fx" size="3" title="Enter x value between 0.0 and 1.0"/><label>y:</label><input type="text" id="'+s+'_jGraduate_fy" size="3" title="Enter y value between 0.0 and 1.0"/></div></div></div><div class="jGraduate_StopSection jGraduate_SpreadMethod"><label class="jGraduate_Form_Heading">Spread method</label><div class="jGraduate_Form_Section"><select class="jGraduate_spreadMethod"><option value=pad selected>Pad</option><option value=reflect>Reflect</option><option value=repeat>Repeat</option></select></div></div><div class="jGraduate_Form"><div class="jGraduate_Slider jGraduate_RadiusField jGraduate_rg_field"><label class="prelabel">Radius:</label><div id="'+s+'_jGraduate_Radius" class="jGraduate_SliderBar jGraduate_Radius" title="Click to set radius"><img id="'+s+'_jGraduate_RadiusArrows" class="jGraduate_RadiusArrows" src="'+i.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+s+'_jGraduate_RadiusInput" size="3" value="100"/>%</label></div><div class="jGraduate_Slider jGraduate_EllipField jGraduate_rg_field"><label class="prelabel">Ellip:</label><div id="'+s+'_jGraduate_Ellip" class="jGraduate_SliderBar jGraduate_Ellip" title="Click to set Ellip"><img id="'+s+'_jGraduate_EllipArrows" class="jGraduate_EllipArrows" src="'+i.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+s+'_jGraduate_EllipInput" size="3" value="0"/>%</label></div><div class="jGraduate_Slider jGraduate_AngleField jGraduate_rg_field"><label class="prelabel">Angle:</label><div id="'+s+'_jGraduate_Angle" class="jGraduate_SliderBar jGraduate_Angle" title="Click to set Angle"><img id="'+s+'_jGraduate_AngleArrows" class="jGraduate_AngleArrows" src="'+i.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+s+'_jGraduate_AngleInput" size="3" value="0"/>deg</label></div><div class="jGraduate_Slider jGraduate_OpacField"><label class="prelabel">Opac:</label><div id="'+s+'_jGraduate_Opac" class="jGraduate_SliderBar jGraduate_Opac" title="Click to set Opac"><img id="'+s+'_jGraduate_OpacArrows" class="jGraduate_OpacArrows" src="'+i.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+s+'_jGraduate_OpacInput" size="3" value="100"/>%</label></div></div><div class="jGraduate_OkCancel"><input type="button" id="'+s+'_jGraduate_Ok" class="jGraduate_Ok" value="OK"/><input type="button" id="'+s+'_jGraduate_Cancel" class="jGraduate_Cancel" value="Cancel"/></div>');var p=256,g=p-0,v=p-0,m={};e(".jGraduate_SliderBar").width(145);var y=e("#"+s+"_jGraduate_GradContainer")[0],b=n("svg",{id:s+"_jgraduate_svg",width:p,height:p,xmlns:ns.svg},y),_=r.paint.type,x=r.paint[_],C=x,S=r.paint.alpha,w="solidColor"===_;switch(_){case"solidColor":case"linearGradient":if(w||(C.id=s+"_lg_jgraduate_grad",x=C=b.appendChild(C)),n("radialGradient",{id:s+"_rg_jgraduate_grad"},b),"linearGradient"===_)break;case"radialGradient":w||(C.id=s+"_rg_jgraduate_grad",x=C=b.appendChild(C)),n("linearGradient",{id:s+"_lg_jgraduate_grad"},b)}var k=void 0;if(w){x=C=e("#"+s+"_lg_jgraduate_grad")[0],Ne(0,"#"+(c=r.paint[_]),1);var $=_typeof(i.newstop);if("string"===$)switch(i.newstop){case"same":Ne(1,"#"+c,1);break;case"inverse":for(var P="",E=0;E<6;E+=2){var A=(255-parseInt(c.substr(E,2),16)).toString(16);A.length<2&&(A=0+A),P+=A}Ne(1,"#"+P,1);break;case"white":Ne(1,"#ffffff",1);break;case"black":Ne(1,"#000000",1)}else if("object"===$){var T="opac"in i.newstop?i.newstop.opac:1;Ne(1,i.newstop.color||"#"+c,T)}}var N=parseFloat(x.getAttribute("x1")||0),G=parseFloat(x.getAttribute("y1")||0),L=parseFloat(x.getAttribute("x2")||1),I=parseFloat(x.getAttribute("y2")||0),M=parseFloat(x.getAttribute("cx")||.5),B=parseFloat(x.getAttribute("cy")||.5),O=parseFloat(x.getAttribute("fx")||M),V=parseFloat(x.getAttribute("fy")||B),R=n("rect",{id:s+"_jgraduate_rect",x:0,y:0,width:g,height:v,fill:"url(#"+s+"_jgraduate_grad)","fill-opacity":S/100},b),j=e("<div/>").attr({class:"grad_coord jGraduate_lg_field",title:"Begin Stop"}).text(1).css({top:G*p,left:N*p}).data("coord","start").appendTo(y),D=j.clone().text(2).css({top:I*p,left:L*p}).attr("title","End stop").data("coord","end").appendTo(y),F=e("<div/>").attr({class:"grad_coord jGraduate_rg_field",title:"Center stop"}).text("C").css({top:B*p,left:M*p}).data("coord","center").appendTo(y),U=F.clone().text("F").css({top:V*p,left:O*p,display:"none"}).attr("title","Focus point").data("coord","focus").appendTo(y);U[0].id=s+"_jGraduate_focusCoord";var H=void 0;e.each(["x1","y1","x2","y2","cx","cy","fx","fy"],function(t,n){var a=isNaN(n[1]),r=C.getAttribute(n);r||(r=a?"0.5":"x2"===n?"1.0":"0.0"),m[n]=e("#"+s+"_jGraduate_"+n).val(r).change(function(){isNaN(parseFloat(this.value))||this.value<0?this.value=0:this.value>1&&(this.value=1),("f"!==n[0]||H)&&(a&&"radialGradient"===_||!a&&"linearGradient"===_)&&C.setAttribute(n,this.value);var e=a?"c"===n[0]?F:U:"1"===n[1]?j:D,t=n.includes("x")?"left":"top";e.css(t,this.value*p)}).change()});var z=e("#"+s+"_jGraduate_StopSlider"),q=void 0,X=void 0,W=void 0,Y=n("path",{d:"m9.75,-6l-19.5,19.5m0,-19.5l19.5,19.5",fill:"none",stroke:"#D00","stroke-width":5,display:"none"},void 0),Q=void 0,Z=1,K=1,J=0,ee=M,te=B,ne=n("svg",{width:"100%",height:45},z[0]),ae=n("image",{width:16,height:16},n("pattern",{width:16,height:16,patternUnits:"userSpaceOnUse",id:"jGraduate_trans"},ne)),re=i.images.clientPath+"map-opacity.png";ae.setAttributeNS(ns.xlink,"xlink:href",re),e(ne).click(function(e){if(Q=z.offset(),"path"!==e.target.tagName){var t=e.pageX-Q.left-8;Ne((t=t<10?10:t>p+10?p+10:t)/p,0,0,!0),e.stopPropagation()}}),e(ne).mouseover(function(){ne.appendChild(Y)}),k=n("g",{},ne),n("line",{x1:10,y1:15,x2:p+10,y2:15,"stroke-width":2,stroke:"#000"},ne);var ie=f.find(".jGraduate_spreadMethod").change(function(){C.setAttribute("spreadMethod",e(this).val())}),se=null,oe=function(e){var t=e.pageX-he.left,n=e.pageY-he.top;t=t<0?0:t>p?p:t,n=n<0?0:n>p?p:n,se.css("left",t).css("top",n);var a=t/g,r=n/v,i=se.data("coord"),s=C;switch(i){case"start":m.x1.val(a),m.y1.val(r),s.setAttribute("x1",a),s.setAttribute("y1",r);break;case"end":m.x2.val(a),m.y2.val(r),s.setAttribute("x2",a),s.setAttribute("y2",r);break;case"center":m.cx.val(a),m.cy.val(r),s.setAttribute("cx",a),s.setAttribute("cy",r),ee=a,te=r,Ie();break;case"focus":m.fx.val(a),m.fy.val(r),s.setAttribute("fx",a),s.setAttribute("fy",r),Ie()}e.preventDefault()},le=function e(){se=null,h.unbind("mousemove",oe).unbind("mouseup",e)},ue=(q=C.getElementsByTagNameNS(ns.svg,"stop")).length;if(ue<2){for(;ue<2;)C.appendChild(document.createElementNS(ns.svg,"stop")),++ue;q=C.getElementsByTagNameNS(ns.svg,"stop")}for(var ce=0;ce<ue;ce++)Ne(0,0,0,0,q[ce]);ie.val(C.getAttribute("spreadMethod")||"pad");var he=void 0;H=!1,R.setAttribute("fill-opacity",S/100),e("#"+s+" div.grad_coord").mousedown(function(t){t.preventDefault(),se=e(this),he=se.parent().offset(),h.mousemove(oe).mouseup(le)}),e("#"+s+"_jGraduate_Ok").bind("click",function(){r.paint.type=_,r.paint[_]=C.cloneNode(!0),r.paint.solidColor=null,l()}),e("#"+s+"_jGraduate_Cancel").bind("click",function(e){u()}),"radialGradient"===_&&(H?U.show():(U.hide(),m.fx.val(""),m.fy.val(""))),e("#"+s+"_jGraduate_match_ctr")[0].checked=!H;var de=void 0,fe=void 0;if(e("#"+s+"_jGraduate_match_ctr").change(function(){H=!this.checked,U.toggle(H),m.fx.val(""),m.fy.val("");var e=C;if(H){var t=de||.5,n=fe||.5;e.setAttribute("fx",t),e.setAttribute("fy",n),m.fx.val(t),m.fy.val(n)}else de=e.getAttribute("fx"),fe=e.getAttribute("fy"),e.removeAttribute("fx"),e.removeAttribute("fy")}),(ue=(q=C.getElementsByTagNameNS(ns.svg,"stop")).length)<2){for(;ue<2;)C.appendChild(document.createElementNS(ns.svg,"stop")),++ue;q=C.getElementsByTagNameNS(ns.svg,"stop")}var pe=void 0,ge=0,ve=0;if("radialGradient"===_){var me=C.gradientTransform.baseVal;if(2===me.numberOfItems){var ye=me.getItem(0),be=me.getItem(1);if(2===ye.type&&3===be.type){var _e=be.matrix;1!==_e.a?ge=Math.round(100*-(1-_e.a)):1!==_e.d&&(ge=Math.round(100*(1-_e.d)))}}else if(3===me.numberOfItems){var xe=me.getItem(0),Ce=me.getItem(1),Se=me.getItem(2);if(4===xe.type&&2===Ce.type&&3===Se.type){ve=Math.round(xe.angle);var we=Se.matrix;1!==we.a?ge=Math.round(100*-(1-we.a)):1!==we.d&&(ge=Math.round(100*(1-we.d)))}}}var ke={radius:{handle:"#"+s+"_jGraduate_RadiusArrows",input:"#"+s+"_jGraduate_RadiusInput",val:100*(C.getAttribute("r")||.5)},opacity:{handle:"#"+s+"_jGraduate_OpacArrows",input:"#"+s+"_jGraduate_OpacInput",val:r.paint.alpha||100},ellip:{handle:"#"+s+"_jGraduate_EllipArrows",input:"#"+s+"_jGraduate_EllipInput",val:ge},angle:{handle:"#"+s+"_jGraduate_AngleArrows",input:"#"+s+"_jGraduate_AngleInput",val:ve}};e.each(ke,function(t,n){var a=e(n.handle);a.mousedown(function(r){var i=a.parent();pe={type:t,elem:a,input:e(n.input),parent:i,offset:i.offset()},h.mousemove($e).mouseup(Pe),r.preventDefault()}),e(n.input).val(n.val).change(function(){var e="radialGradient"===_,n=+this.value,i=0;switch(t){case"radius":e&&C.setAttribute("r",n/100),i=Math.pow(n/100,.4)/2*145;break;case"opacity":r.paint.alpha=n,R.setAttribute("fill-opacity",n/100),i=1.45*n;break;case"ellip":if(Z=K=1,0===n){i=72.5;break}n>99.5&&(n=99.5),n>0?K=1-n/100:Z=-n/100-1,i=(n+100)/2*145/100,e&&Ie();break;case"angle":i=(J=n)/180,i+=.5,i*=145,e&&Ie()}i>145?i=145:i<0&&(i=0),a.css({"margin-left":i-5})}).change()});for(var $e=function(e){!function(e){var t=pe.offset,n=pe.parent,a=e.pageX-t.left-parseInt(n.css("border-left-width"));a>145&&(a=145),a<=0&&(a=0);var i=a-5;switch(a/=145,pe.type){case"radius":(a=Math.pow(2*a,2.5))>.98&&a<1.02&&(a=1),a<=.01&&(a=.01),C.setAttribute("r",a);break;case"opacity":r.paint.alpha=parseInt(100*a),R.setAttribute("fill-opacity",a);break;case"ellip":Z=1,K=1,a<.5?Z=(a/=.5)<=0?.01:a:a>.5&&(K=(a=2-(a/=.5))<=0?.01:a),Ie(),K===1+(a-=1)&&(a=Math.abs(a));break;case"angle":a-=.5,J=a*=180,Ie(),a/=100}pe.elem.css({"margin-left":i}),a=Math.round(100*a),pe.input.val(a)}(e),e.preventDefault()},Pe=function e(t){h.unbind("mousemove",$e).unbind("mouseup",e),pe=null},Ee=(255*r.paint.alpha/100).toString(16);Ee.length<2;)Ee="0"+Ee;Ee=Ee.split(".")[0],c="none"===r.paint.solidColor?"":r.paint.solidColor+Ee,w||(c=q[0].getAttribute("stop-color")),e.extend(e.fn.jPicker.defaults.window,{alphaSupport:!0,effects:{type:"show",speed:0}}),d.jPicker({window:{title:i.window.pickerTitle},images:{clientPath:i.images.clientPath},color:{active:c,alphaSupport:!0}},function(e){r.paint.type="solidColor",r.paint.alpha=e.val("ahex")?Math.round(e.val("a")/255*100):100,r.paint.solidColor=e.val("hex")?e.val("hex"):"none",r.paint.radialGradient=null,l()},null,function(){u()});var Ae=e(o+" .jGraduate_tabs li");Ae.click(function(){Ae.removeClass("jGraduate_tab_current"),e(this).addClass("jGraduate_tab_current"),e(o+" > div").hide();var t=e(this).attr("data-type");if(e(o+" .jGraduate_gradPick").show(),"rg"===t||"lg"===t){e(".jGraduate_"+t+"_field").show(),e(".jGraduate_"+("lg"===t?"rg":"lg")+"_field").hide(),e("#"+s+"_jgraduate_rect")[0].setAttribute("fill","url(#"+s+"_"+t+"_jgraduate_grad)"),_="lg"===t?"linearGradient":"radialGradient",e("#"+s+"_jGraduate_OpacInput").val(r.paint.alpha).change();var n=e("#"+s+"_"+t+"_jgraduate_grad")[0];if(C!==n){var a=e(C).find("stop");e(n).empty().append(a),C=n;var i=ie.val();C.setAttribute("spreadMethod",i)}H="rg"===t&&null!=C.getAttribute("fx")&&!(M===O&&B===V),e("#"+s+"_jGraduate_focusCoord").toggle(H),H&&(e("#"+s+"_jGraduate_match_ctr")[0].checked=!1)}else e(o+" .jGraduate_gradPick").hide(),e(o+" .jGraduate_colPick").show()}),e(o+" > div").hide(),Ae.removeClass("jGraduate_tab_current");var Te=void 0;switch(r.paint.type){case"linearGradient":Te=e(o+" .jGraduate_tab_lingrad");break;case"radialGradient":Te=e(o+" .jGraduate_tab_radgrad");break;default:Te=e(o+" .jGraduate_tab_color")}r.show(),setTimeout(function(){Te.addClass("jGraduate_tab_current").click()},10)}else alert("Container element must have an id attribute to maintain unique id strings for sub-elements.");function Ne(t,a,r,o,l){var u=l||n("stop",{"stop-color":a,"stop-opacity":r,offset:t},C);l?(a=l.getAttribute("stop-color"),r=l.getAttribute("stop-opacity"),t=l.getAttribute("offset")):C.appendChild(u),null===r&&(r=1);var c="M-6.2,0.9c3.6-4,6.7-4.3,6.7-12.4c-0.2,7.9,3.1,8.8,6.5,12.4c3.5,3.8,2.9,9.6,0,12.3c-3.1,2.8-10.4,2.7-13.2,0C-9.6,9.9-9.4,4.4-6.2,0.9z",d=n("path",{d:c,fill:"url(#jGraduate_trans)",transform:"translate("+(10+t*p)+", 26)"},k),f=n("path",{d:c,fill:a,"fill-opacity":r,transform:"translate("+(10+t*p)+", 26)",stroke:"#000","stroke-width":1.5},k);return e(f).mousedown(function(e){return Ge(this),W=X,h.mousemove(Me).mouseup(Le),Q=z.offset(),e.preventDefault(),!1}).data("stop",u).data("bg",d).dblclick(function(){e("div.jGraduate_LightBox").show();for(var t=this,n=+u.getAttribute("stop-opacity")||1,r=u.getAttribute("stop-color")||1,o=(255*parseFloat(n)).toString(16);o.length<2;)o="0"+o;a=r.substr(1)+o,e("#"+s+"_jGraduate_stopPicker").css({left:100,bottom:15}).jPicker({window:{title:"Pick the start color and opacity for the gradient"},images:{clientPath:i.images.clientPath},color:{active:a,alphaSupport:!0}},function(a,i){r=a.val("hex")?"#"+a.val("hex"):"none",n=null!==a.val("a")?a.val("a")/256:1,t.setAttribute("fill",r),t.setAttribute("fill-opacity",n),u.setAttribute("stop-color",r),u.setAttribute("stop-opacity",n),e("div.jGraduate_LightBox").hide(),e("#"+s+"_jGraduate_stopPicker").hide()},null,function(){e("div.jGraduate_LightBox").hide(),e("#"+s+"_jGraduate_stopPicker").hide()})}),e(C).find("stop").each(function(){var n=e(this);if(+this.getAttribute("offset")>t){if(!a){var r=this.getAttribute("stop-color"),i=this.getAttribute("stop-opacity");u.setAttribute("stop-color",r),f.setAttribute("fill",r),u.setAttribute("stop-opacity",null===i?1:i),f.setAttribute("fill-opacity",null===i?1:i)}return n.before(u),!1}}),o&&Ge(f),u}function Ge(e){X&&X.setAttribute("stroke","#000"),e.setAttribute("stroke","blue"),(X=e).parentNode.appendChild(X)}function Le(){h.unbind("mousemove",Me),"none"!==Y.getAttribute("display")&&function(){Y.setAttribute("display","none");var t=e(X),n=t.data("stop"),a=t.data("bg");e([X,n,a]).remove()}(),W=null}function Ie(){var e=J?"rotate("+J+","+ee+","+te+") ":"";if(1===Z&&1===K)C.removeAttribute("gradientTransform");else{var t=-ee*(Z-1),n=-te*(K-1);C.setAttribute("gradientTransform",e+"translate("+t+","+n+") scale("+Z+","+K+")")}}function Me(t){var n=t.pageX-Q.left,a=t.pageY-Q.top,r="translate("+(n=n<10?10:n>p+10?p+10:n)+", 26)";a<-60||a>130?(Y.setAttribute("display","block"),Y.setAttribute("transform",r)):Y.setAttribute("display","none"),W.setAttribute("transform",r),e.data(W,"bg").setAttribute("transform",r);var i=e.data(W,"stop"),s=(n-10)/p;i.setAttribute("offset",s);var o=0;e(C).find("stop").each(function(t){var n=this.getAttribute("offset"),a=e(this);n<o&&(a.prev().before(a),q=e(C).find("stop")),o=n})}})},e}function jqPluginSpinBtn(e){e.loadingStylesheets||(e.loadingStylesheets=[]);return e.loadingStylesheets.includes("spinbtn/JQuerySpinBtn.css")||e.loadingStylesheets.push("spinbtn/JQuerySpinBtn.css"),e.fn.SpinButton=function(t){function n(t,n){for(var a=document.body,r=t[n];(t=t.offsetParent)&&t!==a;)e.browser.msie&&"relative"===t.currentStyle.position||(r+=t[n]);return r}return t=t||{},this.each(function(){this.repeating=!1,this.spinCfg={min:isNaN(parseFloat(t.min))?null:Number(t.min),max:isNaN(parseFloat(t.max))?null:Number(t.max),step:t.step?Number(t.step):1,stepfunc:t.stepfunc||!1,page:t.page?Number(t.page):10,upClass:t.upClass||"up",downClass:t.downClass||"down",reset:t.reset||this.value,delay:t.delay?Number(t.delay):500,interval:t.interval?Number(t.interval):100,_btn_width:20,_direction:null,_delay:null,_repeat:null,callback:t.callback||null},this.spinCfg.smallStep=t.smallStep||this.spinCfg.step/2,this.adjustValue=function(e){var t=void 0;t=isNaN(this.value)?this.spinCfg.reset:"function"==typeof this.spinCfg.stepfunc?this.spinCfg.stepfunc(this,e):Number((Number(this.value)+Number(e)).toFixed(5)),null!==this.spinCfg.min&&(t=Math.max(t,this.spinCfg.min)),null!==this.spinCfg.max&&(t=Math.min(t,this.spinCfg.max)),this.value=t,"function"==typeof this.spinCfg.callback&&this.spinCfg.callback(this)},e(this).addClass(t.spinClass||"spin-button").mousemove(function(a){var r=a.pageX||a.x,i=a.pageY||a.y,s=a.target,o=t.stateObj.tool_scale||1,l=e(s).height()/2,u=r>n(s,"offsetLeft")+s.offsetWidth*o-this.spinCfg._btn_width?i<n(s,"offsetTop")+l*o?1:-1:0;if(u!==this.spinCfg._direction){switch(u){case 1:e(this).removeClass(this.spinCfg.downClass).addClass(this.spinCfg.upClass);break;case-1:e(this).removeClass(this.spinCfg.upClass).addClass(this.spinCfg.downClass);break;default:e(this).removeClass(this.spinCfg.upClass).removeClass(this.spinCfg.downClass)}this.spinCfg._direction=u}}).mouseout(function(){e(this).removeClass(this.spinCfg.upClass).removeClass(this.spinCfg.downClass),this.spinCfg._direction=null,window.clearInterval(this.spinCfg._repeat),window.clearTimeout(this.spinCfg._delay)}).mousedown(function(e){var t=this;if(0===e.button&&0!==this.spinCfg._direction){var n=e.shiftKey?this.spinCfg.smallStep:this.spinCfg.step,a=function(){t.adjustValue(t.spinCfg._direction*n)};a(),this.spinCfg._delay=window.setTimeout(function(){a(),t.spinCfg._repeat=window.setInterval(a,t.spinCfg.interval)},this.spinCfg.delay)}}).mouseup(function(e){window.clearInterval(this.spinCfg._repeat),window.clearTimeout(this.spinCfg._delay)}).dblclick(function(t){e.browser.msie&&this.adjustValue(this.spinCfg._direction*this.spinCfg.step)}).keydown(function(e){switch(e.keyCode){case 38:this.adjustValue(this.spinCfg.step);break;case 40:this.adjustValue(-this.spinCfg.step);break;case 33:this.adjustValue(this.spinCfg.page);break;case 34:this.adjustValue(-this.spinCfg.page)}}).keypress(function(e){if(this.repeating)switch(e.keyCode){case 38:this.adjustValue(this.spinCfg.step);break;case 40:this.adjustValue(-this.spinCfg.step);break;case 33:this.adjustValue(this.spinCfg.page);break;case 34:this.adjustValue(-this.spinCfg.page)}else this.repeating=!0}).keyup(function(e){switch(this.repeating=!1,e.keyCode){case 38:case 40:case 33:case 34:case 13:this.adjustValue(0)}}).bind("mousewheel",function(e){e.wheelDelta>=120?this.adjustValue(this.spinCfg.step):e.wheelDelta<=-120&&this.adjustValue(-this.spinCfg.step),e.preventDefault()}).change(function(e){this.adjustValue(0)}),this.addEventListener&&this.addEventListener("DOMMouseScroll",function(e){e.detail>0?this.adjustValue(-this.spinCfg.step):e.detail<0&&this.adjustValue(this.spinCfg.step),e.preventDefault()},!1)})},e}function jqPluginContextMenu(e){var t=e(window),n=e(document);return e.extend(e.fn,{contextMenu:function(a,r){return void 0!==a.menu&&(void 0===a.inSpeed&&(a.inSpeed=150),void 0===a.outSpeed&&(a.outSpeed=75),0===a.inSpeed&&(a.inSpeed=-1),0===a.outSpeed&&(a.outSpeed=-1),e(this).each(function(){var i=e(this),s=e(i).offset(),o=e("#"+a.menu);o.addClass("contextMenu"),e(this).bind("mousedown",function(l){var u=l;e(this).mouseup(function(l){var c=e(this);if(c.unbind("mouseup"),2===u.button||a.allowLeft||u.ctrlKey&&isMac()){if(l.stopPropagation(),e(".contextMenu").hide(),i.hasClass("disabled"))return!1;var h=l.pageX,d=l.pageY,f=t.width()-o.width(),p=t.height()-o.height();h>f-15&&(h=f-15),d>p-30&&(d=p-30),n.unbind("click"),o.css({top:d,left:h}).fadeIn(a.inSpeed),o.find("A").mouseover(function(){o.find("LI.hover").removeClass("hover"),e(this).parent().addClass("hover")}).mouseout(function(){o.find("LI.hover").removeClass("hover")}),n.keypress(function(e){switch(e.keyCode){case 38:o.find("LI.hover").length?(o.find("LI.hover").removeClass("hover").prevAll("LI:not(.disabled)").eq(0).addClass("hover"),o.find("LI.hover").length||o.find("LI:last").addClass("hover")):o.find("LI:last").addClass("hover");break;case 40:o.find("LI.hover").length?(o.find("LI.hover").removeClass("hover").nextAll("LI:not(.disabled)").eq(0).addClass("hover"),o.find("LI.hover").length||o.find("LI:first").addClass("hover")):o.find("LI:first").addClass("hover");break;case 13:o.find("LI.hover A").trigger("click");break;case 27:n.trigger("click")}}),o.find("A").unbind("mouseup"),o.find("LI:not(.disabled) A").mouseup(function(){return n.unbind("click").unbind("keypress"),e(".contextMenu").hide(),r&&r(e(this).attr("href").substr(1),e(c),{x:h-s.left,y:d-s.top,docX:h,docY:d}),!1}),setTimeout(function(){n.click(function(){return n.unbind("click").unbind("keypress"),o.fadeOut(a.outSpeed),!1})},0)}})}),e.browser.mozilla?e("#"+a.menu).each(function(){e(this).css({MozUserSelect:"none"})}):e.browser.msie?e("#"+a.menu).each(function(){e(this).bind("selectstart.disableTextSelect",function(){return!1})}):e("#"+a.menu).each(function(){e(this).bind("mousedown.disableTextSelect",function(){return!1})}),e(i).add(e("UL.contextMenu")).bind("contextmenu",function(){return!1})}),e(this))},disableContextMenuItems:function(t){return void 0===t?(e(this).find("LI").addClass("disabled"),e(this)):(e(this).each(function(){if(void 0!==t)for(var n=t.split(","),a=0;a<n.length;a++)e(this).find('A[href="'+n[a]+'"]').parent().addClass("disabled")}),e(this))},enableContextMenuItems:function(t){return void 0===t?(e(this).find("LI.disabled").removeClass("disabled"),e(this)):(e(this).each(function(){if(void 0!==t)for(var n=t.split(","),a=0;a<n.length;a++)e(this).find('A[href="'+n[a]+'"]').parent().removeClass("disabled")}),e(this))},disableContextMenu:function(){return e(this).each(function(){e(this).addClass("disabled")}),e(this)},enableContextMenu:function(){return e(this).each(function(){e(this).removeClass("disabled")}),e(this)},destroyContextMenu:function(){return e(this).each(function(){e(this).unbind("mousedown").unbind("mouseup")}),e(this)}}),e}window.console||(window.console={log:function(e){},dir:function(e){}}),Math.precision=function(e,t){return void 0===t&&(t=0),Math.round(e*Math.pow(10,t))/Math.pow(10,t)};var jPicker=function(e){e.loadingStylesheets||(e.loadingStylesheets=[]);function t(t,n){var a=this;function r(n){var r=t.offset();c={l:0|r.left,t:0|r.top},clearTimeout(h),h=setTimeout(function(){o.call(a,n)},0),e(document).bind("mousemove",i).bind("mouseup",s),n.preventDefault()}function i(e){return clearTimeout(h),h=setTimeout(function(){o.call(a,e)},0),e.stopPropagation(),e.preventDefault(),!1}function s(t){return e(document).unbind("mouseup",s).unbind("mousemove",i),t.stopPropagation(),t.preventDefault(),!1}function o(e){var n=t.w,r=t.h,i=e.pageX-c.l,s=e.pageY-c.t;i<0?i=0:i>n&&(i=n),s<0?s=0:s>r&&(s=r),l.call(a,"xy",{x:i/n*v+p,y:s/r*b+m})}function l(e,t,n){if(!(void 0!==t))switch(void 0!==e&&null!=e||(e="xy"),e.toLowerCase()){case"x":return d;case"y":return f;case"xy":default:return{x:d,y:f}}if(null==n||n!==a){var r=!1,i=void 0,s=void 0;switch(null==e&&(e="xy"),e.toLowerCase()){case"x":i=t&&(t.x&&0|t.x||0|t)||0;break;case"y":s=t&&(t.y&&0|t.y||0|t)||0;break;case"xy":default:i=t&&t.x&&0|t.x||0,s=t&&t.y&&0|t.y||0}null!=i&&(i<p?i=p:i>g&&(i=g),d!==i&&(d=i,r=!0)),null!=s&&(s<m?s=m:s>y&&(s=y),f!==s&&(f=s,r=!0)),r&&function(e){for(var t=0;t<x.length;t++)x[t].call(a,a,e)}.call(a,n||a)}}function u(e){"function"==typeof e&&x.push(e)}var c=void 0,h=void 0,d=0,f=0,p=0,g=100,v=100,m=0,y=100,b=100,_=t.find("img:first"),x=[];e.extend(!0,a,{val:l,range:function(e,t){if(void 0===t)switch(void 0!==e&&null!=e||(e="all"),e.toLowerCase()){case"minx":return p;case"maxx":return g;case"rangex":return{minX:p,maxX:g,rangeX:v};case"miny":return m;case"maxy":return y;case"rangey":return{minY:m,maxY:y,rangeY:b};case"all":default:return{minX:p,maxX:g,rangeX:v,minY:m,maxY:y,rangeY:b}}var n=void 0,a=void 0,r=void 0,i=void 0;switch(null==e&&(e="all"),e.toLowerCase()){case"minx":n=t&&(t.minX&&0|t.minX||0|t)||0;break;case"maxx":a=t&&(t.maxX&&0|t.maxX||0|t)||0;break;case"rangex":n=t&&t.minX&&0|t.minX||0,a=t&&t.maxX&&0|t.maxX||0;break;case"miny":r=t&&(t.minY&&0|t.minY||0|t)||0;break;case"maxy":i=t&&(t.maxY&&0|t.maxY||0|t)||0;break;case"rangey":r=t&&t.minY&&0|t.minY||0,i=t&&t.maxY&&0|t.maxY||0;break;case"all":default:n=t&&t.minX&&0|t.minX||0,a=t&&t.maxX&&0|t.maxX||0,r=t&&t.minY&&0|t.minY||0,i=t&&t.maxY&&0|t.maxY||0}null!=n&&p!==n&&(v=g-(p=n)),null!=a&&g!==a&&(v=(g=a)-p),null!=r&&m!==r&&(b=y-(m=r)),null!=i&&y!==i&&(b=(y=i)-m)},bind:u,unbind:function(e){if("function"==typeof e)for(var t=void 0;t=x.includes(e);)x.splice(t,1)},destroy:function(){e(document).unbind("mouseup",s).unbind("mousemove",i),t.unbind("mousedown",r),t=null,_=null,x=null}}),_.src=n.arrow&&n.arrow.image,_.w=n.arrow&&n.arrow.width||_.width(),_.h=n.arrow&&n.arrow.height||_.height(),t.w=n.map&&n.map.width||t.width(),t.h=n.map&&n.map.height||t.height(),t.bind("mousedown",r),u.call(a,function(){var e=t.w,n=t.h,a=_.w,r=_.h,i=0,s=0;setTimeout(function(){v>0&&(i=d===g?e:d/v*e|0),b>0&&(s=f===y?n:f/b*n|0),a>=e?i=(e>>1)-(a>>1):i-=a>>1,r>=n?s=(n>>1)-(r>>1):s-=r>>1,_.css({left:i+"px",top:s+"px"})},0)})}e.loadingStylesheets.includes("jgraduate/css/jPicker.css")||e.loadingStylesheets.push("jgraduate/css/jPicker.css"),e.jPicker={List:[],Color:function t(n){classCallCheck(this,t);var a=this;function r(e){for(var t=0;t<p.length;t++)p[t].call(a,a,e)}function s(e,t,n){var p=Boolean(t);if(p&&""===t.ahex&&(t.ahex="00000000"),!p){if(void 0!==e&&null!=e&&""!==e||(e="all"),null==o)return null;switch(e.toLowerCase()){case"ahex":return i.rgbaToHex({r:o,g:l,b:u,a:c});case"hex":return s("ahex").substring(0,6);case"all":return{r:o,g:l,b:u,a:c,h:h,s:d,v:f,hex:s.call(a,"hex"),ahex:s.call(a,"ahex")};default:for(var g={},v=0;v<e.length;v++)switch(e.charAt(v)){case"r":1===e.length?g=o:g.r=o;break;case"g":1===e.length?g=l:g.g=l;break;case"b":1===e.length?g=u:g.b=u;break;case"a":1===e.length?g=c:g.a=c;break;case"h":1===e.length?g=h:g.h=h;break;case"s":1===e.length?g=d:g.s=d;break;case"v":1===e.length?g=f:g.v=f}return e.length?g:s.call(a,"all")}}if(null==n||n!==a){null==e&&(e="");var m=!1;if(null==t)return null!=o&&(o=null,m=!0),null!=l&&(l=null,m=!0),null!=u&&(u=null,m=!0),null!=c&&(c=null,m=!0),null!=h&&(h=null,m=!0),null!=d&&(d=null,m=!0),null!=f&&(f=null,m=!0),void(m&&r.call(a,n||a));switch(e.toLowerCase()){case"ahex":case"hex":var y=i.hexToRgba(t&&(t.ahex||t.hex)||t||"none");s.call(a,"rgba",{r:y.r,g:y.g,b:y.b,a:"ahex"===e?y.a:null!=c?c:255},n);break;default:if(t&&(null!=t.ahex||null!=t.hex))return void s.call(a,"ahex",t.ahex||t.hex||"00000000",n);var b={},_=!1,x=!1;void 0===t.r||e.includes("r")||(e+="r"),void 0===t.g||e.includes("g")||(e+="g"),void 0===t.b||e.includes("b")||(e+="b"),void 0===t.a||e.includes("a")||(e+="a"),void 0===t.h||e.includes("h")||(e+="h"),void 0===t.s||e.includes("s")||(e+="s"),void 0===t.v||e.includes("v")||(e+="v");for(var C=0;C<e.length;C++)switch(e.charAt(C)){case"r":if(x)continue;_=!0,b.r=t&&t.r&&0|t.r||t&&0|t||0,b.r<0?b.r=0:b.r>255&&(b.r=255),o!==b.r&&(o=b.r,m=!0);break;case"g":if(x)continue;_=!0,b.g=t&&t.g&&0|t.g||t&&0|t||0,b.g<0?b.g=0:b.g>255&&(b.g=255),l!==b.g&&(l=b.g,m=!0);break;case"b":if(x)continue;_=!0,b.b=t&&t.b&&0|t.b||t&&0|t||0,b.b<0?b.b=0:b.b>255&&(b.b=255),u!==b.b&&(u=b.b,m=!0);break;case"a":b.a=t&&null!=t.a?0|t.a:null!=t?0|t:255,b.a<0?b.a=0:b.a>255&&(b.a=255),c!==b.a&&(c=b.a,m=!0);break;case"h":if(_)continue;x=!0,b.h=t&&t.h&&0|t.h||t&&0|t||0,b.h<0?b.h=0:b.h>360&&(b.h=360),h!==b.h&&(h=b.h,m=!0);break;case"s":if(_)continue;x=!0,b.s=t&&null!=t.s?0|t.s:null!=t?0|t:100,b.s<0?b.s=0:b.s>100&&(b.s=100),d!==b.s&&(d=b.s,m=!0);break;case"v":if(_)continue;x=!0,b.v=t&&null!=t.v?0|t.v:null!=t?0|t:100,b.v<0?b.v=0:b.v>100&&(b.v=100),f!==b.v&&(f=b.v,m=!0)}if(m){if(_){o=o||0,l=l||0,u=u||0;var S=i.rgbToHsv({r:o,g:l,b:u});h=S.h,d=S.s,f=S.v}else if(x){h=h||0,d=null!=d?d:100,f=null!=f?f:100;var w=i.hsvToRgb({h:h,s:d,v:f});o=w.r,l=w.g,u=w.b}c=null!=c?c:255,r.call(a,n||a)}}}}var o=void 0,l=void 0,u=void 0,c=void 0,h=void 0,d=void 0,f=void 0,p=[];e.extend(!0,a,{val:s,bind:function(e){"function"==typeof e&&p.push(e)},unbind:function(e){if("function"==typeof e)for(var t=void 0;t=p.includes(e);)p.splice(t,1)},destroy:function(){p=null}}),n&&(null!=n.ahex?s("ahex",n):null!=n.hex?s((null!=n.a?"a":"")+"hex",null!=n.a?{ahex:n.hex+i.intToHex(n.a)}:n):null!=n.r&&null!=n.g&&null!=n.b?s("rgb"+(null!=n.a?"a":""),n):null!=n.h&&null!=n.s&&null!=n.v&&s("hsv"+(null!=n.a?"a":""),n))},ColorMethods:{hexToRgba:function(e){if(""===e||"none"===e)return{r:null,g:null,b:null,a:null};var t="00",n="00",a="00",r="255";return 6===(e=this.validateHex(e)).length&&(e+="ff"),e.length>6?(t=e.substring(0,2),n=e.substring(2,4),a=e.substring(4,6),r=e.substring(6,e.length)):(e.length>4&&(t=e.substring(4,e.length),e=e.substring(0,4)),e.length>2&&(n=e.substring(2,e.length),e=e.substring(0,2)),e.length>0&&(a=e.substring(0,e.length))),{r:this.hexToInt(t),g:this.hexToInt(n),b:this.hexToInt(a),a:this.hexToInt(r)}},validateHex:function(e){return(e=e.toLowerCase().replace(/[^a-f0-9]/g,"")).length>8&&(e=e.substring(0,8)),e},rgbaToHex:function(e){return this.intToHex(e.r)+this.intToHex(e.g)+this.intToHex(e.b)+this.intToHex(e.a)},intToHex:function(e){var t=(0|e).toString(16);return 1===t.length&&(t="0"+t),t.toLowerCase()},hexToInt:function(e){return parseInt(e,16)},rgbToHsv:function(e){var t=e.r/255,n=e.g/255,a=e.b/255,r={h:0,s:0,v:0},i=0,s=0;t>=n&&t>=a?(s=t,i=n>a?a:n):n>=a&&n>=t?(s=n,i=t>a?a:t):(s=a,i=n>t?t:n),r.v=s,r.s=s?(s-i)/s:0;var o=void 0;return r.s?(o=s-i,r.h=t===s?(n-a)/o:n===s?2+(a-t)/o:4+(t-n)/o,r.h=parseInt(60*r.h),r.h<0&&(r.h+=360)):r.h=0,r.s=100*r.s|0,r.v=100*r.v|0,r},hsvToRgb:function(e){var t={r:0,g:0,b:0,a:100},n=e.h,a=e.s,r=e.v;if(0===a)t.r=t.g=t.b=0===r?0:255*r/100|0;else{360===n&&(n=0);var i=0|(n/=60),s=n-i,o=(r/=100)*(1-(a/=100)),l=r*(1-a*s),u=r*(1-a*(1-s));switch(i){case 0:t.r=r,t.g=u,t.b=o;break;case 1:t.r=l,t.g=r,t.b=o;break;case 2:t.r=o,t.g=r,t.b=u;break;case 3:t.r=o,t.g=l,t.b=r;break;case 4:t.r=u,t.g=o,t.b=r;break;case 5:t.r=r,t.g=o,t.b=l}t.r=255*t.r|0,t.g=255*t.g|0,t.b=255*t.b|0}return t}}};var n=e.jPicker,a=n.Color,r=n.List,i=n.ColorMethods;return e.fn.jPicker=function(n){var s=arguments;return this.each(function(){var o=this,l=e.extend(!0,{},e.fn.jPicker.defaults,n);"input"===e(o).get(0).nodeName.toLowerCase()&&(e.extend(!0,l,{window:{bindToInput:!0,expandable:!0,input:e(o)}}),""===e(o).val()?(l.color.active=new a({hex:null}),l.color.current=new a({hex:null})):i.validateHex(e(o).val())&&(l.color.active=new a({hex:e(o).val(),a:l.color.active.val("a")}),l.color.current=new a({hex:e(o).val(),a:l.color.active.val("a")}))),l.window.expandable?e(o).after('<span class="jPicker"><span class="Icon"><span class="Color">&nbsp;</span><span class="Alpha">&nbsp;</span><span class="Image" title="Click To Open Color Picker">&nbsp;</span><span class="Container">&nbsp;</span></span></span>'):l.window.liveUpdate=!1;var u=parseFloat(navigator.appVersion.split("MSIE")[1])<7&&document.body.filters;function c(e){var t=M.active,n=t.val("hex"),a=void 0,r=void 0;switch(l.color.mode=e,e){case"h":if(setTimeout(function(){p.call(o,D,"transparent"),v.call(o,U,0),m.call(o,U,100),v.call(o,H,260),m.call(o,H,100),p.call(o,F,"transparent"),v.call(o,q,0),m.call(o,q,100),v.call(o,X,260),m.call(o,X,100),v.call(o,W,260),m.call(o,W,100),v.call(o,Y,260),m.call(o,Y,100),v.call(o,Z,260),m.call(o,Z,100)},0),K.range("all",{minX:0,maxX:100,minY:0,maxY:100}),J.range("rangeY",{minY:0,maxY:360}),null==t.val("ahex"))break;K.val("xy",{x:t.val("s"),y:100-t.val("v")},K),J.val("y",360-t.val("h"),J);break;case"s":if(setTimeout(function(){p.call(o,D,"transparent"),v.call(o,U,-260),v.call(o,H,-520),v.call(o,q,-260),v.call(o,X,-520),v.call(o,Z,260),m.call(o,Z,100)},0),K.range("all",{minX:0,maxX:360,minY:0,maxY:100}),J.range("rangeY",{minY:0,maxY:100}),null==t.val("ahex"))break;K.val("xy",{x:t.val("h"),y:100-t.val("v")},K),J.val("y",100-t.val("s"),J);break;case"v":if(setTimeout(function(){p.call(o,D,"000000"),v.call(o,U,-780),v.call(o,H,260),p.call(o,F,n),v.call(o,q,-520),v.call(o,X,260),m.call(o,X,100),v.call(o,Z,260),m.call(o,Z,100)},0),K.range("all",{minX:0,maxX:360,minY:0,maxY:100}),J.range("rangeY",{minY:0,maxY:100}),null==t.val("ahex"))break;K.val("xy",{x:t.val("h"),y:100-t.val("s")},K),J.val("y",100-t.val("v"),J);break;case"r":if(a=-1040,r=-780,K.range("all",{minX:0,maxX:255,minY:0,maxY:255}),J.range("rangeY",{minY:0,maxY:255}),null==t.val("ahex"))break;K.val("xy",{x:t.val("b"),y:255-t.val("g")},K),J.val("y",255-t.val("r"),J);break;case"g":if(a=-1560,r=-1820,K.range("all",{minX:0,maxX:255,minY:0,maxY:255}),J.range("rangeY",{minY:0,maxY:255}),null==t.val("ahex"))break;K.val("xy",{x:t.val("b"),y:255-t.val("r")},K),J.val("y",255-t.val("g"),J);break;case"b":if(a=-2080,r=-2860,K.range("all",{minX:0,maxX:255,minY:0,maxY:255}),J.range("rangeY",{minY:0,maxY:255}),null==t.val("ahex"))break;K.val("xy",{x:t.val("r"),y:255-t.val("g")},K),J.val("y",255-t.val("b"),J);break;case"a":if(setTimeout(function(){p.call(o,D,"transparent"),v.call(o,U,-260),v.call(o,H,-520),v.call(o,q,260),v.call(o,X,260),m.call(o,X,100),v.call(o,Z,0),m.call(o,Z,100)},0),K.range("all",{minX:0,maxX:360,minY:0,maxY:100}),J.range("rangeY",{minY:0,maxY:255}),null==t.val("ahex"))break;K.val("xy",{x:t.val("h"),y:100-t.val("v")},K),J.val("y",255-t.val("a"),J);break;default:throw new Error("Invalid Mode")}switch(e){case"h":break;case"s":case"v":case"a":setTimeout(function(){m.call(o,U,100),m.call(o,q,100),v.call(o,W,260),m.call(o,W,100),v.call(o,Y,260),m.call(o,Y,100)},0);break;case"r":case"g":case"b":setTimeout(function(){p.call(o,D,"transparent"),p.call(o,F,"transparent"),m.call(o,q,100),m.call(o,U,100),v.call(o,U,a),v.call(o,H,a-260),v.call(o,q,r-780),v.call(o,X,r-520),v.call(o,W,r),v.call(o,Y,r-260),v.call(o,Z,260),m.call(o,Z,100)},0)}null!=t.val("ahex")&&h.call(o,t)}function h(e,t){(null==t||t!==J&&t!==K)&&function(e,t){if(t!==K)switch(l.color.mode){case"h":var n=e.val("sv");K.val("xy",{x:null!=n?n.s:100,y:100-(null!=n?n.v:100)},t);break;case"s":case"a":var a=e.val("hv");K.val("xy",{x:a&&a.h||0,y:100-(null!=a?a.v:100)},t);break;case"v":var r=e.val("hs");K.val("xy",{x:r&&r.h||0,y:100-(null!=r?r.s:100)},t);break;case"r":var i=e.val("bg");K.val("xy",{x:i&&i.b||0,y:255-(i&&i.g||0)},t);break;case"g":var s=e.val("br");K.val("xy",{x:s&&s.b||0,y:255-(s&&s.r||0)},t);break;case"b":var o=e.val("rg");K.val("xy",{x:o&&o.r||0,y:255-(o&&o.g||0)},t)}if(t!==J)switch(l.color.mode){case"h":J.val("y",360-(e.val("h")||0),t);break;case"s":var u=e.val("s");J.val("y",100-(null!=u?u:100),t);break;case"v":var c=e.val("v");J.val("y",100-(null!=c?c:100),t);break;case"r":J.val("y",255-(e.val("r")||0),t);break;case"g":J.val("y",255-(e.val("g")||0),t);break;case"b":J.val("y",255-(e.val("b")||0),t);break;case"a":var h=e.val("a");J.val("y",255-(null!=h?h:255),t)}}.call(o,e,t),setTimeout(function(){(function(e){try{var t=e.val("all");te.css({backgroundColor:t&&"#"+t.hex||"transparent"}),m.call(o,te,t&&Math.precision(100*t.a/255,4)||0)}catch(e){}}).call(o,e),function(e){switch(l.color.mode){case"h":p.call(o,D,new a({h:e.val("h")||0,s:100,v:100}).val("hex"));break;case"s":case"a":var t=e.val("s");m.call(o,H,100-(null!=t?t:100));break;case"v":var n=e.val("v");m.call(o,U,null!=n?n:100);break;case"r":m.call(o,H,Math.precision((e.val("r")||0)/255*100,4));break;case"g":m.call(o,H,Math.precision((e.val("g")||0)/255*100,4));break;case"b":m.call(o,H,Math.precision((e.val("b")||0)/255*100))}var r=e.val("a");m.call(o,z,Math.precision(100*(255-(r||0))/255,4))}.call(o,e),function(e){switch(l.color.mode){case"h":var t=e.val("a");m.call(o,Q,Math.precision(100*(255-(t||0))/255,4));break;case"s":var n=e.val("hva"),r=new a({h:n&&n.h||0,s:100,v:null!=n?n.v:100});p.call(o,F,r.val("hex")),m.call(o,X,100-(null!=n?n.v:100)),m.call(o,Q,Math.precision(100*(255-(n&&n.a||0))/255,4));break;case"v":var i=e.val("hsa"),s=new a({h:i&&i.h||0,s:null!=i?i.s:100,v:100});p.call(o,F,s.val("hex")),m.call(o,Q,Math.precision(100*(255-(i&&i.a||0))/255,4));break;case"r":case"g":case"b":var u=e.val("rgba"),c=0,h=0;"r"===l.color.mode?(c=u&&u.b||0,h=u&&u.g||0):"g"===l.color.mode?(c=u&&u.b||0,h=u&&u.r||0):"b"===l.color.mode&&(c=u&&u.r||0,h=u&&u.g||0);var d=h>c?c:h;m.call(o,X,c>h?Math.precision((c-h)/(255-h)*100,4):0),m.call(o,W,h>c?Math.precision((h-c)/(255-c)*100,4):0),m.call(o,Y,Math.precision(d/255*100,4)),m.call(o,Q,Math.precision(100*(255-(u&&u.a||0))/255,4));break;case"a":var f=e.val("a");p.call(o,F,e.val("hex")||"000000"),m.call(o,Q,null!=f?0:100),m.call(o,Z,null!=f?100:0)}}.call(o,e)},0)}function d(e,t){var n=M.active;if(t===K||null!=n.val()){var a=e.val("all");switch(l.color.mode){case"h":n.val("sv",{s:a.x,v:100-a.y},t);break;case"s":case"a":n.val("hv",{h:a.x,v:100-a.y},t);break;case"v":n.val("hs",{h:a.x,s:100-a.y},t);break;case"r":n.val("gb",{g:255-a.y,b:a.x},t);break;case"g":n.val("rb",{r:255-a.y,b:a.x},t);break;case"b":n.val("rg",{r:a.x,g:255-a.y},t)}}}function f(e,t){var n=M.active;if(t===J||null!=n.val())switch(l.color.mode){case"h":n.val("h",{h:360-e.val("y")},t);break;case"s":n.val("s",{s:100-e.val("y")},t);break;case"v":n.val("v",{v:100-e.val("y")},t);break;case"r":n.val("r",{r:255-e.val("y")},t);break;case"g":n.val("g",{g:255-e.val("y")},t);break;case"b":n.val("b",{b:255-e.val("y")},t);break;case"a":n.val("a",255-e.val("y"),t)}}function p(e,t){e.css({backgroundColor:t&&6===t.length&&"#"+t||"transparent"})}function g(e,t){u&&(t.includes("AlphaBar.png")||t.includes("Bars.png")||t.includes("Maps.png"))?(e.attr("pngSrc",t),e.css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+t+"', sizingMethod='scale')"})):e.css({backgroundImage:"url('"+t+"')"})}function v(e,t){e.css({top:t+"px"})}function m(e,t){if(e.css({visibility:t>0?"visible":"hidden"}),t>0&&t<100)if(u){var n=e.attr("pngSrc");null!=n&&(n.includes("AlphaBar.png")||n.includes("Bars.png")||n.includes("Maps.png"))?e.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+n+"', sizingMethod='scale') progid:DXImageTransform.Microsoft.Alpha(opacity="+t+")"}):e.css({opacity:Math.precision(t/100,4)})}else e.css({opacity:Math.precision(t/100,4)});else if(0===t||100===t)if(u){var a=e.attr("pngSrc");null!=a&&(a.includes("AlphaBar.png")||a.includes("Bars.png")||a.includes("Maps.png"))?e.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a+"', sizingMethod='scale')"}):e.css({opacity:""})}else e.css({opacity:""})}function y(){M.active.val("ahex",M.current.val("ahex"))}function b(t){e(this).parents("tbody:first").find('input:radio[value!="'+t.target.value+'"]').removeAttr("checked"),c.call(o,t.target.value)}function _(){y.call(o)}function x(){y.call(o),l.window.expandable&&N.call(o),"function"==typeof de&&de.call(o,M.active,re)}function C(){(function(){M.current.val("ahex",M.active.val("ahex"))}).call(o),l.window.expandable&&N.call(o),"function"==typeof ce&&ce.call(o,M.active,ae)}function S(){T.call(o)}function w(e,t){var n=e.val("hex");ne.css({backgroundColor:n&&"#"+n||"transparent"}),m.call(o,ne,Math.precision(100*(e.val("a")||0)/255,4))}function k(e,t){var n=e.val("hex"),a=e.val("va");se.css({backgroundColor:n&&"#"+n||"transparent"}),m.call(o,oe,Math.precision(100*(255-(a&&a.a||0))/255,4)),l.window.bindToInput&&l.window.updateInputColor&&l.window.input.css({backgroundColor:n&&"#"+n||"transparent",color:null==a||a.v>75?"#000000":"#ffffff"})}function $(t){B=parseInt(j.css("left")),O=parseInt(j.css("top")),V=t.pageX,R=t.pageY,e(document).bind("mousemove",P).bind("mouseup",E),t.preventDefault()}function P(t){return j.css({left:B-(V-t.pageX)+"px",top:O-(R-t.pageY)+"px"}),l.window.expandable&&!e.support.boxModel&&j.prev().css({left:j.css("left"),top:j.css("top")}),t.stopPropagation(),t.preventDefault(),!1}function E(t){return e(document).unbind("mousemove",P).unbind("mouseup",E),t.stopPropagation(),t.preventDefault(),!1}function A(t){return t.preventDefault(),t.stopPropagation(),M.active.val("ahex",e(this).attr("title")||null,t.target),!1}function T(){function t(){if(l.window.expandable&&!e.support.boxModel){var t=j.find("table:first");j.before("<iframe/>"),j.prev().css({width:t.width(),height:j.height(),opacity:0,position:"absolute",left:j.css("left"),top:j.css("top")})}}switch(M.current.val("ahex",M.active.val("ahex")),l.window.expandable&&(e(document.body).children("div.jPicker.Container").css({zIndex:10}),j.css({zIndex:20})),l.window.effects.type){case"fade":j.fadeIn(l.window.effects.speed.show,t);break;case"slide":j.slideDown(l.window.effects.speed.show,t);break;case"show":default:j.show(l.window.effects.speed.show,t)}}function N(){function t(){l.window.expandable&&j.css({zIndex:10}),l.window.expandable&&!e.support.boxModel&&j.prev().remove()}switch(l.window.effects.type){case"fade":j.fadeOut(l.window.effects.speed.hide,t);break;case"slide":j.slideUp(l.window.effects.speed.hide,t);break;case"show":default:j.hide(l.window.effects.speed.hide,t)}}function G(){var n=l.window,r=n.expandable?e(o).next().find(".Container:first"):null;(j=n.expandable?e("<div/>"):e(o)).addClass("jPicker Container"),n.expandable&&j.hide(),j.get(0).onselectstart=function(e){if("input"!==e.target.nodeName.toLowerCase())return!1};var i=M.active.val("all");n.alphaPrecision<0?n.alphaPrecision=0:n.alphaPrecision>2&&(n.alphaPrecision=2);var s='<table class="jPicker" cellpadding="0" cellspacing="0"><tbody>'+(n.expandable?'<tr><td class="Move" colspan="5">&nbsp;</td></tr>':"")+'<tr><td rowspan="9"><h2 class="Title">'+(n.title||I.text.title)+'</h2><div class="Map"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><img src="'+L.clientPath+L.colorMap.arrow.file+'" class="Arrow"/></div></td><td rowspan="9"><div class="Bar"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><span class="Map4">&nbsp;</span><span class="Map5">&nbsp;</span><span class="Map6">&nbsp;</span><img src="'+L.clientPath+L.colorBar.arrow.file+'" class="Arrow"/></div></td><td colspan="2" class="Preview">'+I.text.newColor+'<div><span class="Active" title="'+I.tooltips.colors.newColor+'">&nbsp;</span><span class="Current" title="'+I.tooltips.colors.currentColor+'">&nbsp;</span></div>'+I.text.currentColor+'</td><td rowspan="9" class="Button"><input type="button" class="Ok" value="'+I.text.ok+'" title="'+I.tooltips.buttons.ok+'"/><input type="button" class="Cancel" value="'+I.text.cancel+'" title="'+I.tooltips.buttons.cancel+'"/><hr/><div class="Grid">&nbsp;</div></td></tr><tr class="Hue"><td class="Radio"><label title="'+I.tooltips.hue.radio+'"><input type="radio" value="h"'+("h"===l.color.mode?' checked="checked"':"")+'/>H:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=i?i.h:"")+'" title="'+I.tooltips.hue.textbox+'"/>&nbsp;&deg;</td></tr><tr class="Saturation"><td class="Radio"><label title="'+I.tooltips.saturation.radio+'"><input type="radio" value="s"'+("s"===l.color.mode?' checked="checked"':"")+'/>S:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=i?i.s:"")+'" title="'+I.tooltips.saturation.textbox+'"/>&nbsp;%</td></tr><tr class="Value"><td class="Radio"><label title="'+I.tooltips.value.radio+'"><input type="radio" value="v"'+("v"===l.color.mode?' checked="checked"':"")+'/>V:</label><br/><br/></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=i?i.v:"")+'" title="'+I.tooltips.value.textbox+'"/>&nbsp;%<br/><br/></td></tr><tr class="Red"><td class="Radio"><label title="'+I.tooltips.red.radio+'"><input type="radio" value="r"'+("r"===l.color.mode?' checked="checked"':"")+'/>R:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=i?i.r:"")+'" title="'+I.tooltips.red.textbox+'"/></td></tr><tr class="Green"><td class="Radio"><label title="'+I.tooltips.green.radio+'"><input type="radio" value="g"'+("g"===l.color.mode?' checked="checked"':"")+'/>G:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=i?i.g:"")+'" title="'+I.tooltips.green.textbox+'"/></td></tr><tr class="Blue"><td class="Radio"><label title="'+I.tooltips.blue.radio+'"><input type="radio" value="b"'+("b"===l.color.mode?' checked="checked"':"")+'/>B:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=i?i.b:"")+'" title="'+I.tooltips.blue.textbox+'"/></td></tr><tr class="Alpha"><td class="Radio">'+(n.alphaSupport?'<label title="'+I.tooltips.alpha.radio+'"><input type="radio" value="a"'+("a"===l.color.mode?' checked="checked"':"")+"/>A:</label>":"&nbsp;")+'</td><td class="Text">'+(n.alphaSupport?'<input type="text" maxlength="'+(3+n.alphaPrecision)+'" value="'+(null!=i?Math.precision(100*i.a/255,n.alphaPrecision):"")+'" title="'+I.tooltips.alpha.textbox+'"/>&nbsp;%':"&nbsp;")+'</td></tr><tr class="Hex"><td colspan="2" class="Text"><label title="'+I.tooltips.hex.textbox+'">#:<input type="text" maxlength="6" class="Hex" value="'+(null!=i?i.hex:"")+'"/></label>'+(n.alphaSupport?'<input type="text" maxlength="2" class="AHex" value="'+(null!=i?i.ahex.substring(6):"")+'" title="'+I.tooltips.hex.alpha+'"/></td>':"&nbsp;")+"</tr></tbody></table>";n.expandable?(j.html(s),e(document.body).children("div.jPicker.Container").length?e(document.body).children("div.jPicker.Container:last").after(j):e(document.body).prepend(j),j.mousedown(function(){e(document.body).children("div.jPicker.Container").css({zIndex:10}),j.css({zIndex:20})}),j.css({left:"left"===n.position.x?r.offset().left-530-("center"===n.position.y?25:0)+"px":"center"===n.position.x?r.offset().left-260+"px":"right"===n.position.x?r.offset().left-10+("center"===n.position.y?25:0)+"px":"screenCenter"===n.position.x?(e(document).width()>>1)-260+"px":r.offset().left+parseInt(n.position.x)+"px",position:"absolute",top:"top"===n.position.y?r.offset().top-312+"px":"center"===n.position.y?r.offset().top-156+"px":"bottom"===n.position.y?r.offset().top+25+"px":r.offset().top+parseInt(n.position.y)+"px"})):(j=e(o)).html(s);var u=j.find("tbody:first");D=u.find("div.Map:first"),F=u.find("div.Bar:first");var p=D.find("span"),v=F.find("span");U=p.filter(".Map1:first"),H=p.filter(".Map2:first"),z=p.filter(".Map3:first"),q=v.filter(".Map1:first"),X=v.filter(".Map2:first"),W=v.filter(".Map3:first"),Y=v.filter(".Map4:first"),Q=v.filter(".Map5:first"),Z=v.filter(".Map6:first"),(K=new t(D,{map:{width:L.colorMap.width,height:L.colorMap.height},arrow:{image:L.clientPath+L.colorMap.arrow.file,width:L.colorMap.arrow.width,height:L.colorMap.arrow.height}})).bind(d),(J=new t(F,{map:{width:L.colorBar.width,height:L.colorBar.height},arrow:{image:L.clientPath+L.colorBar.arrow.file,width:L.colorBar.arrow.width,height:L.colorBar.arrow.height}})).bind(f),ee=new function(t,n,a,r){var i=this,s=t.find("td.Text input");function o(e){if(""!==e.target.value||e.target===_.get(0)||(null==a||e.target===a.get(0))&&null!=a){if(!c(e))return e;switch(e.target){case f.get(0):switch(e.keyCode){case 38:return f.val(h.call(i,1+(f.val()<<0),0,255)),n.val("r",f.val(),e.target),!1;case 40:return f.val(h.call(i,(f.val()<<0)-1,0,255)),n.val("r",f.val(),e.target),!1}break;case p.get(0):switch(e.keyCode){case 38:return p.val(h.call(i,1+(p.val()<<0),0,255)),n.val("g",p.val(),e.target),!1;case 40:return p.val(h.call(i,(p.val()<<0)-1,0,255)),n.val("g",p.val(),e.target),!1}break;case g.get(0):switch(e.keyCode){case 38:return g.val(h.call(i,1+(g.val()<<0),0,255)),n.val("b",g.val(),e.target),!1;case 40:return g.val(h.call(i,(g.val()<<0)-1,0,255)),n.val("b",g.val(),e.target),!1}break;case v&&v.get(0):switch(e.keyCode){case 38:return v.val(h.call(i,parseFloat(v.val())+1,0,100)),n.val("a",Math.precision(255*v.val()/100,r),e.target),!1;case 40:return v.val(h.call(i,parseFloat(v.val())-1,0,100)),n.val("a",Math.precision(255*v.val()/100,r),e.target),!1}break;case m.get(0):switch(e.keyCode){case 38:return m.val(h.call(i,1+(m.val()<<0),0,360)),n.val("h",m.val(),e.target),!1;case 40:return m.val(h.call(i,(m.val()<<0)-1,0,360)),n.val("h",m.val(),e.target),!1}break;case y.get(0):switch(e.keyCode){case 38:return y.val(h.call(i,1+(y.val()<<0),0,100)),n.val("s",y.val(),e.target),!1;case 40:return y.val(h.call(i,(y.val()<<0)-1,0,100)),n.val("s",y.val(),e.target),!1}break;case b.get(0):switch(e.keyCode){case 38:return b.val(h.call(i,1+(b.val()<<0),0,100)),n.val("v",b.val(),e.target),!1;case 40:return b.val(h.call(i,(b.val()<<0)-1,0,100)),n.val("v",b.val(),e.target),!1}}}}function l(e){if(""!==e.target.value||e.target===_.get(0)||(null==a||e.target===a.get(0))&&null!=a){if(!c(e))return e;switch(e.target){case f.get(0):f.val(h.call(i,f.val(),0,255)),n.val("r",f.val(),e.target);break;case p.get(0):p.val(h.call(i,p.val(),0,255)),n.val("g",p.val(),e.target);break;case g.get(0):g.val(h.call(i,g.val(),0,255)),n.val("b",g.val(),e.target);break;case v&&v.get(0):v.val(h.call(i,v.val(),0,100)),n.val("a",Math.precision(255*v.val()/100,r),e.target);break;case m.get(0):m.val(h.call(i,m.val(),0,360)),n.val("h",m.val(),e.target);break;case y.get(0):y.val(h.call(i,y.val(),0,100)),n.val("s",y.val(),e.target);break;case b.get(0):b.val(h.call(i,b.val(),0,100)),n.val("v",b.val(),e.target);break;case _.get(0):_.val(_.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6)),a&&a.val(_.val()),n.val("hex",""!==_.val()?_.val():null,e.target);break;case a&&a.get(0):a.val(a.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6)),_.val(a.val()),n.val("hex",""!==a.val()?a.val():null,e.target);break;case x&&x.get(0):x.val(x.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,2)),n.val("a",null!=x.val()?parseInt(x.val(),16):null,e.target)}}}function u(e){if(null!=n.val())switch(e.target){case f.get(0):f.val(n.val("r"));break;case p.get(0):p.val(n.val("g"));break;case g.get(0):g.val(n.val("b"));break;case v&&v.get(0):v.val(Math.precision(100*n.val("a")/255,r));break;case m.get(0):m.val(n.val("h"));break;case y.get(0):y.val(n.val("s"));break;case b.get(0):b.val(n.val("v"));break;case _.get(0):case a&&a.get(0):_.val(n.val("hex")),a&&a.val(n.val("hex"));break;case x&&x.get(0):x.val(n.val("ahex").substring(6))}}function c(e){switch(e.keyCode){case 9:case 16:case 29:case 37:case 39:return!1;case"c".charCodeAt():case"v".charCodeAt():if(e.ctrlKey)return!1}return!0}function h(e,t,n){return""===e||isNaN(e)?t:e>n?n:e<t?t:e}function d(e,t){var n=e.val("all");t!==f.get(0)&&f.val(null!=n?n.r:""),t!==p.get(0)&&p.val(null!=n?n.g:""),t!==g.get(0)&&g.val(null!=n?n.b:""),v&&t!==v.get(0)&&v.val(null!=n?Math.precision(100*n.a/255,r):""),t!==m.get(0)&&m.val(null!=n?n.h:""),t!==y.get(0)&&y.val(null!=n?n.s:""),t!==b.get(0)&&b.val(null!=n?n.v:""),t!==_.get(0)&&(a&&t!==a.get(0)||!a)&&_.val(null!=n?n.hex:""),a&&t!==a.get(0)&&t!==_.get(0)&&a.val(null!=n?n.hex:""),x&&t!==x.get(0)&&x.val(null!=n?n.ahex.substring(6):"")}var f=s.eq(3),p=s.eq(4),g=s.eq(5),v=s.length>7?s.eq(6):null,m=s.eq(0),y=s.eq(1),b=s.eq(2),_=s.eq(s.length>7?7:6),x=s.length>7?s.eq(8):null;e.extend(!0,i,{destroy:function(){f.add(p).add(g).add(v).add(m).add(y).add(b).add(_).add(a).add(x).unbind("keyup",l).unbind("blur",u),f.add(p).add(g).add(v).add(m).add(y).add(b).unbind("keydown",o),n.unbind(d),f=null,p=null,g=null,v=null,m=null,y=null,b=null,_=null,x=null}}),f.add(p).add(g).add(v).add(m).add(y).add(b).add(_).add(a).add(x).bind("keyup",l).bind("blur",u),f.add(p).add(g).add(v).add(m).add(y).add(b).bind("keydown",o),n.bind(d)}(u,M.active,n.expandable&&n.bindToInput?n.input:null,n.alphaPrecision);var y=null!=i?i.hex:null,P=u.find(".Preview"),E=u.find(".Button");if(te=P.find(".Active:first").css({backgroundColor:y&&"#"+y||"transparent"}),ne=P.find(".Current:first").css({backgroundColor:y&&"#"+y||"transparent"}).bind("click",_),m.call(o,ne,Math.precision(100*M.current.val("a"))/255,4),ae=E.find(".Ok:first").bind("click",C),re=E.find(".Cancel:first").bind("click",x),ie=E.find(".Grid:first"),setTimeout(function(){g.call(o,U,L.clientPath+"Maps.png"),g.call(o,H,L.clientPath+"Maps.png"),g.call(o,z,L.clientPath+"map-opacity.png"),g.call(o,q,L.clientPath+"Bars.png"),g.call(o,X,L.clientPath+"Bars.png"),g.call(o,W,L.clientPath+"Bars.png"),g.call(o,Y,L.clientPath+"Bars.png"),g.call(o,Q,L.clientPath+"bar-opacity.png"),g.call(o,Z,L.clientPath+"AlphaBar.png"),g.call(o,P.find("div:first"),L.clientPath+"preview-opacity.png")},0),u.find("td.Radio input").bind("click",b),M.quickList&&M.quickList.length>0){for(var N="",G=0;G<M.quickList.length;G++){"string"===_typeof(M.quickList[G]).toString().toLowerCase()&&(M.quickList[G]=new a({hex:M.quickList[G]}));var B=M.quickList[G].val("a"),O=M.quickList[G].val("ahex");!n.alphaSupport&&O&&(O=O.substring(0,6)+"ff");var V=M.quickList[G].val("hex");O||(O="00000000"),N+='<span class="QuickColor"'+(O&&' title="#'+O+'"'||"none")+' style="background-color:'+(V&&"#"+V||"")+";"+(V?"":"background-image:url("+L.clientPath+"NoColor.png)")+(n.alphaSupport&&B&&B<255?";opacity:"+Math.precision(B/255,4)+";filter:Alpha(opacity="+Math.precision(B/2.55,4)+")":"")+'">&nbsp;</span>'}g.call(o,ie,L.clientPath+"bar-opacity.png"),ie.html(N),ie.find(".QuickColor").click(A)}c.call(o,l.color.mode),M.active.bind(h),"function"==typeof he&&M.active.bind(he),M.current.bind(w),n.expandable?(o.icon=r.parents(".Icon:first"),se=o.icon.find(".Color:first").css({backgroundColor:y&&"#"+y||"transparent"}),oe=o.icon.find(".Alpha:first"),g.call(o,oe,L.clientPath+"bar-opacity.png"),m.call(o,oe,Math.precision(100*(255-(null!=i?i.a:0))/255,4)),le=o.icon.find(".Image:first").css({backgroundImage:"url('"+L.clientPath+L.picker.file+"')"}).bind("click",S),n.bindToInput&&n.updateInputColor&&n.input.css({backgroundColor:y&&"#"+y||"transparent",color:null==i||i.v>75?"#000000":"#ffffff"}),ue=u.find(".Move:first").bind("mousedown",$),M.active.bind(k)):T.call(o)}var L=l.images,I=l.localization,M={active:"string"===_typeof(l.color.active).toString().toLowerCase()?new a({ahex:!l.window.alphaSupport&&l.color.active?l.color.active.substring(0,6)+"ff":l.color.active}):new a({ahex:!l.window.alphaSupport&&l.color.active.val("ahex")?l.color.active.val("ahex").substring(0,6)+"ff":l.color.active.val("ahex")}),current:"string"===_typeof(l.color.active).toString().toLowerCase()?new a({ahex:!l.window.alphaSupport&&l.color.active?l.color.active.substring(0,6)+"ff":l.color.active}):new a({ahex:!l.window.alphaSupport&&l.color.active.val("ahex")?l.color.active.val("ahex").substring(0,6)+"ff":l.color.active.val("ahex")}),quickList:l.color.quickList},B=null,O=null,V=null,R=null,j=null,D=null,F=null,U=null,H=null,z=null,q=null,X=null,W=null,Y=null,Q=null,Z=null,K=null,J=null,ee=null,te=null,ne=null,ae=null,re=null,ie=null,se=null,oe=null,le=null,ue=null,ce="function"==typeof s[1]?s[1]:null,he="function"==typeof s[2]?s[2]:null,de="function"==typeof s[3]?s[3]:null;e.extend(!0,o,{commitCallback:ce,liveCallback:he,cancelCallback:de,color:M,show:T,hide:N,destroy:function(){j.find("td.Radio input").unbind("click",b),ne.unbind("click",_),re.unbind("click",x),ae.unbind("click",C),l.window.expandable&&(le.unbind("click",S),ue.unbind("mousedown",$),o.icon=null),j.find(".QuickColor").unbind("click",A),D=null,F=null,U=null,H=null,z=null,q=null,X=null,W=null,Y=null,Q=null,Z=null,K.destroy(),K=null,J.destroy(),J=null,ee.destroy(),ee=null,te=null,ne=null,ae=null,re=null,ie=null,ce=null,de=null,he=null,j.html("");for(var e=0;e<r.length;e++)r[e]===o&&r.splice(e,1)}}),r.push(o),setTimeout(function(){G.call(o)},0)})},e.fn.jPicker.defaults={window:{title:null,effects:{type:"slide",speed:{show:"slow",hide:"fast"}},position:{x:"screenCenter",y:"top"},expandable:!1,liveUpdate:!0,alphaSupport:!1,alphaPrecision:0,updateInputColor:!0},color:{mode:"h",active:new a({ahex:"#ffcc00ff"}),quickList:[new a({h:360,s:33,v:100}),new a({h:360,s:66,v:100}),new a({h:360,s:100,v:100}),new a({h:360,s:100,v:75}),new a({h:360,s:100,v:50}),new a({h:180,s:0,v:100}),new a({h:30,s:33,v:100}),new a({h:30,s:66,v:100}),new a({h:30,s:100,v:100}),new a({h:30,s:100,v:75}),new a({h:30,s:100,v:50}),new a({h:180,s:0,v:90}),new a({h:60,s:33,v:100}),new a({h:60,s:66,v:100}),new a({h:60,s:100,v:100}),new a({h:60,s:100,v:75}),new a({h:60,s:100,v:50}),new a({h:180,s:0,v:80}),new a({h:90,s:33,v:100}),new a({h:90,s:66,v:100}),new a({h:90,s:100,v:100}),new a({h:90,s:100,v:75}),new a({h:90,s:100,v:50}),new a({h:180,s:0,v:70}),new a({h:120,s:33,v:100}),new a({h:120,s:66,v:100}),new a({h:120,s:100,v:100}),new a({h:120,s:100,v:75}),new a({h:120,s:100,v:50}),new a({h:180,s:0,v:60}),new a({h:150,s:33,v:100}),new a({h:150,s:66,v:100}),new a({h:150,s:100,v:100}),new a({h:150,s:100,v:75}),new a({h:150,s:100,v:50}),new a({h:180,s:0,v:50}),new a({h:180,s:33,v:100}),new a({h:180,s:66,v:100}),new a({h:180,s:100,v:100}),new a({h:180,s:100,v:75}),new a({h:180,s:100,v:50}),new a({h:180,s:0,v:40}),new a({h:210,s:33,v:100}),new a({h:210,s:66,v:100}),new a({h:210,s:100,v:100}),new a({h:210,s:100,v:75}),new a({h:210,s:100,v:50}),new a({h:180,s:0,v:30}),new a({h:240,s:33,v:100}),new a({h:240,s:66,v:100}),new a({h:240,s:100,v:100}),new a({h:240,s:100,v:75}),new a({h:240,s:100,v:50}),new a({h:180,s:0,v:20}),new a({h:270,s:33,v:100}),new a({h:270,s:66,v:100}),new a({h:270,s:100,v:100}),new a({h:270,s:100,v:75}),new a({h:270,s:100,v:50}),new a({h:180,s:0,v:10}),new a({h:300,s:33,v:100}),new a({h:300,s:66,v:100}),new a({h:300,s:100,v:100}),new a({h:300,s:100,v:75}),new a({h:300,s:100,v:50}),new a({h:180,s:0,v:0}),new a({h:330,s:33,v:100}),new a({h:330,s:66,v:100}),new a({h:330,s:100,v:100}),new a({h:330,s:100,v:75}),new a({h:330,s:100,v:50}),new a]},images:{clientPath:"/jPicker/images/",colorMap:{width:256,height:256,arrow:{file:"mappoint.gif",width:15,height:15}},colorBar:{width:20,height:256,arrow:{file:"rangearrows.gif",width:20,height:7}},picker:{file:"picker.gif",width:25,height:24}},localization:{text:{title:"Drag Markers To Pick A Color",newColor:"new",currentColor:"current",ok:"OK",cancel:"Cancel"},tooltips:{colors:{newColor:"New Color - Press &ldquo;OK&rdquo; To Commit",currentColor:"Click To Revert To Original Color"},buttons:{ok:"Commit To This Color Selection",cancel:"Cancel And Revert To Original Color"},hue:{radio:"Set To &ldquo;Hue&rdquo; Color Mode",textbox:"Enter A &ldquo;Hue&rdquo; Value (0-360&deg;)"},saturation:{radio:"Set To &ldquo;Saturation&rdquo; Color Mode",textbox:"Enter A &ldquo;Saturation&rdquo; Value (0-100%)"},value:{radio:"Set To &ldquo;Value&rdquo; Color Mode",textbox:"Enter A &ldquo;Value&rdquo; Value (0-100%)"},red:{radio:"Set To &ldquo;Red&rdquo; Color Mode",textbox:"Enter A &ldquo;Red&rdquo; Value (0-255)"},green:{radio:"Set To &ldquo;Green&rdquo; Color Mode",textbox:"Enter A &ldquo;Green&rdquo; Value (0-255)"},blue:{radio:"Set To &ldquo;Blue&rdquo; Color Mode",textbox:"Enter A &ldquo;Blue&rdquo; Value (0-255)"},alpha:{radio:"Set To &ldquo;Alpha&rdquo; Color Mode",textbox:"Enter A &ldquo;Alpha&rdquo; Value (0-100)"},hex:{textbox:"Enter A &ldquo;Hex&rdquo; Color Value (#000000-#ffffff)",alpha:"Enter A &ldquo;Alpha&rdquo; Value (#00-#ff)"}}}},e},$$a=jQuery,langParam=void 0;function setStrings(e,t,n){var a=$$a("#svg_editor").parent();for(var r in t){var i=t[r];if(i||console.log(r),n&&(r="#"+r),a.find(r).length){var s=a.find(r)[0];switch(e){case"content":for(var o,l=0;o=s.childNodes[l];l++)if(3===o.nodeType&&o.textContent.trim()){o.textContent=i;break}break;case"title":s.title=i}}else console.log("Missing: "+r)}}var editor_=void 0,init$7=function(e){editor_=e},readLang=function(e){var t=editor_.addLangData(langParam);if($$a.each(t,function(t,n){n.data&&(e=$$a.merge(e,n.data))}),e.tools){var n=e,a=n.tools,r=n.properties,i=n.config,s=n.layers,o=n.common,l=n.ui;setStrings("content",{curve_segments:r.curve_segments,fitToContent:a.fitToContent,fit_to_all:a.fit_to_all,fit_to_canvas:a.fit_to_canvas,fit_to_layer_content:a.fit_to_layer_content,fit_to_sel:a.fit_to_sel,icon_large:i.icon_large,icon_medium:i.icon_medium,icon_small:i.icon_small,icon_xlarge:i.icon_xlarge,image_opt_embed:i.image_opt_embed,image_opt_ref:i.image_opt_ref,includedImages:i.included_images,largest_object:a.largest_object,layersLabel:s.layers,page:a.page,relativeToLabel:a.relativeTo,selLayerLabel:s.move_elems_to,selectedPredefined:i.select_predefined,selected_objects:a.selected_objects,smallest_object:a.smallest_object,straight_segments:r.straight_segments,svginfo_bg_url:i.editor_img_url+":",svginfo_bg_note:i.editor_bg_note,svginfo_change_background:i.background,svginfo_dim:i.doc_dims,svginfo_editor_prefs:i.editor_prefs,svginfo_height:o.height,svginfo_icons:i.icon_size,svginfo_image_props:i.image_props,svginfo_lang:i.language,svginfo_title:i.doc_title,svginfo_width:o.width,tool_docprops_cancel:o.cancel,tool_docprops_save:o.ok,tool_source_cancel:o.cancel,tool_source_save:o.ok,tool_prefs_cancel:o.cancel,tool_prefs_save:o.ok,sidepanel_handle:s.layers.split("").join(" "),tool_clear:a.new_doc,tool_docprops:a.docprops,tool_export:a.export_img,tool_import:a.import_doc,tool_imagelib:a.imagelib,tool_open:a.open_doc,tool_save:a.save_doc,svginfo_units_rulers:i.units_and_rulers,svginfo_rulers_onoff:i.show_rulers,svginfo_unit:i.base_unit,svginfo_grid_settings:i.grid,svginfo_snap_onoff:i.snapping_onoff,svginfo_snap_step:i.snapping_stepsize,svginfo_grid_color:i.grid_color},!0);var u={};for(var c in e.shape_cats)u['#shape_cats [data-cat="'+c+'"]']=e.shape_cats[c];setTimeout(function(){setStrings("content",u)},2e3);var h={};$$a.each(["cut","copy","paste","paste_in_place","delete","group","ungroup","move_front","move_up","move_down","move_back"],function(){h['#cmenu_canvas a[href="#'+this+'"]']=a[this]}),$$a.each(["dupe","merge_down","merge_all"],function(){h['#cmenu_layers a[href="#'+this+'"]']=s[this]}),h['#cmenu_layers a[href="#delete"]']=s.del,setStrings("content",h),setStrings("title",{align_relative_to:a.align_relative_to,circle_cx:r.circle_cx,circle_cy:r.circle_cy,circle_r:r.circle_r,cornerRadiusLabel:r.corner_radius,ellipse_cx:r.ellipse_cx,ellipse_cy:r.ellipse_cy,ellipse_rx:r.ellipse_rx,ellipse_ry:r.ellipse_ry,fill_color:r.fill_color,font_family:r.font_family,idLabel:r.id,image_height:r.image_height,image_url:r.image_url,image_width:r.image_width,layer_delete:s.del,layer_down:s.move_down,layer_new:s.new,layer_rename:s.rename,layer_moreopts:o.more_opts,layer_up:s.move_up,line_x1:r.line_x1,line_x2:r.line_x2,line_y1:r.line_y1,line_y2:r.line_y2,linecap_butt:r.linecap_butt,linecap_round:r.linecap_round,linecap_square:r.linecap_square,linejoin_bevel:r.linejoin_bevel,linejoin_miter:r.linejoin_miter,linejoin_round:r.linejoin_round,main_icon:a.main_menu,mode_connect:a.mode_connect,tools_shapelib_show:a.mode_shapelib,palette:l.palette_info,zoom_panel:l.zoom_level,path_node_x:r.node_x,path_node_y:r.node_y,rect_height_tool:r.rect_height,rect_width_tool:r.rect_width,seg_type:r.seg_type,selLayerNames:s.move_selected,selected_x:r.pos_x,selected_y:r.pos_y,stroke_color:r.stroke_color,stroke_style:r.stroke_style,stroke_width:r.stroke_width,svginfo_title:i.doc_title,text:r.text_contents,toggle_stroke_tools:l.toggle_stroke_tools,tool_add_subpath:a.add_subpath,tool_alignbottom:a.align_bottom,tool_aligncenter:a.align_center,tool_alignleft:a.align_left,tool_alignmiddle:a.align_middle,tool_alignright:a.align_right,tool_aligntop:a.align_top,tool_angle:r.angle,tool_blur:r.blur,tool_bold:r.bold,tool_circle:a.mode_circle,tool_clone:a.clone,tool_clone_multi:a.clone,tool_delete:a.del,tool_delete_multi:a.del,tool_ellipse:a.mode_ellipse,tool_eyedropper:a.mode_eyedropper,tool_fhellipse:a.mode_fhellipse,tool_fhpath:a.mode_fhpath,tool_fhrect:a.mode_fhrect,tool_font_size:r.font_size,tool_group_elements:a.group_elements,tool_make_link:a.make_link,tool_link_url:a.set_link_url,tool_image:a.mode_image,tool_italic:r.italic,tool_line:a.mode_line,tool_move_bottom:a.move_bottom,tool_move_top:a.move_top,tool_node_clone:a.node_clone,tool_node_delete:a.node_delete,tool_node_link:a.node_link,tool_opacity:r.opacity,tool_openclose_path:a.openclose_path,tool_path:a.mode_path,tool_position:a.align_to_page,tool_rect:a.mode_rect,tool_redo:a.redo,tool_reorient:a.reorient_path,tool_select:a.mode_select,tool_source:a.source_save,tool_square:a.mode_square,tool_text:a.mode_text,tool_topath:a.to_path,tool_undo:a.undo,tool_ungroup:a.ungroup,tool_wireframe:a.wireframe_mode,view_grid:a.toggle_grid,tool_zoom:a.mode_zoom,url_notice:a.no_embed},!0),editor_.setLang(langParam,e)}},putLocale=function(e,t,n){e?langParam=e:((langParam=$$a.pref("lang"))||(navigator.userLanguage?langParam=navigator.userLanguage:navigator.language&&(langParam=navigator.language)),console.log("Lang: "+langParam),t.includes(langParam)||"test"===langParam||(langParam="en"));var a=document.createElement("script"),r=!("svgEditor"in window&&window.svgEditor&&!1===window.svgEditor.modules),i=n.langPath+"lang."+langParam+".js";r&&(a.type="module"),a.src=i,document.querySelector("head").appendChild(a)};function loadStylesheets(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.before,a=t.after,r=t.favicon,i=t.canvas,s=t.image,o=void 0===s||s,l=t.acceptErrors;return e=Array.isArray(e)?e:[e],Promise.all(e.map(function(e){var t={};if(Array.isArray(e)){var s=slicedToArray(e,2);e=s[0];var u=s[1];t=void 0===u?{}:u}var c=t.favicon,h=void 0===c?r:c,d=t,f=d.before,p=void 0===f?n:f,g=d.after,v=void 0===g?a:g,m=d.canvas,y=void 0===m?i:m,b=d.image,_=void 0===b?o:b;function x(){p?p.before(C):v?v.after(C):document.head.appendChild(C)}var C=document.createElement("link");return new Promise(function(n,a){if(l&&(a="function"==typeof l?function(r){l({error:r,stylesheetURL:e,options:t,resolve:n,reject:a})}:n),e.endsWith(".css")?h=!1:e.endsWith(".ico")&&(h=!0),h){if(C.rel="shortcut icon",C.type="image/x-icon",!1===_)return C.href=e,x(),void n(C);var r=document.createElement("canvas");r.width=16,r.height=16;var i=r.getContext("2d"),s=document.createElement("img");return s.addEventListener("error",function(e){a(e)}),s.addEventListener("load",function(){i.drawImage(s,0,0),C.href=y?r.toDataURL("image/x-icon"):e,x(),n(C)}),void(s.src=e)}C.rel="stylesheet",C.type="text/css",C.href=e,x(),C.addEventListener("error",function(e){a(e)}),C.addEventListener("load",function(){n(C)})})}))}var $$b=[jqPluginJSHotkeys,jqPluginBBQ,jqPluginSVGIcons,jqPluginJGraduate,jqPluginSpinBtn,jqPluginSVG,jqPluginContextMenu,jPicker].reduce(function(e,t){return t(e)},jQuery),stylesheet="svg-editor.css";$$b.loadingStylesheets.includes(stylesheet)||$$b.loadingStylesheets.push(stylesheet);var favicon="images/logo.png";$$b.loadingStylesheets.some(function(e){return Array.isArray(e)&&e[0]===favicon})&&$$b.loadingStylesheets.push([favicon,{favicon:!0}]);var editor={tool_scale:1,exportWindowCt:0,langChanged:!1,showSaveWarning:!1,storagePromptClosed:!1},callbacks=[],defaultPrefs={lang:"",iconsize:"",bkgd_color:"#FFF",bkgd_url:"",img_save:"embed",save_notice_done:!1,export_notice_done:!1},defaultExtensions=["ext-overview_window.js","ext-markers.js","ext-connector.js","ext-eyedropper.js","ext-shapes.js","ext-imagelib.js","ext-grid.js","ext-polygon.js","ext-star.js","ext-panning.js","ext-storage.js"],defaultConfig={canvasName:"default",canvas_expansion:3,initFill:{color:"FF0000",opacity:1},initStroke:{width:5,color:"000000",opacity:1},text:{stroke_width:0,font_size:24,font_family:"serif"},initOpacity:1,colorPickerCSS:null,initTool:"select",exportWindowType:"new",wireframe:!1,showlayers:!1,no_save_warning:!1,imgPath:"images/",langPath:"locale/",extPath:"extensions/",extIconsPath:"extensions/",jGraduatePath:"jgraduate/images/",dimensions:[640,480],gridSnapping:!1,gridColor:"#000",baseUnit:"px",snappingStep:10,showRulers:!0,preventAllURLConfig:!1,preventURLContentLoading:!1,lockExtensions:!1,noDefaultExtensions:!1,showGrid:!1,noStorageOnLoad:!1,forceStorage:!1,emptyStorageOnDecline:!1},uiStrings$1=editor.uiStrings={},svgCanvas=void 0,urldata=void 0,isReady=!1,customExportImage=!1,customExportPDF=!1,curPrefs={},curConfig={extensions:[],stylesheets:[],allowedOrigins:[]};function loadSvgString(e,t){var n=!1!==svgCanvas.setSvgString(e);t=t||$$b.noop,n?t(!0):$$b.alert(uiStrings$1.notification.errorLoadingSVG,function(){t(!1)})}$$b.pref=function(e,t){return t?(curPrefs[e]=t,void(editor.curPrefs=curPrefs)):e in curPrefs?curPrefs[e]:defaultPrefs[e]},editor.putLocale=putLocale,editor.readLang=readLang,editor.loadContentAndPrefs=function(){if(curConfig.forceStorage||!curConfig.noStorageOnLoad&&document.cookie.match(/(?:^|;\s*)store=(?:prefsAndContent|prefsOnly)/)){if(editor.storage&&(curConfig.forceStorage||!curConfig.noStorageOnLoad&&document.cookie.match(/(?:^|;\s*)store=prefsAndContent/))){var e="svgedit-"+curConfig.canvasName,t=editor.storage.getItem(e);t&&editor.loadFromString(t)}for(var n in defaultPrefs)if(defaultPrefs.hasOwnProperty(n)){var a="svg-edit-"+n;if(editor.storage){var r=editor.storage.getItem(a);r&&(defaultPrefs[n]=String(r))}else if(window.widget)defaultPrefs[n]=window.widget.preferenceForKey(a);else{var i=document.cookie.match(new RegExp("(?:^|;\\s*)"+regexEscape(encodeURIComponent(a))+"=([^;]+)"));defaultPrefs[n]=i?decodeURIComponent(i[1]):""}}}},editor.setConfig=function(e,t){function n(e,t,n){e[t]&&"object"===_typeof(e[t])?$$b.extend(!0,e[t],n):e[t]=n}t=t||{},$$b.each(e,function(a,r){if(e.hasOwnProperty(a))if(defaultPrefs.hasOwnProperty(a)){if(!1===t.overwrite&&(curConfig.preventAllURLConfig||curPrefs.hasOwnProperty(a)))return;!0===t.allowInitialUserOverride?defaultPrefs[a]=r:$$b.pref(a,r)}else if(["extensions","stylesheets","allowedOrigins"].includes(a)){if(!1===t.overwrite&&(curConfig.preventAllURLConfig||["allowedOrigins","stylesheets"].includes(a)||"extensions"===a&&curConfig.lockExtensions))return;curConfig[a]=curConfig[a].concat(r)}else if(defaultConfig.hasOwnProperty(a)){if(!1===t.overwrite&&(curConfig.preventAllURLConfig||curConfig.hasOwnProperty(a)))return;if(curConfig.hasOwnProperty(a)){if(!1===t.overwrite)return;n(curConfig,a,r)}else!0===t.allowInitialUserOverride?n(defaultConfig,a,r):defaultConfig[a]&&"object"===_typeof(defaultConfig[a])?(curConfig[a]={},$$b.extend(!0,curConfig[a],r)):curConfig[a]=r}}),editor.curConfig=curConfig},editor.setCustomHandlers=function(e){editor.ready(function(){e.open&&($$b('#tool_open > input[type="file"]').remove(),$$b("#tool_open").show(),svgCanvas.open=e.open),e.save&&(editor.showSaveWarning=!1,svgCanvas.bind("saved",e.save)),e.exportImage&&(customExportImage=e.exportImage,svgCanvas.bind("exported",customExportImage)),e.exportPDF&&(customExportPDF=e.exportPDF,svgCanvas.bind("exportedPDF",customExportPDF))})},editor.randomizeIds=function(){svgCanvas.randomizeIds(arguments)},editor.init=function(){var e=!("svgEditor"in window&&window.svgEditor&&!1===window.svgEditor.modules);e||Object.assign(defaultConfig,{langPath:"../dist/locale/",extPath:"../dist/extensions/"});try{"localStorage"in window&&(editor.storage=localStorage)}catch(e){}var t=[];function n(){curPrefs=$$b.extend(!0,{},defaultPrefs,curPrefs),editor.curPrefs=curPrefs}function a(){(curConfig=$$b.extend(!0,{},defaultConfig,curConfig)).noDefaultExtensions||(curConfig.extensions=curConfig.extensions.concat(defaultExtensions)),$$b.each(["extensions","stylesheets","allowedOrigins"],function(e,t){curConfig[t]=$$b.grep(curConfig[t],function(e,n){return n===curConfig[t].indexOf(e)})}),editor.curConfig=curConfig}$$b("#lang_select option").each(function(){t.push(this.value)}),function(){var e=void 0,t=void 0;if(urldata=$$b.deparam.querystring(!0),$$b.isEmptyObject(urldata))a(),editor.loadContentAndPrefs(),n();else{if(urldata.dimensions&&(urldata.dimensions=urldata.dimensions.split(",")),urldata.bkgd_color&&(urldata.bkgd_color="#"+urldata.bkgd_color),urldata.extensions&&(urldata.extensions=urldata.extensions.match(/[:/\\]/)?"":urldata.extensions.split(",")),$$b.each(["extPath","imgPath","extIconsPath","langPath","jGraduatePath"],function(e){urldata[e]&&delete urldata[e]}),editor.setConfig(urldata,{overwrite:!1}),a(),!curConfig.preventURLContentLoading){if(e=urldata.source,t=$$b.param.querystring(),e||t.includes("source=data:")&&(e=t.match(/source=(data:[^&]*)/)[1]),e)return void(e.startsWith("data:")?editor.loadFromDataURI(e):editor.loadFromString(e));if(urldata.url)return void editor.loadFromURL(urldata.url)}urldata.noStorageOnLoad&&!curConfig.forceStorage||editor.loadContentAndPrefs(),n()}}();var r=editor.setIcon=function(e,t,n){var a="string"==typeof t?$$b.getSvgIcon(t,!0):t.clone();a?$$b(e).empty().append(a):console.log("NOTE: Icon image missing: "+t)},i=function(){$$b.each(curConfig.extensions,function(){if(this.match(/^ext-.*\.js/)){var t=document.createElement("script");e&&(t.type="module");var n=curConfig.extPath+this;t.src=n,document.querySelector("head").appendChild(t)}}),editor.putLocale(null,t,curConfig)},s={tool_scale:editor.tool_scale},o=function(){$$b(".tools_flyout").each(function(){var e=$$b("#"+this.id+"_show"),t=e.offset(),n=e.outerWidth();$$b(this).css({left:(t.left+n)*editor.tool_scale,top:t.top})})},l=editor.setIconSize=function(e){var t="#tools_top .toolset, #editor_panel > *, #history_panel > *,        #main_button, #tools_left > *, #path_node_panel > *, #multiselected_panel > *,        #g_panel > *, #tool_font_size > *, .tools_flyout",n=$$b(t),a=1;if("number"==typeof e)a=e;else{a={s:.75,m:1,l:1.25,xl:1.5}[e]}s.tool_scale=editor.tool_scale=a,o();var r=n.parents(":hidden");r.css("visibility","hidden").show(),function(e,t){var n=["top","left","bottom","right"];e.each(function(){for(var e=$$b(this),a=e.outerWidth()*(t-1),r=e.outerHeight()*(t-1),i=0;i<4;i++){var s=n[i],o=e.data("orig_margin-"+s);null==o&&(o=parseInt(e.css("margin-"+s),10),e.data("orig_margin-"+s,o));var l=o*t;"right"===s?l+=a:"bottom"===s&&(l+=r),e.css("margin-"+s,l)}})}(n,a),r.css("visibility","visible").hide(),$$b.pref("iconsize",e),$$b("#iconsize").val(e);var i={"#tools_top":{left:50+$$b("#main_button").width(),height:72},"#tools_left":{width:31,top:74},"div#workarea":{left:38,top:74}},l=$$b("#tool_size_rules");if(l.length?l.empty():l=$$b('<style id="tool_size_rules"></style>').appendTo("head"),"m"!==e){var u="";$$b.each(i,function(t,n){t="#svg_editor "+t.replace(/,/g,", #svg_editor"),u+=t+"{",$$b.each(n,function(t,n){var r=void 0;"number"==typeof n?r=n*a+"px":(n[e]||n.all)&&(r=n[e]||n.all),u+=t+":"+r+";"}),u+="}"});var c="-"+ne.toLowerCase()+"-";u+=t+"{"+c+"transform: scale("+a+");} #svg_editor div.toolset .toolset {"+c+"transform: scale(1); margin: 1px !important;} #svg_editor .ui-slider {"+c+"transform: scale("+1/a+");}",l.text(u)}o()};$$b.svgIcons(curConfig.imgPath+"svg_edit_icons.svg",{w:24,h:24,id_match:!1,no_img:!isWebkit(),fallback_path:curConfig.imgPath,fallback:{new_image:"clear.png",save:"save.png",open:"open.png",source:"source.png",docprops:"document-properties.png",wireframe:"wireframe.png",undo:"undo.png",redo:"redo.png",select:"select.png",select_node:"select_node.png",pencil:"fhpath.png",pen:"line.png",square:"square.png",rect:"rect.png",fh_rect:"freehand-square.png",circle:"circle.png",ellipse:"ellipse.png",fh_ellipse:"freehand-circle.png",path:"path.png",text:"text.png",image:"image.png",zoom:"zoom.png",clone:"clone.png",node_clone:"node_clone.png",delete:"delete.png",node_delete:"node_delete.png",group:"shape_group_elements.png",ungroup:"shape_ungroup.png",move_top:"move_top.png",move_bottom:"move_bottom.png",to_path:"to_path.png",link_controls:"link_controls.png",reorient:"reorient.png",align_left:"align-left.png",align_center:"align-center.png",align_right:"align-right.png",align_top:"align-top.png",align_middle:"align-middle.png",align_bottom:"align-bottom.png",go_up:"go-up.png",go_down:"go-down.png",ok:"save.png",cancel:"cancel.png",arrow_right:"flyouth.png",arrow_down:"dropdown.gif"},placement:{"#logo":"logo","#tool_clear div,#layer_new":"new_image","#tool_save div":"save","#tool_export div":"export","#tool_open div div":"open","#tool_import div div":"import","#tool_source":"source","#tool_docprops > div":"docprops","#tool_wireframe":"wireframe","#tool_undo":"undo","#tool_redo":"redo","#tool_select":"select","#tool_fhpath":"pencil","#tool_line":"pen","#tool_rect,#tools_rect_show":"rect","#tool_square":"square","#tool_fhrect":"fh_rect","#tool_ellipse,#tools_ellipse_show":"ellipse","#tool_circle":"circle","#tool_fhellipse":"fh_ellipse","#tool_path":"path","#tool_text,#layer_rename":"text","#tool_image":"image","#tool_zoom":"zoom","#tool_clone,#tool_clone_multi":"clone","#tool_node_clone":"node_clone","#layer_delete,#tool_delete,#tool_delete_multi":"delete","#tool_node_delete":"node_delete","#tool_add_subpath":"add_subpath","#tool_openclose_path":"open_path","#tool_move_top":"move_top","#tool_move_bottom":"move_bottom","#tool_topath":"to_path","#tool_node_link":"link_controls","#tool_reorient":"reorient","#tool_group_elements":"group_elements","#tool_ungroup":"ungroup","#tool_unlink_use":"unlink_use","#tool_alignleft, #tool_posleft":"align_left","#tool_aligncenter, #tool_poscenter":"align_center","#tool_alignright, #tool_posright":"align_right","#tool_aligntop, #tool_postop":"align_top","#tool_alignmiddle, #tool_posmiddle":"align_middle","#tool_alignbottom, #tool_posbottom":"align_bottom","#cur_position":"align","#linecap_butt,#cur_linecap":"linecap_butt","#linecap_round":"linecap_round","#linecap_square":"linecap_square","#linejoin_miter,#cur_linejoin":"linejoin_miter","#linejoin_round":"linejoin_round","#linejoin_bevel":"linejoin_bevel","#url_notice":"warning","#layer_up":"go_up","#layer_down":"go_down","#layer_moreopts":"context_menu","#layerlist td.layervis":"eye","#tool_source_save,#tool_docprops_save,#tool_prefs_save":"ok","#tool_source_cancel,#tool_docprops_cancel,#tool_prefs_cancel":"cancel","#rwidthLabel, #iwidthLabel":"width","#rheightLabel, #iheightLabel":"height","#cornerRadiusLabel span":"c_radius","#angleLabel":"angle","#linkLabel,#tool_make_link,#tool_make_link_multi":"globe_link","#zoomLabel":"zoom","#tool_fill label":"fill","#tool_stroke .icon_label":"stroke","#group_opacityLabel":"opacity","#blurLabel":"blur","#font_sizeLabel":"fontsize",".flyout_arrow_horiz":"arrow_right",".dropdown button, #main_button .dropdown":"arrow_down","#palette .palette_item:first, #fill_bg, #stroke_bg":"no_color"},resize:{"#logo .svg_icon":28,".flyout_arrow_horiz .svg_icon":5,".layer_button .svg_icon, #layerlist td.layervis .svg_icon":14,".dropdown button .svg_icon":7,"#main_button .dropdown .svg_icon":9,".palette_item:first .svg_icon":15,"#fill_bg .svg_icon, #stroke_bg .svg_icon":16,".toolbar_button button .svg_icon":16,".stroke_tool div div .svg_icon":20,"#tools_bottom label .svg_icon":18},callback:function(e){$$b(".toolbar_button button > svg, .toolbar_button button > img").each(function(){$$b(this).parent().prepend(this)});var t=$$b("#tools_left"),n=void 0;t.length&&(n=t.offset().top+t.outerHeight());var a=$$b.pref("iconsize");function r(e){switch(e){case"jgraduate/css/jPicker.css":return 1;case"jgraduate/css/jgraduate.css":return 2;case"svg-editor.css":return 3;case"spinbtn/JQuerySpinBtn.css":return 4;default:return 1/0}}editor.setIconSize(a||($$b(window).height()<n?"s":"m")),$$b(".tools_flyout").each(function(){var e=$$b("#"+this.id+"_show"),t=e.attr("data-curopt");if(!e.children("svg, img").length){var n=$$b(t).children().clone();n.length&&(n[0].removeAttribute("style"),e.append(n))}});var i=$$b.loadingStylesheets.sort(function(e,t){var n=r(e),a=r(t);return n===a?0:n>a});if(curConfig.stylesheets.length){var s,o=(i=[].concat(toConsumableArray(new Set(curConfig.stylesheets)))).indexOf("@default");if(o>-1)(s=i).splice.apply(s,[o,1].concat(toConsumableArray($$b.loadingStylesheets)))}loadStylesheets(i,{acceptErrors:function(e){var t=e.stylesheetURL,n=e.reject,a=e.resolve;$$b.loadingStylesheets.includes(t)?n(new Error("Missing expected stylesheet: "+t)):a()}}).then(function(){$$b("#svg_container")[0].style.visibility="visible",editor.runCallbacks(),setTimeout(function(){$$b(".flyout_arrow_horiz:empty").each(function(){$$b(this).append($$b.getSvgIcon("arrow_right").width(5).height(5))})},1)})}}),editor.canvas=svgCanvas=new SvgCanvas(document.getElementById("svgcanvas"),curConfig);var u=isMac()?"meta+":"ctrl+",c=svgCanvas.pathActions,h=svgCanvas.undoMgr,d=$$b("#workarea"),f=$$b("#cmenu_canvas"),p={fill:null,stroke:null},g=void 0,v=void 0,m=null,y=curConfig.imgPath+"logo.png",b="crosshair",_="crosshair",x="toolbars";!function(){var e=window.opener||window.parent,t=void 0;if(e)try{(t=e.document.createEvent("Event")).initEvent("svgEditorReady",!0,!0),e.document.documentElement.dispatchEvent(t)}catch(e){}}(),function(){$$b("#dialog_container").draggable({cancel:"#dialog_content, #dialog_buttons *",containment:"window"}).css("position","absolute");var e=$$b("#dialog_box"),t=$$b("#dialog_buttons"),n=$$b("#dialog_content"),a=function(a,r,i,s,o,l,u){n.html("<p>"+r.replace(/\n/g,"</p><p>")+"</p>").toggleClass("prompt","prompt"===a),t.empty();var c=$$b('<input type="button" value="'+uiStrings$1.common.ok+'">').appendTo(t);"alert"!==a&&$$b('<input type="button" value="'+uiStrings$1.common.cancel+'">').appendTo(t).click(function(){e.hide(),i&&i(!1)});var h=void 0,d=void 0;if("prompt"===a)(h=$$b('<input type="text">').prependTo(t)).val(s||""),h.bind("keydown","return",function(){c.click()});else if("select"===a){var f=$$b('<div style="text-align:center;">');if(h=$$b("<select>").appendTo(f),u){var p=$$b("<label>").text(u.label);(d=$$b('<input type="checkbox">').appendTo(p)).val(u.value),u.tooltip&&p.attr("title",u.tooltip),d.prop("checked",!!u.checked),f.append($$b("<div>").append(p))}$$b.each(o||[],function(e,t){"object"===(void 0===t?"undefined":_typeof(t))?h.append($$b("<option>").val(t.value).html(t.text)):h.append($$b("<option>").html(t))}),n.append(f),s&&h.val(s),l&&h.bind("change","return",l),h.bind("keydown","return",function(){c.click()})}else"process"===a&&c.hide();e.show(),c.click(function(){e.hide();var t="prompt"!==a&&"select"!==a||h.val();i&&(d?i(t,d.prop("checked")):i(t))}).focus(),"prompt"!==a&&"select"!==a||h.focus()};$$b.alert=function(e,t){a("alert",e,t)},$$b.confirm=function(e,t){a("confirm",e,t)},$$b.process_cancel=function(e,t){a("process",e,t)},$$b.prompt=function(e,t,n){a("prompt",e,n,t)},$$b.select=function(e,t,n,r,i,s){a("select",e,n,i,t,r,s)}}();for(var C=function(){var e=$$b(".tool_button_current");e.length&&"tool_select"!==e[0].id&&(e.removeClass("tool_button_current").addClass("tool_button"),$$b("#tool_select").addClass("tool_button_current").removeClass("tool_button"),$$b("#styleoverrides").text("#svgcanvas svg *{cursor:move;pointer-events:all} #svgcanvas svg{cursor:default}")),svgCanvas.setMode("select"),d.css("cursor","auto")},S=$$b("title:first").text(),w=[],k=.1;k<1e5;k*=10)w.push(k),w.push(2*k),w.push(5*k);var $=function(e){var t=void 0,n=[],a=svgCanvas.getCurrentDrawing().getNumLayers();for(t=0;t<a;t++)n[t]=svgCanvas.getCurrentDrawing().getLayerName(t);if(e)for(t=0;t<a;++t)n[t]!==e&&svgCanvas.getCurrentDrawing().setLayerOpacity(n[t],.5);else for(t=0;t<a;++t)svgCanvas.getCurrentDrawing().setLayerOpacity(n[t],1)},P=function(){svgCanvas.clearSelection();for(var e=$$b("#layerlist tbody").empty(),t=$$b("#selLayerNames").empty(),n=svgCanvas.getCurrentDrawing(),a=n.getCurrentLayerName(),r=$$b.getSvgIcon("eye"),i=svgCanvas.getCurrentDrawing().getNumLayers();i--;){var s=n.getLayerName(i),o=$$b('<tr class="layer">').toggleClass("layersel",s===a),l=$$b('<td class="layervis">').toggleClass("layerinvis",!n.getLayerVisibility(s)),u=$$b('<td class="layername">'+s+"</td>");e.append(o.append(l,u)),t.append('<option value="'+s+'">'+s+"</option>")}if(void 0!==r){var c=r.clone();$$b("td.layervis",e).append(c),$$b.resizeSvgIcons({"td.layervis .svg_icon":14})}$$b("#layerlist td.layername").mouseup(function(e){$$b("#layerlist tr.layer").removeClass("layersel"),$$b(this.parentNode).addClass("layersel"),svgCanvas.setCurrentLayer(this.textContent),e.preventDefault()}).mouseover(function(){$(this.textContent)}).mouseout(function(){$()}),$$b("#layerlist td.layervis").click(function(){var e=$$b(this.parentNode).prevAll().length,t=$$b("#layerlist tr.layer:eq("+e+") td.layername").text(),n=$$b(this).hasClass("layerinvis");svgCanvas.setLayerVisibility(t,n),$$b(this).toggleClass("layerinvis")});for(var h=5-$$b("#layerlist tr.layer").size();h-- >0;)e.append('<tr><td style="color:white">_</td><td/></tr>')},E=!1,A="",T=function(e,t){E||(E=!0,A=svgCanvas.getSvgString(),$$b("#save_output_btns").toggle(!!t),$$b("#tool_source_back").toggle(!t),$$b("#svg_source_textarea").val(A),$$b("#svg_source_editor").fadeIn(),$$b("#svg_source_textarea").focus())},N=null,G=!1,L=function(){window.opera&&$$b("<p/>").hide().appendTo("body").remove()};function I(e,t){var n=e.id,a=n.split("_"),i=a[0],s=a[1];t&&svgCanvas.setStrokeAttr("stroke-"+i,s),L(),r("#cur_"+i,n,20),$$b(e).addClass("current").siblings().removeClass("current")}var M=editor.toolButtonClick=function(e,t){if($$b(e).hasClass("disabled"))return!1;if($$b(e).parent().hasClass("tools_flyout"))return!0;return t||$$b(".tools_flyout").fadeOut("normal"),$$b("#styleoverrides").text(""),d.css("cursor","auto"),$$b(".tool_button_current").removeClass("tool_button_current").addClass("tool_button"),$$b(e).addClass("tool_button_current").removeClass("tool_button"),!0},B=editor.clickSelect=function(){M("#tool_select")&&(svgCanvas.setMode("select"),$$b("#styleoverrides").text("#svgcanvas svg *{cursor:move;pointer-events:all}, #svgcanvas svg{cursor:default}"))},O=editor.setImageURL=function(e){e||(e=y),svgCanvas.setImageURL(e),$$b("#image_url").val(e),e.startsWith("data:")?($$b("#image_url").hide(),$$b("#change_image_url").show()):(svgCanvas.embedImage(e,function(t){$$b("#url_notice").toggle(!t),y=e}),$$b("#image_url").show(),$$b("#change_image_url").hide())};function V(e,t){$$b.pref("bkgd_color",e),$$b.pref("bkgd_url",t),svgCanvas.setBackground(e,t)}function R(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cancelDeletes,t=void 0!==e&&e,n=svgCanvas.getHref(N);n=n.startsWith("data:")?"":n,$$b.prompt(uiStrings$1.notification.enterNewImgURL,n,function(e){e?O(e):t&&svgCanvas.deleteSelectedElements()})}function j(e,t){t||(t=svgCanvas.getZoom()),e||(e=$$b("#svgcanvas"));var n=void 0,a=void 0,r=svgCanvas.getContentElem(),i=getTypeMap()[curConfig.baseUnit];for(n=0;n<2;n++){var s=0===n,o=s?"x":"y",l=s?"width":"height",u=Number(r.getAttribute(o)),c=$$b("#ruler_"+o+" canvas:first"),h=c.clone();c.replaceWith(h);var d=h[0],f=e[l](),p=f;d.parentNode.style[l]=p+"px";var g=d.getContext("2d"),v=void 0,m=void 0,y=void 0;if(g.fillStyle="rgb(200,0,0)",g.fillRect(0,0,d.width,d.height),h.siblings().remove(),f>=3e4){y=parseInt(f/3e4,10)+1,(v=[])[0]=g;var b=void 0;for(a=1;a<y;a++)d[l]=3e4,b=d.cloneNode(!0),d.parentNode.appendChild(b),v[a]=b.getContext("2d");b[l]=f%3e4,f=3e4}d[l]=f;var _=i*t,x=50/_,C=1;for(a=0;a<w.length&&(C=m=w[a],!(x<=m));a++);var S=C*_;g.font="9px sans-serif";for(var k=u/_%C*_,$=k-S,P=0;k<p;){$+=S;var E=Math.round(k)+.5;s?(g.moveTo(E,15),g.lineTo(E,0)):(g.moveTo(15,E),g.lineTo(0,E)),m=($-u)/_;var A=void 0;if(C>=1)A=Math.round(m);else{var T=String(C).split(".")[1].length;A=m.toFixed(T)}if(0!==A&&1e3!==A&&A%1e3==0&&(A=A/1e3+"K"),s)g.fillText(A,k+2,8);else{var N=String(A).split("");for(a=0;a<N.length;a++)g.fillText(N[a],1,k+9+9*a)}var G=S/10;for(a=1;a<10;a++){var L=Math.round(k+G*a)+.5;if(v&&L>f){if(P++,g.stroke(),P>=y){a=10,k=p;continue}g=v[P],k-=3e4,L=Math.round(k+G*a)+.5}var I=a%2?12:10;s?(g.moveTo(L,15),g.lineTo(L,I)):(g.moveTo(15,L),g.lineTo(I,L))}k+=S}g.strokeStyle="#000",g.stroke()}}var D=editor.updateCanvas=function(e,t){var n=svgCanvas.getZoom(),a=d,r=$$b("#svgcanvas"),i=d.width(),s=d.height(),o=i,l=s,u=a[0].scrollLeft+o/2,c=a[0].scrollTop+l/2,h=curConfig.canvas_expansion;i=Math.max(o,svgCanvas.contentW*n*h),s=Math.max(l,svgCanvas.contentH*n*h),i===o&&s===l?d.css("overflow","hidden"):d.css("overflow","scroll");var f=r.height()/2,p=r.width()/2;r.width(i).height(s);var g=s/2,v=i/2,m=svgCanvas.updateCanvas(i,s),y=v/p,b=i/2-o/2,_=s/2-l/2;t?(t.x+=m.x,t.y+=m.y):t={x:v+(u-p)*y,y:g+(c-f)*y};e?svgCanvas.contentW>a.width()?(d[0].scrollLeft=m.x-10,d[0].scrollTop=m.y-10):(a[0].scrollLeft=b,a[0].scrollTop=_):(a[0].scrollLeft=t.x-o/2,a[0].scrollTop=t.y-l/2),curConfig.showRulers&&(j(r,n),d.scroll()),!0===urldata.storagePrompt||editor.storagePromptClosed||$$b("#dialog_box").hide()},F=function(){var e=void 0,t=void 0,n="none"===svgCanvas.getColor("fill"),a="none"===svgCanvas.getColor("stroke"),r=["#tool_fhpath","#tool_line"],i=["#tools_rect .tool_button","#tools_ellipse .tool_button","#tool_text","#tool_path"];if(a)for(e in r)$$b(t=r[e]).hasClass("tool_button_current")&&B(),$$b(t).addClass("disabled");else for(e in r)$$b(t=r[e]).removeClass("disabled");if(a&&n)for(e in i)$$b(t=i[e]).hasClass("tool_button_current")&&B(),$$b(t).addClass("disabled");else for(e in i)$$b(t=i[e]).removeClass("disabled");svgCanvas.runExtensions("toolButtonStateUpdate",{nofill:n,nostroke:a}),$$b(".tools_flyout").each(function(){var e=$$b("#"+this.id+"_show"),t=!1;$$b(this).children().each(function(){$$b(this).hasClass("disabled")||(t=!0)}),e.toggleClass("disabled",!t)}),L()},U=function(){var e=N;null==e||e.parentNode||(e=null);var t=svgCanvas.getCurrentDrawing().getCurrentLayerName(),n=svgCanvas.getMode(),a="px"!==curConfig.baseUnit?curConfig.baseUnit:null,i="pathedit"===n,s=$$b("#cmenu_canvas li");if($$b("#selected_panel, #multiselected_panel, #g_panel, #rect_panel, #circle_panel,#ellipse_panel, #line_panel, #text_panel, #image_panel, #container_panel, #use_panel, #a_panel").hide(),null!=e){var o=e.nodeName,l=svgCanvas.getRotationAngle(e);$$b("#angle").val(l);var u=svgCanvas.getBlur(e);if($$b("#blur").val(u),$$b("#blur_slider").slider("option","value",u),svgCanvas.addedNew&&"image"===o&&"image"===svgCanvas.getMode()&&(svgCanvas.getHref(e).startsWith("data:")||R({cancelDeletes:!0})),i||"pathedit"===n){var d=c.getNodePoint();if($$b("#tool_add_subpath").removeClass("push_button_pressed").addClass("tool_button"),$$b("#tool_node_delete").toggleClass("disabled",!c.canDeleteNodes),r("#tool_openclose_path",c.closed_subpath?"open_path":"close_path"),d){var p=$$b("#seg_type");a&&(d.x=convertUnit(d.x),d.y=convertUnit(d.y)),$$b("#path_node_x").val(d.x),$$b("#path_node_y").val(d.y),d.type?p.val(d.type).removeAttr("disabled"):p.val(4).attr("disabled","disabled")}return}if($$b("#selected_panel").show(),["line","circle","ellipse"].includes(o))$$b("#xy_panel").hide();else{var g=void 0,v=void 0;if(["g","polyline","path"].includes(o)){var m=svgCanvas.getStrokedBBox([e]);m&&(g=m.x,v=m.y)}else g=e.getAttribute("x"),v=e.getAttribute("y");a&&(g=convertUnit(g),v=convertUnit(v)),$$b("#selected_x").val(g||0),$$b("#selected_y").val(v||0),$$b("#xy_panel").show()}var y=!["image","text","path","g","use"].includes(o);$$b("#tool_topath").toggle(y),$$b("#tool_reorient").toggle("path"===o),$$b("#tool_reorient").toggleClass("disabled",0===l);var b={g:[],a:[],rect:["rx","width","height"],image:["width","height"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],line:["x1","y1","x2","y2"],text:[],use:[]},_=e.tagName,x=null;if("a"===_&&(x=svgCanvas.getHref(e),$$b("#g_panel").show()),"a"===e.parentNode.tagName&&($$b(e).siblings().length||($$b("#a_panel").show(),x=svgCanvas.getHref(e.parentNode))),$$b("#tool_make_link, #tool_make_link").toggle(!x),x&&$$b("#link_url").val(x),b[_]){var C=b[_];if($$b("#"+_+"_panel").show(),$$b.each(C,function(t,n){var a=e.getAttribute(n);if("px"!==curConfig.baseUnit&&e[n]){var r=e[n].baseVal.value;a=convertUnit(r)}$$b("#"+_+"_"+n).val(a||0)}),"text"===_)$$b("#text_panel").css("display","inline"),$$b("#tool_font_size").css("display","inline"),svgCanvas.getItalic()?$$b("#tool_italic").addClass("push_button_pressed").removeClass("tool_button"):$$b("#tool_italic").removeClass("push_button_pressed").addClass("tool_button"),svgCanvas.getBold()?$$b("#tool_bold").addClass("push_button_pressed").removeClass("tool_button"):$$b("#tool_bold").removeClass("push_button_pressed").addClass("tool_button"),$$b("#font_family").val(e.getAttribute("font-family")),$$b("#font_size").val(e.getAttribute("font-size")),$$b("#text").val(e.textContent),svgCanvas.addedNew&&setTimeout(function(){$$b("#text").focus().select()},100);else if("image"===_&&"image"===svgCanvas.getMode())O(svgCanvas.getHref(e));else if("g"===_||"use"===_){$$b("#container_panel").show();var S=svgCanvas.getTitle(),w=$$b("#g_title")[0];w.value=S,function(e){var t=Math.min(Math.max(12+6*e.value.length,50),300);$$b(e).width(t)}(w),$$b("#g_title").prop("disabled","use"===_)}}s[("g"===_?"en":"dis")+"ableContextMenuItems"]("#ungroup"),s[("g"!==_&&G?"en":"dis")+"ableContextMenuItems"]("#group")}else G?($$b("#multiselected_panel").show(),s.enableContextMenuItems("#group").disableContextMenuItems("#ungroup")):s.disableContextMenuItems("#delete,#cut,#copy,#group,#ungroup,#move_front,#move_up,#move_down,#move_back");$$b("#tool_undo").toggleClass("disabled",0===h.getUndoStackSize()),$$b("#tool_redo").toggleClass("disabled",0===h.getRedoStackSize()),svgCanvas.addedNew=!1,e&&!i||G?($$b("#selLayerNames").removeAttr("disabled").val(t),f.enableContextMenuItems("#delete,#cut,#copy,#move_front,#move_up,#move_down,#move_back")):$$b("#selLayerNames").attr("disabled","disabled")},H=function(){if(!Gt){var e="#workarea.wireframe #svgcontent * { stroke-width: "+1/svgCanvas.getZoom()+"px; }";$$b("#wireframe_rules").text(d.hasClass("wireframe")?e:"")}},z="",q=function(e){e=e||svgCanvas.getDocumentTitle();var t=S+(e?": "+e:"");$$b("title:first").text(t)};function X(e){return e&&"g"===e.tagName&&Layer.CLASS_REGEX.test(e.getAttribute("class"))}var W=function(){H()},Y=svgCanvas.zoomChanged=function(e,t,n){var a=d,r=svgCanvas.setBBoxZoom(t,a.width()-15,a.height()-15);if(r){var i=r.zoom,s=r.bbox;i<.001?Q({value:.1}):($$b("#zoom").val((100*i).toFixed(1)),n?D():D(!1,{x:s.x*i+s.width*i/2,y:s.y*i+s.height*i/2}),"zoom"===svgCanvas.getMode()&&s.width&&C(),W())}},Q=function(e){var t=e.value/100;if(t<.001)e.value=.1;else{var n=svgCanvas.getZoom(),a=d;Y(window,{width:0,height:0,x:(a[0].scrollLeft+a.width()/2)/n,y:(a[0].scrollTop+a.height()/2)/n,zoom:t},!0)}};$$b("#cur_context_panel").delegate("a","click",function(){var e=$$b(this);return e.attr("data-root")?svgCanvas.leaveContext():svgCanvas.setContext(e.text()),svgCanvas.clearSelection(),!1});var Z=function(){p.fill.prep(),p.stroke.prep()},K={},J=function(){$$b(".tools_flyout").each(function(){var e=$$b("#"+this.id+"_show");if(!e.data("isLibrary")){var t=[];$$b(this).children().each(function(){t.push(this.title)}),e[0].title=t.join(" / ")}})},ee=function(e){$$b.each(e,function(t,n){var a=$$b(t).children(),r=t+"_show",i=$$b(r),s=!1;a.addClass("tool_button").unbind("click mousedown mouseup").each(function(t){var a=n[t];K[a.sel]=a.fn,a.isDefault&&(s=t);var o=function(t){var n=a;if("keydown"===t.type){var s=$$b(n.parent+"_show").hasClass("tool_button_current"),o=$$b(n.parent+"_show").attr("data-curopt");$$b.each(e[a.parent],function(r,i){i.sel===o&&(n=t.shiftKey&&s?e[a.parent][r+1]||e[a.parent][0]:i)})}if($$b(this).hasClass("disabled"))return!1;M(r)&&n.fn();var l=void 0;(l=n.icon?$$b.getSvgIcon(n.icon,!0):$$b(n.sel).children().eq(0).clone())[0].setAttribute("width",i.width()),l[0].setAttribute("height",i.height()),i.children(":not(.flyout_arrow_horiz)").remove(),i.append(l).attr("data-curopt",n.sel)};$$b(this).mouseup(o),a.key&&$$b(document).bind("keydown",a.key[0]+" shift+"+a.key[0],o)}),s?i.attr("data-curopt",n[s].sel):i.attr("data-curopt")||i.attr("data-curopt",n[0].sel);var o=void 0,l=$$b(r).position();i.mousedown(function(e){if(i.hasClass("disabled"))return!1;var n=$$b(t),a=l.left+34,r=-1*n.width(),s=n.data("shown_popop")?200:0;o=setTimeout(function(){i.data("isLibrary")?n.css("left",a).show():n.css("left",r).show().animate({left:a},150),n.data("shown_popop",!0)},s),e.preventDefault()}).mouseup(function(e){clearTimeout(o);var t=$$b(this).attr("data-curopt");i.data("isLibrary")&&$$b(r.replace("_show","")).is(":visible")?M(r,!0):M(r)&&K[t]&&K[t]()})}),J(),o()},te=function(e,t){return $$b("<div>",{class:"tools_flyout",id:e}).appendTo("#svg_editor").append(t)},ne=function(){var e=void 0,t=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,n=document.getElementsByTagName("script")[0];for(e in n.style)if(t.test(e))return e.match(t)[0];return"WebkitOpacity"in n.style?"Webkit":"KhtmlOpacity"in n.style?"Khtml":""}(),ae=function(e,t,n,a){var i=$$b(e),s=a.dropUp;t=$$b(t),s&&$$b(e).addClass("dropup"),t.find("li").bind("mouseup",function(){a.seticon&&(r("#cur_"+i[0].id,$$b(this).children()),$$b(this).addClass("current").siblings().removeClass("current")),n.apply(this,arguments)});var o=!1;$$b(window).mouseup(function(e){o||(i.removeClass("down"),t.hide(),t.css({top:0,left:0})),o=!1}),i.bind("mousedown",function(){var e=i.offset();s?(e.top-=t.height(),e.left+=8):e.top+=i.height(),t.offset(e),i.hasClass("down")?(t.hide(),t.css({top:0,left:0})):(t.show(),o=!0),i.toggleClass("down")}).hover(function(){o=!0}).mouseout(function(){o=!1}),a.multiclick&&t.mousedown(function(){o=!0})},re=[];svgCanvas.bind("selected",function(e,t){var n=svgCanvas.getMode();"select"===n&&C();var a="pathedit"===n;N=1===t.length||null==t[1]?t[0]:null,G=t.length>=2&&null!=t[1],null!=N&&(a||function(){var e=void 0,t=void 0;if(null!=N)switch(N.tagName){case"use":case"image":case"foreignObject":break;case"g":case"a":var n=N.getElementsByTagName("*"),a=null;for(e=0,t=n.length;e<t;e++){var r=n[e].getAttribute("stroke-width");0===e?a=r:a!==r&&(a=null)}$$b("#stroke_width").val(null===a?"":a),p.fill.update(!0),p.stroke.update(!0);break;default:p.fill.update(!0),p.stroke.update(!0),$$b("#stroke_width").val(N.getAttribute("stroke-width")||1),$$b("#stroke_style").val(N.getAttribute("stroke-dasharray")||"none");var i=N.getAttribute("stroke-linejoin")||"miter";$$b("#linejoin_"+i).length&&I($$b("#linejoin_"+i)[0]),i=N.getAttribute("stroke-linecap")||"butt",$$b("#linecap_"+i).length&&I($$b("#linecap_"+i)[0])}if(null!=N){var s=100*(N.getAttribute("opacity")||1);$$b("#group_opacity").val(s),$$b("#opac_slider").slider("option","value",s),$$b("#elem_id").val(N.id),$$b("#elem_class").val(N.getAttribute("class"))}F()}()),function(e,t){$$b("#path_node_panel").toggle(e),$$b("#tools_bottom_2,#tools_bottom_3").toggle(!e),e?($$b(".tool_button_current").removeClass("tool_button_current").addClass("tool_button"),$$b("#tool_select").addClass("tool_button_current").removeClass("tool_button"),r("#tool_select","select_node"),G=!1,t.length&&(N=t[0])):setTimeout(function(){r("#tool_select","select")},1e3)}(a,t),U(),svgCanvas.runExtensions("selectedChanged",{elems:t,selectedElement:N,multiselected:G})}),svgCanvas.bind("transition",function(e,t){var n=svgCanvas.getMode(),a=t[0];if(a){if(!(G=t.length>=2&&null!=t[1]))switch(n){case"rotate":var r=svgCanvas.getRotationAngle(a);$$b("#angle").val(r),$$b("#tool_reorient").toggleClass("disabled",0===r)}svgCanvas.runExtensions("elementTransition",{elems:t})}}),svgCanvas.bind("changed",function(e,t){var n=svgCanvas.getMode();"select"===n&&C();for(var a=0;a<t.length;++a){var r=t[a],i=r&&"svg"===r.tagName;i||X(r)?(P(),i&&D()):r&&N&&null==N.parentNode&&(N=r)}editor.showSaveWarning=!0,U(),N&&"select"===n&&(p.fill.update(),p.stroke.update()),svgCanvas.runExtensions("elementChanged",{elems:t})}),svgCanvas.bind("saved",function(e,t){if(editor.showSaveWarning=!1,t='<?xml version="1.0"?>\n'+t,isIE())T(0,!0);else{var n=document.createElement("a");n.href="data:image/svg+xml;base64,"+encode64(t),n.download="icon.svg",n.click();var a=$$b.pref("save_notice_done");if("all"!==a){var r=uiStrings$1.notification.saveFromBrowser.replace("%s","SVG");isGecko()?t.includes("<defs")?(r+="\n\n"+uiStrings$1.notification.defsFailOnSave,$$b.pref("save_notice_done","all"),a="all"):$$b.pref("save_notice_done","part"):$$b.pref("save_notice_done","all"),"part"!==a&&alert(r)}}}),svgCanvas.bind("exported",function(e,t){var n=t.issues,a=t.exportWindowName;if(a&&(m=window.open(blankPageObjectURL||"",a)),m&&!m.closed){if(m.location.href=t.bloburl||t.datauri,"all"!==$$b.pref("export_notice_done")){var r=uiStrings$1.notification.saveFromBrowser.replace("%s",t.type);n.length&&(r+="\n\n"+uiStrings$1.notification.noteTheseIssues+"\n • "+n.join("\n • ")),$$b.pref("export_notice_done","all"),m.alert(r)}}else $$b.alert(uiStrings$1.notification.popupWindowBlocked)}),svgCanvas.bind("exportedPDF",function(e,t){var n=t.exportWindowName;n&&(m=window.open("",n)),m.location.href=t.dataurlstring}),svgCanvas.bind("zoomed",Y),svgCanvas.bind("zoomDone",W),svgCanvas.bind("updateCanvas",function(e,t){var n=t.center,a=t.newCtr;D(n,a)}),svgCanvas.bind("contextset",function(e,t){var n="";if(t){var a="";n='<a href="#" data-root="y">'+svgCanvas.getCurrentDrawing().getCurrentLayerName()+"</a>",$$b(t).parentsUntil("#svgcontent > g").andSelf().each(function(){this.id&&(a+=" > "+this.id,n+=this!==t?' > <a href="#">'+this.id+"</a>":" > "+this.id)}),z=a}else z=null;$$b("#cur_context_panel").toggle(!!t).html(n),q()}),svgCanvas.bind("extension_added",function(e,t){if(t){var n=!1,a=!1,r=!0;if(t.langReady)if(editor.langChanged){var i=$$b.pref("lang");t.langReady({lang:i,uiStrings:uiStrings$1})}else re.push(t);var s=function(){t.callback&&!n&&r&&(n=!0,t.callback())},o=[];if(t.context_tools&&$$b.each(t.context_tools,function(e,t){var n=t.container_id?' id="'+t.container_id+'"':"",a=$$b("#"+t.panel);a.length||(a=$$b("<div>",{id:t.panel}).appendTo("#tools_top"));var r=void 0;switch(t.type){case"tool_button":r='<div class="tool_button">'+t.id+"</div>";var i=$$b(r).appendTo(a);t.events&&$$b.each(t.events,function(e,t){$$b(i).bind(e,t)});break;case"select":r="<label"+n+'><select id="'+t.id+'">',$$b.each(t.options,function(e,n){var a=e===t.defval?" selected":"";r+='<option value="'+e+'"'+a+">"+n+"</option>"});var s=$$b(r+="</select></label>").appendTo(a).find("select");$$b.each(t.events,function(e,t){$$b(s).bind(e,t)});break;case"button-select":r='<div id="'+t.id+'" class="dropdown toolset" title="'+t.title+'"><div id="cur_'+t.id+'" class="icon_label"></div><button></button></div>';var l=$$b('<ul id="'+t.id+'_opts"></ul>').appendTo("#option_lists");t.colnum&&l.addClass("optcols"+t.colnum),$$b(r).appendTo(a).children(),o.push({elem:"#"+t.id,list:"#"+t.id+"_opts",title:t.title,callback:t.events.change,cur:"#cur_"+t.id});break;case"input":r="<label"+n+'><span id="'+t.id+'_label">'+t.label+':</span><input id="'+t.id+'" title="'+t.title+'" size="'+(t.size||"4")+'" value="'+(t.defval||"")+'" type="text"/></label>';var u=$$b(r).appendTo(a).find("input");t.spindata&&u.SpinButton(t.spindata),t.events&&$$b.each(t.events,function(e,t){u.bind(e,t)})}}),t.buttons){var u={},c={},h=t.svgicons,d={};$$b.each(t.buttons,function(e,t){for(var n=void 0,a=void 0,r=void 0,i=t.id,s=e;$$b("#"+i).length;)i=t.id+"_"+ ++s;h?(u[i]=t.icon,a=t.svgicon||t.id,"app_menu"===t.type?c["#"+i+" > div"]=a:c["#"+i]=a):n=$$b('<img src="'+t.icon+'">');var o=void 0,l=void 0;switch(t.type){case"mode_flyout":case"mode":o="tool_button",l="#tools_left";break;case"context":o="tool_button",l="#"+t.panel,$$b(l).length||$$b("<div>",{id:t.panel}).appendTo("#tools_top");break;case"app_menu":o="",l="#main_menu ul"}var f=void 0,p=void 0,g=void 0,v=void 0,m=void 0,y=$$b(t.list||"app_menu"===t.type?"<li/>":"<div/>").attr("id",i).attr("title",t.title).addClass(o);if(t.includeWith||t.list){if(t.list)y.addClass("push_button"),$$b("#"+t.list+"_opts").append(y),t.isDefault&&($$b("#cur_"+t.list).append(y.children().clone()),a=t.svgicon||t.id,c["#cur_"+t.list]=a);else if(t.includeWith){var b=t.includeWith;f=(m=$$b(b.button)).parent(),m.parent().hasClass("tools_flyout")||(r=m[0].id.replace("tool_","tools_"),g=m.clone().attr("id",r+"_show").append($$b("<div>",{class:"flyout_arrow_horiz"})),m.before(g),f=te(r,m)),v=qt.getButtonData(b.button),b.isDefault&&(c["#"+r+"_show"]=t.id),p=d["#"+f[0].id]=[{sel:"#"+i,fn:t.events.click,icon:t.id,key:t.key,isDefault:t.includeWith?t.includeWith.isDefault:0},v];var _="position"in b?b.position:"last",x=f.children().length;!isNaN(_)&&_>=0&&_<x?f.children().eq(_).before(y):(f.append(y),p.reverse())}}else"position"in t?$$b(l).children().eq(t.position).length?$$b(l).children().eq(t.position).before(y):$$b(l).children().last().before(y):y.appendTo(l),"mode_flyout"===t.type?(f=(m=$$b(y)).parent(),m.parent().hasClass("tools_flyout")||(r=m[0].id.replace("tool_","tools_"),g=m.clone().attr("id",r+"_show").append($$b("<div>",{class:"flyout_arrow_horiz"})),m.before(g),(f=te(r,m)).data("isLibrary",!0),g.data("isLibrary",!0)),c["#"+r+"_show"]=t.id,p=d["#"+f[0].id]=[{sel:"#"+i,fn:t.events.click,icon:t.id,isDefault:!0},v]):"app_menu"===t.type&&y.append("<div>").append(t.title);h||y.append(n),t.list||$$b.each(t.events,function(e,n){"click"===e&&"mode"===t.type?(t.includeWith?y.bind(e,n):y.bind(e,function(){M(y)&&n()}),t.key&&($$b(document).bind("keydown",t.key,n),t.title&&y.attr("title",t.title+" ["+t.key+"]"))):y.bind(e,n)}),ee(d)}),$$b.each(o,function(){ae(this.elem,this.list,this.callback,{seticon:!0})}),h&&(r=!1),$$b.svgIcons(h,{w:24,h:24,id_match:!1,no_img:!isWebkit(),fallback:u,placement:c,callback:function(e){"m"!==$$b.pref("iconsize")&&(g&&(clearTimeout(g),g=null),a||(g=setTimeout(function(){a=!0,l($$b.pref("iconsize"))},50))),r=!0,s()}})}s()}}),svgCanvas.textActions.setInputElem($$b("#text")[0]);var ie='<div class="palette_item" data-rgb="none"></div>';$$b.each(["#000000","#3f3f3f","#7f7f7f","#bfbfbf","#ffffff","#ff0000","#ff7f00","#ffff00","#7fff00","#00ff00","#00ff7f","#00ffff","#007fff","#0000ff","#7f00ff","#ff00ff","#ff007f","#7f0000","#7f3f00","#7f7f00","#3f7f00","#007f00","#007f3f","#007f7f","#003f7f","#00007f","#3f007f","#7f007f","#7f003f","#ffaaaa","#ffd4aa","#ffffaa","#d4ffaa","#aaffaa","#aaffd4","#aaffff","#aad4ff","#aaaaff","#d4aaff","#ffaaff","#ffaad4"],function(e,t){ie+='<div class="palette_item" style="background-color: '+t+';" data-rgb="'+t+'"></div>'}),$$b("#palette").append(ie);ie="",$$b.each(["#FFF","#888","#000"],function(){ie+='<div class="color_block" style="background-color:'+this+';"></div>'}),$$b("#bg_blocks").append(ie);var se=$$b("#bg_blocks div");se.each(function(){$$b(this).click(function(){se.removeClass("cur_background"),$$b(this).addClass("cur_background")})}),V($$b.pref("bkgd_color"),$$b.pref("bkgd_url")),$$b("#image_save_opts input").val([$$b.pref("img_save")]);var oe=function(e,t){null==t&&(t=e.value),$$b("#group_opacity").val(t),e&&e.handle||$$b("#opac_slider").slider("option","value",t),svgCanvas.setOpacity(t/100)},le=function(e,t,n){null==t&&(t=e.value),$$b("#blur").val(t);var a=!1;e&&e.handle||($$b("#blur_slider").slider("option","value",t),a=!0),n?svgCanvas.setBlurNoUndo(t):svgCanvas.setBlur(t,a)};$$b("#stroke_style").change(function(){svgCanvas.setStrokeAttr("stroke-dasharray",$$b(this).val()),L()}),$$b("#stroke_linejoin").change(function(){svgCanvas.setStrokeAttr("stroke-linejoin",$$b(this).val()),L()}),$$b("select").change(function(){$$b(this).blur()});var ue,ce,he,de,fe,pe=!1;$$b("#selLayerNames").change(function(){var e=this.options[this.selectedIndex].value,t=uiStrings$1.notification.QmoveElemsToLayer.replace("%s",e),n=function(t){t&&(pe=!0,svgCanvas.moveSelectedToLayer(e),svgCanvas.clearSelection(),P())};e&&(pe?n(!0):$$b.confirm(t,n))}),$$b("#font_family").change(function(){svgCanvas.setFontFamily(this.value)}),$$b("#seg_type").change(function(){svgCanvas.setSegType($$b(this).val())}),$$b("#text").bind("keyup input",function(){svgCanvas.setTextContent(this.value)}),$$b("#image_url").change(function(){O(this.value)}),$$b("#link_url").change(function(){this.value.length?svgCanvas.setLinkURL(this.value):svgCanvas.removeHyperlink()}),$$b("#g_title").change(function(){svgCanvas.setGroupTitle(this.value)}),$$b(".attr_changer").change(function(){var e=this.getAttribute("data-attr"),t=this.value;if(!isValidUnit(e,t,N))return $$b.alert(uiStrings$1.notification.invalidAttrValGiven),this.value=N.getAttribute(e),!1;if("id"!==e&&"class"!==e)if(isNaN(t))t=svgCanvas.convertToNum(e,t);else if("px"!==curConfig.baseUnit){var n=getTypeMap();(N[e]||"pathedit"===svgCanvas.getMode()||"x"===e||"y"===e)&&(t*=n[curConfig.baseUnit])}if("id"===e){var a=N;svgCanvas.clearSelection(),a.id=t,svgCanvas.addToSelection([a],!0)}else svgCanvas.changeSelectedAttribute(e,t);this.blur()}),$$b("#palette").mouseover(function(){var e=$$b('<input type="hidden">');$$b(this).append(e),e.focus().remove()}),$$b(".palette_item").mousedown(function(e){var t=e.shiftKey||2===e.button?"stroke":"fill",n=$$b(this).data("rgb"),a=void 0;"none"===n||"transparent"===n||"initial"===n?(n="none",a=new $$b.jGraduate.Paint):a=new $$b.jGraduate.Paint({alpha:100,solidColor:n.substr(1)}),p[t].setPaint(a),svgCanvas.setColor(t,n),"none"!==n&&1!==svgCanvas.getPaintOpacity(t)&&svgCanvas.setPaintOpacity(t,1),F()}).bind("contextmenu",function(e){e.preventDefault()}),$$b("#toggle_stroke_tools").on("click",function(){$$b("#tools_bottom").toggleClass("expanded")}),ue=d[0],ce=null,he=null,de=!1,fe=!1,$$b("#svgcanvas").bind("mousemove mouseup",function(e){if(!1!==de)return ue.scrollLeft-=e.clientX-ce,ue.scrollTop-=e.clientY-he,ce=e.clientX,he=e.clientY,"mouseup"===e.type&&(de=!1),!1}).mousedown(function(e){if(1===e.button||!0===fe)return de=!0,ce=e.clientX,he=e.clientY,!1}),$$b(window).mouseup(function(){de=!1}),$$b(document).bind("keydown","space",function(e){svgCanvas.spaceKey=fe=!0,e.preventDefault()}).bind("keyup","space",function(e){e.preventDefault(),svgCanvas.spaceKey=fe=!1}).bind("keydown","shift",function(e){"zoom"===svgCanvas.getMode()&&d.css("cursor",_)}).bind("keyup","shift",function(e){"zoom"===svgCanvas.getMode()&&d.css("cursor",b)}),editor.setPanning=function(e){svgCanvas.spaceKey=fe=e},function(){var e=$$b("#main_icon"),t=$$b("#main_icon span"),n=$$b("#main_menu"),a=!1,r=0,i=!0,s=!1;$$b(window).mouseup(function(t){a||(e.removeClass("buttondown"),"INPUT"!==t.target.tagName?n.fadeOut(200):s||(s=!0,$$b(t.target).click(function(){n.css("margin-left","-9999px").show()}))),a=!1}).mousedown(function(e){$$b(e.target).closest("div.tools_flyout, .contextMenu").length||$$b(".tools_flyout:visible,.contextMenu").fadeOut(250)}),t.bind("mousedown",function(){e.hasClass("buttondown")?n.fadeOut(200):(n.css("margin-left",0).show(),r||(r=n.height()),n.css("height",0).animate({height:r},200),a=!0),e.toggleClass("buttondown buttonup")}).hover(function(){a=!0}).mouseout(function(){a=!1});var o=$$b("#main_menu li");o.mouseover(function(){i="rgba(0, 0, 0, 0)"===$$b(this).css("background-color"),o.unbind("mouseover"),i&&o.mouseover(function(){this.style.backgroundColor="#FFC"}).mouseout(function(){return this.style.backgroundColor="transparent",!0})})}(),editor.addDropDown=function(e,t,n){if($$b(e).length){var a=$$b(e).find("button"),r=$$b(e).find("ul").attr("id",$$b(e)[0].id+"-list");n?$$b(e).addClass("dropup"):$$b("#option_lists").append(r),r.find("li").bind("mouseup",t);var i=!1;$$b(window).mouseup(function(e){i||(a.removeClass("down"),r.hide()),i=!1}),a.bind("mousedown",function(){if(a.hasClass("down"))r.hide();else{if(!n){var t=$$b(e).position();r.css({top:t.top+24,left:t.left-10})}r.show(),i=!0}a.toggleClass("down")}).hover(function(){i=!0}).mouseout(function(){i=!1})}},editor.addDropDown("#font_family_dropdown",function(){$$b("#font_family").val($$b(this).text()).change()}),editor.addDropDown("#opacity_dropdown",function(){if(!$$b(this).find("div").length){var e=parseInt($$b(this).text().split("%")[0],10);oe(!1,e)}},!0),$$b("#opac_slider").slider({start:function(){$$b("#opacity_dropdown li:not(.special)").hide()},stop:function(){$$b("#opacity_dropdown li").show(),$$b(window).mouseup()},slide:function(e,t){oe(t)}}),editor.addDropDown("#blur_dropdown",$$b.noop);var ge,ve,me=!1;$$b("#blur_slider").slider({max:10,step:.1,stop:function(e,t){me=!1,le(t),$$b("#blur_dropdown li").show(),$$b(window).mouseup()},start:function(){me=!0},slide:function(e,t){le(t,null,me)}}),editor.addDropDown("#zoom_dropdown",function(){var e=$$b(this),t=e.data("val");t?Y(window,t):Q({value:parseFloat(e.text())})},!0),ae("#stroke_linecap","#linecap_opts",function(){I(this,!0)},{dropUp:!0}),ae("#stroke_linejoin","#linejoin_opts",function(){I(this,!0)},{dropUp:!0}),ae("#tool_position","#position_opts",function(){var e=this.id.replace("tool_pos","").charAt(0);svgCanvas.alignSelectedElements(e,"page")},{multiclick:!0}),ge=void 0,ve=function(){$$b(ge).blur()},$$b("#svg_editor").find("button, select, input:not(#text)").focus(function(){ge=this,x="toolbars",d.mousedown(ve)}).blur(function(){x="canvas",d.unbind("mousedown",ve),"textedit"===svgCanvas.getMode()&&$$b("#text").focus()});var ye=function(){M("#tool_fhpath")&&svgCanvas.setMode("fhpath")},be=function(){M("#tool_line")&&svgCanvas.setMode("line")},_e=function(){M("#tool_square")&&svgCanvas.setMode("square")},xe=function(){M("#tool_rect")&&svgCanvas.setMode("rect")},Ce=function(){M("#tool_fhrect")&&svgCanvas.setMode("fhrect")},Se=function(){M("#tool_circle")&&svgCanvas.setMode("circle")},we=function(){M("#tool_ellipse")&&svgCanvas.setMode("ellipse")},ke=function(){M("#tool_fhellipse")&&svgCanvas.setMode("fhellipse")},$e=function(){M("#tool_image")&&svgCanvas.setMode("image")},Pe=function(){M("#tool_zoom")&&(svgCanvas.setMode("zoom"),d.css("cursor",b))},Ee=function(e){var t=svgCanvas.getResolution();e=e?t.zoom*e:1,$$b("#zoom").val(100*e),svgCanvas.setZoom(e),W(),D(!0)},Ae=function(){M("#tool_zoom")&&(Ee(),C())},Te=function(){M("#tool_text")&&svgCanvas.setMode("text")},Ne=function(){M("#tool_path")&&svgCanvas.setMode("path")},Ge=function(){(null!=N||G)&&svgCanvas.deleteSelectedElements()},Le=function(){(null!=N||G)&&svgCanvas.cutSelectedElements()},Ie=function(){(null!=N||G)&&svgCanvas.copySelectedElements()},Me=function(){var e=svgCanvas.getZoom(),t=(d[0].scrollLeft+d.width()/2)/e-svgCanvas.contentW,n=(d[0].scrollTop+d.height()/2)/e-svgCanvas.contentH;svgCanvas.pasteElements("point",t,n)},Be=function(){null!=N&&svgCanvas.moveToTopSelectedElement()},Oe=function(){null!=N&&svgCanvas.moveToBottomSelectedElement()},Ve=function(e){null!=N&&svgCanvas.moveUpDownSelected(e)},Re=function(){null!=N&&svgCanvas.convertToPath()},je=function(){null!=N&&c.reorient()},De=function(){(null!=N||G)&&$$b.prompt(uiStrings$1.notification.enterNewLinkURL,"http://",function(e){e&&svgCanvas.makeHyperlink(e)})},Fe=function(e,t){if(null!=N||G){if(curConfig.gridSnapping){var n=svgCanvas.getZoom()*curConfig.snappingStep;e*=n,t*=n}svgCanvas.moveSelectedElements(e,t)}},Ue=function(){$$b("#tool_node_link").toggleClass("push_button_pressed tool_button");var e=$$b("#tool_node_link").hasClass("push_button_pressed");c.linkControlPoints(e)},He=function(){c.getNodePoint()&&c.clonePathNode()},ze=function(){c.getNodePoint()&&c.deletePathNode()},qe=function(){var e=$$b("#tool_add_subpath"),t=!e.hasClass("push_button_pressed");e.toggleClass("push_button_pressed tool_button"),c.addSubPath(t)},Xe=function(){c.opencloseSubPath()},We=function(){svgCanvas.cycleElement(1)},Ye=function(){svgCanvas.cycleElement(0)},Qe=function(e,t){if(null!=N&&!G){e||(t*=-1);var n=parseFloat($$b("#angle").val())+t;svgCanvas.setRotationAngle(n),U()}},Ze=function(){var e=curConfig.dimensions;$$b.confirm(uiStrings$1.notification.QwantToClear,function(t){t&&(C(),svgCanvas.clear(),svgCanvas.setResolution(e[0],e[1]),D(!0),Ee(),P(),U(),Z(),svgCanvas.runExtensions("onNewDocument"))})},Ke=function(){return svgCanvas.setBold(!svgCanvas.getBold()),U(),!1},Je=function(){return svgCanvas.setItalic(!svgCanvas.getItalic()),U(),!1},et=void 0,tt=function(){$$b.select("Select an image type for export: ",["PNG","JPEG","BMP","WEBP","PDF"],function(e){if(e){var t=void 0;if("PDF"===e)customExportPDF||a(),svgCanvas.exportPDF(t);else{customExportImage||a();var n=parseInt($$b("#image-slider").val(),10)/100;svgCanvas.rasterExport(e,n,t)}}function a(){var e=uiStrings$1.notification.loadingImage;"new"===curConfig.exportWindowType&&editor.exportWindowCt++,t=curConfig.canvasName+editor.exportWindowCt;var n=void 0,a=void 0;if(et)a=et;else{if(n='<!DOCTYPE html><html><head><meta charset="utf-8"><title>'+e+"</title></head><body><h1>"+e+"</h1></body><html>",("undefined"==typeof URL||_typeof(URL))&&URL.createObjectURL){var r=new Blob([n],{type:"text/html"});a=URL.createObjectURL(r)}else a="data:text/html;base64;charset=utf-8,"+encode64(n);et=a}m=window.open(a,t)}},function(){var e=$$b(this);"JPEG"===e.val()||"WEBP"===e.val()?$$b("#image-slider").length||$$b("<div><label>"+uiStrings$1.ui.quality+'\n              <input id="image-slider"\n                type="range" min="1" max="100" value="92" />\n            </label></div>').appendTo(e.parent()):$$b("#image-slider").parent().remove()})},nt=function(){svgCanvas.open()},at=function(){},rt=function(){h.getUndoStackSize()>0&&(h.undo(),P())},it=function(){h.getRedoStackSize()>0&&(h.redo(),P())},st=function(){G?svgCanvas.groupSelectedElements():N&&svgCanvas.ungroupSelectedElement()},ot=function(){svgCanvas.cloneSelectedElements(20,20)},lt=function(){var e=this.id.replace("tool_align","").charAt(0);svgCanvas.alignSelectedElements(e,$$b("#align_relative_to").val())},ut=function(){if($$b("#tool_wireframe").toggleClass("push_button_pressed tool_button"),d.toggleClass("wireframe"),!Gt){var e=$$b("#wireframe_rules");e.length?e.empty():e=$$b('<style id="wireframe_rules"></style>').appendTo("head"),H()}};$$b("#svg_docprops_container, #svg_prefs_container").draggable({cancel:"button,fieldset",containment:"window"});var ct,ht,dt=!1,ft=!1,pt=function(){if(!dt){dt=!0,$$b("#image_save_opts input").val([$$b.pref("img_save")]);var e=svgCanvas.getResolution();"px"!==curConfig.baseUnit&&(e.w=convertUnit(e.w)+curConfig.baseUnit,e.h=convertUnit(e.h)+curConfig.baseUnit),$$b("#canvas_width").val(e.w),$$b("#canvas_height").val(e.h),$$b("#canvas_title").val(svgCanvas.getDocumentTitle()),$$b("#svg_docprops").show()}},gt=function(){$$b("#svg_source_editor").hide(),E=!1,$$b("#svg_source_textarea").blur()},vt=function(){if(E){var e=function(){svgCanvas.clearSelection(),gt(),Ee(),P(),q(),Z()};svgCanvas.setSvgString($$b("#svg_source_textarea").val())?e():$$b.confirm(uiStrings$1.notification.QerrorsRevertToSource,function(t){if(!t)return!1;e()}),C()}},mt=function(){$$b("#svg_docprops").hide(),$$b("#canvas_width,#canvas_height").removeAttr("disabled"),$$b("#resolution")[0].selectedIndex=0,$$b("#image_save_opts input").val([$$b.pref("img_save")]),dt=!1},yt=function(){$$b("#svg_prefs").hide(),ft=!1},bt=function(){var e=$$b("#canvas_title").val();q(e),svgCanvas.setDocumentTitle(e);var t=$$b("#canvas_width"),n=t.val(),a=$$b("#canvas_height"),r=a.val();return"fit"===n||isValidUnit("width",n)?(t.parent().removeClass("error"),"fit"===r||isValidUnit("height",r)?(a.parent().removeClass("error"),svgCanvas.setResolution(n,r)?($$b.pref("img_save",$$b("#image_save_opts :checked").val()),D(),void mt()):($$b.alert(uiStrings$1.notification.noContentToFitTo),!1)):($$b.alert(uiStrings$1.notification.invalidAttrValGiven),a.parent().addClass("error"),!1)):($$b.alert(uiStrings$1.notification.invalidAttrValGiven),t.parent().addClass("error"),!1)},_t=editor.savePreferences=function(){V($$b("#bg_blocks div.cur_background").css("background-color")||"#FFF",$$b("#canvas_bg_url").val());var e=$$b("#lang_select").val();e!==$$b.pref("lang")&&editor.putLocale(e,t,curConfig),l($$b("#iconsize").val()),curConfig.gridSnapping=$$b("#grid_snapping_on")[0].checked,curConfig.snappingStep=$$b("#grid_snapping_step").val(),curConfig.gridColor=$$b("#grid_color").val(),curConfig.showRulers=$$b("#show_rulers")[0].checked,$$b("#rulers").toggle(curConfig.showRulers),curConfig.showRulers&&j(),curConfig.baseUnit=$$b("#base_unit").val(),svgCanvas.setConfig(curConfig),D(),yt()},xt=$$b.noop,Ct=function(){$$b("#dialog_box").hide(),E||dt||ft?(E?A!==$$b("#svg_source_textarea").val()?$$b.confirm(uiStrings$1.notification.QignoreSourceChanges,function(e){e&&gt()}):gt():dt?mt():ft&&yt(),xt()):z&&svgCanvas.leaveContext()},St={width:$$b(window).width(),height:$$b(window).height()};if(isIE()&&(xt=function(){0===d[0].scrollLeft&&0===d[0].scrollTop&&(d[0].scrollLeft=v.left,d[0].scrollTop=v.top)},v={left:d[0].scrollLeft,top:d[0].scrollTop},$$b(window).resize(xt),editor.ready(function(){setTimeout(function(){xt()},500)}),d.scroll(function(){v={left:d[0].scrollLeft,top:d[0].scrollTop}})),$$b(window).resize(function(e){$$b.each(St,function(e,t){var n=$$b(window)[e]();d[0]["scroll"+("width"===e?"Left":"Top")]-=(n-t)/2,St[e]=n}),o()}),d.scroll(function(){$$b("#ruler_x").length&&($$b("#ruler_x")[0].scrollLeft=d[0].scrollLeft),$$b("#ruler_y").length&&($$b("#ruler_y")[0].scrollTop=d[0].scrollTop)}),$$b("#url_notice").click(function(){$$b.alert(this.title)}),$$b("#change_image_url").click(R),ct="tool_button_current",ht="",$$b.each(["clear","open","save","source","delete","delete_multi","paste","clone","clone_multi","move_top","move_bottom"],function(e,t){ht+=(e?",":"")+"#tool_"+t}),$$b(ht).mousedown(function(){$$b(this).addClass(ct)}).bind("mousedown mouseout",function(){$$b(this).removeClass(ct)}),$$b("#tool_undo, #tool_redo").mousedown(function(){$$b(this).hasClass("disabled")||$$b(this).addClass(ct)}).bind("mousedown mouseout",function(){$$b(this).removeClass(ct)}),isMac()&&!window.opera)for(var wt=["tool_clear","tool_save","tool_source","tool_undo","tool_redo","tool_clone"],kt=wt.length;kt--;){var $t=document.getElementById(wt[kt]);if($t){var Pt=$t.title,Et=Pt.indexOf("Ctrl+");$t.title=[Pt.substr(0,Et),"Cmd+",Pt.substr(Et+5)].join("")}}var At=function(e){var t="stroke_color"===e.attr("id")?"stroke":"fill",n="stroke"===t?"Pick a Stroke Paint and Opacity":"Pick a Fill Paint and Opacity",a=e.offset(),r=p[t].paint;$$b("#color_picker").draggable({cancel:".jGraduate_tabs, .jGraduate_colPick, .jGraduate_gradPick, .jPicker",containment:"window"}).css(curConfig.colorPickerCSS||{left:a.left-140,bottom:40}).jGraduate({paint:r,window:{pickerTitle:n},images:{clientPath:curConfig.jGraduatePath},newstop:"inverse"},function(e){r=new $$b.jGraduate.Paint(e),p[t].setPaint(r),svgCanvas.setPaint(t,r),$$b("#color_picker").hide()},function(){$$b("#color_picker").hide()})},Tt=function(e,t){var n=void 0,a=void 0,r=curConfig["fill"===t?"initFill":"initStroke"],i=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg"><rect width="16.5" height="16.5"          fill="#'+r.color+'" opacity="'+r.opacity+'"/>          <defs><linearGradient id="gradbox_"/></defs></svg>',"text/xml").documentElement;(i=$$b(e)[0].appendChild(document.importNode(i,!0))).setAttribute("width",16.5),this.rect=i.firstChild,this.defs=i.getElementsByTagName("defs")[0],this.grad=this.defs.firstChild,this.paint=new $$b.jGraduate.Paint({solidColor:r.color}),this.type=t,this.setPaint=function(e,t){this.paint=e;var r=e.type,i=e.alpha/100,s="none";switch(r){case"solidColor":s="none"!==e[r]?"#"+e[r]:e[r];break;case"linearGradient":case"radialGradient":this.defs.removeChild(this.grad),this.grad=this.defs.appendChild(e[r]),s="url(#"+(this.grad.id="gradbox_"+this.type)+")"}this.rect.setAttribute("fill",s),this.rect.setAttribute("opacity",i),t&&(svgCanvas.setColor(this.type,n,!0),svgCanvas.setPaintOpacity(this.type,a,!0))},this.update=function(e){if(N){var t=this.type;switch(N.tagName){case"use":case"image":case"foreignObject":return;case"g":case"a":for(var r=N.getElementsByTagName("*"),i=null,s=0,o=r.length;s<o;s++){var l=r[s].getAttribute(t);if(0===s)i=l;else if(i!==l){i=null;break}}if(null===i)return void(n=null);n=i,a=1;break;default:a=parseFloat(N.getAttribute(t+"-opacity")),isNaN(a)&&(a=1);var u="fill"===t?"black":"none";n=N.getAttribute(t)||u}e&&(svgCanvas.setColor(t,n,!0),svgCanvas.setPaintOpacity(t,a,!0));var c=function(e,t,n){var a={alpha:t};if(e.startsWith("url(#")){var r=svgCanvas.getRefElem(e);a[(r=r?r.cloneNode(!0):$$b("#"+n+"_color defs *")[0]).tagName]=r}else e.startsWith("#")?a.solidColor=e.substr(1):a.solidColor="none";return new $$b.jGraduate.Paint(a)}(n,a*=100,t);this.setPaint(c)}},this.prep=function(){switch(this.paint.type){case"linearGradient":case"radialGradient":var e=new $$b.jGraduate.Paint({copy:this.paint});svgCanvas.setPaint(t,e)}}};p.fill=new Tt("#fill_color","fill"),p.stroke=new Tt("#stroke_color","stroke"),$$b("#stroke_width").val(curConfig.initStroke.width),$$b("#group_opacity").val(100*curConfig.initOpacity);var Nt=p.fill.rect.cloneNode(!1);Nt.setAttribute("style","vector-effect:non-scaling-stroke");var Gt="non-scaling-stroke"===Nt.style.vectorEffect;Nt.removeAttribute("style");var Lt,It,Mt=p.fill.rect.ownerDocument.createElementNS(NS.SVG,"feGaussianBlur");function Bt(){svgCanvas.deleteCurrentLayer()&&(U(),P(),$$b("#layerlist tr.layer").removeClass("layersel"),$$b("#layerlist tr.layer:first").addClass("layersel"))}function Ot(e){var t=svgCanvas.getCurrentDrawing().getNumLayers(),n=$$b("#layerlist tr.layersel").index();(n>0||n<t-1)&&(n+=e,svgCanvas.setCurrentLayerPosition(t-n-1),P())}void 0===Mt.stdDeviationX&&$$b("#tool_blur").hide(),$$b(Mt).remove(),Lt="-"+ne.toLowerCase()+"-zoom-",It=Lt+"in",d.css("cursor",It),d.css("cursor")===It&&(b=It,_=Lt+"out"),d.css("cursor","auto"),setTimeout(function(){svgCanvas.embedImage("images/logo.png",function(e){e||($$b("#image_save_opts [value=embed]").attr("disabled","disabled"),$$b("#image_save_opts input").val(["ref"]),$$b.pref("img_save","ref"),$$b("#image_opt_embed").css("color","#666").attr("title",uiStrings$1.notification.featNotSupported))})},1e3),$$b("#fill_color, #tool_fill .icon_label").click(function(){At($$b("#fill_color")),F()}),$$b("#stroke_color, #tool_stroke .icon_label").click(function(){At($$b("#stroke_color")),F()}),$$b("#group_opacityLabel").click(function(){$$b("#opacity_dropdown button").mousedown(),$$b(window).mouseup()}),$$b("#zoomLabel").click(function(){$$b("#zoom_dropdown button").mousedown(),$$b(window).mouseup()}),$$b("#tool_move_top").mousedown(function(e){$$b("#tools_stacking").show(),e.preventDefault()}),$$b(".layer_button").mousedown(function(){$$b(this).addClass("layer_buttonpressed")}).mouseout(function(){$$b(this).removeClass("layer_buttonpressed")}).mouseup(function(){$$b(this).removeClass("layer_buttonpressed")}),$$b(".push_button").mousedown(function(){$$b(this).hasClass("disabled")||$$b(this).addClass("push_button_pressed").removeClass("push_button")}).mouseout(function(){$$b(this).removeClass("push_button_pressed").addClass("push_button")}).mouseup(function(){$$b(this).removeClass("push_button_pressed").addClass("push_button")}),$$b("#layer_new").click(function(){var e=void 0,t=svgCanvas.getCurrentDrawing().getNumLayers();do{e=uiStrings$1.layers.layer+" "+ ++t}while(svgCanvas.getCurrentDrawing().hasLayer(e));$$b.prompt(uiStrings$1.notification.enterUniqueLayerName,e,function(e){e&&(svgCanvas.getCurrentDrawing().hasLayer(e)?$$b.alert(uiStrings$1.notification.dupeLayerName):(svgCanvas.createLayer(e),U(),P()))})}),$$b("#layer_delete").click(Bt),$$b("#layer_up").click(function(){Ot(-1)}),$$b("#layer_down").click(function(){Ot(1)}),$$b("#layer_rename").click(function(){var e=$$b("#layerlist tr.layersel td.layername").text();$$b.prompt(uiStrings$1.notification.enterNewLayerName,"",function(t){t&&(e===t||svgCanvas.getCurrentDrawing().hasLayer(t)?$$b.alert(uiStrings$1.notification.layerHasThatName):(svgCanvas.renameCurrentLayer(t),P()))})});var Vt=-1,Rt=!1,jt=!1,Dt=function(e){var t=$$b("#ruler_x");$$b("#sidepanels").width("+="+e),$$b("#layerpanel").width("+="+e),t.css("right",parseInt(t.css("right"),10)+e),d.css("right",parseInt(d.css("right"),10)+e),svgCanvas.runExtensions("workareaResized")},Ft=function(e){if(jt&&-1!==Vt){Rt=!0;var t=Vt-e.pageX,n=$$b("#sidepanels").width();n+t>300?(t=300-n,n=300):n+t<2&&(t=2-n,n=2),0!==t&&(Vt-=t,Dt(t))}},Ut=function(e){var t=$$b("#sidepanels").width();Dt((t>2||e?2:150)-t)};$$b("#sidepanel_handle").mousedown(function(e){Vt=e.pageX,$$b(window).mousemove(Ft),jt=!1,setTimeout(function(){jt=!0},20)}).mouseup(function(e){Rt||Ut(),Vt=-1,Rt=!1}),$$b(window).mouseup(function(){Vt=-1,Rt=!1,$$b("#svg_editor").unbind("mousemove",Ft)}),P();$$b(window).bind("load resize",function(){d.css("line-height",d.height()+"px")}),$$b("#resolution").change(function(){var e=$$b("#canvas_width,#canvas_height");if(this.selectedIndex)if("content"===this.value)e.val("fit").attr("disabled","disabled");else{var t=this.value.split("x");$$b("#canvas_width").val(t[0]),$$b("#canvas_height").val(t[1]),e.removeAttr("disabled")}else"fit"===$$b("#canvas_width").val()&&e.removeAttr("disabled").val(100)}),$$b("input,select").attr("autocomplete","off");var Ht,zt,qt=(Ht=[{sel:"#tool_select",fn:B,evt:"click",key:["V",!0]},{sel:"#tool_fhpath",fn:ye,evt:"click",key:["Q",!0]},{sel:"#tool_line",fn:be,evt:"click",key:["L",!0]},{sel:"#tool_rect",fn:xe,evt:"mouseup",key:["R",!0],parent:"#tools_rect",icon:"rect"},{sel:"#tool_square",fn:_e,evt:"mouseup",parent:"#tools_rect",icon:"square"},{sel:"#tool_fhrect",fn:Ce,evt:"mouseup",parent:"#tools_rect",icon:"fh_rect"},{sel:"#tool_ellipse",fn:we,evt:"mouseup",key:["E",!0],parent:"#tools_ellipse",icon:"ellipse"},{sel:"#tool_circle",fn:Se,evt:"mouseup",parent:"#tools_ellipse",icon:"circle"},{sel:"#tool_fhellipse",fn:ke,evt:"mouseup",parent:"#tools_ellipse",icon:"fh_ellipse"},{sel:"#tool_path",fn:Ne,evt:"click",key:["P",!0]},{sel:"#tool_text",fn:Te,evt:"click",key:["T",!0]},{sel:"#tool_image",fn:$e,evt:"mouseup"},{sel:"#tool_zoom",fn:Pe,evt:"mouseup",key:["Z",!0]},{sel:"#tool_clear",fn:Ze,evt:"mouseup",key:["N",!0]},{sel:"#tool_save",fn:function(){var e;E?vt():(e={images:$$b.pref("img_save"),round_digits:6},svgCanvas.save(e))},evt:"mouseup",key:["S",!0]},{sel:"#tool_export",fn:tt,evt:"mouseup"},{sel:"#tool_open",fn:nt,evt:"mouseup",key:["O",!0]},{sel:"#tool_import",fn:at,evt:"mouseup"},{sel:"#tool_source",fn:T,evt:"click",key:["U",!0]},{sel:"#tool_wireframe",fn:ut,evt:"click",key:["F",!0]},{sel:"#tool_source_cancel,.overlay,#tool_docprops_cancel,#tool_prefs_cancel",fn:Ct,evt:"click",key:["esc",!1,!1],hidekey:!0},{sel:"#tool_source_save",fn:vt,evt:"click"},{sel:"#tool_docprops_save",fn:bt,evt:"click"},{sel:"#tool_docprops",fn:pt,evt:"mouseup"},{sel:"#tool_prefs_save",fn:_t,evt:"click"},{sel:"#tool_prefs_option",fn:function(){return function(){if(!ft){ft=!0,$$b("#main_menu").hide();var e=$$b("#bg_blocks div"),t="cur_background",n=curPrefs.bkgd_color,a=$$b.pref("bkgd_url");e.each(function(){var e=$$b(this),a=e.css("background-color")===n;e.toggleClass(t,a),a&&$$b("#canvas_bg_url").removeClass(t)}),n||e.eq(0).addClass(t),a&&$$b("#canvas_bg_url").val(a),$$b("#grid_snapping_on").prop("checked",curConfig.gridSnapping),$$b("#grid_snapping_step").attr("value",curConfig.snappingStep),$$b("#grid_color").attr("value",curConfig.gridColor),$$b("#svg_prefs").show()}}(),!1},evt:"mouseup"},{sel:"#tool_delete,#tool_delete_multi",fn:Ge,evt:"click",key:["del/backspace",!0]},{sel:"#tool_reorient",fn:je,evt:"click"},{sel:"#tool_node_link",fn:Ue,evt:"click"},{sel:"#tool_node_clone",fn:He,evt:"click"},{sel:"#tool_node_delete",fn:ze,evt:"click"},{sel:"#tool_openclose_path",fn:Xe,evt:"click"},{sel:"#tool_add_subpath",fn:qe,evt:"click"},{sel:"#tool_move_top",fn:Be,evt:"click",key:"ctrl+shift+]"},{sel:"#tool_move_bottom",fn:Oe,evt:"click",key:"ctrl+shift+["},{sel:"#tool_topath",fn:Re,evt:"click"},{sel:"#tool_make_link,#tool_make_link_multi",fn:De,evt:"click"},{sel:"#tool_undo",fn:rt,evt:"click"},{sel:"#tool_redo",fn:it,evt:"click"},{sel:"#tool_clone,#tool_clone_multi",fn:ot,evt:"click",key:["D",!0]},{sel:"#tool_group_elements",fn:st,evt:"click",key:["G",!0]},{sel:"#tool_ungroup",fn:st,evt:"click"},{sel:"#tool_unlink_use",fn:st,evt:"click"},{sel:"[id^=tool_align]",fn:lt,evt:"click"},{sel:"#tool_bold",fn:Ke,evt:"mousedown"},{sel:"#tool_italic",fn:Je,evt:"mousedown"},{sel:"#sidepanel_handle",fn:Ut,key:["X"]},{sel:"#copy_save_done",fn:Ct,evt:"click"},{key:"ctrl+left",fn:function(){Qe(0,1)}},{key:"ctrl+right",fn:function(){Qe(1,1)}},{key:"ctrl+shift+left",fn:function(){Qe(0,5)}},{key:"ctrl+shift+right",fn:function(){Qe(1,5)}},{key:"shift+O",fn:Ye},{key:"shift+P",fn:We},{key:[u+"up",!0],fn:function(){Ee(2)}},{key:[u+"down",!0],fn:function(){Ee(.5)}},{key:[u+"]",!0],fn:function(){Ve("Up")}},{key:[u+"[",!0],fn:function(){Ve("Down")}},{key:["up",!0],fn:function(){Fe(0,-1)}},{key:["down",!0],fn:function(){Fe(0,1)}},{key:["left",!0],fn:function(){Fe(-1,0)}},{key:["right",!0],fn:function(){Fe(1,0)}},{key:"shift+up",fn:function(){Fe(0,-10)}},{key:"shift+down",fn:function(){Fe(0,10)}},{key:"shift+left",fn:function(){Fe(-10,0)}},{key:"shift+right",fn:function(){Fe(10,0)}},{key:["alt+up",!0],fn:function(){svgCanvas.cloneSelectedElements(0,-1)}},{key:["alt+down",!0],fn:function(){svgCanvas.cloneSelectedElements(0,1)}},{key:["alt+left",!0],fn:function(){svgCanvas.cloneSelectedElements(-1,0)}},{key:["alt+right",!0],fn:function(){svgCanvas.cloneSelectedElements(1,0)}},{key:["alt+shift+up",!0],fn:function(){svgCanvas.cloneSelectedElements(0,-10)}},{key:["alt+shift+down",!0],fn:function(){svgCanvas.cloneSelectedElements(0,10)}},{key:["alt+shift+left",!0],fn:function(){svgCanvas.cloneSelectedElements(-10,0)}},{key:["alt+shift+right",!0],fn:function(){svgCanvas.cloneSelectedElements(10,0)}},{key:"A",fn:function(){svgCanvas.selectAllInCurrentLayer()}},{key:u+"z",fn:rt},{key:u+"shift+z",fn:it},{key:u+"y",fn:it},{key:u+"x",fn:Le},{key:u+"c",fn:Ie},{key:u+"v",fn:Me}],zt={"4/Shift+4":"#tools_rect_show","5/Shift+5":"#tools_ellipse_show"},{setAll:function(){var e={};$$b.each(Ht,function(t,n){var a=void 0;if(n.sel){if(!(a=$$b(n.sel)).length)return!0;if(n.evt&&(isTouch()&&"click"===n.evt&&(n.evt="mousedown"),a[n.evt](n.fn)),n.parent&&$$b(n.parent+"_show").length){var r=$$b(n.parent);r.length||(r=te(n.parent.substr(1))),r.append(a),Array.isArray(e[n.parent])||(e[n.parent]=[]),e[n.parent].push(n)}}if(n.key){var i=void 0,s=!1;Array.isArray(n.key)?(i=n.key[0],n.key.length>1&&(s=n.key[1])):i=n.key,i+="";var o=n.fn;if($$b.each(i.split("/"),function(e,t){$$b(document).bind("keydown",t,function(e){return o(),s&&e.preventDefault(),!1})}),n.sel&&!n.hidekey&&a.attr("title")){var l=a.attr("title").split("[")[0]+" ("+i+")";zt[i]=n.sel,a.parents("#main_menu").length||a.attr("title",l)}}}),ee(e),$$b(".attr_changer, #image_url").bind("keydown","return",function(e){$$b(this).change(),e.preventDefault()}),$$b(window).bind("keydown","tab",function(e){"canvas"===x&&(e.preventDefault(),We())}).bind("keydown","shift+tab",function(e){"canvas"===x&&(e.preventDefault(),Ye())}),$$b("#tool_zoom").dblclick(Ae)},setTitles:function(){$$b.each(zt,function(e,t){var n=$$b(t).parents("#main_menu").length;$$b(t).each(function(){var t=void 0;t=n?$$b(this).text().split(" [")[0]:this.title.split(" [")[0];var a="";$$b.each(e.split("/"),function(e,t){var n=t.split("+"),r="";n.length>1&&(r=n[0]+"+",t=n[1]),a+=(e?"/":"")+r+(uiStrings$1["key_"+t]||t)}),n?this.lastChild.textContent=t+" ["+a+"]":this.title=t+" ["+a+"]"})})},getButtonData:function(e){var t=void 0;return $$b.each(Ht,function(n,a){a.sel===e&&(t=a)}),t}});qt.setAll(),editor.ready(function(){var e=curConfig.initTool,t=$$b("#tools_left, #svg_editor .tools_flyout"),n=t.find("#tool_"+e),a=t.find("#"+e);(n.length?n:a.length?a:$$b("#tool_select")).click().mouseup(),curConfig.wireframe&&$$b("#tool_wireframe").click(),curConfig.showlayers&&Ut(),$$b("#rulers").toggle(!!curConfig.showRulers),curConfig.showRulers&&($$b("#show_rulers")[0].checked=!0),curConfig.baseUnit&&$$b("#base_unit").val(curConfig.baseUnit),curConfig.gridSnapping&&($$b("#grid_snapping_on")[0].checked=!0),curConfig.snappingStep&&$$b("#grid_snapping_step").val(curConfig.snappingStep),curConfig.gridColor&&$$b("#grid_color").val(curConfig.gridColor)}),$$b("#rect_rx").SpinButton({min:0,max:1e3,stateObj:s,callback:function(e){svgCanvas.setRectRadius(e.value)}}),$$b("#stroke_width").SpinButton({min:0,max:99,smallStep:.1,stateObj:s,callback:function(e){var t=e.value;0===t&&N&&["line","polyline"].includes(N.nodeName)&&(t=e.value=1),svgCanvas.setStrokeWidth(t)}}),$$b("#angle").SpinButton({min:-180,max:180,step:5,stateObj:s,callback:function(e){svgCanvas.setRotationAngle(e.value),$$b("#tool_reorient").toggleClass("disabled",0===parseInt(e.value,10))}}),$$b("#font_size").SpinButton({min:.001,stepfunc:function(e,t){var n=Number(e.value),a=n+t,r=a>=n;return 0===t?n:n>=24?r?Math.round(1.1*n):Math.round(n/1.1):n<=1?r?2*n:n/2:a},stateObj:s,callback:function(e){svgCanvas.setFontSize(e.value)}}),$$b("#group_opacity").SpinButton({min:0,max:100,step:5,stateObj:s,callback:oe}),$$b("#blur").SpinButton({min:0,max:10,step:.1,stateObj:s,callback:le}),$$b("#zoom").SpinButton({min:.001,max:1e4,step:50,stepfunc:function(e,t){var n=Number(e.value);if(0===n)return 100;var a=n+t;return 0===t?n:n>=100?a:a>=n?2*n:n/2},stateObj:s,callback:Q}).val(100*svgCanvas.getZoom()),$$b("#workarea").contextMenu({menu:"cmenu_canvas",inSpeed:0},function(e,t,n){switch(e){case"delete":Ge();break;case"cut":Le();break;case"copy":Ie();break;case"paste":svgCanvas.pasteElements();break;case"paste_in_place":svgCanvas.pasteElements("in_place");break;case"group":case"group_elements":svgCanvas.groupSelectedElements();break;case"ungroup":svgCanvas.ungroupSelectedElement();break;case"move_front":Be();break;case"move_up":Ve("Up");break;case"move_down":Ve("Down");break;case"move_back":Oe();break;default:hasCustomHandler(e)&&getCustomHandler(e).call()}});var Xt=function(e,t,n){switch(e){case"dupe":a=svgCanvas.getCurrentDrawing().getCurrentLayerName()+" copy",$$b.prompt(uiStrings$1.notification.enterUniqueLayerName,a,function(e){e&&(svgCanvas.getCurrentDrawing().hasLayer(e)?$$b.alert(uiStrings$1.notification.dupeLayerName):(svgCanvas.cloneLayer(e),U(),P()))});break;case"delete":Bt();break;case"merge_down":$$b("#layerlist tr.layersel").index()!==svgCanvas.getCurrentDrawing().getNumLayers()-1&&(svgCanvas.mergeLayer(),U(),P());break;case"merge_all":svgCanvas.mergeAllLayers(),U(),P()}var a};if($$b("#layerlist").contextMenu({menu:"cmenu_layers",inSpeed:0},Xt),$$b("#layer_moreopts").contextMenu({menu:"cmenu_layers",inSpeed:0,allowLeft:!0},Xt),$$b(".contextMenu li").mousedown(function(e){e.preventDefault()}),$$b("#cmenu_canvas li").disableContextMenu(),f.enableContextMenuItems("#delete,#cut,#copy"),f[(localStorage.getItem("svgedit_clipboard")?"en":"dis")+"ableContextMenuItems"]("#paste,#paste_in_place"),window.addEventListener("storage",function(e){"svgedit_clipboard"===e.key&&f[(localStorage.getItem("svgedit_clipboard")?"en":"dis")+"ableContextMenuItems"]("#paste,#paste_in_place")}),window.addEventListener("beforeunload",function(e){if(0===h.getUndoStackSize()&&(editor.showSaveWarning=!1),!curConfig.no_save_warning&&editor.showSaveWarning)return e.returnValue=uiStrings$1.notification.unsavedChanges,uiStrings$1.notification.unsavedChanges},!1),editor.canvas.getUIStrings=function(){return uiStrings$1},editor.openPrep=function(e){$$b("#main_menu").hide(),0===h.getUndoStackSize()?e(!0):$$b.confirm(uiStrings$1.notification.QwantToOpen,e)},window.FileReader){var Wt=function(e){$$b.process_cancel(uiStrings$1.notification.loadingImage),e.stopPropagation(),e.preventDefault(),$$b("#workarea").removeAttr("style"),$$b("#main_menu").hide();var t="drop"===e.type?e.dataTransfer.files[0]:this.files[0];if(t){if(t.type.includes("image")){var n=void 0;t.type.includes("svg")?((n=new FileReader).onloadend=function(e){var t=svgCanvas.importSvgString(e.target.result,!0);svgCanvas.ungroupSelectedElement(),svgCanvas.ungroupSelectedElement(),svgCanvas.groupSelectedElements(),svgCanvas.alignSelectedElements("m","page"),svgCanvas.alignSelectedElements("c","page"),svgCanvas.selectOnly([t]),$$b("#dialog_box").hide()},n.readAsText(t)):((n=new FileReader).onloadend=function(e){var t=100,n=100,a=new Image;a.src=e.target.result,a.style.opacity=0,a.onload=function(){var r,i,s;t=a.offsetWidth,n=a.offsetHeight,r=t,i=n,s=svgCanvas.addSvgElementFromJson({element:"image",attr:{x:0,y:0,width:r,height:i,id:svgCanvas.getNextId(),style:"pointer-events:inherit"}}),svgCanvas.setHref(s,e.target.result),svgCanvas.selectOnly([s]),svgCanvas.alignSelectedElements("m","page"),svgCanvas.alignSelectedElements("c","page"),U(),$$b("#dialog_box").hide()}},n.readAsDataURL(t))}}else $$b("#dialog_box").hide()};d[0].addEventListener("dragenter",function(e){e.stopPropagation(),e.preventDefault()},!1),d[0].addEventListener("dragover",function(e){e.stopPropagation(),e.preventDefault()},!1),d[0].addEventListener("dragleave",function(e){e.stopPropagation(),e.preventDefault()},!1),d[0].addEventListener("drop",Wt,!1);var Yt=$$b('<input type="file">').change(function(){var e=this;editor.openPrep(function(t){if(t&&(svgCanvas.clear(),1===e.files.length)){$$b.process_cancel(uiStrings$1.notification.loadingImage);var n=new FileReader;n.onloadend=function(e){loadSvgString(e.target.result),D()},n.readAsText(e.files[0])}})});$$b("#tool_open").show().prepend(Yt);var Qt=$$b('<input type="file">').change(Wt);$$b("#tool_import").show().prepend(Qt)}D(!0),window.svgCanvas=svgCanvas,svgCanvas.ready=editor.ready;var Zt=editor.setLang=function(e,t){if(editor.langChanged=!0,$$b.pref("lang",e),$$b("#lang_select").val(e),t){$$b.extend(uiStrings$1,t);var n=$$b("#layerlist tr.layersel td.layername").text()===uiStrings$1.common.layer+" 1";if(svgCanvas.setUiStrings(t),qt.setTitles(),n&&(svgCanvas.renameCurrentLayer(uiStrings$1.common.layer+" 1"),P()),re.length)for(;re.length;){re.shift().langReady({lang:e,uiStrings:uiStrings$1})}else svgCanvas.runExtensions("langReady",{lang:e,uiStrings:uiStrings$1});svgCanvas.runExtensions("langChanged",e),J();$$b.each({"#stroke_color":"#tool_stroke .icon_label, #tool_stroke .color_block","#fill_color":"#tool_fill label, #tool_fill .color_block","#linejoin_miter":"#cur_linejoin","#linecap_butt":"#cur_linecap"},function(e,t){$$b(t).attr("title",$$b(e)[0].title)}),$$b("#multiselected_panel div[id^=tool_align]").each(function(){$$b("#tool_pos"+this.id.substr(10))[0].title=this.title})}};init$7({addLangData:function(e){return editor.canvas.runExtensions("addlangData",e,!0)},curConfig:curConfig,setLang:Zt}),"file:"===document.location.protocol?setTimeout(i,100):i()},editor.ready=function(e){isReady?e():callbacks.push(e)},editor.runCallbacks=function(){Promise.all(callbacks.map(function(e){return e()})).then(function(){isReady=!0})},editor.loadFromString=function(e){editor.ready(function(){loadSvgString(e)})},editor.disableUI=function(e){},editor.loadFromURL=function(e,t){t||(t={});var n=t,a=n.cache,r=n.callback;editor.ready(function(){$$b.ajax({url:e,dataType:"text",cache:!!a,beforeSend:function(){$$b.process_cancel(uiStrings$1.notification.loadingImage)},success:function(e){loadSvgString(e,r)},error:function(e,t,n){404!==e.status&&e.responseText?loadSvgString(e.responseText,r):$$b.alert(uiStrings$1.notification.URLloadFail+": \n"+n,r)},complete:function(){$$b("#dialog_box").hide()}})})},editor.loadFromDataURI=function(e){editor.ready(function(){var t=!1,n=e.match(/^data:image\/svg\+xml;base64,/);n?t=!0:n=e.match(/^data:image\/svg\+xml(?:;(?:utf8)?)?,/),n&&(n=n[0]);var a=e.slice(n.length);loadSvgString(t?decode64(a):decodeURIComponent(a))})},editor.addExtension=function(){var e=arguments;svgCanvas&&svgCanvas.addExtension.apply(this,e)},editor.ready(function(){injectExtendedContextMenuItemsIntoDom()}),Promise.resolve().then(function(){editor.init()});export default editor;
//# sourceMappingURL=index-es.min.js.map
